{
  "circa": {
    "title": "Tempus Finance contest",
    "sponsor": "Tempus Finance",
    "slug": "2021-10-tempus",
    "date": "2021-11-08",
    "findings": "https://github.com/code-423n4/2021-10-tempus-findings/issues",
    "contest": 37
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the code contest outlined in this document, C4 conducted an analysis of Tempus Finance contest smart contract system written in Solidity. The code contest took place between October 14—October 20 2021.</p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>14 Wardens contributed reports to the Tempus Finance audit contest:</p>\n<ol>\n<li><a href=\"https://twitter.com/gpersoon\">gpersoon</a></li>\n<li><a href=\"https://twitter.com/cmichelio\">cmichel</a></li>\n<li><a href=\"https://twitter.com/PMerkleplant\">pmerkleplant</a></li>\n<li>pants</li>\n<li>hyh</li>\n<li>chenyu</li>\n<li><a href=\"https://twitter.com/WatchPug_\">WatchPug</a></li>\n<li><a href=\"https://github.com/TomAFrench\">TomFrench</a></li>\n<li><a href=\"https://twitter.com/loop_225\">loop</a></li>\n<li><a href=\"https://twitter.com/defsec_\">defsec</a></li>\n<li>Koustre</li>\n<li>0xMesaj</li>\n<li><a href=\"https://twitter.com/SolidityDev\">pauliax</a></li>\n<li><a href=\"https://twitter.com/_ye0lde\">ye0lde</a></li>\n</ol>\n<p>This contest was judged by <a href=\"https://github.com/0xean\">0xean</a>.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/itsmetechjay\">itsmetechjay</a> and <a href=\"https://twitter.com/CloudEllie1\">CloudEllie</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 8 unique vulnerabilities and 37 total findings. All of the issues presented here are linked back to their original finding.</p>\n<p>Of these vulnerabilities, 1 received a risk rating in the category of HIGH severity, 2 received a risk rating in the category of MEDIUM severity, and 5 received a risk rating in the category of LOW severity.</p>\n<p>C4 analysis also identified 12 non-critical recommendations and 16 gas optimizations.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2021-10-tempus\">C4 Tempus Finance contest repository</a>, and is composed of 40 smart contracts written in the Solidity programming language, and includes 3,903 lines of Solidity code.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code423n4.com\">the C4 website</a>.</p>\n<!-- ============ -->\n<!-- ============ -->\n<h1 id=\"high-risk-findings-1\" style=\"position:relative;\"><a href=\"#high-risk-findings-1\" aria-label=\"high risk findings 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>High Risk Findings (1)</h1>\n<h2 id=\"h-01-steal-tokens-from-tempuscontroller\" style=\"position:relative;\"><a href=\"#h-01-steal-tokens-from-tempuscontroller\" aria-label=\"h 01 steal tokens from tempuscontroller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/10\">[H-01] Steal tokens from TempusController</a></h2>\n<p><em>Submitted by gpersoon</em>.</p>\n<h4 id=\"impact\" style=\"position:relative;\"><a href=\"#impact\" aria-label=\"impact permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Impact</h4>\n<p>The function <code>\\_depositAndProvideLiquidity</code> can be used go retrieve arbitrary ERC20 tokens from the TempusController.sol contract.</p>\n<p>As the test contract of TempusController.sol <a href=\"https://goerli.etherscan.io/address/0xd4330638b87f97ec1605d7ec7d67ea1de5dd7aaa\">https://goerli.etherscan.io/address/0xd4330638b87f97ec1605d7ec7d67ea1de5dd7aaa</a> shows, it has indeed ERC20 tokens.</p>\n<p>The problem is due to the fact that you supply an arbitrary tempusAMM to depositAndProvideLiquidity and thus to <code>\\_depositAndProvideLiquidity</code>.\ntempusAMM could be a fake contract that supplies values that are completely fake.</p>\n<p>At the end of the function <code>\\_depositAndProvideLiquidity</code>, ERC20 tokens are send to the user. If you can manipulate the variables ammTokens,  mintedShares  and sharesUsed you can send back\nany tokens held in the contract\n“ammTokens[0].safeTransfer(msg.sender, mintedShares - sharesUsed[0]);”</p>\n<p>The Proof of Concept shows an approach to do this.</p>\n<h4 id=\"proof-of-concept\" style=\"position:relative;\"><a href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus/blob/63f7639aad08f2bba717830ed81e0649f7fc23ee/contracts/TempusController.sol#L73-L79\">https://github.com/code-423n4/2021-10-tempus/blob/63f7639aad08f2bba717830ed81e0649f7fc23ee/contracts/TempusController.sol#L73-L79</a></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus/blob/63f7639aad08f2bba717830ed81e0649f7fc23ee/contracts/TempusController.sol#L304-L335\">https://github.com/code-423n4/2021-10-tempus/blob/63f7639aad08f2bba717830ed81e0649f7fc23ee/contracts/TempusController.sol#L304-L335</a></li>\n<li>Create a fake Vault contract (fakeVault) with the following functions:\n<code>fakeVault.getPoolTokens(poolId)</code> —> returns {TokenToSteal1,TokenToSteal2},{fakeBalance1,fakeBalance2},0\n<code>fakeVault.JoinPoolRequest()</code> —> do nothing\n<code>fakeVault.joinPool()</code> —> do nothing</li>\n<li>Create a fake Pool contract (fakePool) with the following functions:\n<code>fakePool.yieldBearingToken()</code> —> returns fakeYieldBearingToken\n<code>fakePool.deposit()</code> —> returns fakeMintedShares,…</li>\n<li>Create a fake ammTokens contract with the following functions:\n<code>tempusAMM.getVault()</code> —> returns fakeVault\n<code>tempusAMM.getPoolId()</code> —> returns 0\n<code>tempusAMM.tempusPool()</code> —> returns fakePool</li>\n<li>call depositAndProvideLiquidity(fakeTempusAMM,1,false) // false -> yieldBearingToken\n_getAMMDetailsAndEnsureInitialized returns fakeVault,0, {token1,token2},{balance1,balance2}\n_deposit(fakePool,1,false) calls _depositYieldBearing which calls <code>fakePool.deposit()</code>  and returns fakeMintedShares\n_provideLiquidity(…)  calculates a vale of ammLiquidityProvisionAmounts\n_provideLiquidity(…)  skips the safeTransferFrom because sender == address(this))\nthe calls to fakeVault.JoinPoolRequest() and fakeVault.joinPool() can be faked.\n_provideLiquidity(…)  returns the value ammLiquidityProvisionAmounts</li>\n</ul>\n<p>Now fakeMintedShares - ammLiquidityProvisionAmounts number of TokenToSteal1 and TokenToSteal2 are transferred to msg.sender</p>\n<p>As you can both manipulate TokenToSteal1 and fakeMintedShares, you can transfer any token to msg.sender</p>\n<h4 id=\"recommended-mitigation-steps\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h4>\n<p>Create a whitelist for tempusAMMs</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/10#issuecomment-946718849\">mijovic (Tempus) confirmed</a>:</strong></p>\n<blockquote>\n<p>This is a good point. However, these tokens that are locked in <code>TempusController</code> are coming from dust that was left when the user is doing early redemption. As this needs to be done with equal shares, we have a threshold parameter that is used as the maximum leftover behind redemption (usually there is a need to do a swap before redemption to make this work). So, this is going to be pennies always.</p>\n<p>I would not consider this as high risk, and we are not planning to fix this as steps to make this hack are too complicated to steal pennies… Also, the gas cost of doing it costs by far more than the funds that someone can steal.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/10#issuecomment-946905741\">mijovic (Tempus) commented</a>:</strong></p>\n<blockquote>\n<p>We changed point of view here a little bit. Will add registry of TempusAMMs and TempusPools that can be used with controller, just to prevent possible attacks with fake amms and pools.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/10#issuecomment-948351797\">mijovic (Tempus) patched</a>:</strong></p>\n<blockquote>\n<p>Added whitelist registry for both <code>TempusAMM</code> and <code>TempusPool</code> in this PR <a href=\"https://github.com/tempus-finance/tempus-protocol/pull/365\">https://github.com/tempus-finance/tempus-protocol/pull/365</a>\nHowever, as amount of tokens that TempusController holds is so small (I would say this is of severity 2)</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/10#issuecomment-954181571\">0xean (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The C4 docs don’t speculate on the amount of assets stolen in the TLDR of risk assessment.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">3 — High: Assets can be stolen/lost/compromised directly (or indirectly if there is a valid attack path that does not have hand-wavy hypotheticals).</span></span></code></pre>\n<p>Given the fact that some amount of assets could be stolen, i believe this is the correct severity for the issue.</p>\n</blockquote>\n<h1 id=\"medium-risk-findings-2\" style=\"position:relative;\"><a href=\"#medium-risk-findings-2\" aria-label=\"medium risk findings 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings (2)</h1>\n<h2 id=\"m-01-exittempusamm-can-be-made-to-fail\" style=\"position:relative;\"><a href=\"#m-01-exittempusamm-can-be-made-to-fail\" aria-label=\"m 01 exittempusamm can be made to fail permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/21\">[M-01] <code>exitTempusAMM</code> can be made to fail</a></h2>\n<p><em>Submitted by cmichel</em>.</p>\n<p>There’s a griefing attack where an attacker can make any user transaction for <code>TempusController.exitTempusAMM</code> fail.\nIn <code>_exitTempusAMM</code>, the user exits their LP position and claims back yield and principal shares.\nThe LP amounts to redeem are determined by the function parameter <code>lpTokensAmount</code>.\nA final <code>assert(tempusAMM.balanceOf(address(this)) == 0)</code> statement checks that the LP token amount of the contract is zero after the exit.\nThis is only true if no other LP shares were already in the contract.</p>\n<p>However, an attacker can frontrun this call and send the smallest unit of LP shares to the contract which then makes the original deposit-and-fix transaction fail.</p>\n<h4 id=\"impact-1\" style=\"position:relative;\"><a href=\"#impact-1\" aria-label=\"impact 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Impact</h4>\n<p>All <code>exitTempusAMM</code> calls can be made to fail and this function becomes unusable.</p>\n<h4 id=\"recommended-mitigation-steps-1\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-1\" aria-label=\"recommended mitigation steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h4>\n<p>Remove the <code>assert</code> check.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/21#issuecomment-947962445\">mijovic (Tempus) confirmed</a>:</strong></p>\n<blockquote>\n<p>Great finding. This can block people exiting AMM via <code>TempusController</code>.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/21#issuecomment-948350606\">mijovic (Tempus) patched</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/tempus-finance/tempus-protocol/pull/369\">https://github.com/tempus-finance/tempus-protocol/pull/369</a></p>\n</blockquote>\n<h2 id=\"m-02-depositandfix-can-be-made-to-fail\" style=\"position:relative;\"><a href=\"#m-02-depositandfix-can-be-made-to-fail\" aria-label=\"m 02 depositandfix can be made to fail permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/20\">[M-02] <code>depositAndFix</code> can be made to fail</a></h2>\n<p><em>Submitted by cmichel</em>.</p>\n<p>There’s a griefing attack where an attacker can make any user transaction for <code>TempusController.depositAndFix</code> fail.\nIn <code>_depositAndFix</code>, <code>swapAmount</code> many yield shares are swapped to principal where <code>swapAmount</code> is derived from the function arguments.\nA final <code>assert(yieldShares.balanceOf(address(this)) == 0)</code> statement checks that the yield shares of the contract are zero after the swap.\nThis is only true if no other yield shares were already in the contract.</p>\n<p>However, an attacker can frontrun this call and send the smallest unit of yield shares to the contract which then makes the original deposit-and-fix transaction fail.</p>\n<h4 id=\"impact-2\" style=\"position:relative;\"><a href=\"#impact-2\" aria-label=\"impact 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Impact</h4>\n<p>All <code>depositAndFix</code> calls can be made to fail and this function becomes unusable.</p>\n<h4 id=\"recommended-mitigation-steps-2\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-2\" aria-label=\"recommended mitigation steps 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h4>\n<p>Remove the <code>assert</code> check.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/20#issuecomment-948017482\">mijovic confirmed</a>:</strong></p>\n<blockquote>\n<p>Good catch. This can block users from doing this action via controller</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/20#issuecomment-948350220\">mijovic patched</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/tempus-finance/tempus-protocol/pull/370\">https://github.com/tempus-finance/tempus-protocol/pull/370</a></p>\n</blockquote>\n<h1 id=\"low-risk-findings-5\" style=\"position:relative;\"><a href=\"#low-risk-findings-5\" aria-label=\"low risk findings 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk Findings (5)</h1>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/12\">[L-01] Param <code>initInterestRate</code> in <code>TempusPool::constructor</code> should not be 0</a> <em>Submitted by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/39\">[L-02] Open TODOs</a> <em>Submitted by pants.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/23\">[L-03] No <code>swap</code> slippage checks</a> <em>Submitted by cmichel, also found by hyh.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/9\">[L-04] PermanentlyOwnable does not prevent transferring ownership to a dead address.</a> <em>Submitted by chenyu.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/7\">[L-05] Scaling factors for token 0/1 might swap in TempusAMM constructor.</a> <em>Submitted by chenyu.</em></li>\n</ul>\n<h1 id=\"non-critical-findings-12\" style=\"position:relative;\"><a href=\"#non-critical-findings-12\" aria-label=\"non critical findings 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non-Critical Findings (12)</h1>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/29\">[N-01] Typos</a> <em>Submitted by WatchPug.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/24\">[N-02] <code>transferFees</code> may not be the contract itself</a> <em>Submitted by cmichel.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/46\">[N-03] <code>internal</code> functions can be <code>private</code></a> <em>Submitted by pants.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/37\">[N-04] <code>getAMMOrderedAmounts</code> and <code>_exitTempusAmmAndRedeem</code> functions use explicit token comparison for ordering instead of relying on Balancer’s PoolTokens</a> <em>Submitted by hyh.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/14\">[N-05] Aave/Compound pools result in liquidity mining returns being lost</a> <em>Submitted by TomFrench.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/48\">[N-06] <code>depositYieldBearing</code> didn’t check address <code>!= 0</code></a> <em>Submitted by pants.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/6\">[N-07] No zero address check for controller in <code>TempusPool</code></a> <em>Submitted by loop.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/25\">[N-08] <code>_setAmplificationData</code> should clear upper bits of values</a> <em>Submitted by cmichel.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/13\">[N-09] cToken funds are locked if Compound’s exchange rate is 0</a> <em>Submitted by pmerkleplant.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/5\">[N-10] Improper Access Control</a> <em>Submitted by defsec.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/32\">[N-11] Lack of validation for Maturity Date</a> <em>Submitted by Koustre.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/8\">[N-12] Manipulating <code>updateInterestRate()</code> in Tempus Pools to mint more Principal and Yield Tokens Than They Should</a> <em>Submitted by 0xMesaj.</em></li>\n</ul>\n<h1 id=\"gas-optimizations-16\" style=\"position:relative;\"><a href=\"#gas-optimizations-16\" aria-label=\"gas optimizations 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations (16)</h1>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/15\">[G-01] Use of <code>matured</code> storage variable is unnecessary</a> <em>Submitted by TomFrench.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/16\">[G-02] Repeated token transfers on deposits are unnecessary</a> <em>Submitted by TomFrench.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/18\">[G-03] TempusAMM freezing all actions except proportional exit on maturity seems unnecessary</a> <em>Submitted by  TomFrench.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/38\">[G-04] Use of <code>uint8</code> for counter in <code>for</code> loop increases gas costs</a> <em>Submitted by  TomFrench, also found by pauliax.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/30\">[G-05] Adding unchecked directive can save gas</a> <em>Submitted by WatchPug, also found by pauliax.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/31\">[G-06] Cache array length in for loops can save gas</a> <em>Submitted by WatchPug, also found by pants.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/26\">[G-07] Gas: Don’t store cToken twice</a> <em>Submitted by cmichel.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/40\">[G-08] Prefix increaments are cheaper than postfix increaments</a> <em>Submitted by pants.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/45\">[G-09] <code>public</code> functions can be <code>external</code></a> <em>Submitted by pants.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/33\">[G-10] Unused imports</a> <em>Submitted by pauliax.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/36\">[G-11] <code>for</code> loop with <code>_TOTAL_TOKENS</code></a> <em>Submitted by pauliax.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/28\">[G-12] Long Revert Strings</a> <em>Submitted by ye0lde.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/4\">[G-13] Named Return Issues</a> <em>Submitted by ye0lde.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/17\">[G-14] Inheritance from <code>BaseGeneralPool</code> is unused</a> <em>Submitted by TomFrench.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/27\">[G-15] Gas: <code>ERC20OwnerMintableToken.burn</code> should use caller</a> <em>Submitted by cmichel.</em></li>\n<li><a href=\"https://github.com/code-423n4/2021-10-tempus-findings/issues/11\">[G-16] Make <code>protocolName</code> variables in protocol pools constant</a> <em>Submitted by pmerkleplant.</em></li>\n</ul>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li>\n<p><a href=\"#high-risk-findings-1\">High Risk Findings (1)</a></p>\n<ul>\n<li><a href=\"#h-01-steal-tokens-from-tempuscontroller\">[H-01] Steal tokens from TempusController</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#medium-risk-findings-2\">Medium Risk Findings (2)</a></p>\n<ul>\n<li><a href=\"#m-01-exittempusamm-can-be-made-to-fail\">[M-01] <code>exitTempusAMM</code> can be made to fail</a></li>\n<li><a href=\"#m-02-depositandfix-can-be-made-to-fail\">[M-02] <code>depositAndFix</code> can be made to fail</a></li>\n</ul>\n</li>\n<li><a href=\"#low-risk-findings-5\">Low Risk Findings (5)</a></li>\n<li><a href=\"#non-critical-findings-12\">Non-Critical Findings (12)</a></li>\n<li><a href=\"#gas-optimizations-16\">Gas Optimizations (16)</a></li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>"
}