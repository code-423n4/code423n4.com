{
  "circa": {
    "title": "Forgotten Runes Warrior Guild contest",
    "sponsor": "Forgotten Runes",
    "slug": "2022-05-runes",
    "date": "2022-08-04",
    "findings": "https://github.com/code-423n4/2022-05-runes-findings/issues",
    "contest": 118
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code4rena (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 audit contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the audit contest outlined in this document, C4 conducted an analysis of the Forgotten Runes Warrior Guild smart contract system written in Solidity. The audit contest took place between May 3—May 5 2022.</p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>102 Wardens contributed reports to the Forgotten Runes Warrior Guild contest:</p>\n<ol>\n<li>AuditsAreUS</li>\n<li>BowTiedWardens (BowTiedHeron, BowTiedPickle, <a href=\"BowTiedETHernal\">m4rio_eth</a>, <a href=\"https://twitter.com/JustDravee\">Dravee</a>, and BowTiedFirefox)</li>\n<li>IllIllI</li>\n<li><a href=\"https://twitter.com/Pedroais2/\">pedroais</a></li>\n<li><a href=\"https://twitter.com/defsec_\">defsec</a></li>\n<li><a href=\"https://twitter.com/0xruhum\">Ruhum</a></li>\n<li>sorrynotsorry</li>\n<li><a href=\"https://www.instagram.com/riyan_rfa/\">rfa</a></li>\n<li>VAD37</li>\n<li><a href=\"https://twitter.com/MaratCerby\">MaratCerby</a></li>\n<li><a href=\"https://twitter.com/shenwilly_\">shenwilly</a></li>\n<li><a href=\"https://twitter.com/WatchPug_\">WatchPug</a> (<a href=\"https://github.com/jack-the-pug\">jtp</a> and <a href=\"https://github.com/mingwatch\">ming</a>)</li>\n<li><a href=\"https://twitter.com/0xteddav\">teddav</a></li>\n<li><a href=\"https://twitter.com/0xleastwood\">leastwood</a></li>\n<li>GimelSec (<a href=\"https://twitter.com/rayn731\">rayn</a> and sces60107)</li>\n<li><a href=\"https://twitter.com/Throt7le\">throttle</a></li>\n<li>0xDjango</li>\n<li>unforgiven</li>\n<li>reassor</li>\n<li>hake</li>\n<li><a href=\"https://twitter.com/shunduquar\">shung</a></li>\n<li><a href=\"https://twitter.com/father0fBl0cks\">fatherOfBlocks</a></li>\n<li>dipp</li>\n<li>0x1f8b</li>\n<li>dirk_y</li>\n<li><a href=\"https://twitter.com/rajat_beladiya\">rajatbeladiya</a></li>\n<li><a href=\"https://twitter.com/DavidKulman3\">Kulk0</a></li>\n<li><a href=\"https://twitter.com/0xhyh\">hyh</a></li>\n<li><a href=\"https://twitter.com/0xbroccolirob\">broccolirob</a></li>\n<li>Dinddle</li>\n<li><a href=\"https://twitter.com/JoeStakey\">joestakey</a></li>\n<li>horsefacts</li>\n<li><a href=\"https://twitter.com/HickupH\">hickuphh3</a></li>\n<li>robee</li>\n<li><a href=\"https://twitter.com/0xliumin\">0xliumin</a></li>\n<li>ilan</li>\n<li>p4st13r4 (<a href=\"https://github.com/0x69e8\">0x69e8</a> and 0xb4bb4)</li>\n<li>TrungOre</li>\n<li><a href=\"https://github.com/z3s/\">z3s</a></li>\n<li>rotcivegaf</li>\n<li>hubble (ksk2345 and shri4net)</li>\n<li><a href=\"https://twitter.com/berndartmueller\">berndartmueller</a></li>\n<li>tintin</li>\n<li>cccz</li>\n<li>m9800</li>\n<li>peritoflores</li>\n<li>0xkatana</li>\n<li>FSchmoede</li>\n<li><a href=\"https://twitter.com/_Czar102\">Czar102</a></li>\n<li><a href=\"https://twitter.com/KenzoAgada\">kenzo</a></li>\n<li>TerrierLover</li>\n<li><a href=\"https://twitter.com/catchup22\">catchup</a></li>\n<li>kenta</li>\n<li>0x4non</li>\n<li>marximimus</li>\n<li><a href=\"https://twitter.com/SolidityDev\">pauliax</a></li>\n<li>delfin454000</li>\n<li>kebabsec (okkothejawa and <a href=\"https://twitter.com/FlameHorizon1\">FlameHorizon</a>)</li>\n<li>0xf15ers (remora and twojoy)</li>\n<li><a href=\"https://twitter.com/_0v3rf10w\">0v3rf10w</a></li>\n<li><a href=\"https://twitter.com/CertoraInc\">CertoraInc</a> (egjlmn1, <a href=\"https://twitter.com/ori_dabush\">OriDabush</a>, ItayG, and shakedwinder)</li>\n<li><a href=\"https://twitter.com/ellahinator\">ellahi</a></li>\n<li>minhquanym</li>\n<li>oyc_109</li>\n<li><a href=\"https://twitter.com/thePicodes\">Picodes</a></li>\n<li>eccentricexit</li>\n<li><a href=\"https://instagram.com/vanensurya\">Funen</a></li>\n<li><a href=\"https://twitter.com/hansfriese\">hansfriese</a></li>\n<li>Hawkeye (0xwags and 0xmint)</li>\n<li>M0ndoHEHE</li>\n<li>samruna</li>\n<li>simon135</li>\n<li>Cr4ckM3</li>\n<li><a href=\"http://seanseefried.org/blog\">sseefried</a></li>\n<li>0x52</li>\n<li><a href=\"https://twitter.com/csanuragjain\">csanuragjain</a></li>\n<li>cryptphi</li>\n<li><a href=\"https://twitter.com/plotchy\">plotchy</a></li>\n<li>saian</li>\n<li>0xc0ffEE</li>\n<li><a href=\"https://twitter.com/0xNazgul\">0xNazgul</a></li>\n<li><a href=\"https://github.com/antoncoding\">antonttc</a></li>\n<li>Cityscape</li>\n<li>DavidGialdi</li>\n<li><a href=\"https://milotruck.github.io/\">MiloTruck</a></li>\n<li>slywaters</li>\n<li><a href=\"https://github.com/htadashi\">Tadashi</a></li>\n<li><a href=\"https://twitter.com/praiseprof\">0xProf</a></li>\n<li>ACai</li>\n<li>AlleyCat</li>\n<li>noobie</li>\n<li>RoiEvenHaim</li>\n</ol>\n<p>This contest was judged by <a href=\"https://twitter.com/gzeon\">gzeon</a>. The judge also competed in the contest as a warden, but forfeited their winnings.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/liveactionllama\">liveactionllama</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 6 unique vulnerabilities. Of these vulnerabilities, 0 received a risk rating in the category of HIGH severity and 6 received a risk rating in the category of MEDIUM severity.</p>\n<p>Additionally, C4 analysis included 75 reports detailing issues with a risk rating of LOW severity or non-critical. There were also 73 reports recommending gas optimizations.</p>\n<p>All of the issues presented here are linked back to their original finding.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2022-05-runes\">C4 Forgotten Runes Warrior Guild contest repository</a>, and is composed of 5 smart contracts written in the Solidity programming language and includes 712 lines of Solidity code.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low/non-critical.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code4rena.com\">the C4 website</a>.</p>\n<h1 id=\"medium-risk-findings-6\" style=\"position:relative;\"><a href=\"#medium-risk-findings-6\" aria-label=\"medium risk findings 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings (6)</h1>\n<h2 id=\"m-01-ierc20transfer-does-not-support-all-erc20-token\" style=\"position:relative;\"><a href=\"#m-01-ierc20transfer-does-not-support-all-erc20-token\" aria-label=\"m 01 ierc20transfer does not support all erc20 token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/70\">[M-01] IERC20.transfer does not support all ERC20 token</a></h2>\n<p><em>Submitted by VAD37, also found by AuditsAreUS, IllIllI, MaratCerby, rfa, and sorrynotsorry</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsGuild.sol#L173-L176\">ForgottenRunesWarriorsGuild.sol#L173-L176</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L627-L630\">ForgottenRunesWarriorsMinter.sol#L627-L630</a><br></p>\n<p>Token like <a href=\"https://etherscan.io/address/0xdac17f958d2ee523a2206206994597c13d831ec7#contracts\">USDT</a> known for using non-standard ERC20. (<a href=\"https://forum.openzeppelin.com/t/can-not-call-the-function-approve-of-the-usdt-contract/2130/4\">Missing return boolean on transfer</a>).</p>\n<p>Contract function <a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsGuild.sol#L173-L176\">forwardERC20</a> will always revert when try to transfer this kind of tokens.</p>\n<h3 id=\"impact\" style=\"position:relative;\"><a href=\"#impact\" aria-label=\"impact permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Impact</h3>\n<p>Cannot withdraw some special ERC20 token through contract call. Unexpected contract functionality = Medium severity</p>\n<h3 id=\"recommended-mitigation-steps\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Use <a href=\"https://github.com/Rari-Capital/solmate/blob/4197b521ef3eb81f675d35e64b7b597b24d33500/src/utils/SafeTransferLib.sol#L65-L94\">SafeTransferLib.safeTransfer</a> instead of IERC20 transfer. This accepts ERC20 token with no boolean return like USDT.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1118097813\">cryppadotta (Forgotten Runes) confirmed and commented</a>:</strong></p>\n<blockquote>\n<p>Ah nice. You learn something new every day. Thanks!</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1147126705\">KenzoAgada (warden) commented</a>:</strong></p>\n<blockquote>\n<p>Description is pretty much invalid as ”<a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsGuild.sol#L173-L176\">forwardERC20</a> will always revert when try to transfer this kind of tokens” is simply not true. Same with impact - “Cannot withdraw some special ERC20 token through contract call” - that’s not the impact, using SafeERC20’s transfer will not help to transfer tokens. It will just revert on failure.\nBut generally the issue of not using SafeERC20 is kinda-correct. Duplicate of <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/2\">#2</a>.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1159516016\">gzeon (judge) commented</a>:</strong></p>\n<blockquote>\n<p>This is not a duplicate of <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/2\">#2</a>. #2 describes the silent failure of ERC20 transfer, while this describes a ERC20 that return void instead of bool. The call will revert even if the transfer is successful because Solidity expected a return value. Judging as Med Risk because unlike #2, here you can actually do something to fix the function.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1159630893\">KenzoAgada (warden) commented</a>:</strong></p>\n<blockquote>\n<p>I apologize, my mistake.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-02-contract-may-not-have-enough-fund-to-cover-refund\" style=\"position:relative;\"><a href=\"#m-02-contract-may-not-have-enough-fund-to-cover-refund\" aria-label=\"m 02 contract may not have enough fund to cover refund permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/187\">[M-02] Contract may not have enough fund to cover refund</a></h2>\n<p><em>Submitted by gzeon, also found by AuditsAreUS, BowTiedWardens, pedroais, Ruhum, shenwilly, and teddav</em></p>\n<p>Owner of the contract can call <code>withdrawAll</code> before the refund process is done to send all ETH to the vault. Since there are no payable receive function in <code>ForgottenRunesWarriorsMinter</code>, the owner won’t be able to replenish the contract for the refund process.</p>\n<h3 id=\"proof-of-concept\" style=\"position:relative;\"><a href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L616-L619\">ForgottenRunesWarriorsMinter.sol#L616-L619</a><br></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">withdrawAll</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">payable</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onlyOwner</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;no vault&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-1\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-1\" aria-label=\"recommended mitigation steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Only allow owner to call <code>withdrawAll</code> after refund period.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/187#issuecomment-1119768097\">cryppadotta (Forgotten Runes) confirmed and commented</a>:</strong></p>\n<blockquote>\n<p>This is a great point. It would be annoying to accidentally do this and have to make a new contract for refunds.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/187#issuecomment-1159518087\">gzeon (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Sponsor confirmed, submitted by contest judge.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-03-critical-variables-shouldnt-be-changed-after-they-are-set\" style=\"position:relative;\"><a href=\"#m-03-critical-variables-shouldnt-be-changed-after-they-are-set\" aria-label=\"m 03 critical variables shouldnt be changed after they are set permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/38\">[M-03] Critical variables shouldn’t be changed after they are set</a></h2>\n<p><em>Submitted by pedroais, also found by AuditsAreUS, BowTiedWardens, defsec, GimelSec, gzeon, IllIllI, leastwood, and WatchPug</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L564\">ForgottenRunesWarriorsMinter.sol#L564</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L571\">ForgottenRunesWarriorsMinter.sol#L571</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L557\">ForgottenRunesWarriorsMinter.sol#L557</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L571\">ForgottenRunesWarriorsMinter.sol#L571</a><br></p>\n<p>The price for the dutch auction could be altered.</p>\n<h3 id=\"proof-of-concept-1\" style=\"position:relative;\"><a href=\"#proof-of-concept-1\" aria-label=\"proof of concept 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>I previously sent an issue about start time being settable more than once. This also happens for many other variables. Since they are many I will send them all in a single issue.</p>\n<p>The following functions should only be called once to ensure trustlessness and integrity of the dutch auction:<br>\nsetDaPriceCurveLength<br>\nsetStartPrice<br>\nsetLowestPrice<br>\nsetDaDropInterval<br></p>\n<p>The price in the dutch auction is computed by this formula:<br>\nuint256 dropPerStep = (startPrice - lowestPrice) /<br>\n(daPriceCurveLength / daDropInterval);<br></p>\n<p>By making dapriceCurveLength or daDropInterval equal to 0 the owner could stop the auction. This could benefit the owner since the price lowers with time and everyone pays the final lower price. If the auction does well at the beginning the owner could stop the auction to stop the price from being lower. This works against the integrity of the dutch auction.</p>\n<p>Also changing the Start Price or the Lowest price in the middle of the auction could allow the owner to manipulate the price.</p>\n<h3 id=\"recommended-mitigation-steps-2\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-2\" aria-label=\"recommended mitigation steps 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>To each of these setter functions add require (variable == 0) to ensure they are set once in a permanent way. Also, the Lowest price &#x3C; startPrice should be required.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/38#issuecomment-1159524932\">gzeon (judge) commented</a>:</strong></p>\n<blockquote>\n<p>While centralization risk is acknowledged by the team, I agree that these variable should not be able to be changed during sale since it may lead to loss of functionality. Consolidating all similar issue for different variables here. </p>\n</blockquote>\n<hr>\n<h2 id=\"m-04-many-unbounded-and-under-constrained-variables-in-the-system-can-lead-to-unfair-price-or-dos\" style=\"position:relative;\"><a href=\"#m-04-many-unbounded-and-under-constrained-variables-in-the-system-can-lead-to-unfair-price-or-dos\" aria-label=\"m 04 many unbounded and under constrained variables in the system can lead to unfair price or dos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/27\">[M-04] Many unbounded and under-constrained variables in the system can lead to unfair price or DoS</a></h2>\n<p><em>Submitted by throttle, also found by 0xDjango, BowTiedWardens, defsec, dipp, fatherOfBlocks, gzeon, hake, reassor, shung, unforgiven, and WatchPug</em></p>\n<p>Unbounded and under-constrained variables.</p>\n<h4 id=\"proof-of-concept-2\" style=\"position:relative;\"><a href=\"#proof-of-concept-2\" aria-label=\"proof of concept 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<ol>\n<li><code>dsStartTime</code> | <code>daPriceCurveLength</code> | <code>daDropInterval</code></li>\n</ol>\n<p>The team can change the above variables during sale. It will either increase or decrease the price of an NFT. Or it can make <code>currentDaPrice()</code> revert.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"javascript\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dropPerStep</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">) / (</span><span class=\"mtk12\">daPriceCurveLength</span><span class=\"mtk1\"> / </span><span class=\"mtk12\">daDropInterval</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">elapsed</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">block</span><span class=\"mtk1\">.</span><span class=\"mtk12\">timestamp</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">daStartTime</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">steps</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">elapsed</span><span class=\"mtk1\"> / </span><span class=\"mtk12\">daDropInterval</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">steps</span><span class=\"mtk1\"> * </span><span class=\"mtk12\">dropPerStep</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// don&#39;t go negative in the next step</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L275-L297\">ForgottenRunesWarriorsMinter.sol#L275-L297</a><br></p>\n<ol start=\"2\">\n<li><code>dsStartTime</code> | <code>mintlistStartTime</code> | <code>publicStartTime</code> | <code>claimsStartTime</code>  <code>selfRefundsStartTime</code></li>\n</ol>\n<p>The team can change the above variables. It can result in the wrong sale phases order. For example, the public sale can end up being before every other phase due to accidentally setting it to 0.</p>\n<h3 id=\"recommended-mitigation-steps-3\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-3\" aria-label=\"recommended mitigation steps 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Possible mitigation:</p>\n<ol>\n<li>Bound and constrain variables.<br>\nFor example, daDropInterval should be less than daPriceCurveLength<br>\nAnother example: The total sum of each supply phase should not be bigger than <code>MAX_SUPPLY</code> in the NFT smart contract.</li>\n</ol>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/27#issuecomment-1118375680\">wagmiwiz (Forgotten Runes) commented</a>:</strong></p>\n<blockquote>\n<p>This is true but is a low operational risk and can be undone.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/27#issuecomment-1159534380\">gzeon (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Decided to consolidate all issues regarding missing validation of the listed variables here (M-04).</p>\n</blockquote>\n<hr>\n<h2 id=\"m-05-use-of-send-may-revert-if-the-recipients-fallback-function-consumes-more-than-2300-gas\" style=\"position:relative;\"><a href=\"#m-05-use-of-send-may-revert-if-the-recipients-fallback-function-consumes-more-than-2300-gas\" aria-label=\"m 05 use of send may revert if the recipients fallback function consumes more than 2300 gas permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/254\">[M-05] Use of <code>.send()</code> May Revert if The Recipient’s Fallback Function Consumes More Than 2300 Gas</a></h2>\n<p><em>Submitted by leastwood, also found by 0xliumin, berndartmueller, cccz, Czar102, gzeon, hickuphh3, horsefacts, ilan, IllIllI, joestakey, m9800, p4st13r4, peritoflores, reassor, rfa, robee, sorrynotsorry, tintin, TrungOre, VAD37, WatchPug, and z3s</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L610\">ForgottenRunesWarriorsMinter.sol#L610</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L618\">ForgottenRunesWarriorsMinter.sol#L618</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsGuild.sol#L164\">ForgottenRunesWarriorsGuild.sol#L164</a><br></p>\n<p>The <code>.send()</code> function intends to transfer an ETH amount with a fixed amount of 2300 gas. This function is not equipped to handle changes in the underlying <code>.send()</code> and <code>.transfer()</code> functions which may supply different amounts of gas in the future. Additionally, if the recipient implements a fallback function containing some sort of logic, this may inevitably revert, meaning the vault and owner of the contract will never be able to call certain sensitive functions.</p>\n<h3 id=\"recommended-mitigation-steps-4\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-4\" aria-label=\"recommended mitigation steps 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Consider using <code>.call()</code> instead with the checks-effects-interactions pattern implemented correctly. Careful consideration needs to be made to prevent reentrancy.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/254#issuecomment-1159542053\">gzeon (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Determined the stake is high here and therefore Medium Risk.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-06-the-owner-can-mint-all-of-the-nfts\" style=\"position:relative;\"><a href=\"#m-06-the-owner-can-mint-all-of-the-nfts\" aria-label=\"m 06 the owner can mint all of the nfts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/104\">[M-06] The owner can mint all of the NFTs.</a></h2>\n<p><em>Submitted by Kulk0, also found by 0x1f8b, 0xDjango, BowTiedWardens, broccolirob, defsec, Dinddle, dirk_y, hyh, rajatbeladiya, Ruhum, throttle, and unforgiven</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L257\">ForgottenRunesWarriorsMinter.sol#L257</a><br></p>\n<p>In ForgottenRunesWarriorsMinter.teamSummon() the owner can mint unrestricted amount of NFTs. This is more of a design issue than an actual bug in my opinion.</p>\n<h3 id=\"proof-of-concept-3\" style=\"position:relative;\"><a href=\"#proof-of-concept-3\" aria-label=\"proof of concept 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>If the private keys were compromised during the launch the attacker could mint almost all of the NFTs. Normally I wouldn’t say this is an issue but from your documentation, I understand that you are not planning to use a multi-sig wallet for the owner of the contracts. I definitely don’t want to say that you are incompetent and you can’t store your private keys safely but private keys are getting compromised very often in this space.</p>\n<h3 id=\"recommended-mitigation-steps-5\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-5\" aria-label=\"recommended mitigation steps 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Limit how many NFTs can the owner mint. So even if the private keys were compromised the attacker couldn’t destroy the entire set by minting thousands of the NFTs to himself making the entire set worth nothing.</p>\n<p>I also think this will help with the trust of the protocol since the buyers will know exactly how many NFTs can the Dev Team mint for themselves.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1118089191\">cryppadotta (Forgotten Runes) acknowledged and commented</a>:</strong></p>\n<blockquote>\n<p>This is true, but by design. It’s a risk for minters, but it would be obvious, so we’re economically disincentivized to do this. Acknowledged, but not changing it.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1159522220\">gzeon (judge) marked as Invalid and commented</a>:</strong></p>\n<blockquote>\n<p>Sponsor acknowledged centralization risk in README.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1159581039\">dmitriia (warden) commented</a>:</strong></p>\n<blockquote>\n<p>Centralization risk in general is one thing, the ability for unlimited mint, which is easily fixable, is another.</p>\n<p>A kind of a boundary state here in my opinion, having ‘acknowledged’ and ‘invalid’ flags in the same time poses some contradiction.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1159762761\">gzeon (judge) reassessed as Medium severity and commented</a>:</strong></p>\n<blockquote>\n<p>Judging this as Med Risk since there are specified amounts of teamSummon in the doc</p>\n<blockquote>\n<p>Forgotten Council DAO Creators Fund (teamSummon): ~333<br>\nTeam &#x26; Partners (teamSummon): ~325<br>\nCommunity Honoraries and Contests (teamSummon): ~50<br></p>\n</blockquote>\n<p>which is not enforced in the <code>teamSummon</code> function.</p>\n</blockquote>\n<hr>\n<h1 id=\"low-risk-and-non-critical-issues\" style=\"position:relative;\"><a href=\"#low-risk-and-non-critical-issues\" aria-label=\"low risk and non critical issues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk and Non-Critical Issues</h1>\n<p>For this contest, 75 reports were submitted by wardens detailing low risk and non-critical issues. The <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/225\">report highlighted below</a> by <strong>defsec</strong> received the top score from the judge.</p>\n<p><em>The following wardens also submitted reports: <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/44\">reassor</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/47\">IllIllI</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/174\">hubble</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/142\">rotcivegaf</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/90\">hake</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/270\">horsefacts</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/28\">throttle</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/64\">AuditsAreUS</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/229\">berndartmueller</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/179\">BowTiedWardens</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/119\">hickuphh3</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/257\">hyh</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/249\">joestakey</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/155\">robee</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/36\">Ruhum</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/202\">shung</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/205\">sorrynotsorry</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/215\">sseefried</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/258\">leastwood</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/238\">pedroais</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/50\">TerrierLover</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/72\">VAD37</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/135\">WatchPug</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/209\">0xDjango</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/54\">catchup</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/248\">delfin454000</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/153\">ilan</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/216\">kebabsec</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/137\">kenta</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/9\">MaratCerby</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/143\">p4st13r4</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/234\">pauliax</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/243\">rfa</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/74\">shenwilly</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/97\">tintin</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/12\">0x1f8b</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/120\">0x52</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/114\">0xf15ers</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/127\">0xkatana</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/117\">0xliumin</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/7\">cccz</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/69\">csanuragjain</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/149\">dirk_y</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/95\">eccentricexit</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/268\">fatherOfBlocks</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/280\">Funen</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/145\">GimelSec</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/52\">hansfriese</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/173\">Hawkeye</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/84\">kenzo</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/60\">rajatbeladiya</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/219\">teddav</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/91\">TrungOre</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/154\">unforgiven</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/102\">z3s</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/171\">0v3rf10w</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/82\">0x4non</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/279\">broccolirob</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/224\">CertoraInc</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/77\">Cr4ckM3</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/123\">cryptphi</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/263\">ellahi</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/101\">Kulk0</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/220\">M0ndoHEHE</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/189\">m9800</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/278\">marximimus</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/110\">minhquanym</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/4\">oyc_109</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/276\">peritoflores</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/159\">Picodes</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/42\">plotchy</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/20\">samruna</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/160\">simon135</a>, and <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/180\">gzeon</a>.</em></p>\n<h2 id=\"issue-list\" style=\"position:relative;\"><a href=\"#issue-list\" aria-label=\"issue list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ISSUE LIST</h2>\n<p><strong>[01]: Missing events for only functions that change critical parameters - Non Critical</strong><br>\n<strong>[02] : Critical changes should use two-step procedure - Non Critical</strong><br>\n<strong>[03] : Pragma Version - Non Critical</strong><br>\n<strong>[04] : Missing zero-address check in the setter functions and initializers - Low</strong><br>\n<strong>[05] :  transferOwnership should be two step - Non critical</strong><br>\n<strong>[06] :  Bump OZ packages to ^4.5.0. - Non critical</strong><br>\n<strong>[07] :  Use safeTransfer/safeTransferFrom consistently instead of transfer/transferFrom - Non critical</strong><br>\n<strong>[08] :  Front-running is possible over the bidding mechanism - Low</strong><br></p>\n<h2 id=\"01-missing-events-for-only-functions-that-change-critical-parameters\" style=\"position:relative;\"><a href=\"#01-missing-events-for-only-functions-that-change-critical-parameters\" aria-label=\"01 missing events for only functions that change critical parameters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[01] Missing events for only functions that change critical parameters</h2>\n<p>The afunctions that change critical parameters should emit events. Events allow capturing the changed parameters so that off-chain tools/interfaces can register such changes with timelocks that allow users to evaluate them and consider if they would like to engage/exit based on how they perceive the changes as affecting the trustworthiness of the protocol or profitability of the implemented financial services. The alternative of directly querying on-chain contract state for such changes is not considered practical for most users/usages.</p>\n<p>Missing events and timelocks do not promote transparency and if such changes immediately affect users’ perception of fairness or trustworthiness, they could exit the protocol causing a reduction in liquidity which could negatively impact protocol TVL and reputation.</p>\n<h3 id=\"proof-of-concept-4\" style=\"position:relative;\"><a href=\"#proof-of-concept-4\" aria-label=\"proof of concept 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Navigate to the following contracts.</p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L441\">ForgottenRunesWarriorsMinter.sol#L441</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L448\">ForgottenRunesWarriorsMinter.sol#L448</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L455\">ForgottenRunesWarriorsMinter.sol#L455</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L462\">ForgottenRunesWarriorsMinter.sol#L462</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L469\">ForgottenRunesWarriorsMinter.sol#L469</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L480\">ForgottenRunesWarriorsMinter.sol#L480</a><br></p>\n<p>See similar High-severity H03 finding OpenZeppelin’s Audit of Audius (<a href=\"https://blog.openzeppelin.com/audius-contracts-audit/#high\">https://blog.openzeppelin.com/audius-contracts-audit/#high</a>) and Medium-severity M01 finding OpenZeppelin’s Audit of UMA Phase 4 (<a href=\"https://blog.openzeppelin.com/uma-audit-phase-4/\">https://blog.openzeppelin.com/uma-audit-phase-4/</a>)</p>\n<h3 id=\"recommended-mitigation-steps-6\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-6\" aria-label=\"recommended mitigation steps 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Add events to all functions that change critical parameters.</p>\n<h2 id=\"02-critical-changes-should-use-two-step-procedure\" style=\"position:relative;\"><a href=\"#02-critical-changes-should-use-two-step-procedure\" aria-label=\"02 critical changes should use two step procedure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[02] Critical changes should use two-step procedure</h2>\n<p>The critical procedures should be two step process.</p>\n<h3 id=\"proof-of-concept-5\" style=\"position:relative;\"><a href=\"#proof-of-concept-5\" aria-label=\"proof of concept 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Navigate to the following contracts.</p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L441\">ForgottenRunesWarriorsMinter.sol#L441</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L448\">ForgottenRunesWarriorsMinter.sol#L448</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L455\">ForgottenRunesWarriorsMinter.sol#L455</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L462\">ForgottenRunesWarriorsMinter.sol#L462</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L469\">ForgottenRunesWarriorsMinter.sol#L469</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L480\">ForgottenRunesWarriorsMinter.sol#L480</a><br></p>\n<h3 id=\"recommended-mitigation-steps-7\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-7\" aria-label=\"recommended mitigation steps 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Lack of two-step procedure for critical operations leaves them error-prone. Consider adding two step procedure on the critical functions.</p>\n<h2 id=\"03-pragma-version\" style=\"position:relative;\"><a href=\"#03-pragma-version\" aria-label=\"03 pragma version permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[03] Pragma Version</h2>\n<p>In the contracts, floating pragmas should not be used. Contracts should be deployed with the same compiler version and flags that they have been tested with thoroughly. Locking the pragma helps to ensure that contracts do not accidentally get deployed using, for example, an outdated compiler version that might introduce bugs that affect the contract system negatively.</p>\n<h3 id=\"proof-of-concept-6\" style=\"position:relative;\"><a href=\"#proof-of-concept-6\" aria-label=\"proof of concept 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://swcregistry.io/docs/SWC-103\">https://swcregistry.io/docs/SWC-103</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">All Contracts</span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-8\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-8\" aria-label=\"recommended mitigation steps 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Lock the pragma version: delete pragma solidity 0.8.10 in favor of pragma solidity 0.8.10.</p>\n<h2 id=\"04-missing-zero-address-check-in-the-setter-functions-and-initializers\" style=\"position:relative;\"><a href=\"#04-missing-zero-address-check-in-the-setter-functions-and-initializers\" aria-label=\"04 missing zero address check in the setter functions and initializers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[04] Missing zero-address check in the setter functions and initializers</h2>\n<p>Missing checks for zero-addresses may lead to infunctional protocol, if the variable addresses are updated incorrectly.</p>\n<h3 id=\"proof-of-concept-7\" style=\"position:relative;\"><a href=\"#proof-of-concept-7\" aria-label=\"proof of concept 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Navigate to the following contracts.</p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L544\">ForgottenRunesWarriorsMinter.sol#L544</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L528\">ForgottenRunesWarriorsMinter.sol#L528</a><br></p>\n<h3 id=\"recommended-mitigation-steps-9\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-9\" aria-label=\"recommended mitigation steps 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Consider adding zero-address checks in the discussed constructors:\nrequire(newAddr != address(0));.</p>\n<h2 id=\"05-transferownership-should-be-two-step\" style=\"position:relative;\"><a href=\"#05-transferownership-should-be-two-step\" aria-label=\"05 transferownership should be two step permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[05] transferOwnership should be two step</h2>\n<p>The owner is the authorized user in the solidity contracts. Usually, an owner can be updated with transferOwnership function. However, the process is only completed with single transaction. If the address is updated incorrectly, an owner functionality will be lost forever.</p>\n<h3 id=\"proof-of-concept-8\" style=\"position:relative;\"><a href=\"#proof-of-concept-8\" aria-label=\"proof of concept 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Navigate to the following contracts.</p>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L15\">ForgottenRunesWarriorsMinter.sol#L15</a><br>\n<a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsGuild.sol#L14\">ForgottenRunesWarriorsGuild.sol#L14</a><br></p>\n<h3 id=\"recommended-mitigation-steps-10\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-10\" aria-label=\"recommended mitigation steps 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Lack of two-step procedure for critical operations leaves them error-prone. Consider adding two step procedure on the critical functions.</p>\n<h2 id=\"06-bump-oz-packages-to-450\" style=\"position:relative;\"><a href=\"#06-bump-oz-packages-to-450\" aria-label=\"06 bump oz packages to 450 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[06] Bump OZ packages to ^4.5.0.</h2>\n<p>Line Reference: <a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/package.json#L68\">package.json#L68</a></p>\n<h3 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h3>\n<p>I can verify that the installed version is 4.2.0 by executing the following commands:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">yarn install</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">yarn list @openzeppelin/contracts</span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-11\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-11\" aria-label=\"recommended mitigation steps 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Update the versions of @openzeppelin/contracts and @openzeppelin/contracts-upgradeable to be the latest in package.json. I also recommend double checking the versions of other dependencies as a precaution, as they may include important bug fixes.</p>\n<h2 id=\"07-use-safetransfersafetransferfrom-consistently-instead-of-transfertransferfrom\" style=\"position:relative;\"><a href=\"#07-use-safetransfersafetransferfrom-consistently-instead-of-transfertransferfrom\" aria-label=\"07 use safetransfersafetransferfrom consistently instead of transfertransferfrom permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[07] Use safeTransfer/safeTransferFrom consistently instead of transfer/transferFrom</h2>\n<p>It is good to add a require() statement that checks the return value of token transfers or to use something like OpenZeppelin’s safeTransfer/safeTransferFrom unless one is sure the given token reverts in case of a failure. Failure to do so will cause silent failures of transfers and affect token accounting in contract.</p>\n<p>Reference: This similar medium-severity finding from Consensys Diligence Audit of Fei Protocol: <a href=\"https://consensys.net/diligence/audits/2021/01/fei-protocol/#unchecked-return-value-for-iweth-transfer-call\">https://consensys.net/diligence/audits/2021/01/fei-protocol/#unchecked-return-value-for-iweth-transfer-call</a></p>\n<h3 id=\"proof-of-concept-9\" style=\"position:relative;\"><a href=\"#proof-of-concept-9\" aria-label=\"proof of concept 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<ol>\n<li>Navigate to the following contract.</li>\n<li>transfer/transferFrom functions are used instead of safe transfer/transferFrom on the following contracts.</li>\n</ol>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsGuild.sol#L175\">ForgottenRunesWarriorsGuild.sol#L175</a><br></p>\n<h3 id=\"recommended-mitigation-steps-12\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-12\" aria-label=\"recommended mitigation steps 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Consider using safeTransfer/safeTransferFrom or require() consistently.</p>\n<h2 id=\"08-front-running-is-possible-over-the-minting-process\" style=\"position:relative;\"><a href=\"#08-front-running-is-possible-over-the-minting-process\" aria-label=\"08 front running is possible over the minting process permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[08] Front-running is possible over the minting process</h2>\n<p>During the code review, it has been noticed that to bidding mechanism is vulnerable to front-running. The bidding mechanism can have EOA check on the contract. </p>\n<h3 id=\"proof-of-concept-10\" style=\"position:relative;\"><a href=\"#proof-of-concept-10\" aria-label=\"proof of concept 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<ol>\n<li>Navigate to the following contract.</li>\n<li>The contract does not check for the External Owned Accounts. Without the check, any contract can interact with the function. </li>\n</ol>\n<p><a href=\"https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L120\">ForgottenRunesWarriorsMinter.sol#L120</a><br></p>\n<h3 id=\"recommended-mitigation-steps-13\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-13\" aria-label=\"recommended mitigation steps 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Consider to check EOA at the beginning of the function.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">msg.sender == tx.origin &amp;&amp; !isContract(msg.sender)</span></span></code></pre>\n<hr>\n<h1 id=\"gas-optimizations\" style=\"position:relative;\"><a href=\"#gas-optimizations\" aria-label=\"gas optimizations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations</h1>\n<p>For this contest, 73 reports were submitted by wardens detailing gas optimizations. The <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/177\">report highlighted below</a> by <strong>BowTiedWardens</strong> received the top score from the judge.</p>\n<p><em>The following wardens also submitted reports: <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/233\">joestakey</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/100\">FSchmoede</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/105\">defsec</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/126\">0xkatana</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/240\">horsefacts</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/118\">hickuphh3</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/134\">WatchPug</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/45\">reassor</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/46\">IllIllI</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/138\">rotcivegaf</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/93\">kenzo</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/81\">0x4non</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/116\">0xliumin</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/55\">catchup</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/136\">kenta</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/277\">marximimus</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/245\">rfa</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/156\">robee</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/203\">shung</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/51\">TerrierLover</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/128\">saian</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/204\">sorrynotsorry</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/170\">0v3rf10w</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/13\">0x1f8b</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/21\">0xc0ffEE</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/242\">0xDjango</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/115\">0xf15ers</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/16\">0xNazgul</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/75\">antonttc</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/222\">CertoraInc</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/207\">Cityscape</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/108\">DavidGialdi</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/262\">ellahi</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/146\">GimelSec</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/92\">hake</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/152\">ilan</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/144\">MiloTruck</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/111\">minhquanym</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/3\">oyc_109</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/158\">Picodes</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/106\">slywaters</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/29\">throttle</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/83\">TrungOre</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/71\">VAD37</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/107\">Kulk0</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/214\">M0ndoHEHE</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/141\">p4st13r4</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/235\">pauliax</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/17\">samruna</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/161\">simon135</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/237\">Tadashi</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/124\">0xProf</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/18\">ACai</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/1\">AlleyCat</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/76\">Cr4ckM3</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/247\">delfin454000</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/260\">Dinddle</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/151\">dirk_y</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/94\">eccentricexit</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/253\">fatherOfBlocks</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/198\">Funen</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/35\">hansfriese</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/175\">Hawkeye</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/217\">kebabsec</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/113\">MaratCerby</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/169\">noobie</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/62\">rajatbeladiya</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/150\">RoiEvenHaim</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/73\">shenwilly</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/157\">unforgiven</a>, <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/103\">z3s</a>, and <a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/181\">gzeon</a>.</em></p>\n<h2 id=\"table-of-contents\" style=\"position:relative;\"><a href=\"#table-of-contents\" aria-label=\"table of contents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table of Contents</h2>\n<ul>\n<li>Caching storage values in memory</li>\n<li>Unchecking arithmetics operations that can’t underflow/overflow</li>\n<li>Unnecessary <code>initialize()</code> function</li>\n<li><code>ForgottenRunesWarriorsGuild.forwardERC20s()</code> and <code>ForgottenRunesWarriorsMinter.forwardERC20s()</code>: Unnecessary require statements</li>\n<li><code>ForgottenRunesWarriorsMinter</code>: <code>bidSummon()</code>and <code>publicSummon()</code>: Unnecessary require statement</li>\n<li>Boolean comparisons</li>\n<li><code>> 0</code> is less efficient than <code>!= 0</code> for unsigned integers (with proof)</li>\n<li><code>ForgottenRunesWarriorsMinter.currentDaPrice()</code>: <code>></code> should be <code>>=</code></li>\n<li>Splitting <code>require()</code> statements that use <code>&#x26;&#x26;</code> saves gas</li>\n<li><code>++i</code> costs less gas compared to <code>i++</code> or <code>i += 1</code></li>\n<li>Increments can be unchecked</li>\n<li>Public functions to external</li>\n<li>No need to explicitly initialize variables with default values</li>\n<li>Upgrade pragma to at least 0.8.4</li>\n<li>Use <code>msg.sender</code> instead of OpenZeppelin’s <code>_msgSender()</code> when meta-transactions capabilities aren’t used</li>\n<li>Use Custom Errors instead of Revert Strings to save Gas</li>\n</ul>\n<h2 id=\"g-01-caching-storage-values-in-memory\" style=\"position:relative;\"><a href=\"#g-01-caching-storage-values-in-memory\" aria-label=\"g 01 caching storage values in memory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-01] Caching storage values in memory</h2>\n<p>The code can be optimized by minimising the number of SLOADs. SLOADs are expensive (100 gas) compared to MLOADs/MSTOREs (3 gas). Here, storage values should get cached in memory (see the <code>@audit</code> tags for further details):</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">100</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numMinted</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">MAX_WARRIORS</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;All warriors have been summoned&#39;</span><span class=\"mtk1\">);  </span><span class=\"mtk3\">//@audit gas: numMinted SLOAD 1 (should declare tokenId earlier and use it instead)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">102</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">tokenId</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">numMinted</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: numMinted SLOAD 2 (should be declared earlier)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">104</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">numMinted</span><span class=\"mtk1\"> += </span><span class=\"mtk7\">1</span><span class=\"mtk1\">;  </span><span class=\"mtk3\">//@audit gas: numMinted SLOAD 3 (should be numMinted = tokenId + 1)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">136</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Auction sold out&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 1, maxDaSupply SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">137</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not enough remaining&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 2, maxDaSupply SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">154</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> += </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 3 (equivalent to numSold = numSold + numWarriors)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">156</span><span class=\"mtk1\">:         </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">) { </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 4, maxDaSupply SLOAD 3</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">177</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Sold out&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">193</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> += </span><span class=\"mtk7\">1</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 2 (equivalent to numSold = numSold + 1)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">207</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Sold out&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 1, maxDaSupply SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">208</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not enough remaining&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 2, maxDaSupply SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">219</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> += </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 3 (equivalent to numSold = numSold + numWarriors)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">234</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numClaimed</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForClaim</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;No more claims&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">248</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">numClaimed</span><span class=\"mtk1\"> += </span><span class=\"mtk7\">1</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: numSold SLOAD 2 (equivalent to numSold = numSold + 1)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">279</span><span class=\"mtk1\">:         </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">block</span><span class=\"mtk1\">.</span><span class=\"mtk12\">timestamp</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk12\">daStartTime</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">daPriceCurveLength</span><span class=\"mtk1\">) {</span><span class=\"mtk3\">//@audit gas: daStartTime SLOAD 1, daPriceCurveLength SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">284</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dropPerStep</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">) / </span><span class=\"mtk3\">//@audit gas: startPrice SLOAD 1, lowestPrice SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">285</span><span class=\"mtk1\">:             (</span><span class=\"mtk12\">daPriceCurveLength</span><span class=\"mtk1\"> / </span><span class=\"mtk12\">daDropInterval</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: daPriceCurveLength SLOAD 2, daDropInterval SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">287</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">elapsed</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">block</span><span class=\"mtk1\">.</span><span class=\"mtk12\">timestamp</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">daStartTime</span><span class=\"mtk1\">;</span><span class=\"mtk3\">//@audit gas: daStartTime SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">288</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">steps</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">elapsed</span><span class=\"mtk1\"> / </span><span class=\"mtk12\">daDropInterval</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: daDropInterval SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">292</span><span class=\"mtk1\">:         </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\">) { </span><span class=\"mtk3\">//@audit gas: startPrice SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">293</span><span class=\"mtk1\">:             </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: lowestPrice SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">295</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\">; </span><span class=\"mtk3\">//@audit gas: startPrice SLOAD 3</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">296</span><span class=\"mtk1\">:         </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> : </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">;  </span><span class=\"mtk3\">//@audit gas: lowestPrice SLOAD 2 &amp; 3</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">401</span><span class=\"mtk1\">:             </span><span class=\"mtk11\">IWETH</span><span class=\"mtk1\">(</span><span class=\"mtk12\">weth</span><span class=\"mtk1\">).</span><span class=\"mtk12\">deposit</span><span class=\"mtk1\">{value: </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">}(); </span><span class=\"mtk3\">//@audit gas: weth SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">402</span><span class=\"mtk1\">:             </span><span class=\"mtk11\">IERC20</span><span class=\"mtk1\">(</span><span class=\"mtk12\">weth</span><span class=\"mtk1\">).</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">to</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: weth SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">609</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;no vault&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: vault SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">610</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk12\">_amount</span><span class=\"mtk1\">)); </span><span class=\"mtk3\">//@audit gas: vault SLOAD 2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">617</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;no vault&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">//@audit gas: vault SLOAD 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">618</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">)); </span><span class=\"mtk3\">//@audit gas: vault SLOAD 2</span></span></span></code></pre>\n<h2 id=\"g-02-unchecking-arithmetics-operations-that-cant-underflowoverflow\" style=\"position:relative;\"><a href=\"#g-02-unchecking-arithmetics-operations-that-cant-underflowoverflow\" aria-label=\"g 02 unchecking arithmetics operations that cant underflowoverflow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-02] Unchecking arithmetics operations that can’t underflow/overflow</h2>\n<p>Solidity version 0.8+ comes with implicit overflow and underflow checks on unsigned integers. When an overflow or an underflow isn’t possible (as an example, when a comparison is made before the arithmetic operation), some gas can be saved by using an <code>unchecked</code> block: <a href=\"https://docs.soliditylang.org/en/v0.8.10/control-structures.html#checked-or-unchecked-arithmetic\">https://docs.soliditylang.org/en/v0.8.10/control-structures.html#checked-or-unchecked-arithmetic</a></p>\n<p>I suggest wrapping L295 with an <code>unchecked</code> block (see <code>@audit</code>):</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter\" aria-hidden=\"true\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter\" aria-hidden=\"true\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">291</span><span class=\"mtk1\">:         </span><span class=\"mtk3\">// don&#39;t go negative in the next step</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter\" aria-hidden=\"true\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">292</span><span class=\"mtk1\">:         </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter\" aria-hidden=\"true\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">293</span><span class=\"mtk1\">:             </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter\" aria-hidden=\"true\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">294</span><span class=\"mtk1\">:         }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"293\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">295</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">startPrice</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">stepDeduction</span><span class=\"mtk1\">; </span></span></span></code></pre>\n<h2 id=\"g-03-unnecessary-initialize-function\" style=\"position:relative;\"><a href=\"#g-03-unnecessary-initialize-function\" aria-label=\"g 03 unnecessary initialize function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-03] Unnecessary <code>initialize()</code> function</h2>\n<p>The <code>initialize()</code> function isn’t an initializer. It just calls <code>setMinter()</code>, which has the same visibility and authorization level as <code>initialize()</code>:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">52</span><span class=\"mtk1\">:     </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">initialize</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newMinter</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onlyOwner</span><span class=\"mtk1\"> { </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">53</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">setMinter</span><span class=\"mtk1\">(</span><span class=\"mtk12\">newMinter</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">54</span><span class=\"mtk1\">:     }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">137</span><span class=\"mtk1\">:     </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setMinter</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newMinter</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onlyOwner</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">138</span><span class=\"mtk1\">:         </span><span class=\"mtk12\">minter</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">newMinter</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">139</span><span class=\"mtk1\">:     }</span></span></span></code></pre>\n<p>It could even be called repeatedly.</p>\n<p>As the <code>initialize()</code> function is not needed, I suggest deleting it and directly calling <code>setMinter()</code> to “Conveniently initialize the contract”.</p>\n<h2 id=\"g-04-forgottenruneswarriorsguildforwarderc20s-and-forgottenruneswarriorsminterforwarderc20s-unnecessary-require-statements\" style=\"position:relative;\"><a href=\"#g-04-forgottenruneswarriorsguildforwarderc20s-and-forgottenruneswarriorsminterforwarderc20s-unnecessary-require-statements\" aria-label=\"g 04 forgottenruneswarriorsguildforwarderc20s and forgottenruneswarriorsminterforwarderc20s unnecessary require statements permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-04] <code>ForgottenRunesWarriorsGuild.forwardERC20s()</code> and <code>ForgottenRunesWarriorsMinter.forwardERC20s()</code>: Unnecessary require statements</h2>\n<p>Here, as the <code>onlyOwner</code> modifier is applied, the <code>address(0)</code> checks are not needed here:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">173</span><span class=\"mtk1\">      </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">forwardERC20s</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IERC20</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onlyOwner</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">174</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)); </span><span class=\"mtk3\">//@audit gas: there&#39;s the onlyOwner modifier: msg.sender can&#39;t be address(0)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">175</span><span class=\"mtk1\">          </span><span class=\"mtk12\">token</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">176</span><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">627</span><span class=\"mtk1\">      </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">forwardERC20s</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IERC20</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onlyOwner</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">628</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)); </span><span class=\"mtk3\">//@audit gas: there&#39;s the onlyOwner modifier: msg.sender can&#39;t be address(0)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">629</span><span class=\"mtk1\">          </span><span class=\"mtk12\">token</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">630</span><span class=\"mtk1\">      }</span></span></span></code></pre>\n<p>I suggest removing these checks.</p>\n<h2 id=\"g-05-forgottenruneswarriorsminter-bidsummonand-publicsummon-unnecessary-require-statement\" style=\"position:relative;\"><a href=\"#g-05-forgottenruneswarriorsminter-bidsummonand-publicsummon-unnecessary-require-statement\" aria-label=\"g 05 forgottenruneswarriorsminter bidsummonand publicsummon unnecessary require statement permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-05] <code>ForgottenRunesWarriorsMinter</code>: <code>bidSummon()</code>and <code>publicSummon()</code>: Unnecessary require statement</h2>\n<p>The code is as such:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">130</span><span class=\"mtk1\">:     </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">bidSummon</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">131:         </span><span class=\"mtk11\">external</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">132:         </span><span class=\"mtk11\">payable</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">133:         </span><span class=\"mtk11\">nonReentrant</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">134:         </span><span class=\"mtk11\">whenNotPaused</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">135:     {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">136</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Auction sold out&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">137</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not enough remaining&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">138</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">daStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Auction not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">139</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(!</span><span class=\"mtk11\">mintlistStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Auction phase over&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">140</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">141</span><span class=\"mtk1\">:             </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">20</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">142</span><span class=\"mtk1\">:             </span><span class=\"mtk8\">&#39;You can summon no more than 20 Warriors at a time&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">143</span><span class=\"mtk1\">:         );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">201</span><span class=\"mtk1\">:     </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">publicSummon</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">202:         </span><span class=\"mtk11\">external</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">203:         </span><span class=\"mtk11\">payable</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">204:         </span><span class=\"mtk11\">nonReentrant</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">205:         </span><span class=\"mtk11\">whenNotPaused</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">206:     {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">207</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Sold out&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">208</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not enough remaining&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">209</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">publicStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Public sale not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">210</span><span class=\"mtk1\">:         </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">211</span><span class=\"mtk1\">:             </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">20</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">212</span><span class=\"mtk1\">:             </span><span class=\"mtk8\">&#39;You can summon no more than 20 Warriors at a time&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">213</span><span class=\"mtk1\">:         );</span></span></span></code></pre>\n<p>Logically speaking, <code>numSold + numWarriors &#x3C;= maxForSale</code> could only reach the edge-case if <code>numWarriors == 0</code>, but that’s prevented with the condition that follows in both functions: <code>numWarriors > 0 &#x26;&#x26; numWarriors &#x3C;= 20</code>.\nMeaning that, with <code>numSold + numWarriors &#x3C;= maxForSale</code> and <code>numWarriors > 0</code>, we don’t need to check if <code>numSold &#x3C; maxForSale</code> as it just can’t happen.</p>\n<p>I suggest removing the 2 <code>require(numSold &#x3C; maxDaSupply)</code> checks L136 and L207.</p>\n<p>Furthermore, notice that <code>'Not enough remaining'</code> and <code>'Sold out'</code> kinda mean the same thing, so the additionnal require statement might not be justified.</p>\n<h2 id=\"g-06-boolean-comparisons\" style=\"position:relative;\"><a href=\"#g-06-boolean-comparisons\" aria-label=\"g 06 boolean comparisons permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-06] Boolean comparisons</h2>\n<p>Comparing to a constant (<code>true</code> or <code>false</code>) is a bit more expensive than directly checking the returned boolean value.\nI suggest using <code>if(!directValue)</code> instead of <code>if(directValue == false)</code> here:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">182</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">mintlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] == </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Already minted&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">238</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">claimlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] == </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Already claimed&#39;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<h2 id=\"g-07--0-is-less-efficient-than--0-for-unsigned-integers-with-proof\" style=\"position:relative;\"><a href=\"#g-07--0-is-less-efficient-than--0-for-unsigned-integers-with-proof\" aria-label=\"g 07  0 is less efficient than  0 for unsigned integers with proof permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-07] <code>> 0</code> is less efficient than <code>!= 0</code> for unsigned integers (with proof)</h2>\n<p><code>!= 0</code> costs less gas compared to <code>> 0</code> for unsigned integers in <code>require</code> statements with the optimizer enabled (6 gas)</p>\n<p>Proof: While it may seem that <code>> 0</code> is cheaper than <code>!=</code>, this is only true without the optimizer enabled and outside a require statement. If you enable the optimizer at 10k AND you’re in a <code>require</code> statement, this will save gas. You can see this tweet for more proofs: <a href=\"https://twitter.com/gzeon/status/1485428085885640706\">https://twitter.com/gzeon/status/1485428085885640706</a></p>\n<p>I suggest changing <code>> 0</code> with <code>!= 0</code> here:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">141</span><span class=\"mtk1\">:            </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">20</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">211</span><span class=\"mtk1\">:            </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">20</span><span class=\"mtk1\">,</span></span></span></code></pre>\n<p>Also, please enable the Optimizer.</p>\n<h2 id=\"g-08-forgottenruneswarriorsmintercurrentdaprice--should-be-\" style=\"position:relative;\"><a href=\"#g-08-forgottenruneswarriorsmintercurrentdaprice--should-be-\" aria-label=\"g 08 forgottenruneswarriorsmintercurrentdaprice  should be  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-08] <code>ForgottenRunesWarriorsMinter.currentDaPrice()</code>: <code>></code> should be <code>>=</code></h2>\n<p>The return statement is as follows:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">296</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> : </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p>Strict inequalities (<code>></code>) are more expensive than non-strict ones (<code>>=</code>). This is due to some supplementary checks (ISZERO, 3 gas)<br>\nFurthermore, <code>lowestPrice</code> is read from storage while <code>currentPrice</code> is read from memory.</p>\n<p>Therefore, it’s possible to always save 3 gas and sometimes further save 1 SLOAD (when <code>currentPrice == lowestPrice</code>) by replacing the code to:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">296</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">currentPrice</span><span class=\"mtk1\"> : </span><span class=\"mtk12\">lowestPrice</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<h2 id=\"g-09-splitting-require-statements-that-use--saves-gas\" style=\"position:relative;\"><a href=\"#g-09-splitting-require-statements-that-use--saves-gas\" aria-label=\"g 09 splitting require statements that use  saves gas permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-09] Splitting <code>require()</code> statements that use <code>&#x26;&#x26;</code> saves gas</h2>\n<p>If you’re using the Optimizer at 200, instead of using the <code>&#x26;&#x26;</code> operator in a single require statement to check multiple conditions, I suggest using multiple require statements with 1 condition per require statement:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">140</span><span class=\"mtk1\">          </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">141</span><span class=\"mtk1\">:             </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">20</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">142</span><span class=\"mtk1\">              </span><span class=\"mtk8\">&#39;You can summon no more than 20 Warriors at a time&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">143</span><span class=\"mtk1\">          );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">210</span><span class=\"mtk1\">          </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">211</span><span class=\"mtk1\">:             </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">20</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">212</span><span class=\"mtk1\">              </span><span class=\"mtk8\">&#39;You can summon no more than 20 Warriors at a time&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">213</span><span class=\"mtk1\">          );</span></span></span></code></pre>\n<h2 id=\"g-10-i-costs-less-gas-compared-to-i-or-i--1\" style=\"position:relative;\"><a href=\"#g-10-i-costs-less-gas-compared-to-i-or-i--1\" aria-label=\"g 10 i costs less gas compared to i or i  1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-10] <code>++i</code> costs less gas compared to <code>i++</code> or <code>i += 1</code></h2>\n<p><code>++i</code> costs less gas compared to <code>i++</code> or <code>i += 1</code> for unsigned integer, as pre-increment is cheaper (about 5 gas per iteration). This statement is true even with the optimizer enabled.</p>\n<p><code>i++</code> increments <code>i</code> and returns the initial value of <code>i</code>. Which means:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">1</span><span class=\"mtk1\">;  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">i</span><span class=\"mtk1\">++; </span><span class=\"mtk3\">// == 1 but i == 2  </span></span></span></code></pre>\n<p>But <code>++i</code> returns the actual incremented value:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">1</span><span class=\"mtk1\">;  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">++</span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk3\">// == 2 and i == 2 too, so no need for a temporary variable  </span></span></span></code></pre>\n<p>In the first case, the compiler has to create a temporary variable (when used) for returning <code>1</code> instead of <code>2</code></p>\n<p>Instances include:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">104</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">numMinted</span><span class=\"mtk1\"> += </span><span class=\"mtk7\">1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">162</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">193</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> += </span><span class=\"mtk7\">1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">220</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">248</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">numClaimed</span><span class=\"mtk1\"> += </span><span class=\"mtk7\">1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">259</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">count</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">355</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">startIdx</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">endIdx</span><span class=\"mtk1\"> + </span><span class=\"mtk7\">1</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span></code></pre>\n<p>I suggest using <code>++i</code> instead of <code>i++</code> to increment the value of an uint variable.</p>\n<h2 id=\"g-11-increments-can-be-unchecked\" style=\"position:relative;\"><a href=\"#g-11-increments-can-be-unchecked\" aria-label=\"g 11 increments can be unchecked permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-11] Increments can be unchecked</h2>\n<p>In Solidity 0.8+, there’s a default overflow check on unsigned integers. It’s possible to uncheck this in for-loops and save some gas at each iteration, but at the cost of some code readability, as this uncheck cannot be made inline.</p>\n<p><a href=\"https://github.com/ethereum/solidity/issues/10695\">ethereum/solidity#10695</a></p>\n<p>Instances include:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">162</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">220</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">259</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">count</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">355</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">startIdx</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">endIdx</span><span class=\"mtk1\"> + </span><span class=\"mtk7\">1</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span></code></pre>\n<p>The code would go from:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numIterations</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk3\">// ...  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}  </span></span></span></code></pre>\n<p>to:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numIterations</span><span class=\"mtk1\">;) {  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk3\">// ...  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk12\">unchecked</span><span class=\"mtk1\"> { ++</span><span class=\"mtk12\">i</span><span class=\"mtk1\">; }  </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}  </span></span></span></code></pre>\n<p>The risk of overflow is inexistant for a <code>uint256</code> here.</p>\n<h2 id=\"g-12-public-functions-to-external\" style=\"position:relative;\"><a href=\"#g-12-public-functions-to-external\" aria-label=\"g 12 public functions to external permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-12] Public functions to external</h2>\n<p>The following functions could be set external to save gas and improve code quality.\nExternal call cost is less expensive than of public functions.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">initialize</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk11\">initialize</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">52</span><span class=\"mtk1\">-</span><span class=\"mtk7\">54</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">exists</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk11\">exists</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">85</span><span class=\"mtk1\">-</span><span class=\"mtk7\">87</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setProvenanceHash</span><span class=\"mtk1\">(</span><span class=\"mtk12\">string</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setProvenanceHash</span><span class=\"mtk1\">(</span><span class=\"mtk12\">string</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">145</span><span class=\"mtk1\">-</span><span class=\"mtk7\">147</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">withdrawAll</span><span class=\"mtk1\">() </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk11\">withdrawAll</span><span class=\"mtk1\">() (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">163</span><span class=\"mtk1\">-</span><span class=\"mtk7\">165</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">forwardERC20s</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IERC20</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk11\">forwardERC20s</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IERC20</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">173</span><span class=\"mtk1\">-</span><span class=\"mtk7\">176</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">numDaMinters</span><span class=\"mtk1\">() </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">numDaMinters</span><span class=\"mtk1\">() (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">337</span><span class=\"mtk1\">-</span><span class=\"mtk7\">339</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">issueRefunds</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">issueRefunds</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">350</span><span class=\"mtk1\">-</span><span class=\"mtk7\">358</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">refundAddress</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">refundAddress</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">364</span><span class=\"mtk1\">-</span><span class=\"mtk7\">366</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">selfRefund</span><span class=\"mtk1\">() </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">selfRefund</span><span class=\"mtk1\">() (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">371</span><span class=\"mtk1\">-</span><span class=\"mtk7\">374</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">pause</span><span class=\"mtk1\">() </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">pause</span><span class=\"mtk1\">() (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">427</span><span class=\"mtk1\">-</span><span class=\"mtk7\">429</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">unpause</span><span class=\"mtk1\">() </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">unpause</span><span class=\"mtk1\">() (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">434</span><span class=\"mtk1\">-</span><span class=\"mtk7\">436</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setSelfRefundsStartTime</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setSelfRefundsStartTime</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">469</span><span class=\"mtk1\">-</span><span class=\"mtk7\">471</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setPhaseTimes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setPhaseTimes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">480</span><span class=\"mtk1\">-</span><span class=\"mtk7\">500</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setMintlist1MerkleRoot</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setMintlist1MerkleRoot</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">505</span><span class=\"mtk1\">-</span><span class=\"mtk7\">507</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setMintlist2MerkleRoot</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setMintlist2MerkleRoot</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">513</span><span class=\"mtk1\">-</span><span class=\"mtk7\">515</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setClaimlistMerkleRoot</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setClaimlistMerkleRoot</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">520</span><span class=\"mtk1\">-</span><span class=\"mtk7\">522</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setStartPrice</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setStartPrice</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">550</span><span class=\"mtk1\">-</span><span class=\"mtk7\">552</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setLowestPrice</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setLowestPrice</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">557</span><span class=\"mtk1\">-</span><span class=\"mtk7\">559</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setDaPriceCurveLength</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setDaPriceCurveLength</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">564</span><span class=\"mtk1\">-</span><span class=\"mtk7\">566</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setDaDropInterval</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setDaDropInterval</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">571</span><span class=\"mtk1\">-</span><span class=\"mtk7\">573</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setFinalPrice</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setFinalPrice</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">579</span><span class=\"mtk1\">-</span><span class=\"mtk7\">581</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setMaxDaSupply</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setMaxDaSupply</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">586</span><span class=\"mtk1\">-</span><span class=\"mtk7\">588</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setMaxForSale</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setMaxForSale</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">593</span><span class=\"mtk1\">-</span><span class=\"mtk7\">595</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">setMaxForClaim</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setMaxForClaim</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">600</span><span class=\"mtk1\">-</span><span class=\"mtk7\">602</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">withdraw</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">withdraw</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">608</span><span class=\"mtk1\">-</span><span class=\"mtk7\">611</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">withdrawAll</span><span class=\"mtk1\">() </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">withdrawAll</span><span class=\"mtk1\">() (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">616</span><span class=\"mtk1\">-</span><span class=\"mtk7\">619</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">forwardERC20s</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IERC20</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) </span><span class=\"mtk12\">should</span><span class=\"mtk1\"> </span><span class=\"mtk12\">be</span><span class=\"mtk1\"> </span><span class=\"mtk12\">declared</span><span class=\"mtk1\"> external:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> - </span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">forwardERC20s</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IERC20</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) (</span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">#</span><span class=\"mtk7\">627</span><span class=\"mtk1\">-</span><span class=\"mtk7\">630</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h2 id=\"g-13-no-need-to-explicitly-initialize-variables-with-default-values\" style=\"position:relative;\"><a href=\"#g-13-no-need-to-explicitly-initialize-variables-with-default-values\" aria-label=\"g 13 no need to explicitly initialize variables with default values permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-13] No need to explicitly initialize variables with default values</h2>\n<p>If a variable is not set/initialized, it is assumed to have the default value (<code>0</code> for <code>uint</code>, <code>false</code> for <code>bool</code>, <code>address(0)</code> for address…). Explicitly initializing it with its default value is an anti-pattern and wastes gas.</p>\n<p>As an example: <code>for (uint256 i = 0; i &#x3C; numIterations; ++i) {</code> should be replaced with <code>for (uint256 i; i &#x3C; numIterations; ++i) {</code></p>\n<p>Instances include:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">24</span><span class=\"mtk1\">:    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">public</span><span class=\"mtk1\"> </span><span class=\"mtk12\">numMinted</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">162</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">220</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">259</span><span class=\"mtk1\">:        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">count</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span></code></pre>\n<p>I suggest removing explicit initializations for default values.</p>\n<h2 id=\"g-14-upgrade-pragma-to-at-least-084\" style=\"position:relative;\"><a href=\"#g-14-upgrade-pragma-to-at-least-084\" aria-label=\"g 14 upgrade pragma to at least 084 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-14] Upgrade pragma to at least 0.8.4</h2>\n<p>Using newer compiler versions and the optimizer give gas optimizations. Also, additional safety checks are available for free.</p>\n<p>The advantages here are:</p>\n<ul>\n<li><strong>Low level inliner</strong> (>= 0.8.2): Cheaper runtime gas (especially relevant when the contract has small functions).</li>\n<li><strong>Optimizer improvements in packed structs</strong> (>= 0.8.3)</li>\n<li><strong>Custom errors</strong> (>= 0.8.4): cheaper deployment cost and runtime cost. <em>Note</em>: the runtime cost is only relevant when the revert condition is met. In short, replace revert strings by custom errors.</li>\n</ul>\n<p>Consider upgrading pragma to at least 0.8.4:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"jsx\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">1</span><span class=\"mtk1\">:</span><span class=\"mtk12\">pragma</span><span class=\"mtk1\"> </span><span class=\"mtk12\">solidity</span><span class=\"mtk1\"> ^</span><span class=\"mtk7\">0.8</span><span class=\"mtk1\">.</span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">1</span><span class=\"mtk1\">:</span><span class=\"mtk12\">pragma</span><span class=\"mtk1\"> </span><span class=\"mtk12\">solidity</span><span class=\"mtk1\"> ^</span><span class=\"mtk7\">0.8</span><span class=\"mtk1\">.</span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<h2 id=\"g-15-use-msgsender-instead-of-openzeppelins-_msgsender-when-meta-transactions-capabilities-arent-used\" style=\"position:relative;\"><a href=\"#g-15-use-msgsender-instead-of-openzeppelins-_msgsender-when-meta-transactions-capabilities-arent-used\" aria-label=\"g 15 use msgsender instead of openzeppelins _msgsender when meta transactions capabilities arent used permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-15] Use <code>msg.sender</code> instead of OpenZeppelin’s <code>_msgSender()</code> when meta-transactions capabilities aren’t used</h2>\n<p><code>msg.sender</code> costs 2 gas (CALLER opcode).\n<code>_msgSender()</code> represents the following:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">_msgSender</span><span class=\"mtk1\">() </span><span class=\"mtk11\">internal</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> </span><span class=\"mtk11\">virtual</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">payable</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>When no meta-transactions capabilities are used: <code>msg.sender</code> is enough.</p>\n<p>See <a href=\"https://docs.openzeppelin.com/contracts/2.x/gsn\">https://docs.openzeppelin.com/contracts/2.x/gsn</a> for more information about GSN capabilities.</p>\n<p>Consider replacing <code>_msgSender()</code> with <code>msg.sender</code> here:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">101</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">_msgSender</span><span class=\"mtk1\">() == </span><span class=\"mtk12\">minter</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not a minter&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">115</span><span class=\"mtk1\">:            </span><span class=\"mtk11\">_isApprovedOrOwner</span><span class=\"mtk1\">(</span><span class=\"mtk11\">_msgSender</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">tokenId</span><span class=\"mtk1\">),</span></span></span></code></pre>\n<p>In the solution, <code>msg.sender</code> is used everywhere else:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">164</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">174</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">175</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">token</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">113</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">setVaultAddress</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">151</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">daMinters</span><span class=\"mtk1\">.</span><span class=\"mtk11\">push</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">152</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">daAmountPaid</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] += </span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">value</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">153</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">daNumMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] += </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">163</span><span class=\"mtk1\">:            </span><span class=\"mtk11\">_mint</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">182</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">mintlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] == </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Already minted&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">183</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">mintlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">186</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">node</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">194</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">_mint</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">221</span><span class=\"mtk1\">:            </span><span class=\"mtk11\">_mint</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">238</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">claimlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] == </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Already claimed&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">239</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">claimlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">242</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">node</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">249</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">_mint</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">373</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">_refundAddress</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">628</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">629</span><span class=\"mtk1\">:        </span><span class=\"mtk12\">token</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<h2 id=\"g-16-use-custom-errors-instead-of-revert-strings-to-save-gas\" style=\"position:relative;\"><a href=\"#g-16-use-custom-errors-instead-of-revert-strings-to-save-gas\" aria-label=\"g 16 use custom errors instead of revert strings to save gas permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-16] Use Custom Errors instead of Revert Strings to save Gas</h2>\n<p>Custom errors from Solidity 0.8.4 are cheaper than revert strings (cheaper deployment cost and runtime cost when the revert condition is met)</p>\n<p>Source: <a href=\"https://blog.soliditylang.org/2021/04/21/custom-errors/\">https://blog.soliditylang.org/2021/04/21/custom-errors/</a>:</p>\n<blockquote>\n<p>Starting from <a href=\"https://github.com/ethereum/solidity/releases/tag/v0.8.4\">Solidity v0.8.4</a>, there is a convenient and gas-efficient way to explain to users why an operation failed through the use of custom errors. Until now, you could already use strings to give more information about failures (e.g., <code>revert(\"Insufficient funds.\");</code>), but they are rather expensive, especially when it comes to deploy cost, and it is difficult to use dynamic information in them.</p>\n</blockquote>\n<p>Custom errors are defined using the <code>error</code> statement, which can be used inside and outside of contracts (including interfaces and libraries).</p>\n<p>Instances include:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">68</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">&lt;</span><span class=\"mtk12\">img</span><span class=\"mtk1\"> </span><span class=\"mtk12\">class</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;emoji-icon&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">alt</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;emoji-100&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span><span class=\"mtk1\">-</span><span class=\"mtk12\">icon</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;emoji-100&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;display: inline; margin: 0; margin-top: 1px; position: relative; top: 5px; width: 25px&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">src</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAMMUlEQVR4Ae3YhXtcx90o4HfOnhVZlpntkMN0nTK3TsrMzPdjZmZmvh8zM5SZuQ04zInMsiVb0kq7e2jmPnBRj11t5HLy/gcz88Px4PaQhwRf5Q6xJQFTViAc9OWV2FVyVc6tq5hEZXlj0zylxxNKzkr0hng7/nMdo6OkQIFkGXnbl95mwn1c1mFvyWWBqxpuq/k13Oz0bOeyeZ5Z8eKaR9a0ARtyPpy4aophfBhdywj7fOGt5ZySrTUziQPoAwyxteDJJc+teXnBUAQEvnML78BQn5M4ArCGUHPhAt9d8LKS9RGBMjCVeMsovz3KD3cZrvkeTFlG3vWFs47xkkfP85zIwxpuj/wWbocxtvV4c8l39NgcgTrQCZzIaNW8MHFRw3vxz7CBrM+mgu/o8uqK1WgCdwf2tbg2510ZWY9rKhb6rDKAvOfMXUS2yLo+T6/4/YK1NVo8OvI23L6D8Q6vKPixPiNIgfnAvowbW3y2zTv7/Ejk+ZE7AXqM1Dx7kVfXrIaMycivXMff30WB9Houx9bIbM3orxKQOL38F52Zv6DVZUfJq0q+q8eaBIj0a9IjCEd4Rs3r+4xAoJPxlgV+LOPoBM0mth/hrJrViVHYSTbPtprvqhhPCFT4pxbveQT9R+AswmHaEYl2ZPhJg1zAk6zcq2iVnNfnG7t8Y8lYIgBSxoEhjvdZt8DVJVcAKuyb4+f6HELTwVb2JM5uCBkjEFnX4qXznJ/IkQKfyXgnDgNEVo9y1QIhUOU0Ocky8twZedI839Fjb814AgAEbsH0LC9oeFpFDoH7Mn43cv8QDUDFeYHNgdkWx6DDpoZXxv8nchr+YIHPIQKsZ0vimQ2txGgiRMvLo5V5Ga+e51t67ImsOsXh+yVvW82JeR5bcw4EOhmf6PG+EUoAmOfKhq2J+cjoYwn72F1wcSJDzHhn4LPj9ACgYSxxViIgS6Sjlpcf9cB8P5fO8aI5XlZyWUNuKZqMzzZcu55Lj3NJTRtwZ+IfRjhpiZK1kTbKRO8+zm7xmooRpECn4V8jBywRyRMTgGw1F7+Bu7Ho9ORvMJh15ImHH+fba66p2BoRaDLm0GpYAyga/jJw/yKvi1yaECgDtxR8whLnsesoayIC7YywwJaKpyWgCdzUsA89S+SUkWlA1mJ3xsiyF5AZTMFQ4vUFL60ZBtyaeG+L4cArGiBmHFvkExez4TiPaVgP2N/i42MsWIoGCTCacW6kU7ARUODtQ0w7hUATKAGpoQgky8gbg6lJiZPYH5hI3Jj4+1V8KOM5JV8PKPCREToFz6w5JwIxcH2bDziFjBMtOhENApdiy/97qTXvi3ScQs3amrMBqeTuPj3LyBcMZoh+4teHmKrZ2OMtuHYdj57juRUtwHzNPyZO9LkmsjWixULgpoK7ndpFGROAAltqzk1AHZhM7A/UlriMsaNcWLELAWWXyf+gbxn5PxhYwkn8LsBP0p7m4Q2PS0ATONjjhnMY6XBBZCwgcGiI+51GyeMj50VkzCXUnA2oA/cPUzmFDmdHri4ZRhOYyum+jGQZ+cusXM1ZFY8omIBAt8W+TfTa7K3ZFAGR2xtudgqbyDs8pWZ7RJteoFfTAnQi/xboOoVFzqt5RgKqFjePM2sA+biVK3gMHhuBhKmGt+Y0NY9NTECgjFzb5SZLnE2G3QXnR4YDArOJuQYQWFzk5i6VJR5Odow1NZsAZeBzgb4B5MHK9djdsDshY7bFuxven9FUXIhRCBxrc7BNbYlIhidENkQE6hbtwASgCUxH5kaIluKynGf1CICy4loUBpCXVuYcdkxxQU07AJMN/4xOzSpsSrQhcKTFcaewQNbieZHNgE7GIoYgULY4PE7hFGa5tOJJCUiBk13umaUygPyIldnOExJXNgjAzAL7YJiAjWj9PxcwY4kNtGseMcMVkREIHMw4FDkPkGE4d2oFGxu2A7oZn8uZ3kg0gHyjlVngUZHdCYF+xtQBClgHDCcCoMgoLFGRJ17YsDEhIPLhjLsjFwJakXEEANhJXvHoWa6pyQHTDX87TNeA8mEP3FlcfJQralYF4N7EO9s0kCylSFQAsJV2j0sWeGZiDAJTkY+1WahpQSJEhgtqAGiz6SQvq9gbESgDdxzlY/PUBpTf6YHbxEsjl0cgJm7t8Y4dVE5tKNACgFlW1XxdlwsTOeBDLfbl7EIDyLBuA/9tHSfaFInRBfYW7K1YCzgWeMduFpAMKL/K4NYQsHmWqyPbINAJ3D3GCQBAAMAliceM089oAqnDI0teWzMMGYcTb9nPPZsZTxwGBOwo+b45ZhKdjLU1j49cCIEC1y/wnwskg5MfM7hxQuA5BefUANyZ8SkAyEiJk9iBVs0VGd/S52osBpqG51WMA8rAf+R8cjfVRm6b5UMZeyMTibGCl9VoEJAAaHBrxr9+gANIBif8oMG9iaHI78zyipq1gSrxW9fzE+gDXM1w4rs7fGvDDgQkJABkgH7GtRXfPcnnkOBRXN7le3u8ODGODAAQUWTcE/jTm/lDFB6g8EcG81Syhp3z/GefPZGQcW2Ln8d/WGIVYxW/1OdlDRuQIwASInotPt3nJ2f5HAqAS2lVnF3yhj6vj2xAQEDKmM74eOLvT/JB9KxAeJvBXMhI4jtn+N6aTYGY+KVZfhWzTmEX6xPPqHh5zSMiGxPtQCfj9sB7Kv5ugftRWuJcWn3GF1nTZ11D3mZrw2xgZoSTLebQt0LhEwazitV4S4fHRYYC70z8/P/gE0hO4ycZX2RjwZqK8chIRtliZojjh5hBtIx9hDHCHoZmqFE7c8LfDRb+4Rg7e3ysYBcWEz+c8RdYNDi/Q0DyFSK83PJ+hXaXR83ynw0bMybxzXinM+c81k5QonuQx7U4F/2aNW3ua3PfOo7NcU6i3Ml9aJw5+T9Z3iRDOZdE8oTAVIt5K7CLbX1297m4oVWz5ijbJkmJ+RaPztiZKBLjOBw5eJSZwI5EdZybRvngBm5C1xnIj1texVDDJWhD5AZMWcZljMyys2BLl2012w9zduBS7Im0IusTrRpQIyEBAhdBCxHQ0K954hy/gfc7A+FTljfBxobfmeWFWEh8W8Vb0QOAKwld1lVsX2RLwzkZD09cUnNpzeYGEQnBaaVAjQBIaLCAk4HhRBH55U/z50hWKP+I5T2bVmIDQotPRG4dpgcAZ5PPsLPi+XhazeNK1tdIlpIySpTI0EGT6GMxcDLQQQCkQA+TQ9ycMVFzuMdnEc7oAgygZihyMVoZ+07zN7+m4SUL/GJFjgCAGiXKQC8wHTja4giG8NkW8wX3d7i7y3Sg2EwEQIJEQkAaJT3ZmcmfbHkZDaaxYYGPTzFtia2kSF3TABrEQDdjMnBTxh2RW6a5bgOziAhokBATsSQhHXBayRdIfq/lXUkv8IEWWWDm72ks8WRmI+8Z5dkl3RY3N0wW3Bo4MMxioApU91HcR/LlJ/y25T2bdsVli7yx4Tew3ykM08bOPrFNt6Y4SQ+VZVzCeEZ7DfOzjGPoLGYOMYYFgMTqnSwiOnNCMpi7GeqwM3AIhRXaQ+sgOyq2VuwNzCVGKi7qsjMxhKGGLKNAnugOcxCrarY0yJka4a5hPrmGT2PeCoQpXzwl2xLbe+zpc2XF+P/u/ZgI7E70kWN9wwQkJAQAZHQxlMgTAiljGpOBD67mb3CTByjc4gvjUlqHuKhmU5eLFtmOsxMbcWHi/EiWEJGQAAkQfH4B6GacwGxiBE3G+0b4A9ziAcoLK7ObdoftfXb12HoDuxJXYWvkipqtEc3nP2AM1IEmsIATWIgcQxMYbzgYqCHQD8zkTGVMR4YTZeSmD3OnFQi/aXAvJU9s6rG54OLEoxJX1VzcsK06zZQXKNELdBIFmsi9gZOBMqPb4jgOtJgpuKumGmPD9dxUUEACyi95F4BnkWNPyTMbHlfyiJJNjaXUgQL9xFxgJnAw52hgMnEiUNzDW2boRaDwZZIbUGQ48S3zvLRmNQAiKvQxnzGZcTjjvsinulw/x5GlX+a7Sbt9+YVPG8wqxvBzc7y2YQIlqoy5wF2BT0c+vMjnxilzYkOzSET0FSq812C2ESLrSn6sZqLPO/vcntPP6QzTayhQ+ioSPuaBGWNLRdZl7pP0EX0VC7/gwS3zIPfQBTx0AQ9yD12AB7mHLsCD3EMX4EHufwJIOEs9kLQJngAAAABJRU5ErkJggg==&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">title</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;emoji-100&quot;</span><span class=\"mtk1\"> /&gt;        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numMinted</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">MAX_WARRIORS</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;All warriors have been summoned&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">101</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">_msgSender</span><span class=\"mtk1\">() == </span><span class=\"mtk12\">minter</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not a minter&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">114</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">164</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsGuild</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">174</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">136</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Auction sold out&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">137</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">maxDaSupply</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not enough remaining&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">138</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">daStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Auction not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">139</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(!</span><span class=\"mtk11\">mintlistStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Auction phase over&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">140</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">146</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">177</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Sold out&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">178</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">mintlistStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Mintlist phase not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">179</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">value</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">finalPrice</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Ether value incorrect&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">182</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">mintlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] == </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Already minted&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">187</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">207</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Sold out&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">208</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numSold</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">numWarriors</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">maxForSale</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Not enough remaining&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">209</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">publicStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Public sale not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">210</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">214</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">234</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">numClaimed</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">maxForClaim</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;No more claims&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">235</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">claimsStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Claim phase not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">238</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">claimlistMinted</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] == </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;Already claimed&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">243</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">258</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">recipient</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;address req&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">372</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">selfRefundsStarted</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&#39;Self refund period not started&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">488</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">492</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">609</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;no vault&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">610</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk12\">_amount</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">617</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;no vault&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">618</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">payable</span><span class=\"mtk1\">(</span><span class=\"mtk12\">vault</span><span class=\"mtk1\">).</span><span class=\"mtk11\">send</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">ForgottenRunesWarriorsMinter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk7\">628</span><span class=\"mtk1\">:        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">));</span></span></span></code></pre>\n<p>I suggest replacing revert strings with custom errors.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-05-runes-findings/issues/177#issuecomment-1160705332\">gzeon (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Most are valid, except:</p>\n<blockquote>\n<p><strong>ForgottenRunesWarriorsMinter.currentDaPrice(): > should be >=</strong></p>\n</blockquote>\n<p>Strict is cheaper since there is no opcode for non-strict comparison in evm.</p>\n<blockquote>\n<p><strong>No need to explicitly initialize variables with default values</strong></p>\n</blockquote>\n<p>Yes, but I don’t think it saves gas in for loop with optimizer enabled.</p>\n</blockquote>\n<hr>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li>\n<p><a href=\"#medium-risk-findings-6\">Medium Risk Findings (6)</a></p>\n<ul>\n<li><a href=\"#m-01-ierc20transfer-does-not-support-all-erc20-token\">[M-01] IERC20.transfer does not support all ERC20 token</a></li>\n<li><a href=\"#m-02-contract-may-not-have-enough-fund-to-cover-refund\">[M-02] Contract may not have enough fund to cover refund</a></li>\n<li><a href=\"#m-03-critical-variables-shouldnt-be-changed-after-they-are-set\">[M-03] Critical variables shouldn’t be changed after they are set</a></li>\n<li><a href=\"#m-04-many-unbounded-and-under-constrained-variables-in-the-system-can-lead-to-unfair-price-or-dos\">[M-04] Many unbounded and under-constrained variables in the system can lead to unfair price or DoS</a></li>\n<li><a href=\"#m-05-use-of-send-may-revert-if-the-recipients-fallback-function-consumes-more-than-2300-gas\">[M-05] Use of <code>.send()</code> May Revert if The Recipient’s Fallback Function Consumes More Than 2300 Gas</a></li>\n<li><a href=\"#m-06-the-owner-can-mint-all-of-the-nfts\">[M-06] The owner can mint all of the NFTs.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#low-risk-and-non-critical-issues\">Low Risk and Non-Critical Issues</a></p>\n<ul>\n<li><a href=\"#issue-list\">ISSUE LIST</a></li>\n<li><a href=\"#01-missing-events-for-only-functions-that-change-critical-parameters\">01 Missing events for only functions that change critical parameters</a></li>\n<li><a href=\"#02-critical-changes-should-use-two-step-procedure\">02 Critical changes should use two-step procedure</a></li>\n<li><a href=\"#03-pragma-version\">03 Pragma Version</a></li>\n<li><a href=\"#04-missing-zero-address-check-in-the-setter-functions-and-initializers\">04 Missing zero-address check in the setter functions and initializers</a></li>\n<li><a href=\"#05-transferownership-should-be-two-step\">05 transferOwnership should be two step</a></li>\n<li><a href=\"#06-bump-oz-packages-to-450\">06 Bump OZ packages to ^4.5.0.</a></li>\n<li><a href=\"#07-use-safetransfersafetransferfrom-consistently-instead-of-transfertransferfrom\">07 Use safeTransfer/safeTransferFrom consistently instead of transfer/transferFrom</a></li>\n<li><a href=\"#08-front-running-is-possible-over-the-minting-process\">08 Front-running is possible over the minting process</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#gas-optimizations\">Gas Optimizations</a></p>\n<ul>\n<li><a href=\"#table-of-contents\">Table of Contents</a></li>\n<li><a href=\"#g-01-caching-storage-values-in-memory\">G-01 Caching storage values in memory</a></li>\n<li><a href=\"#g-02-unchecking-arithmetics-operations-that-cant-underflowoverflow\">G-02 Unchecking arithmetics operations that can’t underflow/overflow</a></li>\n<li><a href=\"#g-03-unnecessary-initialize-function\">G-03 Unnecessary <code>initialize()</code> function</a></li>\n<li><a href=\"#g-04-forgottenruneswarriorsguildforwarderc20s-and-forgottenruneswarriorsminterforwarderc20s-unnecessary-require-statements\">G-04 <code>ForgottenRunesWarriorsGuild.forwardERC20s()</code> and <code>ForgottenRunesWarriorsMinter.forwardERC20s()</code>: Unnecessary require statements</a></li>\n<li><a href=\"#g-05-forgottenruneswarriorsminter-bidsummonand-publicsummon-unnecessary-require-statement\">G-05 <code>ForgottenRunesWarriorsMinter</code>: <code>bidSummon()</code>and <code>publicSummon()</code>: Unnecessary require statement</a></li>\n<li><a href=\"#g-06-boolean-comparisons\">G-06 Boolean comparisons</a></li>\n<li><a href=\"#g-07--0-is-less-efficient-than--0-for-unsigned-integers-with-proof\">G-07 <code>> 0</code> is less efficient than <code>!= 0</code> for unsigned integers (with proof)</a></li>\n<li><a href=\"#g-08-forgottenruneswarriorsmintercurrentdaprice--should-be-\">G-08 <code>ForgottenRunesWarriorsMinter.currentDaPrice()</code>: <code>></code> should be <code>>=</code></a></li>\n<li><a href=\"#g-09-splitting-require-statements-that-use--saves-gas\">G-09 Splitting <code>require()</code> statements that use <code>&#x26;&#x26;</code> saves gas</a></li>\n<li><a href=\"#g-10-i-costs-less-gas-compared-to-i-or-i--1\">G-10 <code>++i</code> costs less gas compared to <code>i++</code> or <code>i += 1</code></a></li>\n<li><a href=\"#g-11-increments-can-be-unchecked\">G-11 Increments can be unchecked</a></li>\n<li><a href=\"#g-12-public-functions-to-external\">G-12 Public functions to external</a></li>\n<li><a href=\"#g-13-no-need-to-explicitly-initialize-variables-with-default-values\">G-13 No need to explicitly initialize variables with default values</a></li>\n<li><a href=\"#g-14-upgrade-pragma-to-at-least-084\">G-14 Upgrade pragma to at least 0.8.4</a></li>\n<li><a href=\"#g-15-use-msgsender-instead-of-openzeppelins-_msgsender-when-meta-transactions-capabilities-arent-used\">G-15 Use <code>msg.sender</code> instead of OpenZeppelin’s <code>_msgSender()</code> when meta-transactions capabilities aren’t used</a></li>\n<li><a href=\"#g-16-use-custom-errors-instead-of-revert-strings-to-save-gas\">G-16 Use Custom Errors instead of Revert Strings to save Gas</a></li>\n</ul>\n</li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>",
  "md": "\n# Overview\n\n## About C4\n\nCode4rena (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.\n\nA C4 audit contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\n\nDuring the audit contest outlined in this document, C4 conducted an analysis of the Forgotten Runes Warrior Guild smart contract system written in Solidity. The audit contest took place between May 3—May 5 2022.\n\n## Wardens\n\n102 Wardens contributed reports to the Forgotten Runes Warrior Guild contest:\n\n  1. AuditsAreUS\n  1. BowTiedWardens (BowTiedHeron, BowTiedPickle, [m4rio_eth](BowTiedETHernal), [Dravee](https://twitter.com/JustDravee), and BowTiedFirefox)\n  1. IllIllI\n  1. [pedroais](https://twitter.com/Pedroais2/)\n  1. [defsec](https://twitter.com/defsec_)\n  1. [Ruhum](https://twitter.com/0xruhum)\n  1. sorrynotsorry\n  1. [rfa](https://www.instagram.com/riyan_rfa/)\n  1. VAD37\n  1. [MaratCerby](https://twitter.com/MaratCerby)\n  1. [shenwilly](https://twitter.com/shenwilly_)\n  1. [WatchPug](https://twitter.com/WatchPug_) ([jtp](https://github.com/jack-the-pug) and [ming](https://github.com/mingwatch))\n  1. [teddav](https://twitter.com/0xteddav)\n  1. [leastwood](https://twitter.com/0xleastwood)\n  1. GimelSec ([rayn](https://twitter.com/rayn731) and sces60107)\n  1. [throttle](https://twitter.com/Throt7le)\n  1. 0xDjango\n  1. unforgiven\n  1. reassor\n  1. hake\n  1. [shung](https://twitter.com/shunduquar)\n  1. [fatherOfBlocks](https://twitter.com/father0fBl0cks)\n  1. dipp\n  1. 0x1f8b\n  1. dirk_y\n  1. [rajatbeladiya](https://twitter.com/rajat_beladiya)\n  1. [Kulk0](https://twitter.com/DavidKulman3)\n  1. [hyh](https://twitter.com/0xhyh)\n  1. [broccolirob](https://twitter.com/0xbroccolirob)\n  1. Dinddle\n  1. [joestakey](https://twitter.com/JoeStakey)\n  1. horsefacts\n  1. [hickuphh3](https://twitter.com/HickupH)\n  1. robee\n  1. [0xliumin](https://twitter.com/0xliumin)\n  1. ilan\n  1. p4st13r4 ([0x69e8](https://github.com/0x69e8) and 0xb4bb4)\n  1. TrungOre\n  1. [z3s](https://github.com/z3s/)\n  1. rotcivegaf\n  1. hubble (ksk2345 and shri4net)\n  1. [berndartmueller](https://twitter.com/berndartmueller)\n  1. tintin\n  1. cccz\n  1. m9800\n  1. peritoflores\n  1. 0xkatana\n  1. FSchmoede\n  1. [Czar102](https://twitter.com/_Czar102)\n  1. [kenzo](https://twitter.com/KenzoAgada)\n  1. TerrierLover\n  1. [catchup](https://twitter.com/catchup22)\n  1. kenta\n  1. 0x4non\n  1. marximimus\n  1. [pauliax](https://twitter.com/SolidityDev)\n  1. delfin454000\n  1. kebabsec (okkothejawa and [FlameHorizon](https://twitter.com/FlameHorizon1))\n  1. 0xf15ers (remora and twojoy)\n  1. [0v3rf10w](https://twitter.com/_0v3rf10w)\n  1. [CertoraInc](https://twitter.com/CertoraInc) (egjlmn1, [OriDabush](https://twitter.com/ori_dabush), ItayG, and shakedwinder)\n  1. [ellahi](https://twitter.com/ellahinator)\n  1. minhquanym\n  1. oyc_109\n  1. [Picodes](https://twitter.com/thePicodes)\n  1. eccentricexit\n  1. [Funen](https://instagram.com/vanensurya)\n  1. [hansfriese](https://twitter.com/hansfriese)\n  1. Hawkeye (0xwags and 0xmint)\n  1. M0ndoHEHE\n  1. samruna\n  1. simon135\n  1. Cr4ckM3\n  1. [sseefried](http://seanseefried.org/blog)\n  1. 0x52\n  1. [csanuragjain](https://twitter.com/csanuragjain)\n  1. cryptphi\n  1. [plotchy](https://twitter.com/plotchy)\n  1. saian\n  1. 0xc0ffEE\n  1. [0xNazgul](https://twitter.com/0xNazgul)\n  1. [antonttc](https://github.com/antoncoding)\n  1. Cityscape\n  1. DavidGialdi\n  1. [MiloTruck](https://milotruck.github.io/)\n  1. slywaters\n  1. [Tadashi](https://github.com/htadashi)\n  1. [0xProf](https://twitter.com/praiseprof)\n  1. ACai\n  1. AlleyCat\n  1. noobie\n  1. RoiEvenHaim\n\nThis contest was judged by [gzeon](https://twitter.com/gzeon). The judge also competed in the contest as a warden, but forfeited their winnings.\n\nFinal report assembled by [liveactionllama](https://twitter.com/liveactionllama).\n\n# Summary\n\nThe C4 analysis yielded an aggregated total of 6 unique vulnerabilities. Of these vulnerabilities, 0 received a risk rating in the category of HIGH severity and 6 received a risk rating in the category of MEDIUM severity.\n\nAdditionally, C4 analysis included 75 reports detailing issues with a risk rating of LOW severity or non-critical. There were also 73 reports recommending gas optimizations.\n\nAll of the issues presented here are linked back to their original finding.\n\n# Scope\n\nThe code under review can be found within the [C4 Forgotten Runes Warrior Guild contest repository](https://github.com/code-423n4/2022-05-runes), and is composed of 5 smart contracts written in the Solidity programming language and includes 712 lines of Solidity code.\n\n# Severity Criteria\n\nC4 assesses the severity of disclosed vulnerabilities according to a methodology based on [OWASP standards](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).\n\nVulnerabilities are divided into three primary risk categories: high, medium, and low/non-critical.\n\nHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\n\n- Malicious Input Handling\n- Escalation of privileges\n- Arithmetic\n- Gas use\n\nFurther information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on [the C4 website](https://code4rena.com).\n\n# Medium Risk Findings (6)\n## [[M-01] IERC20.transfer does not support all ERC20 token](https://github.com/code-423n4/2022-05-runes-findings/issues/70)\n_Submitted by VAD37, also found by AuditsAreUS, IllIllI, MaratCerby, rfa, and sorrynotsorry_\n\n[ForgottenRunesWarriorsGuild.sol#L173-L176](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsGuild.sol#L173-L176)<br>\n[ForgottenRunesWarriorsMinter.sol#L627-L630](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L627-L630)<br>\n\nToken like [USDT](https://etherscan.io/address/0xdac17f958d2ee523a2206206994597c13d831ec7#contracts) known for using non-standard ERC20. ([Missing return boolean on transfer](https://forum.openzeppelin.com/t/can-not-call-the-function-approve-of-the-usdt-contract/2130/4)).\n\nContract function [forwardERC20](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsGuild.sol#L173-L176) will always revert when try to transfer this kind of tokens.\n\n### Impact\n\nCannot withdraw some special ERC20 token through contract call. Unexpected contract functionality = Medium severity\n\n### Recommended Mitigation Steps\n\nUse [SafeTransferLib.safeTransfer](https://github.com/Rari-Capital/solmate/blob/4197b521ef3eb81f675d35e64b7b597b24d33500/src/utils/SafeTransferLib.sol#L65-L94) instead of IERC20 transfer. This accepts ERC20 token with no boolean return like USDT.\n\n**[cryppadotta (Forgotten Runes) confirmed and commented](https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1118097813):**\n > Ah nice. You learn something new every day. Thanks!\n\n**[KenzoAgada (warden) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1147126705):**\n > Description is pretty much invalid as \"[forwardERC20](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsGuild.sol#L173-L176) will always revert when try to transfer this kind of tokens\" is simply not true. Same with impact - \"Cannot withdraw some special ERC20 token through contract call\" - that's not the impact, using SafeERC20's transfer will not help to transfer tokens. It will just revert on failure.\n> But generally the issue of not using SafeERC20 is kinda-correct. Duplicate of [#2](https://github.com/code-423n4/2022-05-runes-findings/issues/2).\n\n**[gzeon (judge) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1159516016):**\n > This is not a duplicate of [#2](https://github.com/code-423n4/2022-05-runes-findings/issues/2). #2 describes the silent failure of ERC20 transfer, while this describes a ERC20 that return void instead of bool. The call will revert even if the transfer is successful because Solidity expected a return value. Judging as Med Risk because unlike #2, here you can actually do something to fix the function.\n\n**[KenzoAgada (warden) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/70#issuecomment-1159630893):**\n > I apologize, my mistake.\n\n\n\n***\n\n## [[M-02] Contract may not have enough fund to cover refund](https://github.com/code-423n4/2022-05-runes-findings/issues/187)\n_Submitted by gzeon, also found by AuditsAreUS, BowTiedWardens, pedroais, Ruhum, shenwilly, and teddav_\n\nOwner of the contract can call `withdrawAll` before the refund process is done to send all ETH to the vault. Since there are no payable receive function in `ForgottenRunesWarriorsMinter`, the owner won't be able to replenish the contract for the refund process.\n\n### Proof of Concept\n\n[ForgottenRunesWarriorsMinter.sol#L616-L619](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L616-L619)<br>\n\n```solidity\n    function withdrawAll() public payable onlyOwner {\n        require(address(vault) != address(0), 'no vault');\n        require(payable(vault).send(address(this).balance));\n    }\n```\n\n### Recommended Mitigation Steps\n\nOnly allow owner to call `withdrawAll` after refund period.\n\n**[cryppadotta (Forgotten Runes) confirmed and commented](https://github.com/code-423n4/2022-05-runes-findings/issues/187#issuecomment-1119768097):**\n > This is a great point. It would be annoying to accidentally do this and have to make a new contract for refunds.\n\n**[gzeon (judge) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/187#issuecomment-1159518087):**\n > Sponsor confirmed, submitted by contest judge.\n\n\n\n***\n\n## [[M-03] Critical variables shouldn't be changed after they are set](https://github.com/code-423n4/2022-05-runes-findings/issues/38)\n_Submitted by pedroais, also found by AuditsAreUS, BowTiedWardens, defsec, GimelSec, gzeon, IllIllI, leastwood, and WatchPug_\n\n[ForgottenRunesWarriorsMinter.sol#L564](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L564)<br>\n[ForgottenRunesWarriorsMinter.sol#L571](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L571)<br>\n[ForgottenRunesWarriorsMinter.sol#L557](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L557)<br>\n[ForgottenRunesWarriorsMinter.sol#L571](https://github.com/code-423n4/2022-05-runes/blob/060b4f82b79c8308fe65674a39a07c44fa586cd3/contracts/ForgottenRunesWarriorsMinter.sol#L571)<br>\n\nThe price for the dutch auction could be altered.\n\n### Proof of Concept\n\nI previously sent an issue about start time being settable more than once. This also happens for many other variables. Since they are many I will send them all in a single issue.\n\nThe following functions should only be called once to ensure trustlessness and integrity of the dutch auction:<br>\nsetDaPriceCurveLength<br>\nsetStartPrice<br>\nsetLowestPrice<br>\nsetDaDropInterval<br>\n\nThe price in the dutch auction is computed by this formula:<br>\nuint256 dropPerStep = (startPrice - lowestPrice) /<br>\n(daPriceCurveLength / daDropInterval);<br>\n\nBy making dapriceCurveLength or daDropInterval equal to 0 the owner could stop the auction. This could benefit the owner since the price lowers with time and everyone pays the final lower price. If the auction does well at the beginning the owner could stop the auction to stop the price from being lower. This works against the integrity of the dutch auction.\n\nAlso changing the Start Price or the Lowest price in the middle of the auction could allow the owner to manipulate the price.\n\n### Recommended Mitigation Steps\n\nTo each of these setter functions add require (variable == 0) to ensure they are set once in a permanent way. Also, the Lowest price < startPrice should be required.\n\n**[gzeon (judge) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/38#issuecomment-1159524932):**\n > While centralization risk is acknowledged by the team, I agree that these variable should not be able to be changed during sale since it may lead to loss of functionality. Consolidating all similar issue for different variables here. \n\n\n\n***\n\n## [[M-04] Many unbounded and under-constrained variables in the system can lead to unfair price or DoS](https://github.com/code-423n4/2022-05-runes-findings/issues/27)\n_Submitted by throttle, also found by 0xDjango, BowTiedWardens, defsec, dipp, fatherOfBlocks, gzeon, hake, reassor, shung, unforgiven, and WatchPug_\n\nUnbounded and under-constrained variables.\n\n#### Proof of Concept\n\n1.  `dsStartTime` | `daPriceCurveLength` | `daDropInterval`\n\nThe team can change the above variables during sale. It will either increase or decrease the price of an NFT. Or it can make `currentDaPrice()` revert.\n\n```javascript\nuint256 dropPerStep = (startPrice - lowestPrice) / (daPriceCurveLength / daDropInterval);\n\nuint256 elapsed = block.timestamp - daStartTime;\nuint256 steps = elapsed / daDropInterval;\nuint256 stepDeduction = steps * dropPerStep;\n\n// don't go negative in the next step\nif (stepDeduction > startPrice) {\n    return lowestPrice;\n}\nuint256 currentPrice = startPrice - stepDeduction;\n```\n\n[ForgottenRunesWarriorsMinter.sol#L275-L297](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L275-L297)<br>\n\n2.  `dsStartTime` | `mintlistStartTime` | `publicStartTime` | `claimsStartTime`  `selfRefundsStartTime`\n\nThe team can change the above variables. It can result in the wrong sale phases order. For example, the public sale can end up being before every other phase due to accidentally setting it to 0.\n\n### Recommended Mitigation Steps\n\nPossible mitigation:\n\n1.  Bound and constrain variables.<br>\nFor example, daDropInterval should be less than daPriceCurveLength<br>\nAnother example: The total sum of each supply phase should not be bigger than `MAX_SUPPLY` in the NFT smart contract.\n\n**[wagmiwiz (Forgotten Runes) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/27#issuecomment-1118375680):**\n > This is true but is a low operational risk and can be undone.\n\n**[gzeon (judge) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/27#issuecomment-1159534380):**\n > Decided to consolidate all issues regarding missing validation of the listed variables here (M-04).\n\n\n\n***\n\n## [[M-05] Use of `.send()` May Revert if The Recipient's Fallback Function Consumes More Than 2300 Gas](https://github.com/code-423n4/2022-05-runes-findings/issues/254)\n_Submitted by leastwood, also found by 0xliumin, berndartmueller, cccz, Czar102, gzeon, hickuphh3, horsefacts, ilan, IllIllI, joestakey, m9800, p4st13r4, peritoflores, reassor, rfa, robee, sorrynotsorry, tintin, TrungOre, VAD37, WatchPug, and z3s_\n\n[ForgottenRunesWarriorsMinter.sol#L610](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L610)<br>\n[ForgottenRunesWarriorsMinter.sol#L618](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L618)<br>\n[ForgottenRunesWarriorsGuild.sol#L164](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsGuild.sol#L164)<br>\n\nThe `.send()` function intends to transfer an ETH amount with a fixed amount of 2300 gas. This function is not equipped to handle changes in the underlying `.send()` and `.transfer()` functions which may supply different amounts of gas in the future. Additionally, if the recipient implements a fallback function containing some sort of logic, this may inevitably revert, meaning the vault and owner of the contract will never be able to call certain sensitive functions.\n\n### Recommended Mitigation Steps\n\nConsider using `.call()` instead with the checks-effects-interactions pattern implemented correctly. Careful consideration needs to be made to prevent reentrancy.\n\n**[gzeon (judge) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/254#issuecomment-1159542053):**\n > Determined the stake is high here and therefore Medium Risk.\n\n\n\n***\n\n## [[M-06] The owner can mint all of the NFTs.](https://github.com/code-423n4/2022-05-runes-findings/issues/104)\n*Submitted by Kulk0, also found by 0x1f8b, 0xDjango, BowTiedWardens, broccolirob, defsec, Dinddle, dirk_y, hyh, rajatbeladiya, Ruhum, throttle, and unforgiven*\n\n[ForgottenRunesWarriorsMinter.sol#L257](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L257)<br>\n\nIn ForgottenRunesWarriorsMinter.teamSummon() the owner can mint unrestricted amount of NFTs. This is more of a design issue than an actual bug in my opinion.\n\n### Proof of Concept\n\nIf the private keys were compromised during the launch the attacker could mint almost all of the NFTs. Normally I wouldn't say this is an issue but from your documentation, I understand that you are not planning to use a multi-sig wallet for the owner of the contracts. I definitely don't want to say that you are incompetent and you can't store your private keys safely but private keys are getting compromised very often in this space.\n\n### Recommended Mitigation Steps\n\nLimit how many NFTs can the owner mint. So even if the private keys were compromised the attacker couldn't destroy the entire set by minting thousands of the NFTs to himself making the entire set worth nothing.\n\nI also think this will help with the trust of the protocol since the buyers will know exactly how many NFTs can the Dev Team mint for themselves.\n\n**[cryppadotta (Forgotten Runes) acknowledged and commented](https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1118089191):**\n > This is true, but by design. It's a risk for minters, but it would be obvious, so we're economically disincentivized to do this. Acknowledged, but not changing it.\n\n**[gzeon (judge) marked as Invalid and commented](https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1159522220):**\n > Sponsor acknowledged centralization risk in README.\n\n**[dmitriia (warden) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1159581039):**\n > Centralization risk in general is one thing, the ability for unlimited mint, which is easily fixable, is another.\n> \n> A kind of a boundary state here in my opinion, having 'acknowledged' and 'invalid' flags in the same time poses some contradiction.\n\n**[gzeon (judge) reassessed as Medium severity and commented](https://github.com/code-423n4/2022-05-runes-findings/issues/104#issuecomment-1159762761):**\n > Judging this as Med Risk since there are specified amounts of teamSummon in the doc\n> > Forgotten Council DAO Creators Fund (teamSummon): ~333<br>\n> Team & Partners (teamSummon): ~325<br>\n> Community Honoraries and Contests (teamSummon): ~50<br>\n> \n> which is not enforced in the `teamSummon` function.\n\n\n\n***\n\n# Low Risk and Non-Critical Issues\n\nFor this contest, 75 reports were submitted by wardens detailing low risk and non-critical issues. The [report highlighted below](https://github.com/code-423n4/2022-05-runes-findings/issues/225) by **defsec** received the top score from the judge.\n\n*The following wardens also submitted reports: [reassor](https://github.com/code-423n4/2022-05-runes-findings/issues/44), [IllIllI](https://github.com/code-423n4/2022-05-runes-findings/issues/47), [hubble](https://github.com/code-423n4/2022-05-runes-findings/issues/174), [rotcivegaf](https://github.com/code-423n4/2022-05-runes-findings/issues/142), [hake](https://github.com/code-423n4/2022-05-runes-findings/issues/90), [horsefacts](https://github.com/code-423n4/2022-05-runes-findings/issues/270), [throttle](https://github.com/code-423n4/2022-05-runes-findings/issues/28), [AuditsAreUS](https://github.com/code-423n4/2022-05-runes-findings/issues/64), [berndartmueller](https://github.com/code-423n4/2022-05-runes-findings/issues/229), [BowTiedWardens](https://github.com/code-423n4/2022-05-runes-findings/issues/179), [hickuphh3](https://github.com/code-423n4/2022-05-runes-findings/issues/119), [hyh](https://github.com/code-423n4/2022-05-runes-findings/issues/257), [joestakey](https://github.com/code-423n4/2022-05-runes-findings/issues/249), [robee](https://github.com/code-423n4/2022-05-runes-findings/issues/155), [Ruhum](https://github.com/code-423n4/2022-05-runes-findings/issues/36), [shung](https://github.com/code-423n4/2022-05-runes-findings/issues/202), [sorrynotsorry](https://github.com/code-423n4/2022-05-runes-findings/issues/205), [sseefried](https://github.com/code-423n4/2022-05-runes-findings/issues/215), [leastwood](https://github.com/code-423n4/2022-05-runes-findings/issues/258), [pedroais](https://github.com/code-423n4/2022-05-runes-findings/issues/238), [TerrierLover](https://github.com/code-423n4/2022-05-runes-findings/issues/50), [VAD37](https://github.com/code-423n4/2022-05-runes-findings/issues/72), [WatchPug](https://github.com/code-423n4/2022-05-runes-findings/issues/135), [0xDjango](https://github.com/code-423n4/2022-05-runes-findings/issues/209), [catchup](https://github.com/code-423n4/2022-05-runes-findings/issues/54), [delfin454000](https://github.com/code-423n4/2022-05-runes-findings/issues/248), [ilan](https://github.com/code-423n4/2022-05-runes-findings/issues/153), [kebabsec](https://github.com/code-423n4/2022-05-runes-findings/issues/216), [kenta](https://github.com/code-423n4/2022-05-runes-findings/issues/137), [MaratCerby](https://github.com/code-423n4/2022-05-runes-findings/issues/9), [p4st13r4](https://github.com/code-423n4/2022-05-runes-findings/issues/143), [pauliax](https://github.com/code-423n4/2022-05-runes-findings/issues/234), [rfa](https://github.com/code-423n4/2022-05-runes-findings/issues/243), [shenwilly](https://github.com/code-423n4/2022-05-runes-findings/issues/74), [tintin](https://github.com/code-423n4/2022-05-runes-findings/issues/97), [0x1f8b](https://github.com/code-423n4/2022-05-runes-findings/issues/12), [0x52](https://github.com/code-423n4/2022-05-runes-findings/issues/120), [0xf15ers](https://github.com/code-423n4/2022-05-runes-findings/issues/114), [0xkatana](https://github.com/code-423n4/2022-05-runes-findings/issues/127), [0xliumin](https://github.com/code-423n4/2022-05-runes-findings/issues/117), [cccz](https://github.com/code-423n4/2022-05-runes-findings/issues/7), [csanuragjain](https://github.com/code-423n4/2022-05-runes-findings/issues/69), [dirk_y](https://github.com/code-423n4/2022-05-runes-findings/issues/149), [eccentricexit](https://github.com/code-423n4/2022-05-runes-findings/issues/95), [fatherOfBlocks](https://github.com/code-423n4/2022-05-runes-findings/issues/268), [Funen](https://github.com/code-423n4/2022-05-runes-findings/issues/280), [GimelSec](https://github.com/code-423n4/2022-05-runes-findings/issues/145), [hansfriese](https://github.com/code-423n4/2022-05-runes-findings/issues/52), [Hawkeye](https://github.com/code-423n4/2022-05-runes-findings/issues/173), [kenzo](https://github.com/code-423n4/2022-05-runes-findings/issues/84), [rajatbeladiya](https://github.com/code-423n4/2022-05-runes-findings/issues/60), [teddav](https://github.com/code-423n4/2022-05-runes-findings/issues/219), [TrungOre](https://github.com/code-423n4/2022-05-runes-findings/issues/91), [unforgiven](https://github.com/code-423n4/2022-05-runes-findings/issues/154), [z3s](https://github.com/code-423n4/2022-05-runes-findings/issues/102), [0v3rf10w](https://github.com/code-423n4/2022-05-runes-findings/issues/171), [0x4non](https://github.com/code-423n4/2022-05-runes-findings/issues/82), [broccolirob](https://github.com/code-423n4/2022-05-runes-findings/issues/279), [CertoraInc](https://github.com/code-423n4/2022-05-runes-findings/issues/224), [Cr4ckM3](https://github.com/code-423n4/2022-05-runes-findings/issues/77), [cryptphi](https://github.com/code-423n4/2022-05-runes-findings/issues/123), [ellahi](https://github.com/code-423n4/2022-05-runes-findings/issues/263), [Kulk0](https://github.com/code-423n4/2022-05-runes-findings/issues/101), [M0ndoHEHE](https://github.com/code-423n4/2022-05-runes-findings/issues/220), [m9800](https://github.com/code-423n4/2022-05-runes-findings/issues/189), [marximimus](https://github.com/code-423n4/2022-05-runes-findings/issues/278), [minhquanym](https://github.com/code-423n4/2022-05-runes-findings/issues/110), [oyc_109](https://github.com/code-423n4/2022-05-runes-findings/issues/4), [peritoflores](https://github.com/code-423n4/2022-05-runes-findings/issues/276), [Picodes](https://github.com/code-423n4/2022-05-runes-findings/issues/159), [plotchy](https://github.com/code-423n4/2022-05-runes-findings/issues/42), [samruna](https://github.com/code-423n4/2022-05-runes-findings/issues/20), [simon135](https://github.com/code-423n4/2022-05-runes-findings/issues/160), and [gzeon](https://github.com/code-423n4/2022-05-runes-findings/issues/180).*\n\n## ISSUE LIST\n\n**[01]: Missing events for only functions that change critical parameters - Non Critical**<br>\n**[02] : Critical changes should use two-step procedure - Non Critical**<br>\n**[03] : Pragma Version - Non Critical**<br>\n**[04] : Missing zero-address check in the setter functions and initializers - Low**<br>\n**[05] :  transferOwnership should be two step - Non critical**<br>\n**[06] :  Bump OZ packages to ^4.5.0. - Non critical**<br>\n**[07] :  Use safeTransfer/safeTransferFrom consistently instead of transfer/transferFrom - Non critical**<br>\n**[08] :  Front-running is possible over the bidding mechanism - Low**<br>\n\n## [01] Missing events for only functions that change critical parameters\n\nThe afunctions that change critical parameters should emit events. Events allow capturing the changed parameters so that off-chain tools/interfaces can register such changes with timelocks that allow users to evaluate them and consider if they would like to engage/exit based on how they perceive the changes as affecting the trustworthiness of the protocol or profitability of the implemented financial services. The alternative of directly querying on-chain contract state for such changes is not considered practical for most users/usages.\n\nMissing events and timelocks do not promote transparency and if such changes immediately affect users’ perception of fairness or trustworthiness, they could exit the protocol causing a reduction in liquidity which could negatively impact protocol TVL and reputation.\n\n### Proof of Concept\n\nNavigate to the following contracts.\n\n[ForgottenRunesWarriorsMinter.sol#L441](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L441)<br>\n[ForgottenRunesWarriorsMinter.sol#L448](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L448)<br>\n[ForgottenRunesWarriorsMinter.sol#L455](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L455)<br>\n[ForgottenRunesWarriorsMinter.sol#L462](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L462)<br>\n[ForgottenRunesWarriorsMinter.sol#L469](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L469)<br>\n[ForgottenRunesWarriorsMinter.sol#L480](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L480)<br>\n\nSee similar High-severity H03 finding OpenZeppelin’s Audit of Audius (https://blog.openzeppelin.com/audius-contracts-audit/#high) and Medium-severity M01 finding OpenZeppelin’s Audit of UMA Phase 4 (https://blog.openzeppelin.com/uma-audit-phase-4/)\n\n### Recommended Mitigation Steps\n\nAdd events to all functions that change critical parameters.\n\n## [02] Critical changes should use two-step procedure\n\nThe critical procedures should be two step process.\n\n### Proof of Concept\n\nNavigate to the following contracts.\n\n[ForgottenRunesWarriorsMinter.sol#L441](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L441)<br>\n[ForgottenRunesWarriorsMinter.sol#L448](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L448)<br>\n[ForgottenRunesWarriorsMinter.sol#L455](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L455)<br>\n[ForgottenRunesWarriorsMinter.sol#L462](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L462)<br>\n[ForgottenRunesWarriorsMinter.sol#L469](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L469)<br>\n[ForgottenRunesWarriorsMinter.sol#L480](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L480)<br>\n\n### Recommended Mitigation Steps\n\nLack of two-step procedure for critical operations leaves them error-prone. Consider adding two step procedure on the critical functions.\n\n## [03] Pragma Version\n\nIn the contracts, floating pragmas should not be used. Contracts should be deployed with the same compiler version and flags that they have been tested with thoroughly. Locking the pragma helps to ensure that contracts do not accidentally get deployed using, for example, an outdated compiler version that might introduce bugs that affect the contract system negatively.\n\n### Proof of Concept\n\nhttps://swcregistry.io/docs/SWC-103\n\n```\nAll Contracts\n```\n\n### Recommended Mitigation Steps\nLock the pragma version: delete pragma solidity 0.8.10 in favor of pragma solidity 0.8.10.\n\n## [04] Missing zero-address check in the setter functions and initializers\n\nMissing checks for zero-addresses may lead to infunctional protocol, if the variable addresses are updated incorrectly.\n\n### Proof of Concept\n\nNavigate to the following contracts.\n\n[ForgottenRunesWarriorsMinter.sol#L544](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L544)<br>\n[ForgottenRunesWarriorsMinter.sol#L528](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L528)<br>\n\n### Recommended Mitigation Steps\n\nConsider adding zero-address checks in the discussed constructors:\nrequire(newAddr != address(0));.\n\n## [05] transferOwnership should be two step\n\nThe owner is the authorized user in the solidity contracts. Usually, an owner can be updated with transferOwnership function. However, the process is only completed with single transaction. If the address is updated incorrectly, an owner functionality will be lost forever.\n\n### Proof of Concept\n\nNavigate to the following contracts.\n\n[ForgottenRunesWarriorsMinter.sol#L15](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L15)<br>\n[ForgottenRunesWarriorsGuild.sol#L14](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsGuild.sol#L14)<br>\n\n### Recommended Mitigation Steps\n\nLack of two-step procedure for critical operations leaves them error-prone. Consider adding two step procedure on the critical functions.\n\n## [06] Bump OZ packages to ^4.5.0.\n\nLine Reference: [package.json#L68](https://github.com/code-423n4/2022-05-runes/blob/main/package.json#L68)\n\n### Description\n\nI can verify that the installed version is 4.2.0 by executing the following commands:\n\n```\nyarn install\nyarn list @openzeppelin/contracts\n\n```\n\n### Recommended Mitigation Steps\n\nUpdate the versions of @openzeppelin/contracts and @openzeppelin/contracts-upgradeable to be the latest in package.json. I also recommend double checking the versions of other dependencies as a precaution, as they may include important bug fixes.\n\n## [07] Use safeTransfer/safeTransferFrom consistently instead of transfer/transferFrom\n\nIt is good to add a require() statement that checks the return value of token transfers or to use something like OpenZeppelin’s safeTransfer/safeTransferFrom unless one is sure the given token reverts in case of a failure. Failure to do so will cause silent failures of transfers and affect token accounting in contract.\n\nReference: This similar medium-severity finding from Consensys Diligence Audit of Fei Protocol: https://consensys.net/diligence/audits/2021/01/fei-protocol/#unchecked-return-value-for-iweth-transfer-call\n\n### Proof of Concept\n\n1. Navigate to the following contract.\n\n2. transfer/transferFrom functions are used instead of safe transfer/transferFrom on the following contracts.\n\n[ForgottenRunesWarriorsGuild.sol#L175](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsGuild.sol#L175)<br>\n\n### Recommended Mitigation Steps\n\nConsider using safeTransfer/safeTransferFrom or require() consistently.\n\n## [08] Front-running is possible over the minting process\n\nDuring the code review, it has been noticed that to bidding mechanism is vulnerable to front-running. The bidding mechanism can have EOA check on the contract. \n\n### Proof of Concept\n\n1. Navigate to the following contract.\n\n2. The contract does not check for the External Owned Accounts. Without the check, any contract can interact with the function. \n\n[ForgottenRunesWarriorsMinter.sol#L120](https://github.com/code-423n4/2022-05-runes/blob/main/contracts/ForgottenRunesWarriorsMinter.sol#L120)<br>\n\n### Recommended Mitigation Steps\n\nConsider to check EOA at the beginning of the function.\n\n```\nmsg.sender == tx.origin && !isContract(msg.sender)\n```\n\n\n\n***\n\n# Gas Optimizations\n\nFor this contest, 73 reports were submitted by wardens detailing gas optimizations. The [report highlighted below](https://github.com/code-423n4/2022-05-runes-findings/issues/177) by **BowTiedWardens** received the top score from the judge.\n\n*The following wardens also submitted reports: [joestakey](https://github.com/code-423n4/2022-05-runes-findings/issues/233), [FSchmoede](https://github.com/code-423n4/2022-05-runes-findings/issues/100), [defsec](https://github.com/code-423n4/2022-05-runes-findings/issues/105), [0xkatana](https://github.com/code-423n4/2022-05-runes-findings/issues/126), [horsefacts](https://github.com/code-423n4/2022-05-runes-findings/issues/240), [hickuphh3](https://github.com/code-423n4/2022-05-runes-findings/issues/118), [WatchPug](https://github.com/code-423n4/2022-05-runes-findings/issues/134), [reassor](https://github.com/code-423n4/2022-05-runes-findings/issues/45), [IllIllI](https://github.com/code-423n4/2022-05-runes-findings/issues/46), [rotcivegaf](https://github.com/code-423n4/2022-05-runes-findings/issues/138), [kenzo](https://github.com/code-423n4/2022-05-runes-findings/issues/93), [0x4non](https://github.com/code-423n4/2022-05-runes-findings/issues/81), [0xliumin](https://github.com/code-423n4/2022-05-runes-findings/issues/116), [catchup](https://github.com/code-423n4/2022-05-runes-findings/issues/55), [kenta](https://github.com/code-423n4/2022-05-runes-findings/issues/136), [marximimus](https://github.com/code-423n4/2022-05-runes-findings/issues/277), [rfa](https://github.com/code-423n4/2022-05-runes-findings/issues/245), [robee](https://github.com/code-423n4/2022-05-runes-findings/issues/156), [shung](https://github.com/code-423n4/2022-05-runes-findings/issues/203), [TerrierLover](https://github.com/code-423n4/2022-05-runes-findings/issues/51), [saian](https://github.com/code-423n4/2022-05-runes-findings/issues/128), [sorrynotsorry](https://github.com/code-423n4/2022-05-runes-findings/issues/204), [0v3rf10w](https://github.com/code-423n4/2022-05-runes-findings/issues/170), [0x1f8b](https://github.com/code-423n4/2022-05-runes-findings/issues/13), [0xc0ffEE](https://github.com/code-423n4/2022-05-runes-findings/issues/21), [0xDjango](https://github.com/code-423n4/2022-05-runes-findings/issues/242), [0xf15ers](https://github.com/code-423n4/2022-05-runes-findings/issues/115), [0xNazgul](https://github.com/code-423n4/2022-05-runes-findings/issues/16), [antonttc](https://github.com/code-423n4/2022-05-runes-findings/issues/75), [CertoraInc](https://github.com/code-423n4/2022-05-runes-findings/issues/222), [Cityscape](https://github.com/code-423n4/2022-05-runes-findings/issues/207), [DavidGialdi](https://github.com/code-423n4/2022-05-runes-findings/issues/108), [ellahi](https://github.com/code-423n4/2022-05-runes-findings/issues/262), [GimelSec](https://github.com/code-423n4/2022-05-runes-findings/issues/146), [hake](https://github.com/code-423n4/2022-05-runes-findings/issues/92), [ilan](https://github.com/code-423n4/2022-05-runes-findings/issues/152), [MiloTruck](https://github.com/code-423n4/2022-05-runes-findings/issues/144), [minhquanym](https://github.com/code-423n4/2022-05-runes-findings/issues/111), [oyc_109](https://github.com/code-423n4/2022-05-runes-findings/issues/3), [Picodes](https://github.com/code-423n4/2022-05-runes-findings/issues/158), [slywaters](https://github.com/code-423n4/2022-05-runes-findings/issues/106), [throttle](https://github.com/code-423n4/2022-05-runes-findings/issues/29), [TrungOre](https://github.com/code-423n4/2022-05-runes-findings/issues/83), [VAD37](https://github.com/code-423n4/2022-05-runes-findings/issues/71), [Kulk0](https://github.com/code-423n4/2022-05-runes-findings/issues/107), [M0ndoHEHE](https://github.com/code-423n4/2022-05-runes-findings/issues/214), [p4st13r4](https://github.com/code-423n4/2022-05-runes-findings/issues/141), [pauliax](https://github.com/code-423n4/2022-05-runes-findings/issues/235), [samruna](https://github.com/code-423n4/2022-05-runes-findings/issues/17), [simon135](https://github.com/code-423n4/2022-05-runes-findings/issues/161), [Tadashi](https://github.com/code-423n4/2022-05-runes-findings/issues/237), [0xProf](https://github.com/code-423n4/2022-05-runes-findings/issues/124), [ACai](https://github.com/code-423n4/2022-05-runes-findings/issues/18), [AlleyCat](https://github.com/code-423n4/2022-05-runes-findings/issues/1), [Cr4ckM3](https://github.com/code-423n4/2022-05-runes-findings/issues/76), [delfin454000](https://github.com/code-423n4/2022-05-runes-findings/issues/247), [Dinddle](https://github.com/code-423n4/2022-05-runes-findings/issues/260), [dirk_y](https://github.com/code-423n4/2022-05-runes-findings/issues/151), [eccentricexit](https://github.com/code-423n4/2022-05-runes-findings/issues/94), [fatherOfBlocks](https://github.com/code-423n4/2022-05-runes-findings/issues/253), [Funen](https://github.com/code-423n4/2022-05-runes-findings/issues/198), [hansfriese](https://github.com/code-423n4/2022-05-runes-findings/issues/35), [Hawkeye](https://github.com/code-423n4/2022-05-runes-findings/issues/175), [kebabsec](https://github.com/code-423n4/2022-05-runes-findings/issues/217), [MaratCerby](https://github.com/code-423n4/2022-05-runes-findings/issues/113), [noobie](https://github.com/code-423n4/2022-05-runes-findings/issues/169), [rajatbeladiya](https://github.com/code-423n4/2022-05-runes-findings/issues/62), [RoiEvenHaim](https://github.com/code-423n4/2022-05-runes-findings/issues/150), [shenwilly](https://github.com/code-423n4/2022-05-runes-findings/issues/73), [unforgiven](https://github.com/code-423n4/2022-05-runes-findings/issues/157), [z3s](https://github.com/code-423n4/2022-05-runes-findings/issues/103), and [gzeon](https://github.com/code-423n4/2022-05-runes-findings/issues/181).*\n\n## Table of Contents\n\n*   Caching storage values in memory\n*   Unchecking arithmetics operations that can't underflow/overflow\n*   Unnecessary `initialize()` function\n*   `ForgottenRunesWarriorsGuild.forwardERC20s()` and `ForgottenRunesWarriorsMinter.forwardERC20s()`: Unnecessary require statements\n*   `ForgottenRunesWarriorsMinter`: `bidSummon()`and `publicSummon()`: Unnecessary require statement\n*   Boolean comparisons\n*   `> 0` is less efficient than `!= 0` for unsigned integers (with proof)\n*   `ForgottenRunesWarriorsMinter.currentDaPrice()`: `>` should be `>=`\n*   Splitting `require()` statements that use `&&` saves gas\n*   `++i` costs less gas compared to `i++` or `i += 1`\n*   Increments can be unchecked\n*   Public functions to external\n*   No need to explicitly initialize variables with default values\n*   Upgrade pragma to at least 0.8.4\n*   Use `msg.sender` instead of OpenZeppelin's `_msgSender()` when meta-transactions capabilities aren't used\n*   Use Custom Errors instead of Revert Strings to save Gas\n\n## [G-01] Caching storage values in memory\n\nThe code can be optimized by minimising the number of SLOADs. SLOADs are expensive (100 gas) compared to MLOADs/MSTOREs (3 gas). Here, storage values should get cached in memory (see the `@audit` tags for further details):\n\n```solidity\ncontracts/ForgottenRunesWarriorsGuild.sol:\n  100:         require(numMinted < MAX_WARRIORS, 'All warriors have been summoned');  //@audit gas: numMinted SLOAD 1 (should declare tokenId earlier and use it instead)\n  102:         uint256 tokenId = numMinted; //@audit gas: numMinted SLOAD 2 (should be declared earlier)\n  104:         numMinted += 1;  //@audit gas: numMinted SLOAD 3 (should be numMinted = tokenId + 1)\n\ncontracts/ForgottenRunesWarriorsMinter.sol:\n  136:         require(numSold < maxDaSupply, 'Auction sold out'); //@audit gas: numSold SLOAD 1, maxDaSupply SLOAD 1\n  137:         require(numSold + numWarriors <= maxDaSupply, 'Not enough remaining'); //@audit gas: numSold SLOAD 2, maxDaSupply SLOAD 2\n  154:         numSold += numWarriors; //@audit gas: numSold SLOAD 3 (equivalent to numSold = numSold + numWarriors)\n  156:         if (numSold == maxDaSupply) { //@audit gas: numSold SLOAD 4, maxDaSupply SLOAD 3\n  177:         require(numSold < maxForSale, 'Sold out'); //@audit gas: numSold SLOAD 1\n  193:         numSold += 1; //@audit gas: numSold SLOAD 2 (equivalent to numSold = numSold + 1)\n  207:         require(numSold < maxForSale, 'Sold out'); //@audit gas: numSold SLOAD 1, maxDaSupply SLOAD 1\n  208:         require(numSold + numWarriors <= maxForSale, 'Not enough remaining'); //@audit gas: numSold SLOAD 2, maxDaSupply SLOAD 2\n  219:         numSold += numWarriors; //@audit gas: numSold SLOAD 3 (equivalent to numSold = numSold + numWarriors)\n  234:         require(numClaimed < maxForClaim, 'No more claims'); //@audit gas: numSold SLOAD 1\n  248:         numClaimed += 1; //@audit gas: numSold SLOAD 2 (equivalent to numSold = numSold + 1)\n  279:         if (block.timestamp >= daStartTime + daPriceCurveLength) {//@audit gas: daStartTime SLOAD 1, daPriceCurveLength SLOAD 1\n  284:         uint256 dropPerStep = (startPrice - lowestPrice) / //@audit gas: startPrice SLOAD 1, lowestPrice SLOAD 1\n  285:             (daPriceCurveLength / daDropInterval); //@audit gas: daPriceCurveLength SLOAD 2, daDropInterval SLOAD 1\n  287:         uint256 elapsed = block.timestamp - daStartTime;//@audit gas: daStartTime SLOAD 2\n  288:         uint256 steps = elapsed / daDropInterval; //@audit gas: daDropInterval SLOAD 2\n  292:         if (stepDeduction > startPrice) { //@audit gas: startPrice SLOAD 2\n  293:             return lowestPrice; //@audit gas: lowestPrice SLOAD 2\n  295:         uint256 currentPrice = startPrice - stepDeduction; //@audit gas: startPrice SLOAD 3\n  296:         return currentPrice > lowestPrice ? currentPrice : lowestPrice;  //@audit gas: lowestPrice SLOAD 2 & 3\n  401:             IWETH(weth).deposit{value: amount}(); //@audit gas: weth SLOAD 1\n  402:             IERC20(weth).transfer(to, amount); //@audit gas: weth SLOAD 2\n  609:         require(address(vault) != address(0), 'no vault'); //@audit gas: vault SLOAD 1\n  610:         require(payable(vault).send(_amount)); //@audit gas: vault SLOAD 2\n  617:         require(address(vault) != address(0), 'no vault'); //@audit gas: vault SLOAD 1\n  618:         require(payable(vault).send(address(this).balance)); //@audit gas: vault SLOAD 2\n```\n\n## [G-02] Unchecking arithmetics operations that can't underflow/overflow\n\nSolidity version 0.8+ comes with implicit overflow and underflow checks on unsigned integers. When an overflow or an underflow isn't possible (as an example, when a comparison is made before the arithmetic operation), some gas can be saved by using an `unchecked` block: <https://docs.soliditylang.org/en/v0.8.10/control-structures.html#checked-or-unchecked-arithmetic>\n\nI suggest wrapping L295 with an `unchecked` block (see `@audit`):\n\n```solidity\nFile: ForgottenRunesWarriorsMinter.sol\n291:         // don't go negative in the next step\n292:         if (stepDeduction > startPrice) {\n293:             return lowestPrice;\n294:         }\n295:         uint256 currentPrice = startPrice - stepDeduction; //@audit gas: should be unchecked due to L292-L293\n```\n\n## [G-03] Unnecessary `initialize()` function\n\nThe `initialize()` function isn't an initializer. It just calls `setMinter()`, which has the same visibility and authorization level as `initialize()`:\n\n```solidity\nFile: ForgottenRunesWarriorsGuild.sol\n52:     function initialize(address newMinter) public onlyOwner { \n53:         setMinter(newMinter);\n54:     }\n...\n137:     function setMinter(address newMinter) public onlyOwner {\n138:         minter = newMinter;\n139:     }\n```\n\nIt could even be called repeatedly.\n\nAs the `initialize()` function is not needed, I suggest deleting it and directly calling `setMinter()` to \"Conveniently initialize the contract\".\n\n## [G-04] `ForgottenRunesWarriorsGuild.forwardERC20s()` and `ForgottenRunesWarriorsMinter.forwardERC20s()`: Unnecessary require statements\n\nHere, as the `onlyOwner` modifier is applied, the `address(0)` checks are not needed here:\n\n```solidity\ncontracts/ForgottenRunesWarriorsGuild.sol:\n  173      function forwardERC20s(IERC20 token, uint256 amount) public onlyOwner {\n  174:         require(address(msg.sender) != address(0)); //@audit gas: there's the onlyOwner modifier: msg.sender can't be address(0)\n  175          token.transfer(msg.sender, amount);\n  176      }\n\ncontracts/ForgottenRunesWarriorsMinter.sol:\n  627      function forwardERC20s(IERC20 token, uint256 amount) public onlyOwner {\n  628:         require(address(msg.sender) != address(0)); //@audit gas: there's the onlyOwner modifier: msg.sender can't be address(0)\n  629          token.transfer(msg.sender, amount);\n  630      }\n```\n\nI suggest removing these checks.\n\n## [G-05] `ForgottenRunesWarriorsMinter`: `bidSummon()`and `publicSummon()`: Unnecessary require statement\n\nThe code is as such:\n\n```solidity\nFile: ForgottenRunesWarriorsMinter.sol\n130:     function bidSummon(uint256 numWarriors)\n131:         external\n132:         payable\n133:         nonReentrant\n134:         whenNotPaused\n135:     {\n136:         require(numSold < maxDaSupply, 'Auction sold out');\n137:         require(numSold + numWarriors <= maxDaSupply, 'Not enough remaining');\n138:         require(daStarted(), 'Auction not started');\n139:         require(!mintlistStarted(), 'Auction phase over');\n140:         require(\n141:             numWarriors > 0 && numWarriors <= 20,\n142:             'You can summon no more than 20 Warriors at a time'\n143:         );\n...\n201:     function publicSummon(uint256 numWarriors)\n202:         external\n203:         payable\n204:         nonReentrant\n205:         whenNotPaused\n206:     {\n207:         require(numSold < maxForSale, 'Sold out');\n208:         require(numSold + numWarriors <= maxForSale, 'Not enough remaining');\n209:         require(publicStarted(), 'Public sale not started');\n210:         require(\n211:             numWarriors > 0 && numWarriors <= 20,\n212:             'You can summon no more than 20 Warriors at a time'\n213:         );\n```\n\nLogically speaking, `numSold + numWarriors <= maxForSale` could only reach the edge-case if `numWarriors == 0`, but that's prevented with the condition that follows in both functions: `numWarriors > 0 && numWarriors <= 20`.\nMeaning that, with `numSold + numWarriors <= maxForSale` and `numWarriors > 0`, we don't need to check if `numSold < maxForSale` as it just can't happen.\n\nI suggest removing the 2 `require(numSold < maxDaSupply)` checks L136 and L207.\n\nFurthermore, notice that `'Not enough remaining'` and `'Sold out'` kinda mean the same thing, so the additionnal require statement might not be justified.\n\n## [G-06] Boolean comparisons\n\nComparing to a constant (`true` or `false`) is a bit more expensive than directly checking the returned boolean value.\nI suggest using `if(!directValue)` instead of `if(directValue == false)` here:\n\n```solidity\nForgottenRunesWarriorsMinter.sol:182:        require(mintlistMinted[msg.sender] == false, 'Already minted');\nForgottenRunesWarriorsMinter.sol:238:        require(claimlistMinted[msg.sender] == false, 'Already claimed');\n```\n\n## [G-07] `> 0` is less efficient than `!= 0` for unsigned integers (with proof)\n\n`!= 0` costs less gas compared to `> 0` for unsigned integers in `require` statements with the optimizer enabled (6 gas)\n\nProof: While it may seem that `> 0` is cheaper than `!=`, this is only true without the optimizer enabled and outside a require statement. If you enable the optimizer at 10k AND you're in a `require` statement, this will save gas. You can see this tweet for more proofs: <https://twitter.com/gzeon/status/1485428085885640706>\n\nI suggest changing `> 0` with `!= 0` here:\n\n```solidity\nForgottenRunesWarriorsMinter.sol:141:            numWarriors > 0 && numWarriors <= 20,\nForgottenRunesWarriorsMinter.sol:211:            numWarriors > 0 && numWarriors <= 20,\n```\n\nAlso, please enable the Optimizer.\n\n## [G-08] `ForgottenRunesWarriorsMinter.currentDaPrice()`: `>` should be `>=`\n\nThe return statement is as follows:\n\n```solidity\nForgottenRunesWarriorsMinter.sol:296:        return currentPrice > lowestPrice ? currentPrice : lowestPrice;\n```\n\nStrict inequalities (`>`) are more expensive than non-strict ones (`>=`). This is due to some supplementary checks (ISZERO, 3 gas)\\\nFurthermore, `lowestPrice` is read from storage while `currentPrice` is read from memory.\n\nTherefore, it's possible to always save 3 gas and sometimes further save 1 SLOAD (when `currentPrice == lowestPrice`) by replacing the code to:\n\n```solidity\nForgottenRunesWarriorsMinter.sol:296:        return currentPrice >= lowestPrice ? currentPrice : lowestPrice;\n```\n\n## [G-09] Splitting `require()` statements that use `&&` saves gas\n\nIf you're using the Optimizer at 200, instead of using the `&&` operator in a single require statement to check multiple conditions, I suggest using multiple require statements with 1 condition per require statement:\n\n```solidity\ncontracts/ForgottenRunesWarriorsMinter.sol:\n  140          require(\n  141:             numWarriors > 0 && numWarriors <= 20,\n  142              'You can summon no more than 20 Warriors at a time'\n  143          );\n\n  210          require(\n  211:             numWarriors > 0 && numWarriors <= 20,\n  212              'You can summon no more than 20 Warriors at a time'\n  213          );\n```\n\n## [G-10] `++i` costs less gas compared to `i++` or `i += 1`\n\n`++i` costs less gas compared to `i++` or `i += 1` for unsigned integer, as pre-increment is cheaper (about 5 gas per iteration). This statement is true even with the optimizer enabled.\n\n`i++` increments `i` and returns the initial value of `i`. Which means:\n\n```solidity\nuint i = 1;  \ni++; // == 1 but i == 2  \n```\n\nBut `++i` returns the actual incremented value:\n\n```solidity\nuint i = 1;  \n++i; // == 2 and i == 2 too, so no need for a temporary variable  \n```\n\nIn the first case, the compiler has to create a temporary variable (when used) for returning `1` instead of `2`\n\nInstances include:\n\n```solidity\nForgottenRunesWarriorsGuild.sol:104:        numMinted += 1;\nForgottenRunesWarriorsMinter.sol:162:        for (uint256 i = 0; i < numWarriors; i++) {\nForgottenRunesWarriorsMinter.sol:193:        numSold += 1;\nForgottenRunesWarriorsMinter.sol:220:        for (uint256 i = 0; i < numWarriors; i++) {\nForgottenRunesWarriorsMinter.sol:248:        numClaimed += 1;\nForgottenRunesWarriorsMinter.sol:259:        for (uint256 i = 0; i < count; i++) {\nForgottenRunesWarriorsMinter.sol:355:        for (uint256 i = startIdx; i < endIdx + 1; i++) {\n```\n\nI suggest using `++i` instead of `i++` to increment the value of an uint variable.\n\n## [G-11] Increments can be unchecked\n\nIn Solidity 0.8+, there's a default overflow check on unsigned integers. It's possible to uncheck this in for-loops and save some gas at each iteration, but at the cost of some code readability, as this uncheck cannot be made inline.\n\n[ethereum/solidity#10695](https://github.com/ethereum/solidity/issues/10695)\n\nInstances include:\n\n```solidity\nForgottenRunesWarriorsMinter.sol:162:        for (uint256 i = 0; i < numWarriors; i++) {\nForgottenRunesWarriorsMinter.sol:220:        for (uint256 i = 0; i < numWarriors; i++) {\nForgottenRunesWarriorsMinter.sol:259:        for (uint256 i = 0; i < count; i++) {\nForgottenRunesWarriorsMinter.sol:355:        for (uint256 i = startIdx; i < endIdx + 1; i++) {\n```\n\nThe code would go from:\n\n```solidity\nfor (uint256 i; i < numIterations; i++) {  \n // ...  \n}  \n```\n\nto:\n\n```solidity\nfor (uint256 i; i < numIterations;) {  \n // ...  \n unchecked { ++i; }  \n}  \n```\n\nThe risk of overflow is inexistant for a `uint256` here.\n\n## [G-12] Public functions to external\n\nThe following functions could be set external to save gas and improve code quality.\nExternal call cost is less expensive than of public functions.\n\n```solidity\ninitialize(address) should be declared external:\n - ForgottenRunesWarriorsGuild.initialize(address) (contracts/ForgottenRunesWarriorsGuild.sol#52-54)\nexists(uint256) should be declared external:\n - ForgottenRunesWarriorsGuild.exists(uint256) (contracts/ForgottenRunesWarriorsGuild.sol#85-87)\nsetProvenanceHash(string) should be declared external:\n - ForgottenRunesWarriorsGuild.setProvenanceHash(string) (contracts/ForgottenRunesWarriorsGuild.sol#145-147)\nwithdrawAll() should be declared external:\n - ForgottenRunesWarriorsGuild.withdrawAll() (contracts/ForgottenRunesWarriorsGuild.sol#163-165)\nforwardERC20s(IERC20,uint256) should be declared external:\n - ForgottenRunesWarriorsGuild.forwardERC20s(IERC20,uint256) (contracts/ForgottenRunesWarriorsGuild.sol#173-176)\nnumDaMinters() should be declared external:\n - ForgottenRunesWarriorsMinter.numDaMinters() (contracts/ForgottenRunesWarriorsMinter.sol#337-339)\nissueRefunds(uint256,uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.issueRefunds(uint256,uint256) (contracts/ForgottenRunesWarriorsMinter.sol#350-358)\nrefundAddress(address) should be declared external:\n - ForgottenRunesWarriorsMinter.refundAddress(address) (contracts/ForgottenRunesWarriorsMinter.sol#364-366)\nselfRefund() should be declared external:\n - ForgottenRunesWarriorsMinter.selfRefund() (contracts/ForgottenRunesWarriorsMinter.sol#371-374)\npause() should be declared external:\n - ForgottenRunesWarriorsMinter.pause() (contracts/ForgottenRunesWarriorsMinter.sol#427-429)\nunpause() should be declared external:\n - ForgottenRunesWarriorsMinter.unpause() (contracts/ForgottenRunesWarriorsMinter.sol#434-436)\nsetSelfRefundsStartTime(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setSelfRefundsStartTime(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#469-471)\nsetPhaseTimes(uint256,uint256,uint256,uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setPhaseTimes(uint256,uint256,uint256,uint256) (contracts/ForgottenRunesWarriorsMinter.sol#480-500)\nsetMintlist1MerkleRoot(bytes32) should be declared external:\n - ForgottenRunesWarriorsMinter.setMintlist1MerkleRoot(bytes32) (contracts/ForgottenRunesWarriorsMinter.sol#505-507)\nsetMintlist2MerkleRoot(bytes32) should be declared external:\n - ForgottenRunesWarriorsMinter.setMintlist2MerkleRoot(bytes32) (contracts/ForgottenRunesWarriorsMinter.sol#513-515)\nsetClaimlistMerkleRoot(bytes32) should be declared external:\n - ForgottenRunesWarriorsMinter.setClaimlistMerkleRoot(bytes32) (contracts/ForgottenRunesWarriorsMinter.sol#520-522)\nsetStartPrice(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setStartPrice(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#550-552)\nsetLowestPrice(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setLowestPrice(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#557-559)\nsetDaPriceCurveLength(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setDaPriceCurveLength(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#564-566)\nsetDaDropInterval(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setDaDropInterval(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#571-573)\nsetFinalPrice(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setFinalPrice(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#579-581)\nsetMaxDaSupply(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setMaxDaSupply(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#586-588)\nsetMaxForSale(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setMaxForSale(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#593-595)\nsetMaxForClaim(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.setMaxForClaim(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#600-602)\nwithdraw(uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.withdraw(uint256) (contracts/ForgottenRunesWarriorsMinter.sol#608-611)\nwithdrawAll() should be declared external:\n - ForgottenRunesWarriorsMinter.withdrawAll() (contracts/ForgottenRunesWarriorsMinter.sol#616-619)\nforwardERC20s(IERC20,uint256) should be declared external:\n - ForgottenRunesWarriorsMinter.forwardERC20s(IERC20,uint256) (contracts/ForgottenRunesWarriorsMinter.sol#627-630)\n```\n\n## [G-13] No need to explicitly initialize variables with default values\n\nIf a variable is not set/initialized, it is assumed to have the default value (`0` for `uint`, `false` for `bool`, `address(0)` for address...). Explicitly initializing it with its default value is an anti-pattern and wastes gas.\n\nAs an example: `for (uint256 i = 0; i < numIterations; ++i) {` should be replaced with `for (uint256 i; i < numIterations; ++i) {`\n\nInstances include:\n\n```solidity\nForgottenRunesWarriorsGuild.sol:24:    uint256 public numMinted = 0;\nForgottenRunesWarriorsMinter.sol:162:        for (uint256 i = 0; i < numWarriors; i++) {\nForgottenRunesWarriorsMinter.sol:220:        for (uint256 i = 0; i < numWarriors; i++) {\nForgottenRunesWarriorsMinter.sol:259:        for (uint256 i = 0; i < count; i++) {\n```\n\nI suggest removing explicit initializations for default values.\n\n## [G-14] Upgrade pragma to at least 0.8.4\n\nUsing newer compiler versions and the optimizer give gas optimizations. Also, additional safety checks are available for free.\n\nThe advantages here are:\n\n*   **Low level inliner** (>= 0.8.2): Cheaper runtime gas (especially relevant when the contract has small functions).\n*   **Optimizer improvements in packed structs** (>= 0.8.3)\n*   **Custom errors** (>= 0.8.4): cheaper deployment cost and runtime cost. *Note*: the runtime cost is only relevant when the revert condition is met. In short, replace revert strings by custom errors.\n\nConsider upgrading pragma to at least 0.8.4:\n\n```jsx\nForgottenRunesWarriorsGuild.sol:1:pragma solidity ^0.8.0;\nForgottenRunesWarriorsMinter.sol:1:pragma solidity ^0.8.0;\n```\n\n## [G-15] Use `msg.sender` instead of OpenZeppelin's `_msgSender()` when meta-transactions capabilities aren't used\n\n`msg.sender` costs 2 gas (CALLER opcode).\n`_msgSender()` represents the following:\n\n```solidity\nfunction _msgSender() internal view virtual returns (address payable) {\n  return msg.sender;\n}\n```\n\nWhen no meta-transactions capabilities are used: `msg.sender` is enough.\n\nSee <https://docs.openzeppelin.com/contracts/2.x/gsn> for more information about GSN capabilities.\n\nConsider replacing `_msgSender()` with `msg.sender` here:\n\n```solidity\nForgottenRunesWarriorsGuild.sol:101:        require(_msgSender() == minter, 'Not a minter');\nForgottenRunesWarriorsGuild.sol:115:            _isApprovedOrOwner(_msgSender(), tokenId),\n```\n\nIn the solution, `msg.sender` is used everywhere else:\n\n```solidity\nForgottenRunesWarriorsGuild.sol:164:        require(payable(msg.sender).send(address(this).balance));\nForgottenRunesWarriorsGuild.sol:174:        require(address(msg.sender) != address(0));\nForgottenRunesWarriorsGuild.sol:175:        token.transfer(msg.sender, amount);\nForgottenRunesWarriorsMinter.sol:113:        setVaultAddress(msg.sender);\nForgottenRunesWarriorsMinter.sol:151:        daMinters.push(msg.sender);\nForgottenRunesWarriorsMinter.sol:152:        daAmountPaid[msg.sender] += msg.value;\nForgottenRunesWarriorsMinter.sol:153:        daNumMinted[msg.sender] += numWarriors;\nForgottenRunesWarriorsMinter.sol:163:            _mint(msg.sender);\nForgottenRunesWarriorsMinter.sol:182:        require(mintlistMinted[msg.sender] == false, 'Already minted');\nForgottenRunesWarriorsMinter.sol:183:        mintlistMinted[msg.sender] = true;\nForgottenRunesWarriorsMinter.sol:186:        bytes32 node = keccak256(abi.encodePacked(msg.sender));\nForgottenRunesWarriorsMinter.sol:194:        _mint(msg.sender);\nForgottenRunesWarriorsMinter.sol:221:            _mint(msg.sender);\nForgottenRunesWarriorsMinter.sol:238:        require(claimlistMinted[msg.sender] == false, 'Already claimed');\nForgottenRunesWarriorsMinter.sol:239:        claimlistMinted[msg.sender] = true;\nForgottenRunesWarriorsMinter.sol:242:        bytes32 node = keccak256(abi.encodePacked(msg.sender));\nForgottenRunesWarriorsMinter.sol:249:        _mint(msg.sender);\nForgottenRunesWarriorsMinter.sol:373:        _refundAddress(msg.sender);\nForgottenRunesWarriorsMinter.sol:628:        require(address(msg.sender) != address(0));\nForgottenRunesWarriorsMinter.sol:629:        token.transfer(msg.sender, amount);\n```\n\n## [G-16] Use Custom Errors instead of Revert Strings to save Gas\n\nCustom errors from Solidity 0.8.4 are cheaper than revert strings (cheaper deployment cost and runtime cost when the revert condition is met)\n\nSource: <https://blog.soliditylang.org/2021/04/21/custom-errors/>:\n\n> Starting from [Solidity v0.8.4](https://github.com/ethereum/solidity/releases/tag/v0.8.4), there is a convenient and gas-efficient way to explain to users why an operation failed through the use of custom errors. Until now, you could already use strings to give more information about failures (e.g., `revert(\"Insufficient funds.\");`), but they are rather expensive, especially when it comes to deploy cost, and it is difficult to use dynamic information in them.\n\nCustom errors are defined using the `error` statement, which can be used inside and outside of contracts (including interfaces and libraries).\n\nInstances include:\n\n```solidity\nForgottenRunesWarriorsGuild.sol:68:        require(\nForgottenRunesWarriorsGuild.sol:100:        require(numMinted < MAX_WARRIORS, 'All warriors have been summoned');\nForgottenRunesWarriorsGuild.sol:101:        require(_msgSender() == minter, 'Not a minter');\nForgottenRunesWarriorsGuild.sol:114:        require(\nForgottenRunesWarriorsGuild.sol:164:        require(payable(msg.sender).send(address(this).balance));\nForgottenRunesWarriorsGuild.sol:174:        require(address(msg.sender) != address(0));\nForgottenRunesWarriorsMinter.sol:136:        require(numSold < maxDaSupply, 'Auction sold out');\nForgottenRunesWarriorsMinter.sol:137:        require(numSold + numWarriors <= maxDaSupply, 'Not enough remaining');\nForgottenRunesWarriorsMinter.sol:138:        require(daStarted(), 'Auction not started');\nForgottenRunesWarriorsMinter.sol:139:        require(!mintlistStarted(), 'Auction phase over');\nForgottenRunesWarriorsMinter.sol:140:        require(\nForgottenRunesWarriorsMinter.sol:146:        require(\nForgottenRunesWarriorsMinter.sol:177:        require(numSold < maxForSale, 'Sold out');\nForgottenRunesWarriorsMinter.sol:178:        require(mintlistStarted(), 'Mintlist phase not started');\nForgottenRunesWarriorsMinter.sol:179:        require(msg.value == finalPrice, 'Ether value incorrect');\nForgottenRunesWarriorsMinter.sol:182:        require(mintlistMinted[msg.sender] == false, 'Already minted');\nForgottenRunesWarriorsMinter.sol:187:        require(\nForgottenRunesWarriorsMinter.sol:207:        require(numSold < maxForSale, 'Sold out');\nForgottenRunesWarriorsMinter.sol:208:        require(numSold + numWarriors <= maxForSale, 'Not enough remaining');\nForgottenRunesWarriorsMinter.sol:209:        require(publicStarted(), 'Public sale not started');\nForgottenRunesWarriorsMinter.sol:210:        require(\nForgottenRunesWarriorsMinter.sol:214:        require(\nForgottenRunesWarriorsMinter.sol:234:        require(numClaimed < maxForClaim, 'No more claims');\nForgottenRunesWarriorsMinter.sol:235:        require(claimsStarted(), 'Claim phase not started');\nForgottenRunesWarriorsMinter.sol:238:        require(claimlistMinted[msg.sender] == false, 'Already claimed');\nForgottenRunesWarriorsMinter.sol:243:        require(\nForgottenRunesWarriorsMinter.sol:258:        require(address(recipient) != address(0), 'address req');\nForgottenRunesWarriorsMinter.sol:372:        require(selfRefundsStarted(), 'Self refund period not started');\nForgottenRunesWarriorsMinter.sol:488:        require(\nForgottenRunesWarriorsMinter.sol:492:        require(\nForgottenRunesWarriorsMinter.sol:609:        require(address(vault) != address(0), 'no vault');\nForgottenRunesWarriorsMinter.sol:610:        require(payable(vault).send(_amount));\nForgottenRunesWarriorsMinter.sol:617:        require(address(vault) != address(0), 'no vault');\nForgottenRunesWarriorsMinter.sol:618:        require(payable(vault).send(address(this).balance));\nForgottenRunesWarriorsMinter.sol:628:        require(address(msg.sender) != address(0));\n```\n\nI suggest replacing revert strings with custom errors.\n\n**[gzeon (judge) commented](https://github.com/code-423n4/2022-05-runes-findings/issues/177#issuecomment-1160705332):**\n > Most are valid, except:\n> > **ForgottenRunesWarriorsMinter.currentDaPrice(): > should be >=**\n> \n> Strict is cheaper since there is no opcode for non-strict comparison in evm.\n> \n> > **No need to explicitly initialize variables with default values**\n> \n> Yes, but I don't think it saves gas in for loop with optimizer enabled.\n\n\n\n***\n\n# Disclosures\n\nC4 is an open organization governed by participants in the community.\n\nC4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\n\nC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\n"
}