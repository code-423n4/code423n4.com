{
  "circa": {
    "title": "88mph",
    "sponsor": "88mph",
    "slug": "2021-05-88mph",
    "date": "2021-06-14",
    "findings": "https://github.com/code-423n4/2021-05-88mph-findings/issues",
    "contest": 9
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the code contest outlined in this document, C4 conducted an analysis of 88mphâ€™s smart contract system written in Solidity. The code contest took place between May 13 and May 19, 2021.</p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>5 Wardens contributed reports to the 88mph code contest:</p>\n<ul>\n<li><a href=\"https://twitter.com/cmichelio\">cmichel</a></li>\n<li><a href=\"https://twitter.com/shw9453\">shw</a></li>\n<li><a href=\"https://twitter.com/gpersoon\">gpersoon</a></li>\n<li><a href=\"https://twitter.com/SolidityDev\">Thunder</a></li>\n<li><a href=\"https://twitter.com/a_delamo\">a_delamo</a></li>\n</ul>\n<p>This contest was judged by <a href=\"https://twitter.com/ghoulsol\">ghoul.sol</a>.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/_ninek_\">ninek</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 14 unique vulnerabilities. All of the issues presented here are linked back to their original finding.</p>\n<p>Of these vulnerabilities, 2 received a risk rating in the category of MEDIUM severity, and 5 received a risk rating in the category of LOW severity.</p>\n<p>C4 analysis also identified 7 non-critical recommendations.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2021-05-88mph\">C4 code contest repository</a> and comprises 39 smart contracts written in the Solidity programming language.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code423n4.com\">the C4 website</a>.</p>\n<h1 id=\"high-risk-findings\" style=\"position:relative;\"><a href=\"#high-risk-findings\" aria-label=\"high risk findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>High Risk Findings</h1>\n<p>There were no high risk findings identified in this contest.</p>\n<h1 id=\"medium-risk-findings\" style=\"position:relative;\"><a href=\"#medium-risk-findings\" aria-label=\"medium risk findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings</h1>\n<h2 id=\"m-01-incompatability-with-deflationary--fee-on-transfer-tokens\" style=\"position:relative;\"><a href=\"#m-01-incompatability-with-deflationary--fee-on-transfer-tokens\" aria-label=\"m 01 incompatability with deflationary  fee on transfer tokens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/16\">[M-01] Incompatability with deflationary / fee-on-transfer tokens</a></h2>\n<p>The <code>DInterest.deposit</code> function takes a <code>depositAmount</code> parameter but this parameter is not the actual transferred amount for fee-on-transfer / deflationary (or other rebasing) tokens.</p>\n<p>The actual deposited amount might be lower than the specified <code>depositAmount</code> of the function parameter.</p>\n<p>This would lead to wrong interest rate calculations on the principal.</p>\n<p>Recommend transferring the tokens first and comparing pre-/after token balances to compute the actual deposited amount.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/16#issuecomment-844441370\">ZeframLou (88mph) acknowledged</a>:</strong></p>\n<blockquote>\n<p>While this is true, we have no plans to support fee-on-transfer or rebasing tokens.</p>\n</blockquote>\n<h2 id=\"m-02-unchecking-the-ownership-of-mph-in-function-distributefundingrewards-could-cause-several-critical-functions-to-revert\" style=\"position:relative;\"><a href=\"#m-02-unchecking-the-ownership-of-mph-in-function-distributefundingrewards-could-cause-several-critical-functions-to-revert\" aria-label=\"m 02 unchecking the ownership of mph in function distributefundingrewards could cause several critical functions to revert permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/23\">[M-02] Unchecking the ownership of <code>mph</code> in function <code>distributeFundingRewards</code> could cause several critical functions to revert</a></h2>\n<p>In contract <code>MPHMinter</code>, the function <code>distributeFundingRewards</code> does not check whether the contract itself is the owner of <code>mph</code>. If the contract is not the owner of <code>mph</code>, <code>mph.ownerMint</code> could revert, causing functions such as <code>withdraw</code>, <code>rolloverDeposit</code>, <code>payInterestToFunders</code> in the contract <code>DInterest</code> to revert as well.</p>\n<p>Recommend adding a <code>mph.owner() != address(this)</code> check as in the other functions (e.g., <code>mintVested</code>).</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/23#issuecomment-844625823\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/026dde3d30bddedbc1eeca6c87bce4bc5b5c7ee5\">this commit</a>.</p>\n</blockquote>\n<h1 id=\"low-risk-findings\" style=\"position:relative;\"><a href=\"#low-risk-findings\" aria-label=\"low risk findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk Findings</h1>\n<h2 id=\"l-01-use-openzeppelin-ecda-for-erecover\" style=\"position:relative;\"><a href=\"#l-01-use-openzeppelin-ecda-for-erecover\" aria-label=\"l 01 use openzeppelin ecda for erecover permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/20\">[L-01] Use openzeppelin ECDA for erecover</a></h2>\n<p>In <code>Sponsorable.sol</code> is using erecover directly to verify the signature.\nSince it is a critical piece of the protocol, it is recommended to use the ECDSA from openzeppelin as it does more validations when verifying the signature.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/20#issuecomment-844573323\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/de3742fe48991870ca3be8210c56e8301cffe4c6\">this commit</a>.</p>\n</blockquote>\n<h2 id=\"l-02-anyone-can-withdraw-vested-amount-on-behalf-of-someone\" style=\"position:relative;\"><a href=\"#l-02-anyone-can-withdraw-vested-amount-on-behalf-of-someone\" aria-label=\"l 02 anyone can withdraw vested amount on behalf of someone permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/15\">[L-02] Anyone can withdraw vested amount on behalf of someone</a></h2>\n<p>The <code>Vesting.withdrawVested</code> function allows withdrawing the tokens of other users.</p>\n<p>While the tokens are sent to the correct address, this can lead to issues with smart contracts that might rely on claiming the tokens themselves.</p>\n<p>As one example, suppose the <code>_to</code> address corresponds to a smart contract that has a function of the following form:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">withdrawAndDoSomething</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">.</span><span class=\"mtk11\">withdrawVested</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">), </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">token</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">externalWallet</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>If the contract has no other functions to transfer out funds, they may be locked forever in this contract.</p>\n<p>Recommend not allowing users to withdraw on behalf of other users.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/15#issuecomment-844447528\">ZeframLou (88mph) acknowledged</a>:</strong></p>\n<blockquote>\n<p>This is true, but <code>Vesting.sol</code> is only kept for legacy support, <code>Vesting02.sol</code> will be the main vesting contract, so weâ€™re fine with this.</p>\n</blockquote>\n<h2 id=\"l-03-extra-precautions-in-updateandquery\" style=\"position:relative;\"><a href=\"#l-03-extra-precautions-in-updateandquery\" aria-label=\"l 03 extra precautions in updateandquery permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/10\">[L-03] Extra precautions in updateAndQuery</a></h2>\n<p>The function <code>updateAndQuery</code> of EMAOracle.sol subtracts the <code>incomeIndex</code> with the previous <code>incomeIndex</code>.\nThese <code>incomeIndex</code> values are retrieved via the moneyMarket contract from an external contract.</p>\n<p>If, by accident, the previous <code>incomeIndex</code> is larger than the current <code>incomeIndex</code>, then the subtraction would be negative and the code halts (reverts) without an error message.</p>\n<p>Also, the <code>updateAndQuery</code> function would not be able to execute (until the current <code>incomeIndex</code> is larger than the previous <code>incomeIndex</code>).</p>\n<p>This situation could occur when an error occurs in one of the current or future money markets.</p>\n<p>Recommend giving an error message when the previous <code>incomeIndex</code> is larger than the current <code>incomeIndex</code> and/or create a way to recover from this erroneous situation.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/10#issuecomment-844618871\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/9de33956c1c31cde52768110dc6ec9c19049a748\">this commit</a>.</p>\n</blockquote>\n<h2 id=\"l-04-add-extra-error-message-in_depositrecorddata\" style=\"position:relative;\"><a href=\"#l-04-add-extra-error-message-in_depositrecorddata\" aria-label=\"l 04 add extra error message in_depositrecorddata permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/7\">[L-04] Add extra error message in_depositRecordData</a></h2>\n<p>In the function <code>_depositRecordData</code> of DInterest.sol, <code>interestAmount</code> is lowered with <code>feeAmount</code>.</p>\n<p>If, by accident, <code>feeAmount</code> happens to be larger than <code>interestAmount</code>, an error occurs and the execution stops, without an error message.</p>\n<p>This might make troubleshooting this situation more complicated.</p>\n<p>Suggest adding something like:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">interestAmount</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk12\">feeAmount</span><span class=\"mtk1\">,</span><span class=\"mtk8\">&quot;DInterest: fee too large&quot;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/7\">ZeframLou (88mph) acknowledged</a></strong></p>\n<h2 id=\"l-05-function-payinteresttofunders-does-not-have-a-re-entrancy-modifier\" style=\"position:relative;\"><a href=\"#l-05-function-payinteresttofunders-does-not-have-a-re-entrancy-modifier\" aria-label=\"l 05 function payinteresttofunders does not have a re entrancy modifier permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/6\">[L-05] function payInterestToFunders does not have a re-entrancy modifier</a></h2>\n<p>Function <code>payInterestToFunders</code> does not have a re-entrancy modifier. I expect to see this modifier because similar functions (including sponsored version) have it.</p>\n<p>Add â€˜nonReentrantâ€™ to function <code>payInterestToFunders</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/6#issuecomment-844461166\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/ed9dec252b1dde4225f4bfc1ac4a52bc79af40a4\">this commit</a>.</p>\n</blockquote>\n<h1 id=\"non-critical-findings\" style=\"position:relative;\"><a href=\"#non-critical-findings\" aria-label=\"non critical findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non-Critical Findings</h1>\n<h2 id=\"n-01-zero-amount--of-token-value-can-be-entered-for-creating-vest-object-in--vestingsol\" style=\"position:relative;\"><a href=\"#n-01-zero-amount--of-token-value-can-be-entered-for-creating-vest-object-in--vestingsol\" aria-label=\"n 01 zero amount  of token value can be entered for creating vest object in  vestingsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/12\">[N-01] zero amount  of token value can be entered for creating vest object in  vesting.sol</a></h2>\n<p>The impact will be on the end-user; if they entered the zero amount by mistake, they would end paying a gas fee for nothing.</p>\n<p>In the <code>vest</code> function, there is checking of <code>vestPeriodInSeconds</code> but no checking of amount, due to which amount can be set to 0.</p>\n<p>Recommend adding a condition to check for function parameter.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/12#issuecomment-844448773\">ZeframLou (88mph) acknowledged</a>:</strong></p>\n<blockquote>\n<p>Weâ€™re ok with this.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/12#issuecomment-851066055\">ghoul.sol commented</a>:</strong></p>\n<blockquote>\n<p>Passing 0 doesnâ€™t break anything. This is a non-critical issue.</p>\n</blockquote>\n<h2 id=\"n-02-lack-of-zero-address-validation-in-constructor\" style=\"position:relative;\"><a href=\"#n-02-lack-of-zero-address-validation-in-constructor\" aria-label=\"n 02 lack of zero address validation in constructor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/13\">[N-02] lack of zero address validation in constructor</a></h2>\n<p>Due to the lack of zero address validation, there is a chance of losing funds.</p>\n<p><a href=\"https://github.com/code-423n4/2021-05-88mph/blob/main/contracts/rewards/dumpers/Dumper.sol\">Dumper.sol</a></p>\n<p><a href=\"https://github.com/code-423n4/2021-05-88mph/blob/main/contracts/rewards/dumpers/OneSplitDumper.sol\">OneSplitDumper.sol</a></p>\n<p>Recommend adding zero address check.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/13#issuecomment-844445191\">ZeframLou (88mph) acknowledged</a>:</strong></p>\n<blockquote>\n<p>Weâ€™re fine with this.</p>\n</blockquote>\n<h2 id=\"n-03-multiple-definitions-of-precision\" style=\"position:relative;\"><a href=\"#n-03-multiple-definitions-of-precision\" aria-label=\"n 03 multiple definitions of precision permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/8\">[N-03] Multiple definitions of PRECISION</a></h2>\n<p>There are multiple definitions of PRECISION.</p>\n<p>This risk is that is someone (a new developer?) would change the value of PRECISION on one location and might forget to change it in one of the other places. Also, 2 of them are defined as public while the rest is internal.</p>\n<p>Recommend defining PRECISION once and import this in all the other contracts.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/8\">ZeframLou (88mph) acknowledged</a></strong></p>\n<h2 id=\"n-04-contract-aavemarket-function-setrewards-has-a-misleading-revert-message\" style=\"position:relative;\"><a href=\"#n-04-contract-aavemarket-function-setrewards-has-a-misleading-revert-message\" aria-label=\"n 04 contract aavemarket function setrewards has a misleading revert message permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/4\">[N-04] contract AaveMarket function setRewards has a misleading revert message</a></h2>\n<p>AaveMarket function <code>setRewards</code> has a misleading revert message:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">newValue</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isContract</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&quot;HarvestMarket: not contract&quot;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p>Recommend naming it â€˜AaveMarketâ€™, not â€˜HarvestMarketâ€™.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/4#issuecomment-844575572\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/f4b58f8af4366507f14d781c4af95dbab970fb50\">this commit</a>.</p>\n</blockquote>\n<h2 id=\"n-05-mismatch-between-the-comment-and-the-actual-code\" style=\"position:relative;\"><a href=\"#n-05-mismatch-between-the-comment-and-the-actual-code\" aria-label=\"n 05 mismatch between the comment and the actual code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/5\">[N-05] Mismatch between the comment and the actual code</a></h2>\n<p>Here the comment says that it should transfer from msg.sender, but it actually transfers from the sender which is not always the msg.sender (e.g., sponsored txs):</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">// Transfer `fundAmount` stablecoins from msg.sender</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">stablecoin.safeTransferFrom(sender, address(this), fundAmount);</span></span></code></pre>\n<p>Update the comment to match the code.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/5#issuecomment-844575355\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Fixed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/f4b58f8af4366507f14d781c4af95dbab970fb50\">this commit</a>.</p>\n</blockquote>\n<h1 id=\"gas-optimizations\" style=\"position:relative;\"><a href=\"#gas-optimizations\" aria-label=\"gas optimizations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations</h1>\n<h2 id=\"g-01-gas-optimizations-by-using-external-over-public-\" style=\"position:relative;\"><a href=\"#g-01-gas-optimizations-by-using-external-over-public-\" aria-label=\"g 01 gas optimizations by using external over public  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/18\">[G-01] Gas optimizations by using external over public </a></h2>\n<p>Some functions could use external instead of public in order to save gas.</p>\n<p>If we run the following methods on Remix, we can see the difference:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">//  transaction cost  21448 gas</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">//  execution cost    176 gas</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">tt</span><span class=\"mtk1\">() </span><span class=\"mtk11\">external</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">//  transaction cost  21558 gas</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">//  execution cost    286 gas</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">tt_public</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/18#issuecomment-844566246\">ZeframLou (88mph) disputed</a>:</strong></p>\n<blockquote>\n<p>Many of the functions listed are also called within the contract, so changing their visibility to <code>public</code> will break things.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/18#issuecomment-851067622\">ghoul.sol commented</a>:</strong></p>\n<blockquote>\n<p>Even though out of the whole list, only a few functions are good candidates to be changed, itâ€™s technically a valid suggestion.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/18#issuecomment-856489515\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Addressed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/e1df42dc46960ecd0c67a8d896f933149ea129e4\">this commit</a>.</p>\n</blockquote>\n<h2 id=\"g-02-gas-optimizations---storage-over-memory\" style=\"position:relative;\"><a href=\"#g-02-gas-optimizations---storage-over-memory\" aria-label=\"g 02 gas optimizations   storage over memory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/19\">[G-02] Gas optimizations - storage over memory</a></h2>\n<p>Some functions are using memory to read state variables when using storage is more gas efficient.</p>\n<p><a href=\"https://docs.soliditylang.org/en/v0.4.21/types.html#reference-types\">Solidity doc reference</a></p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/19#issuecomment-844565136\">ZeframLou (88mph) disputed</a>:</strong></p>\n<blockquote>\n<p>The memory location of those variables is intentionally set to be <code>memory</code> to only load the data from storage once to save gas. If changed to <code>storage</code>, there will be multiple `SLOADâ€™s for accessing the same variable, which is expensive.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/19#issuecomment-851069151\">ghoul.sol commented</a>:</strong></p>\n<blockquote>\n<p>In case of the <code>withdrawableAmountOfDeposit</code> function, the warden is right. <code>_getDeposit</code> makes 7 <code>SLOAD</code> calls in this case because itâ€™s pulling the whole object from storage. Using storage would make only 5 <code>SLOAD</code> calls.</p>\n<p>In the case of <code>_getVestWithdrawableAmount</code>, either way uses 6 <code>SLOAD</code> calls.</p>\n<p>Warden is correct in at least one case, so the reports stand.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-05-88mph-findings/issues/19#issuecomment-856489220\">ZeframLou (88mph) confirmed</a>:</strong></p>\n<blockquote>\n<p>Addressed in <a href=\"https://github.com/88mphapp/88mph-contracts/commit/6459177a642d854ca6ee4deeda7f61075bd4bdf1\">this commit</a>.</p>\n</blockquote>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li><a href=\"#high-risk-findings\">High Risk Findings</a></li>\n<li>\n<p><a href=\"#medium-risk-findings\">Medium Risk Findings</a></p>\n<ul>\n<li><a href=\"#m-01-incompatability-with-deflationary--fee-on-transfer-tokens\">[M-01] Incompatability with deflationary / fee-on-transfer tokens</a></li>\n<li><a href=\"#m-02-unchecking-the-ownership-of-mph-in-function-distributefundingrewards-could-cause-several-critical-functions-to-revert\">[M-02] Unchecking the ownership of <code>mph</code> in function <code>distributeFundingRewards</code> could cause several critical functions to revert</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#low-risk-findings\">Low Risk Findings</a></p>\n<ul>\n<li><a href=\"#l-01-use-openzeppelin-ecda-for-erecover\">[L-01] Use openzeppelin ECDA for erecover</a></li>\n<li><a href=\"#l-02-anyone-can-withdraw-vested-amount-on-behalf-of-someone\">[L-02] Anyone can withdraw vested amount on behalf of someone</a></li>\n<li><a href=\"#l-03-extra-precautions-in-updateandquery\">[L-03] Extra precautions in updateAndQuery</a></li>\n<li><a href=\"#l-04-add-extra-error-message-in_depositrecorddata\">[L-04] Add extra error message in_depositRecordData</a></li>\n<li><a href=\"#l-05-function-payinteresttofunders-does-not-have-a-re-entrancy-modifier\">[L-05] function payInterestToFunders does not have a re-entrancy modifier</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#non-critical-findings\">Non-Critical Findings</a></p>\n<ul>\n<li><a href=\"#n-01-zero-amount--of-token-value-can-be-entered-for-creating-vest-object-in--vestingsol\">[N-01] zero amount  of token value can be entered for creating vest object in  vesting.sol</a></li>\n<li><a href=\"#n-02-lack-of-zero-address-validation-in-constructor\">[N-02] lack of zero address validation in constructor</a></li>\n<li><a href=\"#n-03-multiple-definitions-of-precision\">[N-03] Multiple definitions of PRECISION</a></li>\n<li><a href=\"#n-04-contract-aavemarket-function-setrewards-has-a-misleading-revert-message\">[N-04] contract AaveMarket function setRewards has a misleading revert message</a></li>\n<li><a href=\"#n-05-mismatch-between-the-comment-and-the-actual-code\">[N-05] Mismatch between the comment and the actual code</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#gas-optimizations\">Gas Optimizations</a></p>\n<ul>\n<li><a href=\"#g-01-gas-optimizations-by-using-external-over-public-\">[G-01] Gas optimizations by using external over public </a></li>\n<li><a href=\"#g-02-gas-optimizations---storage-over-memory\">[G-02] Gas optimizations - storage over memory</a></li>\n</ul>\n</li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>",
  "md": "\n# Overview\n\n## About C4\n\nCode 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.\n\nA C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\n\nDuring the code contest outlined in this document, C4 conducted an analysis of 88mph's smart contract system written in Solidity. The code contest took place between May 13 and May 19, 2021.\n\n## Wardens\n\n5 Wardens contributed reports to the 88mph code contest:\n\n- [cmichel](https://twitter.com/cmichelio)\n- [shw](https://twitter.com/shw9453)\n- [gpersoon](https://twitter.com/gpersoon)\n- [Thunder](https://twitter.com/SolidityDev)\n- [a_delamo](https://twitter.com/a_delamo)\n\nThis contest was judged by [ghoul.sol](https://twitter.com/ghoulsol).\n\nFinal report assembled by [ninek](https://twitter.com/_ninek_).\n\n# Summary\n\nThe C4 analysis yielded an aggregated total of 14 unique vulnerabilities. All of the issues presented here are linked back to their original finding.\n\nOf these vulnerabilities, 2 received a risk rating in the category of MEDIUM severity, and 5 received a risk rating in the category of LOW severity.\n\nC4 analysis also identified 7 non-critical recommendations.\n\n# Scope\n\nThe code under review can be found within the [C4 code contest repository](https://github.com/code-423n4/2021-05-88mph) and comprises 39 smart contracts written in the Solidity programming language.\n\n# Severity Criteria\n\nC4 assesses the severity of disclosed vulnerabilities according to a methodology based on [OWASP standards](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).\n\nVulnerabilities are divided into three primary risk categories: high, medium, and low.\n\nHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\n\n- Malicious Input Handling\n- Escalation of privileges\n- Arithmetic\n- Gas use\n\nFurther information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on [the C4 website](https://code423n4.com).\n\n# High Risk Findings\n\nThere were no high risk findings identified in this contest.\n \n# Medium Risk Findings\n\n## [[M-01] Incompatability with deflationary / fee-on-transfer tokens](https://github.com/code-423n4/2021-05-88mph-findings/issues/16)\n\nThe `DInterest.deposit` function takes a `depositAmount` parameter but this parameter is not the actual transferred amount for fee-on-transfer / deflationary (or other rebasing) tokens.\n\nThe actual deposited amount might be lower than the specified `depositAmount` of the function parameter.\n\nThis would lead to wrong interest rate calculations on the principal.\n\nRecommend transferring the tokens first and comparing pre-/after token balances to compute the actual deposited amount.\n\n**[ZeframLou (88mph) acknowledged](https://github.com/code-423n4/2021-05-88mph-findings/issues/16#issuecomment-844441370):**\n> While this is true, we have no plans to support fee-on-transfer or rebasing tokens.\n\n## [[M-02] Unchecking the ownership of `mph` in function `distributeFundingRewards` could cause several critical functions to revert](https://github.com/code-423n4/2021-05-88mph-findings/issues/23)\n\nIn contract `MPHMinter`, the function `distributeFundingRewards` does not check whether the contract itself is the owner of `mph`. If the contract is not the owner of `mph`, `mph.ownerMint` could revert, causing functions such as `withdraw`, `rolloverDeposit`, `payInterestToFunders` in the contract `DInterest` to revert as well.\n\nRecommend adding a `mph.owner() != address(this)` check as in the other functions (e.g., `mintVested`).\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/23#issuecomment-844625823):**\n> Fixed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/026dde3d30bddedbc1eeca6c87bce4bc5b5c7ee5).\n \n# Low Risk Findings\n\n## [[L-01] Use openzeppelin ECDA for erecover](https://github.com/code-423n4/2021-05-88mph-findings/issues/20)\n\nIn `Sponsorable.sol` is using erecover directly to verify the signature.\nSince it is a critical piece of the protocol, it is recommended to use the ECDSA from openzeppelin as it does more validations when verifying the signature.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/20#issuecomment-844573323):**\n> Fixed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/de3742fe48991870ca3be8210c56e8301cffe4c6).\n\n## [[L-02] Anyone can withdraw vested amount on behalf of someone](https://github.com/code-423n4/2021-05-88mph-findings/issues/15)\n\nThe `Vesting.withdrawVested` function allows withdrawing the tokens of other users.\n\nWhile the tokens are sent to the correct address, this can lead to issues with smart contracts that might rely on claiming the tokens themselves.\n\nAs one example, suppose the `_to` address corresponds to a smart contract that has a function of the following form:\n\n```solidity\nfunction withdrawAndDoSomething() {\n    contract.withdrawVested(address(this), amount);\n    token.transfer(externalWallet, amount)\n}\n```\n\nIf the contract has no other functions to transfer out funds, they may be locked forever in this contract.\n\nRecommend not allowing users to withdraw on behalf of other users.\n\n**[ZeframLou (88mph) acknowledged](https://github.com/code-423n4/2021-05-88mph-findings/issues/15#issuecomment-844447528):**\n> This is true, but `Vesting.sol` is only kept for legacy support, `Vesting02.sol` will be the main vesting contract, so we're fine with this.\n\n## [[L-03] Extra precautions in updateAndQuery](https://github.com/code-423n4/2021-05-88mph-findings/issues/10)\n\nThe function `updateAndQuery` of EMAOracle.sol subtracts the `incomeIndex` with the previous `incomeIndex`.\nThese `incomeIndex` values are retrieved via the moneyMarket contract from an external contract.\n\nIf, by accident, the previous `incomeIndex` is larger than the current `incomeIndex`, then the subtraction would be negative and the code halts (reverts) without an error message.\n\nAlso, the `updateAndQuery` function would not be able to execute (until the current `incomeIndex` is larger than the previous `incomeIndex`).\n\nThis situation could occur when an error occurs in one of the current or future money markets.\n\nRecommend giving an error message when the previous `incomeIndex` is larger than the current `incomeIndex` and/or create a way to recover from this erroneous situation.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/10#issuecomment-844618871):**\n> Fixed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/9de33956c1c31cde52768110dc6ec9c19049a748).\n\n## [[L-04] Add extra error message in_depositRecordData](https://github.com/code-423n4/2021-05-88mph-findings/issues/7)\n\nIn the function `_depositRecordData` of DInterest.sol, `interestAmount` is lowered with `feeAmount`.\n\nIf, by accident, `feeAmount` happens to be larger than `interestAmount`, an error occurs and the execution stops, without an error message.\n\nThis might make troubleshooting this situation more complicated.\n\nSuggest adding something like:\n```solidity\nrequire(interestAmount >= feeAmount,\"DInterest: fee too large\");\n```\n\n**[ZeframLou (88mph) acknowledged](https://github.com/code-423n4/2021-05-88mph-findings/issues/7)**\n\n## [[L-05] function payInterestToFunders does not have a re-entrancy modifier](https://github.com/code-423n4/2021-05-88mph-findings/issues/6)\n\nFunction `payInterestToFunders` does not have a re-entrancy modifier. I expect to see this modifier because similar functions (including sponsored version) have it.\n\nAdd 'nonReentrant' to function `payInterestToFunders`.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/6#issuecomment-844461166):**\n> Fixed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/ed9dec252b1dde4225f4bfc1ac4a52bc79af40a4).\n \n# Non-Critical Findings\n\n## [[N-01] zero amount  of token value can be entered for creating vest object in  vesting.sol](https://github.com/code-423n4/2021-05-88mph-findings/issues/12)\n\nThe impact will be on the end-user; if they entered the zero amount by mistake, they would end paying a gas fee for nothing.\n\nIn the `vest` function, there is checking of `vestPeriodInSeconds` but no checking of amount, due to which amount can be set to 0.\n\nRecommend adding a condition to check for function parameter.\n\n**[ZeframLou (88mph) acknowledged](https://github.com/code-423n4/2021-05-88mph-findings/issues/12#issuecomment-844448773):**\n> We're ok with this.\n\n**[ghoul.sol commented](https://github.com/code-423n4/2021-05-88mph-findings/issues/12#issuecomment-851066055):**\n> Passing 0 doesn't break anything. This is a non-critical issue.\n\n## [[N-02] lack of zero address validation in constructor](https://github.com/code-423n4/2021-05-88mph-findings/issues/13)\n\nDue to the lack of zero address validation, there is a chance of losing funds.\n\n[Dumper.sol](https://github.com/code-423n4/2021-05-88mph/blob/main/contracts/rewards/dumpers/Dumper.sol)\n\n[OneSplitDumper.sol](https://github.com/code-423n4/2021-05-88mph/blob/main/contracts/rewards/dumpers/OneSplitDumper.sol)\n\nRecommend adding zero address check.\n\n**[ZeframLou (88mph) acknowledged](https://github.com/code-423n4/2021-05-88mph-findings/issues/13#issuecomment-844445191):**\n> We're fine with this.\n\n## [[N-03] Multiple definitions of PRECISION](https://github.com/code-423n4/2021-05-88mph-findings/issues/8)\n\nThere are multiple definitions of PRECISION.\n\nThis risk is that is someone (a new developer?) would change the value of PRECISION on one location and might forget to change it in one of the other places. Also, 2 of them are defined as public while the rest is internal.\n\nRecommend defining PRECISION once and import this in all the other contracts.\n\n**[ZeframLou (88mph) acknowledged](https://github.com/code-423n4/2021-05-88mph-findings/issues/8)**\n\n## [[N-04] contract AaveMarket function setRewards has a misleading revert message](https://github.com/code-423n4/2021-05-88mph-findings/issues/4)\n\nAaveMarket function `setRewards` has a misleading revert message:\n```solidity\nrequire(newValue.isContract(), \"HarvestMarket: not contract\");\n```\n\nRecommend naming it 'AaveMarket', not 'HarvestMarket'.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/4#issuecomment-844575572):**\n> Fixed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/f4b58f8af4366507f14d781c4af95dbab970fb50).\n\n\n## [[N-05] Mismatch between the comment and the actual code](https://github.com/code-423n4/2021-05-88mph-findings/issues/5)\n\nHere the comment says that it should transfer from msg.sender, but it actually transfers from the sender which is not always the msg.sender (e.g., sponsored txs):\n\n```\n// Transfer `fundAmount` stablecoins from msg.sender\nstablecoin.safeTransferFrom(sender, address(this), fundAmount);\n```\n\nUpdate the comment to match the code.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/5#issuecomment-844575355):**\n> Fixed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/f4b58f8af4366507f14d781c4af95dbab970fb50).\n \n# Gas Optimizations\n## [[G-01] Gas optimizations by using external over public ](https://github.com/code-423n4/2021-05-88mph-findings/issues/18)\n\nSome functions could use external instead of public in order to save gas.\n\nIf we run the following methods on Remix, we can see the difference:\n```solidity\n  //  transaction cost  21448 gas\n  //  execution cost    176 gas\n  function tt() external returns(uint256) {\n      return 0;\n  }\n\n  //  transaction cost  21558 gas\n  //  execution cost    286 gas\n  function tt_public() public returns(uint256) {\n      return 0;\n  }\n```\n\n**[ZeframLou (88mph) disputed](https://github.com/code-423n4/2021-05-88mph-findings/issues/18#issuecomment-844566246):**\n> Many of the functions listed are also called within the contract, so changing their visibility to `public` will break things.\n\n**[ghoul.sol commented](https://github.com/code-423n4/2021-05-88mph-findings/issues/18#issuecomment-851067622):**\n> Even though out of the whole list, only a few functions are good candidates to be changed, it's technically a valid suggestion.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/18#issuecomment-856489515):**\n> Addressed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/e1df42dc46960ecd0c67a8d896f933149ea129e4).\n\n\n## [[G-02] Gas optimizations - storage over memory](https://github.com/code-423n4/2021-05-88mph-findings/issues/19)\n\nSome functions are using memory to read state variables when using storage is more gas efficient.\n\n[Solidity doc reference](https://docs.soliditylang.org/en/v0.4.21/types.html#reference-types)\n\n**[ZeframLou (88mph) disputed](https://github.com/code-423n4/2021-05-88mph-findings/issues/19#issuecomment-844565136):**\n> The memory location of those variables is intentionally set to be `memory` to only load the data from storage once to save gas. If changed to `storage`, there will be multiple `SLOAD's for accessing the same variable, which is expensive.\n\n**[ghoul.sol commented](https://github.com/code-423n4/2021-05-88mph-findings/issues/19#issuecomment-851069151):**\n> In case of the `withdrawableAmountOfDeposit` function, the warden is right. `_getDeposit` makes 7 `SLOAD` calls in this case because it's pulling the whole object from storage. Using storage would make only 5 `SLOAD` calls.\n> \n> In the case of `_getVestWithdrawableAmount`, either way uses 6 `SLOAD` calls.\n> \n> Warden is correct in at least one case, so the reports stand.\n\n**[ZeframLou (88mph) confirmed](https://github.com/code-423n4/2021-05-88mph-findings/issues/19#issuecomment-856489220):**\n> Addressed in [this commit](https://github.com/88mphapp/88mph-contracts/commit/6459177a642d854ca6ee4deeda7f61075bd4bdf1).\n\n# Disclosures\n\nC4 is an open organization governed by participants in the community.\n\nC4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\n\nC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\n"
}