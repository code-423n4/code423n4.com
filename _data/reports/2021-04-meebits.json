{
  "circa": {
    "title": "Larva Labs Meebits",
    "sponsor": "LarvaLabs Meebits",
    "slug": "2021-04-meebits",
    "date": "2021-06-30",
    "findings": "https://github.com/code-423n4/2021-04-meebits-findings/issues",
    "contest": 6
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the code contest outlined in this document, C4 conducted an analysis of Larva Labsâ€™ Meebits smart contract system written in Solidity. The code contest took place between April 29 and May 1, 2021.</p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>9 Wardens contributed reports to the Meebits code contest:</p>\n<ul>\n<li><a href=\"https://twitter.com/0xRajeev\">0xRajeev</a></li>\n<li><a href=\"https://github.com/alex-ppg\">0xsomeone</a></li>\n<li><a href=\"https://twitter.com/SolidityDev\">Thunder</a></li>\n<li><a href=\"https://twitter.com/_smonica_\">s1m0</a></li>\n<li><a href=\"https://twitter.com/jvaqa\">jvaqa</a></li>\n<li><a href=\"https://twitter.com/MukeshJ_eth\">Jmukesh</a></li>\n<li><a href=\"https://twitter.com/gallodasballo\">GalloDaSballo</a></li>\n<li><a href=\"https://twitter.com/cmichelio\">cmichel</a></li>\n<li><a href=\"https://twitter.com/gpersoon\">gpersoon</a></li>\n</ul>\n<p>This contest was judged by <a href=\"https://twitter.com/josephdelong\">Joseph Delong</a>.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/_ninek_\">ninek</a> and <a href=\"https://twitter.com/money_lego\">moneylegobatman</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 15 unique vulnerabilities. All of the issues presented here are linked back to their original finding.</p>\n<p>Of these vulnerabilities, 6 received a risk rating in the category of HIGH severity, 3 received a risk rating in the category of MEDIUM severity, and 6 received a risk rating in the category of LOW severity.</p>\n<p>C4 analysis also identified 8 non-critical recommendations.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2021-04-meebits\">C4 code contest repository</a> and comprises 1 smart contract written in the Solidity programming language.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code423n4.com\">the C4 website</a>.</p>\n<h1 id=\"high-risk-findings\" style=\"position:relative;\"><a href=\"#high-risk-findings\" aria-label=\"high risk findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>High Risk Findings</h1>\n<h2 id=\"h-00-erc-721-enumerable-spec-mismatch-for-index-of-tokenbyindex-function\" style=\"position:relative;\"><a href=\"#h-00-erc-721-enumerable-spec-mismatch-for-index-of-tokenbyindex-function\" aria-label=\"h 00 erc 721 enumerable spec mismatch for index of tokenbyindex function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/47\">[H-00] ERC-721 Enumerable Spec mismatch for index of <code>tokenByIndex()</code> function</a></h2>\n<p>Index starts at 0 for token array, but the implementation here requires index to be greater than 0. This will prevent querying of tokens at index 0.</p>\n<p>See <a href=\"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/3ba2a1354f8f830d5a0e711537efdbdd8bcb109e/contracts/token/ERC721/extensions/ERC721Enumerable.sol#L21\">reference implementation</a>.</p>\n<p>This will impact compatibility with NFT platforms that expect full conformity with ERC-721 specification.</p>\n<p>Recommend accepting 0 index by changing to <code>require(index >= 0 &#x26;&#x26; index &#x3C; TOKEN_LIMIT);</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/47#issuecomment-847429104\">dangerousfood (Meebits) commented</a>:</strong></p>\n<blockquote>\n<p>Beebots indexes by 1 for whatever reason</p>\n</blockquote>\n<h2 id=\"h-01-signature-malleability-of-evms-ecrecover-in-verify\" style=\"position:relative;\"><a href=\"#h-01-signature-malleability-of-evms-ecrecover-in-verify\" aria-label=\"h 01 signature malleability of evms ecrecover in verify permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/54\">[H-01] Signature malleability of EVMâ€™s <code>ecrecover</code> in <code>verify()</code></a></h2>\n<p>EVMâ€™s <code>ecrecover</code> is susceptible to signature malleability, which allows replay attacks, but that is mitigated here by tracking accepted offers and canceling them (on L645) specifically to prevent replays. However, if any application logic changes, it might make signature malleability a risk for replay attacks.</p>\n<p>See <a href=\"https://swcregistry.io/docs/SWC-117\">reference</a>.</p>\n<p>Recommend using <a href=\"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol\">OpenZeppelinâ€™s ECDSA library</a></p>\n<h2 id=\"h-02-arbitrary-transfer-of-unowned-nfts\" style=\"position:relative;\"><a href=\"#h-02-arbitrary-transfer-of-unowned-nfts\" aria-label=\"h 02 arbitrary transfer of unowned nfts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/4\">[H-02] Arbitrary Transfer of Unowned NFTs</a></h2>\n<p>Due to how the market functions are structured, it is possible to arbitrarily transfer any NFT that is not owned by any address.</p>\n<p>The function in question is the <code>tradeValid</code> function invoked by <code>acceptTrade</code> before the trade is performed. It, in turn, validates the signature of a trade via <code>verify</code>, which does not account for the behavior of <code>ecrecover</code>.</p>\n<p>When <code>ecrecover</code> is invoked with an invalid signature, the zero-address is returned by it, meaning that <code>verify</code> will yield <code>true</code> for the zero-address as long as the signature provided is invalid.</p>\n<p>This can be exploited to transfer any NFT whose <code>idToOwner</code> is zero, including NFTs that have not been minted yet.</p>\n<p>Recommend an additional check be imposed within <code>verify</code> that ensures the signer is not the zero-address which will alleviate this check. For more details, consult the <a href=\"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v3.4.0/contracts/cryptography/ECDSA.sol#L53-L71\">EIP721 implementation by OpenZeppelin</a>.</p>\n<h2 id=\"h-03-beebotstradevalid-will-erroneously-return-true-when-maker-is-set-to-address0-and-makerids-are-set-to-the-tokenids-of-unminted-beebot-nfts\" style=\"position:relative;\"><a href=\"#h-03-beebotstradevalid-will-erroneously-return-true-when-maker-is-set-to-address0-and-makerids-are-set-to-the-tokenids-of-unminted-beebot-nfts\" aria-label=\"h 03 beebotstradevalid will erroneously return true when maker is set to address0 and makerids are set to the tokenids of unminted beebot nfts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/77\">[H-03] <code>Beebots.TradeValid()</code> Will Erroneously Return True When Maker Is Set To <code>Address(0)</code> and <code>makerIds</code> Are Set To The <code>TokenIds</code> of Unminted Beebot NFTs</a></h2>\n<p><code>Beebots.TradeValid()</code> will erroneously return true when <code>maker</code> is set to <code>address(0)</code> and <code>makerIds</code> are set to the <code>tokenIds</code> of unminted beebot NFTs.</p>\n<p><code>Beebots.verify()</code> returns true no matter what signature is given when signer is set to <code>address(0)</code>. This means that <code>BeeBots.tradeValid()</code> will erroneously return true when <code>maker</code> is set to <code>address(0)</code>.</p>\n<p>Finally, before an NFT has even been minted at all, it is assumed to have an owner of <code>address(0)</code> due to the <code>idToOwner</code> mapping being initialized to zero for all uninitialized slots, so an attacker can call <code>tradeValid()</code> with <code>maker</code> set to <code>address(0)</code> and <code>makerIds</code> set to the <code>tokenIds</code> of any unminted <code>nftIds</code>, and <code>tradeValid()</code> will erroneously return true.</p>\n<ul>\n<li>\n<p>(1) <code>Beebots.verify()</code> returns true no matter what signature is given when signer is set to <code>address(0)</code>.</p>\n<ul>\n<li>(1a) <code>BeeBots.verify()</code> does not check to ensure that signer is not <code>address(0)</code>.</li>\n<li>(1b) This is a problem because <code>ecrecover</code> fails silently if the signature does not match and returns zero.</li>\n<li>(1c) So if an attacker passes in <code>address(0)</code> as the signer, then verify will return true no matter what signature is provided, since <code>ecrecover</code> will return <code>address(0)</code>, and the signer is <code>address(0)</code>, so verify will pass.</li>\n<li>(1d) This means that <code>BeeBots.tradeValid()</code> will erroneously return true when maker is set to <code>address(0)</code>.</li>\n</ul>\n</li>\n<li>\n<p>(2) Before an NFT has even been minted at all, it is assumed to have an owner of <code>address(0)</code> due to the <code>idToOwner</code> mapping being initialized to zero for all uninitialized slots</p>\n<ul>\n<li>(2a) Solidity initializes all mappings to 0 for all slots that have not yet been set.</li>\n<li>(2b) So for any NFT ID that has not yet been minted, the corresponding owner in the mapping <code>BeeBots.idToOwner</code> is <code>address(0)</code>, even though that NFT should not even exist.</li>\n<li>(2c) This means that an attacker can call <code>tradeValid()</code> with maker set to <code>address(0)</code> and makerIds set to any unminted nftIds, and <code>tradeValid()</code> will erroneously return true.</li>\n</ul>\n</li>\n</ul>\n<p>(1) Recommend adding this check to <code>Beebots.verify()</code>:\n<code>require(signer != address(0), \"Cannot verify signatures from 0x0\");</code></p>\n<p>(2) Recommend adding this check to <code>Beebots.tradeValid()</code>:\n<code>require(maker != address(0), \"Maker 0x0 not allowed\");</code></p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/77#issuecomment-847413820\">dangerousfood (Meebits) commented</a>:</strong></p>\n<blockquote>\n<p>Wow, this exploit is absolutely stunning.</p>\n</blockquote>\n<h2 id=\"h-04-function-tokenbyindex-treats-last-index-as-invalid\" style=\"position:relative;\"><a href=\"#h-04-function-tokenbyindex-treats-last-index-as-invalid\" aria-label=\"h 04 function tokenbyindex treats last index as invalid permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/73\">[H-04] function <code>tokenByIndex</code> treats last index as invalid</a></h2>\n<p>NFT indexes start from 0:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Don&#39;t allow a zero index, start counting at 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">value</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p>So if there are 30 tokens, indexes would be 1-30. However, function <code>tokenByIndex</code> sets such boundaries:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">index</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">index</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">TOKEN_LIMIT</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p>This means that the last token (with index 30 in this case) will not be valid.</p>\n<p>Recommend using:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">index</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">index</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">TOKEN_LIMIT</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/73#issuecomment-847429563\">dangerousfood (Meebits) commented</a>:</strong></p>\n<blockquote>\n<p>Beebots is indexing by 1</p>\n</blockquote>\n<h2 id=\"h-05-nft-can-be-minted-for-free-after-sale-ended\" style=\"position:relative;\"><a href=\"#h-05-nft-can-be-minted-for-free-after-sale-ended\" aria-label=\"h 05 nft can be minted for free after sale ended permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/75\">[H-05] NFT can be minted for free after sale ended</a></h2>\n<p>The <code>getPrice()</code> function returned 0 after the sale ended and (<code>SALE_LIMIT - numSales</code>) NFT can be minted for free.</p>\n<p>Without documentation, itâ€™s not clear if this is the expected behavior or not. If itâ€™s unexpected, it is recommended to revert instead of returning 0. If itâ€™s expected behavior, itâ€™s possible to create a smart contract and claim all the remaining NFT front-running the regular users.</p>\n<h1 id=\"medium-risk-findings\" style=\"position:relative;\"><a href=\"#medium-risk-findings\" aria-label=\"medium risk findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings</h1>\n<h2 id=\"m-00-legacy-function-usage\" style=\"position:relative;\"><a href=\"#m-00-legacy-function-usage\" aria-label=\"m 00 legacy function usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/14\">[M-00] Legacy Function Usage</a></h2>\n<p>The <code>withdraw</code> function utilizes the <code>transfer</code> invocation, which has a fixed gas stipend and can fail, especially beyond the Berlin fork, which increased the <a href=\"https://eips.ethereum.org/EIPS/eip-2929\">gas costs</a> for first-time invocations of a transfer.</p>\n<p>The EIP should be sufficient.</p>\n<p>Recommend using a safe wrapper library, such as the OpenZeppelin <code>Address</code> libraryâ€™s <code>sendValue</code> function, which forwards sufficient gas for the transfer regardless of the underlying OPCODE gas costs.</p>\n<h2 id=\"m-01-randomindex-is-not-truly-random---possibility-of-predictably-minting-a-specific-token-id\" style=\"position:relative;\"><a href=\"#m-01-randomindex-is-not-truly-random---possibility-of-predictably-minting-a-specific-token-id\" aria-label=\"m 01 randomindex is not truly random   possibility of predictably minting a specific token id permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/30\">[M-01] <code>randomIndex</code> is not truly random - possibility of predictably minting a specific token Id</a></h2>\n<p>`randomIndexâ€™ is not random. Any miner has access to these values:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">index</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">uint</span><span class=\"mtk1\">(</span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span><span class=\"mtk12\">nonce</span><span class=\"mtk1\">, </span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk12\">block</span><span class=\"mtk1\">.</span><span class=\"mtk12\">difficulty</span><span class=\"mtk1\">, </span><span class=\"mtk12\">block</span><span class=\"mtk1\">.</span><span class=\"mtk12\">timestamp</span><span class=\"mtk1\">))) % </span><span class=\"mtk12\">totalSize</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p>Non-miner attackers could also test the minting random condition until they get the ID they are looking to access.</p>\n<p>The internal variable <a href=\"https://github.com/code-423n4/2021-04-meebits/blob/2ec4ce8e98374be2048126485ad8ddacc2d36d2f/Beebots.sol#L158\"><code>indices</code></a> seems to be used to avoid this type of collision.</p>\n<p>While this makes it less straightforward, there is still the possibility of minting a token with a specific ID.</p>\n<p>That said, <a href=\"https://github.com/code-423n4/2021-04-meebits/blob/2ec4ce8e98374be2048126485ad8ddacc2d36d2f/Beebots.sol#L408\"><code>_addNFToken</code></a> is checking if the token is already owned by an address, ensuring a token canâ€™t be stolen.</p>\n<p>Refactoring as suggested below will save gas, make code easier to read and prevent reverts in rare unfortunate occasions of clashes.</p>\n<p>Recommend not generating random IDs and instead using counters. It makes the code more predictable and easier to read, avoids clashing of IDs, and reduces the need to track minted tokens.</p>\n<h2 id=\"m-02-instead-of-call--transfer-is-used-to-withdraw-the-ether\" style=\"position:relative;\"><a href=\"#m-02-instead-of-call--transfer-is-used-to-withdraw-the-ether\" aria-label=\"m 02 instead of call  transfer is used to withdraw the ether permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/2\">[M-02] instead of <code>call()</code> , <code>transfer()</code> is used to withdraw the ether</a></h2>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">withdraw</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">) </span><span class=\"mtk11\">external</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">amount</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk12\">ethBalance</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">ethBalance</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">] = </span><span class=\"mtk12\">ethBalance</span><span class=\"mtk1\">[</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">].</span><span class=\"mtk11\">sub</span><span class=\"mtk1\">(</span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transfer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">emit</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Withdraw</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>To withdraw ETH, it uses <code>transfer()</code>, this transaction will fail inevitably when:</p>\n<ol>\n<li>The withdrawer smart contract does not implement a payable function.</li>\n<li>Withdrawer smart contract does implement a payable fallback which uses more than 2300 gas unit.</li>\n<li>The withdrawer smart contract implements a payable fallback function that needs less than 2300 gas units but is called through proxy, raising the callâ€™s gas usage above 2300.</li>\n</ol>\n<p>Recommend using <code>call()</code> to send ETH.</p>\n<h1 id=\"low-risk-findings\" style=\"position:relative;\"><a href=\"#low-risk-findings\" aria-label=\"low risk findings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk Findings</h1>\n<h2 id=\"l-00-atypical-contract-structure-affects-maintainability-and-readability\" style=\"position:relative;\"><a href=\"#l-00-atypical-contract-structure-affects-maintainability-and-readability\" aria-label=\"l 00 atypical contract structure affects maintainability and readability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/23\">[L-00] Atypical contract structure affects maintainability and readability</a></h2>\n<p>A typical/recommended contract structure has the variable declarations followed by events instead of the other way around. This affects readability/maintainability and may introduce/persist security issues.</p>\n<p>Recommend considering restructuring the contract to place the variable declarations before events.</p>\n<h2 id=\"l-01-mint-can-be-front-run\" style=\"position:relative;\"><a href=\"#l-01-mint-can-be-front-run\" aria-label=\"l 01 mint can be front run permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/20\">[L-01] Mint can be front-run</a></h2>\n<p>The price of an NFT falls over time which creates a dynamic that one potential buyer wants to wait for the price to drop but not wait too long to avoid hitting the max sale cap.</p>\n<p>However, any such <code>mint</code> call can be observed on public blockchains, and attackers can wait until another person decides to buy at the current price and then frontrun that person.</p>\n<p>Legitimate minters can be frontrun and end up with a failed transaction and without the NFT as the max sale limit is reached: <code>require(numSales &#x3C; SALE_LIMIT, \"Sale limit reached.\");</code>.</p>\n<p>Front-running is hard to prevent; maybe an auction-style minting process could work where the top <code>SALE_LIMIT</code> bids are accepted after the sale duration.</p>\n<h2 id=\"l-01-missing-parameters-in-salesbegin-event-of-critical-startsale-function\" style=\"position:relative;\"><a href=\"#l-01-missing-parameters-in-salesbegin-event-of-critical-startsale-function\" aria-label=\"l 01 missing parameters in salesbegin event of critical startsale function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/37\">[L-01] Missing parameters in <code>SalesBegin</code> event of critical <code>startSale()</code> function</a></h2>\n<p>Consider including <code>salesStartTime</code> and <code>salesDuration</code> as parameters in the <code>SaleBegins</code> event to allow off-chain tools to track sale launch time and duration, especially given that sale price depends on the time elapsed in the sale.</p>\n<p>Recommend adding <code>salesStartTime</code> and <code>salesDuration</code> as parameters in the <code>SaleBegins</code> event of <code>startSale()</code> function.</p>\n<h2 id=\"l-02-incorrect-implementation\" style=\"position:relative;\"><a href=\"#l-02-incorrect-implementation\" aria-label=\"l 02 incorrect implementation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/16\">[L-02] Incorrect Implementation</a></h2>\n<p>The <code>tokenByIndex</code> function appears not to perform correctly as it simply checks its input argument and returns it.</p>\n<p>It is recommended this function be adequately fleshed out or omitted from the codebase to avoid redundant bytecode.</p>\n<h2 id=\"l-03-missing-error-messages-in-require-statements-of-various-function\" style=\"position:relative;\"><a href=\"#l-03-missing-error-messages-in-require-statements-of-various-function\" aria-label=\"l 03 missing error messages in require statements of various function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/40\">[L-03] Missing error messages in require statements of various function</a></h2>\n<p>The use of informative error messages helps troubleshoot exceptional conditions during transaction failures or unexpected behavior. Otherwise, it can be misleading and waste crucial time during exploits or emergency conditions.</p>\n<p>While many require statements have descriptive error messages, some are missing them.</p>\n<p>For reference, see Note 2 in <a href=\"https://blog.openzeppelin.com/compound-governor-bravo-audit/\">OpenZeppelinâ€™s Audit of Compound Governor Bravo</a>.</p>\n<p>Recommend using meaningful error messages which specifically describe the conditional failure in all require statements.</p>\n<h2 id=\"l-04-missing-event-in-critical-devmint-function\" style=\"position:relative;\"><a href=\"#l-04-missing-event-in-critical-devmint-function\" aria-label=\"l 04 missing event in critical devmint function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/42\">[L-04] Missing event in critical <code>devMint()</code> function</a></h2>\n<p>The dev/deployer is allowed to mint an unlimited quantity of NFTs without paying arbitrary recipients. This reduces the token balance and affects token availability for other sale participants, and therefore is significant enough to warrant its own event.</p>\n<p>Recommend adding an event for <code>devMint</code> and emit at the end of <code>devMint()</code> function.</p>\n<h2 id=\"l-05-safemath-library-asserts-instead-of-reverts\" style=\"position:relative;\"><a href=\"#l-05-safemath-library-asserts-instead-of-reverts\" aria-label=\"l 05 safemath library asserts instead of reverts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/17\">[L-05] SafeMath library asserts instead of reverts</a></h2>\n<p>The implementation of SafeMath performs an <code>assert</code> instead of a <code>revert</code> on failure. An <code>assert</code> will consume all the transaction gas, whereas a <code>revert</code>/<code>require</code> releases the remaining gas to the transaction sender again. Usually, one wants to try to keep the gas cost for contract failures low and use <code>assert</code> only for invariants that should always be true.</p>\n<p>Recommend using <code>require</code> instead of <code>assert</code>.</p>\n<h1 id=\"gas-optimizations\" style=\"position:relative;\"><a href=\"#gas-optimizations\" aria-label=\"gas optimizations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations</h1>\n<h2 id=\"g-00-explicit-initialization-with-zero-not-required-for-numtokens\" style=\"position:relative;\"><a href=\"#g-00-explicit-initialization-with-zero-not-required-for-numtokens\" aria-label=\"g 00 explicit initialization with zero not required for numtokens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/26\">[G-00] Explicit initialization with zero not required for <code>numTokens</code></a></h2>\n<p>Explicit initialization with zero is not required for variable declaration of <code>numTokens</code> because uints are 0 by default. Removing this will reduce contract size and save a bit of gas.</p>\n<p>Recommend removing explicit initialization with zero.</p>\n<h2 id=\"g-01-numerous-gas-optimizations\" style=\"position:relative;\"><a href=\"#g-01-numerous-gas-optimizations\" aria-label=\"g 01 numerous gas optimizations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/15\">[G-01] Numerous Gas Optimizations</a></h2>\n<p>This finding is dedicated to the numerous gas optimizations that can be applied across the codebase.</p>\n<ul>\n<li>The <code>tradeValid</code>, <code>cancelOffer</code>, and <code>acceptTrade</code> functions should have their <code>memory</code> arrays declared as <code>calldata</code>, significantly reducing the gas costs of the functions.</li>\n<li>The <code>require</code> statements of L629 and L650 are redundant as the usage of <code>SafeMath</code> inherently guarantees them.</li>\n<li>The <code>deployer</code>, <code>beta</code>, <code>alpha</code>, and <code>beneficiary</code> variables can all be declared as <code>immutable</code> since they are assigned only once during the contractâ€™s <code>constructor</code>.</li>\n<li>The <code>SafeMath</code> statements of L333, L337, L349, and L385 are redundant as they are guaranteed to be safe due to surrounding <code>require</code> and <code>if</code> clauses.</li>\n<li>The <code>abi.encodePacked</code> invocations of L539 and L541 are redundant given that the elements of the arrays cannot be tight packed since they each occupy a full 256-bit slot.</li>\n</ul>\n<h2 id=\"g-02-state-variables-that-could-be-declared-constant\" style=\"position:relative;\"><a href=\"#g-02-state-variables-that-could-be-declared-constant\" aria-label=\"g 02 state variables that could be declared constant permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/3\">[G-02] state variables that could be declared constant</a></h2>\n<p>These state variables can be declared constants to save the gas: <code>nftName</code> and <code>nftSymbol</code>.</p>\n<h2 id=\"g-03-public-function-that-could-be-declared-external\" style=\"position:relative;\"><a href=\"#g-03-public-function-that-could-be-declared-external\" aria-label=\"g 03 public function that could be declared external permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/5\">[G-03] public function that could be declared external</a></h2>\n<p>public function that could be declared external to save gas</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">1.</span><span class=\"mtk11\">totalSupply</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">2.</span><span class=\"mtk11\">tokenByIndex</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">3.</span><span class=\"mtk11\">hashToSign</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\">,</span><span class=\"mtk12\">address</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[],</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[],</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">,</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h2 id=\"g-04-optimizations-storage\" style=\"position:relative;\"><a href=\"#g-04-optimizations-storage\" aria-label=\"g 04 optimizations storage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/83\">[G-04] Optimizations storage</a></h2>\n<p>Suggestions provided <a href=\"https://gist.github.com/alexon1234/126320751f7a108e9aaf74c8d147d7df\">here</a>.</p>\n<h2 id=\"g-05-creatornftmints-is-assigned-only-0-or-1\" style=\"position:relative;\"><a href=\"#g-05-creatornftmints-is-assigned-only-0-or-1\" aria-label=\"g 05 creatornftmints is assigned only 0 or 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/68\">[G-05] <code>creatorNftMints</code> is assigned only 0 or 1</a></h2>\n<p>It is unclear why this mapping points to uint: <code>mapping (uint256 => uint256) public creatorNftMints;</code> the only values it could get is either 0 or 1, so a boolean type might be more suitable here.</p>\n<p>Recommend using true/false values if the intention was that 0 means false and 1 means true:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">mapping</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">boolean</span><span class=\"mtk1\">) </span><span class=\"mtk12\">public</span><span class=\"mtk1\"> </span><span class=\"mtk12\">creatorNftMints</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<h2 id=\"g-06-require-not-needed\" style=\"position:relative;\"><a href=\"#g-06-require-not-needed\" aria-label=\"g 06 require not needed permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/67\">[G-06] <code>Require()</code> not needed</a></h2>\n<p>On line 650, <code>require(amount &#x3C;= ethBalance[msg.sender]);</code> is not needed because itâ€™s implicitly checked when making the subtraction in the following line.</p>\n<p>Recommend removing the <code>require()</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/67#issuecomment-847430433\">dangerousfood (Meebits) commented</a>:</strong></p>\n<blockquote>\n<p>Fantastic catch imo.</p>\n</blockquote>\n<h2 id=\"g-07-pausemarket-can-be-optimized\" style=\"position:relative;\"><a href=\"#g-07-pausemarket-can-be-optimized\" aria-label=\"g 07 pausemarket can be optimized permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-04-meebits-findings/issues/69\">[G-07] <code>PauseMarket()</code> can be optimized</a></h2>\n<p>The function <code>pauseMarket()</code> on line 230 can be optimized.</p>\n<p>Recommend not using an argument and set <code>marketPaused = !marketPaused</code>.</p>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li>\n<p><a href=\"#high-risk-findings\">High Risk Findings</a></p>\n<ul>\n<li><a href=\"#h-00-erc-721-enumerable-spec-mismatch-for-index-of-tokenbyindex-function\">[H-00] ERC-721 Enumerable Spec mismatch for index of <code>tokenByIndex()</code> function</a></li>\n<li><a href=\"#h-01-signature-malleability-of-evms-ecrecover-in-verify\">[H-01] Signature malleability of EVMâ€™s <code>ecrecover</code> in <code>verify()</code></a></li>\n<li><a href=\"#h-02-arbitrary-transfer-of-unowned-nfts\">[H-02] Arbitrary Transfer of Unowned NFTs</a></li>\n<li><a href=\"#h-03-beebotstradevalid-will-erroneously-return-true-when-maker-is-set-to-address0-and-makerids-are-set-to-the-tokenids-of-unminted-beebot-nfts\">[H-03] <code>Beebots.TradeValid()</code> Will Erroneously Return True When Maker Is Set To <code>Address(0)</code> and <code>makerIds</code> Are Set To The <code>TokenIds</code> of Unminted Beebot NFTs</a></li>\n<li><a href=\"#h-04-function-tokenbyindex-treats-last-index-as-invalid\">[H-04] function <code>tokenByIndex</code> treats last index as invalid</a></li>\n<li><a href=\"#h-05-nft-can-be-minted-for-free-after-sale-ended\">[H-05] NFT can be minted for free after sale ended</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#medium-risk-findings\">Medium Risk Findings</a></p>\n<ul>\n<li><a href=\"#m-00-legacy-function-usage\">[M-00] Legacy Function Usage</a></li>\n<li><a href=\"#m-01-randomindex-is-not-truly-random---possibility-of-predictably-minting-a-specific-token-id\">[M-01] <code>randomIndex</code> is not truly random - possibility of predictably minting a specific token Id</a></li>\n<li><a href=\"#m-02-instead-of-call--transfer-is-used-to-withdraw-the-ether\">[M-02] instead of <code>call()</code> , <code>transfer()</code> is used to withdraw the ether</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#low-risk-findings\">Low Risk Findings</a></p>\n<ul>\n<li><a href=\"#l-00-atypical-contract-structure-affects-maintainability-and-readability\">[L-00] Atypical contract structure affects maintainability and readability</a></li>\n<li><a href=\"#l-01-mint-can-be-front-run\">[L-01] Mint can be front-run</a></li>\n<li><a href=\"#l-01-missing-parameters-in-salesbegin-event-of-critical-startsale-function\">[L-01] Missing parameters in <code>SalesBegin</code> event of critical <code>startSale()</code> function</a></li>\n<li><a href=\"#l-02-incorrect-implementation\">[L-02] Incorrect Implementation</a></li>\n<li><a href=\"#l-03-missing-error-messages-in-require-statements-of-various-function\">[L-03] Missing error messages in require statements of various function</a></li>\n<li><a href=\"#l-04-missing-event-in-critical-devmint-function\">[L-04] Missing event in critical <code>devMint()</code> function</a></li>\n<li><a href=\"#l-05-safemath-library-asserts-instead-of-reverts\">[L-05] SafeMath library asserts instead of reverts</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#gas-optimizations\">Gas Optimizations</a></p>\n<ul>\n<li><a href=\"#g-00-explicit-initialization-with-zero-not-required-for-numtokens\">[G-00] Explicit initialization with zero not required for <code>numTokens</code></a></li>\n<li><a href=\"#g-01-numerous-gas-optimizations\">[G-01] Numerous Gas Optimizations</a></li>\n<li><a href=\"#g-02-state-variables-that-could-be-declared-constant\">[G-02] state variables that could be declared constant</a></li>\n<li><a href=\"#g-03-public-function-that-could-be-declared-external\">[G-03] public function that could be declared external</a></li>\n<li><a href=\"#g-04-optimizations-storage\">[G-04] Optimizations storage</a></li>\n<li><a href=\"#g-05-creatornftmints-is-assigned-only-0-or-1\">[G-05] <code>creatorNftMints</code> is assigned only 0 or 1</a></li>\n<li><a href=\"#g-06-require-not-needed\">[G-06] <code>Require()</code> not needed</a></li>\n<li><a href=\"#g-07-pausemarket-can-be-optimized\">[G-07] <code>PauseMarket()</code> can be optimized</a></li>\n</ul>\n</li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>",
  "md": "\n# Overview\n\n## About C4\n\nCode 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.\n\nA C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\n\nDuring the code contest outlined in this document, C4 conducted an analysis of Larva Labs' Meebits smart contract system written in Solidity. The code contest took place between April 29 and May 1, 2021.\n\n## Wardens\n\n9 Wardens contributed reports to the Meebits code contest:\n\n- [0xRajeev](https://twitter.com/0xRajeev)\n- [0xsomeone](https://github.com/alex-ppg)\n- [Thunder](https://twitter.com/SolidityDev)\n- [s1m0](https://twitter.com/_smonica_)\n- [jvaqa](https://twitter.com/jvaqa)\n- [Jmukesh](https://twitter.com/MukeshJ_eth)\n- [GalloDaSballo](https://twitter.com/gallodasballo)\n- [cmichel](https://twitter.com/cmichelio)\n- [gpersoon](https://twitter.com/gpersoon)\n\nThis contest was judged by [Joseph Delong](https://twitter.com/josephdelong).\n\nFinal report assembled by [ninek](https://twitter.com/_ninek_) and [moneylegobatman](https://twitter.com/money_lego).\n\n# Summary\n\nThe C4 analysis yielded an aggregated total of 15 unique vulnerabilities. All of the issues presented here are linked back to their original finding.\n\nOf these vulnerabilities, 6 received a risk rating in the category of HIGH severity, 3 received a risk rating in the category of MEDIUM severity, and 6 received a risk rating in the category of LOW severity.\n\nC4 analysis also identified 8 non-critical recommendations.\n\n# Scope\n\nThe code under review can be found within the [C4 code contest repository](https://github.com/code-423n4/2021-04-meebits) and comprises 1 smart contract written in the Solidity programming language.\n\n# Severity Criteria\n\nC4 assesses the severity of disclosed vulnerabilities according to a methodology based on [OWASP standards](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).\n\nVulnerabilities are divided into three primary risk categories: high, medium, and low.\n\nHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\n\n- Malicious Input Handling\n- Escalation of privileges\n- Arithmetic\n- Gas use\n\nFurther information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on [the C4 website](https://code423n4.com).\n\n# High Risk Findings\n## [[H-00] ERC-721 Enumerable Spec mismatch for index of `tokenByIndex()` function](https://github.com/code-423n4/2021-04-meebits-findings/issues/47)\n\nIndex starts at 0 for token array, but the implementation here requires index to be greater than 0. This will prevent querying of tokens at index 0.\n\nSee [reference implementation](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/3ba2a1354f8f830d5a0e711537efdbdd8bcb109e/contracts/token/ERC721/extensions/ERC721Enumerable.sol#L21).\n\nThis will impact compatibility with NFT platforms that expect full conformity with ERC-721 specification.\n\nRecommend accepting 0 index by changing to `require(index >= 0 && index < TOKEN_LIMIT);`.\n\n**[dangerousfood (Meebits) commented](https://github.com/code-423n4/2021-04-meebits-findings/issues/47#issuecomment-847429104):**\n> Beebots indexes by 1 for whatever reason\n\n## [[H-01] Signature malleability of EVM's `ecrecover` in `verify()`](https://github.com/code-423n4/2021-04-meebits-findings/issues/54)\n\nEVM's `ecrecover` is susceptible to signature malleability, which allows replay attacks, but that is mitigated here by tracking accepted offers and canceling them (on L645) specifically to prevent replays. However, if any application logic changes, it might make signature malleability a risk for replay attacks.\n\nSee [reference](https://swcregistry.io/docs/SWC-117).\n\nRecommend using [OpenZeppelin's ECDSA library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol)\n\n## [[H-02] Arbitrary Transfer of Unowned NFTs](https://github.com/code-423n4/2021-04-meebits-findings/issues/4)\n\nDue to how the market functions are structured, it is possible to arbitrarily transfer any NFT that is not owned by any address.\n\nThe function in question is the `tradeValid` function invoked by `acceptTrade` before the trade is performed. It, in turn, validates the signature of a trade via `verify`, which does not account for the behavior of `ecrecover`.\n\nWhen `ecrecover` is invoked with an invalid signature, the zero-address is returned by it, meaning that `verify` will yield `true` for the zero-address as long as the signature provided is invalid.\n\nThis can be exploited to transfer any NFT whose `idToOwner` is zero, including NFTs that have not been minted yet.\n\nRecommend an additional check be imposed within `verify` that ensures the signer is not the zero-address which will alleviate this check. For more details, consult the [EIP721 implementation by OpenZeppelin](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v3.4.0/contracts/cryptography/ECDSA.sol#L53-L71).\n\n## [[H-03] `Beebots.TradeValid()` Will Erroneously Return True When Maker Is Set To `Address(0)` and `makerIds` Are Set To The `TokenIds` of Unminted Beebot NFTs](https://github.com/code-423n4/2021-04-meebits-findings/issues/77)\n\n`Beebots.TradeValid()` will erroneously return true when `maker` is set to `address(0)` and `makerIds` are set to the `tokenIds` of unminted beebot NFTs.\n\n`Beebots.verify()` returns true no matter what signature is given when signer is set to `address(0)`. This means that `BeeBots.tradeValid()` will erroneously return true when `maker` is set to `address(0)`.\n\nFinally, before an NFT has even been minted at all, it is assumed to have an owner of `address(0)` due to the `idToOwner` mapping being initialized to zero for all uninitialized slots, so an attacker can call `tradeValid()` with `maker` set to `address(0)` and `makerIds` set to the `tokenIds` of any unminted `nftIds`, and `tradeValid()` will erroneously return true.\n\n* (1) `Beebots.verify()` returns true no matter what signature is given when signer is set to `address(0)`.\n  * (1a) `BeeBots.verify()` does not check to ensure that signer is not `address(0)`.\n  * (1b) This is a problem because `ecrecover` fails silently if the signature does not match and returns zero.\n  * (1c) So if an attacker passes in `address(0)` as the signer, then verify will return true no matter what signature is provided, since `ecrecover` will return `address(0)`, and the signer is `address(0)`, so verify will pass.\n  * (1d) This means that `BeeBots.tradeValid()` will erroneously return true when maker is set to `address(0)`.\n* (2) Before an NFT has even been minted at all, it is assumed to have an owner of `address(0)` due to the `idToOwner` mapping being initialized to zero for all uninitialized slots\n  * (2a) Solidity initializes all mappings to 0 for all slots that have not yet been set.\n  * (2b) So for any NFT ID that has not yet been minted, the corresponding owner in the mapping `BeeBots.idToOwner` is `address(0)`, even though that NFT should not even exist.\n  * (2c) This means that an attacker can call `tradeValid()` with maker set to `address(0)` and makerIds set to any unminted nftIds, and `tradeValid()` will erroneously return true.\n\n(1) Recommend adding this check to `Beebots.verify()`:\n```require(signer != address(0), \"Cannot verify signatures from 0x0\");```\n\n(2) Recommend adding this check to `Beebots.tradeValid()`:\n```require(maker != address(0), \"Maker 0x0 not allowed\");```\n\n**[dangerousfood (Meebits) commented](https://github.com/code-423n4/2021-04-meebits-findings/issues/77#issuecomment-847413820):**\n> Wow, this exploit is absolutely stunning.\n\n## [[H-04] function `tokenByIndex` treats last index as invalid](https://github.com/code-423n4/2021-04-meebits-findings/issues/73)\n\nNFT indexes start from 0:\n```solidity\n// Don't allow a zero index, start counting at 1\nreturn value.add(1);\n```\nSo if there are 30 tokens, indexes would be 1-30. However, function `tokenByIndex` sets such boundaries:\n```solidity\nrequire(index > 0 && index < TOKEN_LIMIT);\n```\nThis means that the last token (with index 30 in this case) will not be valid.\n\nRecommend using:\n```solidity\nrequire(index > 0 && index <= TOKEN_LIMIT);\n```\n\n**[dangerousfood (Meebits) commented](https://github.com/code-423n4/2021-04-meebits-findings/issues/73#issuecomment-847429563):**\n> Beebots is indexing by 1\n\n## [[H-05] NFT can be minted for free after sale ended](https://github.com/code-423n4/2021-04-meebits-findings/issues/75)\n\nThe `getPrice()` function returned 0 after the sale ended and (```SALE_LIMIT - numSales```) NFT can be minted for free.\n\nWithout documentation, it's not clear if this is the expected behavior or not. If it's unexpected, it is recommended to revert instead of returning 0. If it's expected behavior, it's possible to create a smart contract and claim all the remaining NFT front-running the regular users.\n\n# Medium Risk Findings\n## [[M-00] Legacy Function Usage](https://github.com/code-423n4/2021-04-meebits-findings/issues/14)\n\nThe `withdraw` function utilizes the `transfer` invocation, which has a fixed gas stipend and can fail, especially beyond the Berlin fork, which increased the [gas costs](https://eips.ethereum.org/EIPS/eip-2929) for first-time invocations of a transfer.\n\nThe EIP should be sufficient.\n\nRecommend using a safe wrapper library, such as the OpenZeppelin `Address` library's `sendValue` function, which forwards sufficient gas for the transfer regardless of the underlying OPCODE gas costs.\n\n## [[M-01] `randomIndex` is not truly random - possibility of predictably minting a specific token Id](https://github.com/code-423n4/2021-04-meebits-findings/issues/30)\n\n`randomIndex' is not random. Any miner has access to these values:\n\n```solidity\nuint index = uint(keccak256(abi.encodePacked(nonce, msg.sender, block.difficulty, block.timestamp))) % totalSize;\n```\n\nNon-miner attackers could also test the minting random condition until they get the ID they are looking to access.\n\nThe internal variable [`indices`](https://github.com/code-423n4/2021-04-meebits/blob/2ec4ce8e98374be2048126485ad8ddacc2d36d2f/Beebots.sol#L158) seems to be used to avoid this type of collision.\n\nWhile this makes it less straightforward, there is still the possibility of minting a token with a specific ID.\n\nThat said, [`_addNFToken`](https://github.com/code-423n4/2021-04-meebits/blob/2ec4ce8e98374be2048126485ad8ddacc2d36d2f/Beebots.sol#L408) is checking if the token is already owned by an address, ensuring a token can't be stolen.\n\nRefactoring as suggested below will save gas, make code easier to read and prevent reverts in rare unfortunate occasions of clashes.\n\nRecommend not generating random IDs and instead using counters. It makes the code more predictable and easier to read, avoids clashing of IDs, and reduces the need to track minted tokens.\n\n## [[M-02] instead of `call()` , `transfer()` is used to withdraw the ether](https://github.com/code-423n4/2021-04-meebits-findings/issues/2)\n\n```solidity\nfunction withdraw(uint amount) external {\n  require(amount <= ethBalance[msg.sender]);\n  ethBalance[msg.sender] = ethBalance[msg.sender].sub(amount);\n  msg.sender.transfer(amount);\n  emit Withdraw(msg.sender, amount);\n}\n```\n\nTo withdraw ETH, it uses `transfer()`, this transaction will fail inevitably when:\n\n1. The withdrawer smart contract does not implement a payable function.\n2. Withdrawer smart contract does implement a payable fallback which uses more than 2300 gas unit.\n3. The withdrawer smart contract implements a payable fallback function that needs less than 2300 gas units but is called through proxy, raising the call's gas usage above 2300.\n\nRecommend using `call()` to send ETH.\n\n# Low Risk Findings\n## [[L-00] Atypical contract structure affects maintainability and readability](https://github.com/code-423n4/2021-04-meebits-findings/issues/23)\n\nA typical/recommended contract structure has the variable declarations followed by events instead of the other way around. This affects readability/maintainability and may introduce/persist security issues.\n\nRecommend considering restructuring the contract to place the variable declarations before events.\n\n## [[L-01] Mint can be front-run](https://github.com/code-423n4/2021-04-meebits-findings/issues/20)\n\nThe price of an NFT falls over time which creates a dynamic that one potential buyer wants to wait for the price to drop but not wait too long to avoid hitting the max sale cap.\n\nHowever, any such `mint` call can be observed on public blockchains, and attackers can wait until another person decides to buy at the current price and then frontrun that person.\n\nLegitimate minters can be frontrun and end up with a failed transaction and without the NFT as the max sale limit is reached: `require(numSales < SALE_LIMIT, \"Sale limit reached.\");`.\n\nFront-running is hard to prevent; maybe an auction-style minting process could work where the top `SALE_LIMIT` bids are accepted after the sale duration.\n\n## [[L-01] Missing parameters in `SalesBegin` event of critical `startSale()` function](https://github.com/code-423n4/2021-04-meebits-findings/issues/37)\n\nConsider including `salesStartTime` and `salesDuration` as parameters in the `SaleBegins` event to allow off-chain tools to track sale launch time and duration, especially given that sale price depends on the time elapsed in the sale.\n\nRecommend adding `salesStartTime` and `salesDuration` as parameters in the `SaleBegins` event of `startSale()` function.\n\n## [[L-02] Incorrect Implementation](https://github.com/code-423n4/2021-04-meebits-findings/issues/16)\n\nThe `tokenByIndex` function appears not to perform correctly as it simply checks its input argument and returns it.\n\nIt is recommended this function be adequately fleshed out or omitted from the codebase to avoid redundant bytecode.\n\n## [[L-03] Missing error messages in require statements of various function](https://github.com/code-423n4/2021-04-meebits-findings/issues/40)\n\nThe use of informative error messages helps troubleshoot exceptional conditions during transaction failures or unexpected behavior. Otherwise, it can be misleading and waste crucial time during exploits or emergency conditions.\n\nWhile many require statements have descriptive error messages, some are missing them.\n\nFor reference, see Note 2 in [OpenZeppelin's Audit of Compound Governor Bravo](https://blog.openzeppelin.com/compound-governor-bravo-audit/).\n\nRecommend using meaningful error messages which specifically describe the conditional failure in all require statements.\n\n## [[L-04] Missing event in critical `devMint()` function](https://github.com/code-423n4/2021-04-meebits-findings/issues/42)\n\nThe dev/deployer is allowed to mint an unlimited quantity of NFTs without paying arbitrary recipients. This reduces the token balance and affects token availability for other sale participants, and therefore is significant enough to warrant its own event.\n\nRecommend adding an event for `devMint` and emit at the end of `devMint()` function.\n\n## [[L-05] SafeMath library asserts instead of reverts](https://github.com/code-423n4/2021-04-meebits-findings/issues/17)\n\nThe implementation of SafeMath performs an `assert` instead of a `revert` on failure. An `assert` will consume all the transaction gas, whereas a `revert`/`require` releases the remaining gas to the transaction sender again. Usually, one wants to try to keep the gas cost for contract failures low and use `assert` only for invariants that should always be true.\n\nRecommend using `require` instead of `assert`.\n\n# Gas Optimizations\n## [[G-00] Explicit initialization with zero not required for `numTokens`](https://github.com/code-423n4/2021-04-meebits-findings/issues/26)\n\nExplicit initialization with zero is not required for variable declaration of `numTokens` because uints are 0 by default. Removing this will reduce contract size and save a bit of gas.\n\nRecommend removing explicit initialization with zero.\n\n## [[G-01] Numerous Gas Optimizations](https://github.com/code-423n4/2021-04-meebits-findings/issues/15)\n\nThis finding is dedicated to the numerous gas optimizations that can be applied across the codebase.\n\n- The `tradeValid`, `cancelOffer`, and `acceptTrade` functions should have their `memory` arrays declared as `calldata`, significantly reducing the gas costs of the functions.\n- The `require` statements of L629 and L650 are redundant as the usage of `SafeMath` inherently guarantees them.\n- The `deployer`, `beta`, `alpha`, and `beneficiary` variables can all be declared as `immutable` since they are assigned only once during the contract's `constructor`.\n- The `SafeMath` statements of L333, L337, L349, and L385 are redundant as they are guaranteed to be safe due to surrounding `require` and `if` clauses.\n- The `abi.encodePacked` invocations of L539 and L541 are redundant given that the elements of the arrays cannot be tight packed since they each occupy a full 256-bit slot.\n\n\n## [[G-02] state variables that could be declared constant](https://github.com/code-423n4/2021-04-meebits-findings/issues/3)\n\nThese state variables can be declared constants to save the gas: `nftName` and `nftSymbol`.\n\n## [[G-03] public function that could be declared external](https://github.com/code-423n4/2021-04-meebits-findings/issues/5)\n\npublic function that could be declared external to save gas\n```solidity\n1.totalSupply()\n2.tokenByIndex(uint256)\n3.hashToSign(address,address,uint256,uint256[],uint256,uint256[],uint256,uint256)\n```\n## [[G-04] Optimizations storage](https://github.com/code-423n4/2021-04-meebits-findings/issues/83)\n\nSuggestions provided [here](https://gist.github.com/alexon1234/126320751f7a108e9aaf74c8d147d7df).\n\n## [[G-05] `creatorNftMints` is assigned only 0 or 1](https://github.com/code-423n4/2021-04-meebits-findings/issues/68)\n\nIt is unclear why this mapping points to uint: ```mapping (uint256 => uint256) public creatorNftMints; ``` the only values it could get is either 0 or 1, so a boolean type might be more suitable here.\n\nRecommend using true/false values if the intention was that 0 means false and 1 means true:\n```solidity\nmapping (uint256 => boolean) public creatorNftMints;\n```\n\n## [[G-06] `Require()` not needed](https://github.com/code-423n4/2021-04-meebits-findings/issues/67)\n\nOn line 650, `require(amount <= ethBalance[msg.sender]);` is not needed because it's implicitly checked when making the subtraction in the following line.\n\nRecommend removing the `require()`.\n\n**[dangerousfood (Meebits) commented](https://github.com/code-423n4/2021-04-meebits-findings/issues/67#issuecomment-847430433):**\n> Fantastic catch imo.\n\n## [[G-07] `PauseMarket()` can be optimized](https://github.com/code-423n4/2021-04-meebits-findings/issues/69)\n\nThe function `pauseMarket()` on line 230 can be optimized.\n\nRecommend not using an argument and set ```marketPaused = !marketPaused```.\n\n# Disclosures\n\nC4 is an open organization governed by participants in the community.\n\nC4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\n\nC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\n"
}