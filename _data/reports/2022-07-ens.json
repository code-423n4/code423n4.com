{
  "circa": {
    "title": "ENS contest",
    "sponsor": "ENS",
    "slug": "2022-07-ens",
    "date": "2022-12-13",
    "findings": "https://github.com/code-423n4/2022-07-ens-findings/issues",
    "contest": 145
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code4rena (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 audit contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the audit contest outlined in this document, C4 conducted an analysis of the ENS smart contract system written in Solidity. The audit contest took place between July 12—July 19 2022.</p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>107 Wardens contributed reports to the ENS contest:</p>\n<ol>\n<li>PwnedNoMore (<a href=\"https://www.cs.purdue.edu/homes/zhan3299/index.html\">izhuer</a>, ItsNio, papr1ka2, and <a href=\"https://twitter.com/0xtarafans\">wen</a>)</li>\n<li>zzzitron</li>\n<li><a href=\"https://www.linkedin.com/in/pavel-anokhin/\">panprog</a></li>\n<li>GimelSec (<a href=\"https://twitter.com/rayn731\">rayn</a> and sces60107)</li>\n<li>0x52</li>\n<li>alan724</li>\n<li><a href=\"https://twitter.com/csanuragjain\">csanuragjain</a></li>\n<li>0x1f8b</li>\n<li><a href=\"https://twitter.com/WahWaste\">wastewa</a></li>\n<li>Aussie_Battlers (<a href=\"http://seanseefried.org/blog\">sseefried</a> and <a href=\"https://twitter.com/andyfeili\">oyc_109</a>)</li>\n<li>brgltd</li>\n<li>cryptphi</li>\n<li>peritoflores</li>\n<li>cccz</li>\n<li>Lambda</li>\n<li>IllIllI</li>\n<li><a href=\"https://twitter.com/BowTiedDravee\">Dravee</a></li>\n<li><a href=\"https://twitter.com/bin2chen\">bin2chen</a></li>\n<li>0x29A (0x4non and rotcivegaf)</li>\n<li>Limbooo</li>\n<li>ronnyx2017</li>\n<li><a href=\"https://twitter.com/JoeStakey\">joestakey</a></li>\n<li>rbserver</li>\n<li><a href=\"https://github.com/0xKitsune\">0xKitsune</a></li>\n<li><a href=\"https://benbaessler.com\">benbaessler</a></li>\n<li><a href=\"https://twitter.com/Sm4rty_\">Sm4rty</a></li>\n<li><a href=\"https://twitter.com/berndartmueller\">berndartmueller</a></li>\n<li>Bnke0x0</li>\n<li><a href=\"https://twitter.com/Deivitto\">Deivitto</a></li>\n<li>RedOneN</li>\n<li>CRYP70</li>\n<li><a href=\"https://www.linkedin.com/in/georgi-nikolaev-georgiev-978253219\">gogo</a></li>\n<li>Amithuddar</li>\n<li>hake</li>\n<li><a href=\"https://mobile.twitter.com/tomj_bb\">TomJ</a></li>\n<li><a href=\"https://milotruck.github.io/\">MiloTruck</a></li>\n<li>Rolezn</li>\n<li><a href=\"https://twitter.com/c3ph_\">c3phas</a></li>\n<li><a href=\"https://twitter.com/0xruhum\">Ruhum</a></li>\n<li><a href=\"https://twitter.com/0xch301\">Ch_301</a></li>\n<li>_Adam</li>\n<li><a href=\"https://twitter.com/0xhyh\">hyh</a></li>\n<li>__141345__</li>\n<li>asutorufos</li>\n<li><a href=\"https://twitter.com/father0fBl0cks\">fatherOfBlocks</a></li>\n<li>0xNineDec</li>\n<li><a href=\"https://twitter.com/rajat_beladiya\">rajatbeladiya</a></li>\n<li><a href=\"https://twitter.com/0xNazgul\">0xNazgul</a></li>\n<li>robee</li>\n<li>sashik_eth</li>\n<li><a href=\"https://instagram.com/vanensurya\">Funen</a></li>\n<li>kyteg</li>\n<li>Waze</li>\n<li><a href=\"https://twitter.com/sm4rtcontr4ct\">JC</a></li>\n<li>JohnSmith</li>\n<li><a href=\"https://twitter.com/ROHANJH56009256\">Rohan16</a></li>\n<li>bulej93</li>\n<li>cRat1st0s</li>\n<li><a href=\"twitter.com/rokinot\">rokinot</a></li>\n<li>delfin454000</li>\n<li><a href=\"https://twitter.com/8olidity\">8olidity</a></li>\n<li>sach1r0</li>\n<li>ReyAdmirado</li>\n<li>zuhaibmohd</li>\n<li>lcfr_eth</li>\n<li>simon135</li>\n<li><a href=\"https://twitter.com/seynixyz\">seyni</a></li>\n<li>cryptonue</li>\n<li><a href=\"https://twitter.com/ElKu_crypto\">ElKu</a></li>\n<li>dxdv</li>\n<li>pashov</li>\n<li>0xf15ers (remora and twojoy)</li>\n<li>p_crypt0</li>\n<li>Critical</li>\n<li>pedr02b2</li>\n<li><a href=\"https://twitter.com/real_philogy\">philogy</a></li>\n<li>0xDjango</li>\n<li>rishabh</li>\n<li><a href=\"https://twitter.com/svs_kaushik\">svskaushik</a></li>\n<li>RustyRabbit</li>\n<li>minhtrng</li>\n<li><a href=\"https://github.com/exd0tpy\">exd0tpy</a></li>\n<li><a href=\"https://t.me/Road220\">m_Rassska</a></li>\n<li><a href=\"https://github.com/lyciumlee\">durianSausage</a></li>\n<li>ajtra</li>\n<li><a href=\"https://twitter.com/meidhiwirara\">Tomio</a></li>\n<li>0x040</li>\n<li>0xsam</li>\n<li><a href=\"https://github.com/Aymen1001\">Aymen0909</a></li>\n<li><a href=\"https://twitter.com/fitraldys\">Fitraldys</a></li>\n<li>lucacez</li>\n<li>Noah3o6</li>\n<li>samruna</li>\n<li>arcoun</li>\n<li>karanctf</li>\n<li>sahar</li>\n<li>ak1</li>\n<li><a href=\"https://chom.dev\">Chom</a></li>\n<li>Jujic</li>\n<li>scaraven</li>\n</ol>\n<p>This contest was judged by <a href=\"https://twitter.com/lsdan_defi\">LSDan</a>.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/liveactionllama\">liveactionllama</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 16 unique vulnerabilities. Of these vulnerabilities, 3 received a risk rating in the category of HIGH severity and 13 received a risk rating in the category of MEDIUM severity.</p>\n<p>Additionally, C4 analysis included 71 reports detailing issues with a risk rating of LOW severity or non-critical. There were also 70 reports recommending gas optimizations.</p>\n<p>All of the issues presented here are linked back to their original finding.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2022-07-ens\">C4 ENS contest repository</a>, and is composed of 23 smart contracts written in the Solidity programming language and includes 2,132 lines of Solidity code.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low/non-critical.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code4rena.com\">the C4 website</a>.</p>\n<h1 id=\"high-risk-findings-3\" style=\"position:relative;\"><a href=\"#high-risk-findings-3\" aria-label=\"high risk findings 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>High Risk Findings (3)</h1>\n<h2 id=\"h-01-it-is-possible-to-create-fake-erc1155-namewrapper-token-for-subdomain-which-is-not-owned-by-namewrapper\" style=\"position:relative;\"><a href=\"#h-01-it-is-possible-to-create-fake-erc1155-namewrapper-token-for-subdomain-which-is-not-owned-by-namewrapper\" aria-label=\"h 01 it is possible to create fake erc1155 namewrapper token for subdomain which is not owned by namewrapper permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/84\">[H-01] It is possible to create fake ERC1155 <code>NameWrapper</code> token for subdomain, which is not owned by <code>NameWrapper</code></a></h2>\n<p><em>Submitted by panprog, also found by Aussie_Battlers, brgltd, cryptphi, peritoflores, and wastewa</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L820-L821\">NameWrapper.sol#L820-L821</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L524\">NameWrapper.sol#L524</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L572\">NameWrapper.sol#L572</a><br></p>\n<p>Due to re-entrancy possibility in <code>NameWrapper._transferAndBurnFuses</code> (called from <code>setSubnodeOwner</code> and <code>setSubnodeRecord</code>), it is possible to do some stuff in <code>onERC1155Received</code> right after transfer but before new owner and new fuses are set. This makes it possible, for example, to unwrap the subdomain, but owner and fuses will still be set even for unwrapped domain, creating fake <code>ERC1155</code> <code>NameWrapper</code> token for domain, which is not owned by <code>NameWrapper</code>.</p>\n<p>Fake token creation scenario:</p>\n<ol>\n<li><code>Account1</code> registers and wraps <code>test.eth</code> domain</li>\n<li><code>Account1</code> calls <code>NameWrapper.setSubnodeOwner</code> for <code>sub.test.eth</code> subdomain with <code>Account1</code> as owner (to make NameWrapper owner of subdomain)</li>\n<li><code>Contract1</code> smart contract is created, which calls unwrap in its <code>onERC1155Received</code> function, and a function to send <code>sub.test.eth</code> ERC1155 NameWrapper token back to <code>Account1</code></li>\n<li><code>Account1</code> calls <code>NameWrapper.setSubnodeOwner</code> for <code>sub.test.eth</code> with <code>Contract1</code> as new owner, which unwraps domain back to <code>Account1</code> but due to re-entrancy, NameWrapper sets fuses and ownership to <code>Contract1</code></li>\n<li><code>Account1</code> calls function to send ERC1155 token from <code>Contract1</code> back to self.</li>\n</ol>\n<p>After this sequence of events, <code>sub.test.eth</code> subdomain is owned by <code>Account1</code> both in <code>ENS</code> registry and in <code>NameWrapper</code> (with fuses and expiry correctly set to the future date). Lots (but not all) of functions in <code>NameWrapper</code> will fail to execute for this subdomain, because they expect <code>NameWrapper</code> to have ownership of the domain in <code>ENS</code>, but some functions will still work, making it possible to make the impression of good domain.</p>\n<p>At this point, ownership in <code>NameWrapper</code> is “detached” from ownership in <code>ENS</code> and <code>Account1</code> can do all kinds of malcious stuff with its ERC1155 token. For example:</p>\n<ol>\n<li>Sell subdomain to the other user, transfering <code>ERC1155</code> to that user and burning <code>PARENT_CANNOT_CONTROL</code> to create impression that he can’t control the domain. After receiving the payment, <code>Account1</code> can wrap the domain again, which burns existing ownership record and replaces with the new one with clear fuses and <code>Account1</code> ownership, effectively stealing domain back from unsuspecting user, who thought that <code>ERC1155</code> gives him the right to the domain (and didn’t expect that parent can clear fuses when <code>PARENT_CANNOT_CONTROL</code> is set).</li>\n<li>Transfer subdomain to some other smart contract, which implements <code>onERC1155Received</code>, then take it back, fooling smart contract into believing that it has received the domain.</li>\n</ol>\n<h3 id=\"proof-of-concept\" style=\"position:relative;\"><a href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Copy these to test/wrapper and run:<br>\nyarn test test/wrapper/NameWrapperReentrancy.js</p>\n<p><a href=\"https://gist.github.com/panprog/3cd94e3fbb0c52410a4c6609e55b863e\">https://gist.github.com/panprog/3cd94e3fbb0c52410a4c6609e55b863e</a></p>\n<h3 id=\"recommended-mitigation-steps\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Consider adding <code>nonReentrant</code> modifiers with <code>ReentrancyGuard</code> implementation from <code>openzeppelin</code>. Alternatively just fix this individual re-entrancy issue. There are multiple ways to fix it depending on expected behaviour, for example saving <code>ERC1155</code> data and requiring it to match the data after transfer (restricting <code>onERC1155Received</code> to not change any data for the token received):</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">function _transferAndBurnFuses(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    bytes32 node,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    address newOwner,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint32 fuses,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint64 expiry</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">) internal {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (address owner, uint32 saveFuses, uint64 saveExpiry) = getData(uint256(node));</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    _transfer(owner, newOwner, uint256(node), 1, &quot;&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint32 curFuses;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint64 curExpiry;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (owner, curFuses, curExpiry) = getData(uint256(node));</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    require(owner == newOwner &amp;&amp; saveFuses == curFuses &amp;&amp; saveExpiry == curExpiry);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    _setFuses(node, newOwner, fuses, expiry);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/84\">Arachnid (ENS) confirmed</a></strong></p>\n<hr>\n<h2 id=\"h-02-the-expiry-of-the-parent-node-can-be-smaller-than-the-one-of-a-child-node-violating-the-guarantee-policy\" style=\"position:relative;\"><a href=\"#h-02-the-expiry-of-the-parent-node-can-be-smaller-than-the-one-of-a-child-node-violating-the-guarantee-policy\" aria-label=\"h 02 the expiry of the parent node can be smaller than the one of a child node violating the guarantee policy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/187\">[H-02] The expiry of the parent node can be smaller than the one of a child node, violating the guarantee policy</a></h2>\n<p><em>Submitted by PwnedNoMore</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L504\">NameWrapper.sol#L504</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L356\">NameWrapper.sol#L356</a><br></p>\n<p>By design, the child node’s expiry can only be extended up to the parent’s current one. Adding these restrictions means that the ENS users only have to look at the name itself’s fuses and expiry (without traversing the hierarchy) to understand what guarantees the users have.</p>\n<p>When a parent node tries to <code>setSubnodeOwner</code> / <code>setSubnodeRecord</code>, the following code is used to guarantee that the new expiry can only be extended up to the current one.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">_getDataAndNormaliseExpiry</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">node</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint64</span><span class=\"mtk1\"> </span><span class=\"mtk12\">expiry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">internal</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">view</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">owner</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint64</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint64</span><span class=\"mtk1\"> </span><span class=\"mtk12\">oldExpiry</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    (</span><span class=\"mtk12\">owner</span><span class=\"mtk1\">, </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">, </span><span class=\"mtk12\">oldExpiry</span><span class=\"mtk1\">) = </span><span class=\"mtk11\">getData</span><span class=\"mtk1\">(</span><span class=\"mtk11\">uint256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">node</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    (, , </span><span class=\"mtk12\">uint64</span><span class=\"mtk1\"> </span><span class=\"mtk12\">maxExpiry</span><span class=\"mtk1\">) = </span><span class=\"mtk11\">getData</span><span class=\"mtk1\">(</span><span class=\"mtk11\">uint256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">_normaliseExpiry</span><span class=\"mtk1\">(</span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">, </span><span class=\"mtk12\">oldExpiry</span><span class=\"mtk1\">, </span><span class=\"mtk12\">maxExpiry</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">owner</span><span class=\"mtk1\">, </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">, </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>However, the problem shows when</p>\n<ul>\n<li>The sub-domain (e.g., <code>sub1.base.eth</code>) has its own sub-sub-domain (e.g., <code>sub2.sub1.base.eth</code>)</li>\n<li>The sub-domain is unwrapped later, and thus its <code>oldExpiry</code> becomes zero.</li>\n<li>When <code>base.eth</code> calls <code>NameWrapper.setSubnodeOwner</code>, there is not constraint of <code>sub1.base.eth</code>’s expiry, since <code>oldExpiry == 0</code>. As a result, the new expiry of <code>sub1.base.eth</code> can be arbitrary and smaller than the one of <code>sub2.sub1.base.eth</code></li>\n</ul>\n<p>The point here is that the <code>oldExpiry</code> will be set as 0 when unwrapping the node even it holds child nodes, relaxing the constraint.</p>\n<p>Specifically, considering the following scenario</p>\n<ul>\n<li>The hacker owns a domain (or a 2LD), e.g., <code>base.eth</code></li>\n<li>\n<p>The hacker assigns a sub-domain to himself, e.g., <code>sub1.base.eth</code></p>\n<ul>\n<li>The expiry should be as large as possible</li>\n</ul>\n</li>\n<li>\n<p>Hacker assigns a sub-sub-domain, e.g., <code>sub2.sub1.base.eth</code></p>\n<ul>\n<li>The expiry should be as large as possible</li>\n</ul>\n</li>\n<li>The hacker unwraps his sub-domain, i.e., <code>sub1.base.eth</code></li>\n<li>\n<p>The hacker re-wraps his sub-domain via <code>NameWrapper.setSubnodeOwner</code></p>\n<ul>\n<li>The expiry can be small than the one of sub2.sub1.base.eth</li>\n</ul>\n</li>\n</ul>\n<p>The root cause <em>seems</em> that we should not zero out the expiry when burning a node if the node holds any subnode.</p>\n<h3 id=\"suggested-fix\" style=\"position:relative;\"><a href=\"#suggested-fix\" aria-label=\"suggested fix permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Suggested Fix</h3>\n<ul>\n<li>Potential fix 1: auto-burn <code>CANNOT_UNWRAP</code> which thus lets <code>expiry</code> decide whether a node can be unwrapped.</li>\n<li>Potential fix 2: force the parent to have <code>CANNOT_UNWRAP</code> burnt if they want to set expiries on a child via <code>setSubnodeOwner</code> / <code>setSubnodeRecord</code> / <code>setChildFuses</code></li>\n</ul>\n<h3 id=\"proof-of-concept--attack-scenario\" style=\"position:relative;\"><a href=\"#proof-of-concept--attack-scenario\" aria-label=\"proof of concept  attack scenario permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept / Attack Scenario</h3>\n<p>For full details, please see <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/187\">original warden submission</a>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/187\">Arachnid (ENS) confirmed</a></strong></p>\n<hr>\n<h2 id=\"h-03-parent_cannot_control-can-be-bypassed-by-maliciously-unwrapping-parent-node\" style=\"position:relative;\"><a href=\"#h-03-parent_cannot_control-can-be-bypassed-by-maliciously-unwrapping-parent-node\" aria-label=\"h 03 parent_cannot_control can be bypassed by maliciously unwrapping parent node permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/173\">[H-03] <code>PARENT_CANNOT_CONTROL</code> can be bypassed by maliciously unwrapping parent node</a></h2>\n<p><em>Submitted by PwnedNoMore, also found by panprog, and zzzitron</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L356\">NameWrapper.sol#L356</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L295\">NameWrapper.sol#L295</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/registry/ENSRegistry.sol#L74\">ENSRegistry.sol#L74</a><br></p>\n<p>By design, for any subdomain, as long as its <code>PARENT_CANNOT_CONTROL</code> fuse is burnt (and does not expire), its parent should not be able to burn its fuses or change its owner.</p>\n<p>However, this contraint can be bypassed by a parent node maliciously unwrapping itself. As long as the hacker becomes the ENS owner of the parent node, he can leverage <code>ENSRegistry::setSubnodeOwner</code> to re-set himself as the ENS owner of the subdomain, and thus re-invoking <code>NameWrapper.wrap</code> can rewrite the fuses and wrapper owner of the given subdoamin.</p>\n<p>Considering the following attack scenario:</p>\n<ul>\n<li>Someone owns a domain (or a 2LD), e.g., <em>poc.eth</em></li>\n<li>\n<p>The domain owner assigns a sub-domain to the hacker, e.g., <em>hack.poc.eth</em></p>\n<ul>\n<li>This sub-domain should not burn <code>CANNOT_UNWRAP</code></li>\n<li>This sub-domain can burn <code>PARENT_CANNOT_CONTROL</code></li>\n</ul>\n</li>\n<li>Hacker assigns a sub-sub-domain to a victim user, e.g., <em>victim.hack.poc.eth</em></li>\n<li>\n<p>The victim user burns arbitrary fuses, including <code>PARENT_CANNOT_CONTROL</code></p>\n<ul>\n<li>The hacker should not be able to change the owner and the fuses of <code>victim.hack.poc.eth</code> ideally</li>\n</ul>\n</li>\n<li>However, the hacker then unwraps his sub-domain, i.e., <em>hack.poc.eth</em></li>\n<li>\n<p>The hacker invokes <code>ENSRegistry::setSubnodeOwner(hacker.poc.eth, victim)</code> on the sub-sub-domain</p>\n<ul>\n<li>He can reassign himself as the owner of the <em>victim.hack.poc.eth</em></li>\n</ul>\n</li>\n<li>The hacker invokes <code>NameWrapper.wrap(victim.hacker.poc.eth)</code> to over-write the fuses and owner of the sub-sub-domain, i.e., <em>victim.hacker.poc.eth</em></li>\n</ul>\n<p>The root cause here is that, for any node, when one of its subdomains burns <code>PARENT_CANNOT_CONTROL</code>, the node itself fails to burn <code>CANNOT_UNWRAP</code>. Theoretically, this should check to the root, which however is very gas-consuming.</p>\n<h3 id=\"suggested-fix-1\" style=\"position:relative;\"><a href=\"#suggested-fix-1\" aria-label=\"suggested fix 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Suggested Fix</h3>\n<ul>\n<li>Potential fix 1: auto-burn <code>CANNOT_UNWRAP</code> which thus lets <code>expiry</code> decide whether a node can be unwrapped.</li>\n<li>Potential fix 2: leave fuses as is when unwrapping and re-wrapping, unless name expires. Meanwhile, check the old fuses even wrapping.</li>\n</ul>\n<h3 id=\"proof-of-concept--attack-scenario-1\" style=\"position:relative;\"><a href=\"#proof-of-concept--attack-scenario-1\" aria-label=\"proof of concept  attack scenario 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept / Attack Scenario</h3>\n<p>For full details, please see <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/173\">original warden submission</a>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/173\">Arachnid (ENS) confirmed</a></strong></p>\n<hr>\n<h1 id=\"medium-risk-findings-13\" style=\"position:relative;\"><a href=\"#medium-risk-findings-13\" aria-label=\"medium risk findings 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings (13)</h1>\n<h2 id=\"m-01-wrapeth2ld-permissioning-is-over-extended\" style=\"position:relative;\"><a href=\"#m-01-wrapeth2ld-permissioning-is-over-extended\" aria-label=\"m 01 wrapeth2ld permissioning is over extended permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/51\">[M-01] <code>wrapETH2LD</code> permissioning is over-extended</a></h2>\n<p><em>Submitted by 0x52</em></p>\n<p>Undesired use of ENS wrapper.</p>\n<h3 id=\"proof-of-concept-1\" style=\"position:relative;\"><a href=\"#proof-of-concept-1\" aria-label=\"proof of concept 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L219-L223\">NameWrapper.sol#L219-L223</a><br></p>\n<p>Current permissioning for wrapETH2LD allows msg.senders who are not owner to call it if they are EITHER approved for all on the ERC721 registrar or approved on the wrapper. Allowing users who are approved for the ERC721 registrar makes sense. By giving them approval, you are giving them approval to do what they wish with the token. Any other restrictions are moot regardless because they could use approval to transfer themselves the token anyways and bypass them as the new owner. The issue is allowing users who are approved for the wrapper contract to wrap the underlying domain. By giving approval to the contract the user should only be giving approval for the wrapped domains. As it is currently setup, once a user has given approval on the wrapper contract they have essentially given approval for every domain, wrapped or unwrapped, because any unwrapped domain can be wrapped and taken control of. This is an over-extension of approval which should be limited to the tokens managed by the wrapper contract and not extend to unwrapped domains</p>\n<h3 id=\"recommended-mitigation-steps-1\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-1\" aria-label=\"recommended mitigation steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Remove L221.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/51#issuecomment-1196225256\">Arachnid (ENS) disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>This was by design, but the warden raises a good point about the implications of this permission model. Recommend downgrading to QA.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/51#issuecomment-1203751996\">LSDan (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>I’m going to downgrade this to medium. There are not assets at direct risk, but with external factors the assets could be at risk due to the user being unaware that in approving wrapped domains, they are also approving unwrapped domains.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-02-renew-of-2nd-level-domain-is-not-done-properly\" style=\"position:relative;\"><a href=\"#m-02-renew-of-2nd-level-domain-is-not-done-properly\" aria-label=\"m 02 renew of 2nd level domain is not done properly permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/63\">[M-02] Renew of 2nd level domain is not done properly</a></h2>\n<p><em>Submitted by csanuragjain, also found by cccz and GimelSec</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/main/contracts/ethregistrar/ETHRegistrarController.sol#L201\">ETHRegistrarController.sol#L201</a><br>\n<a href=\"https://github.com/ensdomains/ens-contracts/blob/master/contracts/wrapper/NameWrapper.sol#L271\">NameWrapper.sol#L271</a><br></p>\n<p>The ETHRegistrarController is calling renew from base registrar and not through Namewrapper. This means the fuses for the subdomain will not be updated via <a href=\"https://github.com/code-423n4/2022-07-ens/blob/main/contracts/wrapper/NameWrapper.sol#L284\">_setData</a>. This impacts the permission model set over subdomain and could lead to takeover</p>\n<h3 id=\"proof-of-concept-2\" style=\"position:relative;\"><a href=\"#proof-of-concept-2\" aria-label=\"proof of concept 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<ol>\n<li>Observe the <a href=\"https://github.com/code-423n4/2022-07-ens/blob/main/contracts/ethregistrar/ETHRegistrarController.sol#L189\">renew</a> function</li>\n</ol>\n<!---->\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">function renew(string calldata name, uint256 duration)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        external</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        payable</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        override</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        ...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint256 expires = base.renew(uint256(label), duration);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        ....</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<ol start=\"2\">\n<li>As we can see this is calling renew function of Base Registrar instead of NameWrapper. Since this is not going via NameWrapper fuses will not be set</li>\n<li>Also since renew in NameWrapper can only be called via Controller which is ETHRegistrarController so there is no way to renew subdomain</li>\n</ol>\n<h3 id=\"recommended-mitigation-steps-2\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-2\" aria-label=\"recommended mitigation steps 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>The ETHRegistrarController must renew using Namewrapper’s renew contract.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/63#issuecomment-1196218068\">Arachnid (ENS) commented</a>:</strong></p>\n<blockquote>\n<p>Duplicate of <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/223\">#223</a>.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/63#issuecomment-1203797392\">LSDan (judge) commented</a>:</strong></p>\n<blockquote>\n<p>On <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/223\">#223</a>, which I’ve invalidated, @Arachnid notes that:</p>\n<blockquote>\n<p>In fact, this should only be severity QA, as it can be worked around by calling <code>renew</code> on the registrar controller followed by <code>setChildFuses</code>.</p>\n</blockquote>\n<p>I’m going to make this report the main one and leave the risk rating of Medium in place. While there is a workaround, if the workaround is not employed, permissions will be incorrect and may lead to a breakdown in the functioning of the protocol. </p>\n</blockquote>\n<hr>\n<h2 id=\"m-03-transfer-depends-on-gas-consts\" style=\"position:relative;\"><a href=\"#m-03-transfer-depends-on-gas-consts\" aria-label=\"m 03 transfer depends on gas consts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/133\">[M-03] <code>transfer()</code> depends on gas consts</a></h2>\n<p><em>Submitted by rajatbeladiya, also found by __141345__, _Adam, 0x29A, 0xNineDec, alan724, Amithuddar, asutorufos, Aussie_Battlers, berndartmueller, c3phas, cccz, Ch_301, cryptphi, csanuragjain, Dravee, durianSausage, fatherOfBlocks, GimelSec, hake, hyh, IllIllI, Jujic, Limbooo, pashov, RedOneN, Ruhum, scaraven, TomJ, and zzzitron</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L183-L185\">ETHRegistrarController.sol#L183-L185</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L204\">ETHRegistrarController.sol#L204</a><br></p>\n<p><code>transfer()</code> forwards 2300 gas only, which may not be enough in future if the recipient is a contract and gas costs change. it could break existing contracts functionality.</p>\n<h3 id=\"proof-of-concept-3\" style=\"position:relative;\"><a href=\"#proof-of-concept-3\" aria-label=\"proof of concept 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><code>.transfer</code> or <code>.send</code> method, only 2300 gas will be “forwarded” to fallback function. Specifically, the SLOAD instruction, will go from costing 200 gas to 800 gas.</p>\n<p>If any smart contract has a functionality of register ens and it has fallback function which is making some state change in contract on ether receive, it could use more than 2300 gas and revert every transaction.</p>\n<p>For reference, check out:</p>\n<ul>\n<li><a href=\"https://docs.soliditylang.org/en/v0.8.15/security-considerations.html?highlight=transfer#sending-and-receiving-ether\">https://docs.soliditylang.org/en/v0.8.15/security-considerations.html?highlight=transfer#sending-and-receiving-ether</a></li>\n<li><a href=\"https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/\">https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/</a></li>\n</ul>\n<h3 id=\"recommended-mitigation-steps-3\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-3\" aria-label=\"recommended mitigation steps 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Use <code>.call</code> insted <code>.transfer</code></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"> (bool success, ) = msg.sender.call.value(amount)(&quot;&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> require(success, &quot;Transfer failed.&quot;);</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1196371402\">jefflau (ENS) confirmed, but disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>Recommend reducing severity to QA</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1203817454\">LSDan (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>I’m downgrading this to Medium. There are external factors required to make this problem occur, but if it does the functionality of the protocol as a whole could be severely impacted.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1206025827\">Arachnid (ENS) commented</a>:</strong></p>\n<blockquote>\n<p>It’s unclear to me how this could be a significant issue. Anyone writing code to register names knows that any excess funds will be returned, and therefore that they need a fallback that consumes minimal gas. Any EVM change that increases the gas of fallback functions would be breaking for a great number of contracts beyond ENS.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1208062192\">LSDan (judge) commented</a>:</strong></p>\n<blockquote>\n<blockquote>\n<p>It’s unclear to me how this could be a significant issue.</p>\n</blockquote>\n<p>The register functions will fail, consuming a good bit of gas along the way if this occurs. If this were not such a critical piece of functionality I would have considered it QA, but a failure here breaks the protocol.</p>\n<blockquote>\n<p>Anyone writing code to register names knows that any excess funds will be returned, and therefore that they need a fallback that consumes minimal gas. Any EVM change that increases the gas of fallback functions would be breaking for a great number of contracts beyond ENS.</p>\n</blockquote>\n<p>The fact that other contracts will break along with ENS does not invalidate the issue. This is a clearly documented problem that has been known for years (see ref links). There is no reason to introduce more critical contracts to the ecosystem that will fail in this scenario, particularly when it is so easy to avoid.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1214550653\">Arachnid (ENS) commented</a>:</strong></p>\n<blockquote>\n<blockquote>\n<p>The register functions will fail, consuming a good bit of gas along the way if this occurs. If this were not such a critical piece of functionality I would have considered it QA, but a failure here breaks the protocol.</p>\n</blockquote>\n<p>I think the implied API here is that any contract registering names with the controller must either send the right amount of ether, or have a fallback function that can accept ether. Changes to the consensus layer that invalidate that assumption for a given contract are out-of-scope for ENS.</p>\n<p>Sending all remaining gas with the refund increases the threat surface by allowing possible reentrancy etc, which we haven’t examined as a threat model here.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-04-bytesutilcompare-returns-wrong-result-on-some-strings-longer-than-32-characters\" style=\"position:relative;\"><a href=\"#m-04-bytesutilcompare-returns-wrong-result-on-some-strings-longer-than-32-characters\" aria-label=\"m 04 bytesutilcompare returns wrong result on some strings longer than 32 characters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/78\">[M-04] <code>BytesUtil.compare</code> returns wrong result on some strings longer than 32 characters</a></h2>\n<p><em>Submitted by panprog, also found by alan724 and GimelSec</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L66-L70\">BytesUtils.sol#L66-L70</a><br></p>\n<p>Due to incorrect condition in <code>ByteUtil.compare</code> function, irrelevant characters are masked out only for strings shorter than <code>32</code> characters. However, they must be masked out for strings of all lengths in the last pass of the loop (when remainder of the string is 32 characters or less). This leads to incorrect comparision of strings longer than <code>32</code> characters where <code>len</code> or <code>otherlen</code> is smaller than string length (characters beyond provided length are still accounted for in the comparision in this case while they should be ignored).</p>\n<p>This wrong <code>compare</code> behaviour also makes <code>RRUtils.compareNames</code> fail to correctly compare DNS names in certain cases.</p>\n<p>While the <code>BytesUtil.compare</code> and <code>RRUtils.compareNames</code> methods are currently not used in the functions in the scope (but are used in mainnet’s <code>DNSSECImpl.checkNsecName</code>, which is out of scope here), they’re public library functions relied upon and can be used by the other users or the ENS project in the future. And since the functions in scope provide incorrect result, that’s a wrong (unexpected) behaviour of the smart contract. Moreover, since the problem can be seen only with the large strings (more than <code>32</code> characters), this might go unnoticed with any code that uses <code>compare</code> or <code>compareNames</code> method and can potentially lead to high security risk of any integration project or ENS itself.</p>\n<p>Example strings to compare which give incorrect result:\n<code>01234567890123450123456789012345ab</code>\n<code>01234567890123450123456789012345aa</code></p>\n<p>Each string is <code>34</code> characters long, first <code>33</code> characters are the same, the last one is different. If we compare first <code>33</code> characters of both strings, the result should be <code>equal</code> (as they only differ in the 34th character), but <code>compare</code> will return <code>></code>, because it fails to ignore the last character of both strings and simply compares strings themselves.</p>\n<p>If we compare the first <code>33</code> characters from the first string vs all <code>34</code> characters of the second string, the result of <code>compare</code> will be <code>></code>, while the correct result is <code>&#x3C;</code>, because <code>compare</code> fails to ignore the last character of the first string.</p>\n<p>Example dns names to compare which give incorrect result:<br>\n<code>01234567890123456789012345678901a0.0123456789012345678901234567890123456789012345678.eth</code><br>\n<code>01234567890123456789012345678901a.0123456789012345678901234567890123456789012345678.eth</code><br></p>\n<p>The first dns name should come after the second, but <code>dnsCompare</code> returns <code>-1</code> (the first name to come before), because the length of the 2nd domain (49 characters) is ASCII character <code>1</code> and is not correctly masked off during strings comparision.</p>\n<h3 id=\"proof-of-concept-4\" style=\"position:relative;\"><a href=\"#proof-of-concept-4\" aria-label=\"proof of concept 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>git diff</p>\n<p><a href=\"https://gist.github.com/panprog/32adefdc853ccd0fd0f1aad85c526bea\">https://gist.github.com/panprog/32adefdc853ccd0fd0f1aad85c526bea</a></p>\n<p>then:</p>\n<p>yarn test test/dnssec-oracle/TestSolidityTests.js</p>\n<h3 id=\"recommended-mitigation-steps-4\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-4\" aria-label=\"recommended mitigation steps 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>In addition to the incorrect condition, the mask calculation formula: <code>32 - shortest + idx</code> will also overflow since <code>shortest</code> can be more than <code>32</code>, so addition should be performed before subtractions.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">            if (shortest - idx &gt;= 32) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                mask = type(uint256).max;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            } else {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                mask = ~(2 ** (8 * (idx + 32 - shortest)) - 1);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            }</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/78\">Arachnid (ENS) confirmed</a></strong></p>\n<hr>\n<h2 id=\"m-05-dnssecimplverifysignature-compares-strings-incorrectly-allowing-malicious-zones-to-forge-dnssec-trust-chain\" style=\"position:relative;\"><a href=\"#m-05-dnssecimplverifysignature-compares-strings-incorrectly-allowing-malicious-zones-to-forge-dnssec-trust-chain\" aria-label=\"m 05 dnssecimplverifysignature compares strings incorrectly allowing malicious zones to forge dnssec trust chain permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/207\">[M-05] <code>DNSSECImpl.verifySignature</code> compares strings incorrectly, allowing malicious zones to forge DNSSEC trust chain</a></h2>\n<p><em>Submitted by GimelSec, also found by csanuragjain</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/main/contracts/dnssec-oracle/DNSSECImpl.sol#L186-L190\">DNSSECImpl.sol#L186-L190</a><br></p>\n<p>DNSSEC allows parent zones to sign for its child zones. To check validity of a signature, RFC4034 3.1.7 requires the <code>Signer's Name</code> in any RRSIG RDATA to contain the zone of covered RRset. This requirement is reasonable since any child zone should be covered by its parent zone.</p>\n<p>ENS tries to implement the concept of name coverage in <code>DNSSECImpl.verifySignature</code>, but unfortuantely does it wrong, resulting in possibiliy of coverage between two unrelated domains. In the worst case, an attacker can utilize this bug to forge malicious trust chains and authenticate invalid domains.</p>\n<h3 id=\"proof-of-concept-5\" style=\"position:relative;\"><a href=\"#proof-of-concept-5\" aria-label=\"proof of concept 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>In <code>DNSSECImpl.verifySignature</code>, ENS tries to verify the name of RRSet zone (<code>name</code>) is contained by Signer’s Name (<code>rrset.signerName</code>).</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    if(rrset.signerName.length &gt; name.length</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            || !rrset.signerName.equals(0, name, name.length - rrset.signerName.length))    //## This allows matches such as name=&quot;SubString.com&quot; signerName=&quot;String.com&quot;, which is clearly incorrect, use label counts instead</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            revert InvalidSignerName(name, rrset.signerName);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        }</span></span></code></pre>\n<p>In DNS, for a parent zone to contain another child zone, we generally require the child zone to be a subdomain of the parent. For instance, <code>example.eth.</code> in considered to cover <code>sub.example.eth.</code>, while <code>xample.eth.</code> should not be cover <code>example.eth.</code>.</p>\n<p>Unfortunately in the implementation shown above, both cases will path the check, and <code>ample.eth.</code> will be considered appropriate to sign for <code>example.eth.</code>. This is against the original design of DNS, and would result in breach of zone hierarchy.</p>\n<p>In practice, the requirement to exploit this is a bit more complex. Since names are stored as a sequence of packed labels, <code>example.eth.</code> should be stored as <code>\\x06example\\x03eth\\x00</code>, while <code>xample.eth.</code> is stored as <code>\\x05xample\\x03eth\\x00</code>. Thus to successfully pull off the attack ,we have to make sure that the packed signer’s name is actually a substring of child zone.</p>\n<p>A simple (yet unrealistic) example can be like this <code>xample.eth.</code> can sign for <code>e\\x05xample.eth.</code>, since packed format of those two names are <code>\\x05xample\\x03eth\\x00</code> and <code>\\x07e\\x05ample\\x03eth\\x00</code>.</p>\n<p>In general, it would require some effort for an attacker to find attackable zones, nevertheless, this should still be considered as a potential threat to the integrity of ENS.</p>\n<h3 id=\"recommended-mitigation-steps-5\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-5\" aria-label=\"recommended mitigation steps 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Check label by label instead of comparing the entire name.<br>\nTo actually meet all requirements specified in RFC4034 and RFC4035, there are still a lot to do, but we will discuss that in a separate issue for clarity.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/207#issuecomment-1196205728\">Arachnid (ENS) disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>This is a valid issue, but unexploitable in the wild; RFC 1035 specifies labels are limited to 63 octets or less, and the ASCII code of lowercase ‘a’ is 97. As a result, no vulnerable names should exist.</p>\n<p>Recommend that this be triaged as severity 2 as a result.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/207#issuecomment-1203857417\">LSDan (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>I agree with @Arachnid on this. The lack of real world likelihood makes this a Medium severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-06-bytesutils-compare-will-not-revert-when-the-offset-and-len-exceeds-the-bytes-lengths\" style=\"position:relative;\"><a href=\"#m-06-bytesutils-compare-will-not-revert-when-the-offset-and-len-exceeds-the-bytes-lengths\" aria-label=\"m 06 bytesutils compare will not revert when the offset and len exceeds the bytes lengths permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/180\">[M-06] <code>BytesUtils</code>: compare will not revert when the <code>offset</code> and <code>len</code> exceeds the bytes lengths</a></h2>\n<p><em>Submitted by zzzitron</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L44-L51\">BytesUtils.sol#L44-L51</a><br></p>\n<p>Compare will return false answer without reverting when the inputs are not valid.</p>\n<h3 id=\"proof-of-concept-6\" style=\"position:relative;\"><a href=\"#proof-of-concept-6\" aria-label=\"proof of concept 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>The <code>compare</code> function is used for <code>compareNames</code>. The names are supposed to be DNS wire format. If the strings are malformed, it is possible to give out-of-range <code>offset</code>, <code>len</code>, <code>otheroffset</code>, and <code>otherlen</code>. When it happens, the <code>compare</code> will return some false values, without reverting, since the validity of <code>offset</code> and <code>len</code> are not checked.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"51\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"52\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">// dnssec-oracle/BytesUtils.sol::compare</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"53\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">// The length of self and other are not enforced</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"54\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"55\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">44</span><span class=\"mtk1\">     </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">compare</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes</span><span class=\"mtk1\"> </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">self</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">offset</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">len</span><span class=\"mtk1\">, </span><span class=\"mtk12\">bytes</span><span class=\"mtk1\"> </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">other</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">otheroffset</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">otherlen</span><span class=\"mtk1\">) </span><span class=\"mtk11\">internal</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">int</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"56\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">45</span><span class=\"mtk1\">         </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">shortest</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">len</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"57\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">46</span><span class=\"mtk1\">         </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">otherlen</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">len</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"58\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">47</span><span class=\"mtk1\">         </span><span class=\"mtk12\">shortest</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">otherlen</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"59\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">48</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"60\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">49</span><span class=\"mtk1\">         </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">selfptr</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"61\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk7\">50</span><span class=\"mtk1\">         </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">otherptr</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-6\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-6\" aria-label=\"recommended mitigation steps 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Check whether the <code>offset</code>, <code>len</code> are within the length of <code>self</code>, as well as for the <code>other</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/180#issuecomment-1196600009\">makoto (ENS) acknowledged and commented</a>:</strong></p>\n<blockquote>\n<p>It’s lacking enough test to prove the bug.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/180#issuecomment-1198703171\">Arachnid (ENS) confirmed and commented</a>:</strong></p>\n<blockquote>\n<p><code>compareNames</code> does not sanity check the lengths passed in, so this is a legitimate bug.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-07-if-parent_cannot_control-is-set-on-subdomain-it-can-be-unwrapped-then-wrapped-by-its-owner-and-then-parent-can-control-it-again-before-the-expiry\" style=\"position:relative;\"><a href=\"#m-07-if-parent_cannot_control-is-set-on-subdomain-it-can-be-unwrapped-then-wrapped-by-its-owner-and-then-parent-can-control-it-again-before-the-expiry\" aria-label=\"m 07 if parent_cannot_control is set on subdomain it can be unwrapped then wrapped by its owner and then parent can control it again before the expiry permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/119\">[M-07] If <code>PARENT_CANNOT_CONTROL</code> is set on subdomain, it can be unwrapped then wrapped by its owner and then parent can control it again before the expiry</a></h2>\n<p><em>Submitted by panprog</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L955-L961\">NameWrapper.sol#L955-L961</a><br></p>\n<p>There is a general incorrect logic of allowing to burn only <code>PARENT_CANNOT_CONTROL</code> fuse without burning <code>CANNOT_UNWRAP</code> fuse. If only <code>PARENT_CANNOT_CONTROL</code> fuse is burnt, then domain can be unwrapped by its owner and then wrapped again, which clears <code>PARENT_CANNOT_CONTROL</code> fuse, making it possible for parent to bypass the limitation of parent control before the expiry.</p>\n<p>Bypassing parent control scenario:</p>\n<ol>\n<li>Alice registers and wraps <code>test.eth</code> domain</li>\n<li>Alice creates subdomain <code>bob.test.eth</code> and burns <code>PARENT_CANNOT_CONTROL</code> fuse with max expiry, transferring this domain to Bob</li>\n<li>At this point Bob can verify that he is indeed domain owner of <code>bob.test.eth</code> in <code>NameWrapper</code>, <code>PARENT_CANNOT_CONTROL</code> fuse is burnt for this domain and fuse expiry is set to expiry of <code>test.eth</code> domain. So Bob thinks his domain is secure and can not be taken from him before the expiry.</li>\n<li>Bob unwraps <code>bob.test.eth</code> domain.</li>\n<li>Bob wraps <code>bob.test.eth</code> domain, which clears fuses and expiry</li>\n<li>Alice changes <code>bob.test.eth</code> domain ownership to her breaking Bob’s impression that his domain was secure until expiry.</li>\n</ol>\n<h3 id=\"proof-of-concept-7\" style=\"position:relative;\"><a href=\"#proof-of-concept-7\" aria-label=\"proof of concept 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Copy this to test/wrapper and run:<br>\nyarn test test/wrapper/NameWrapperBypassPCC.js</p>\n<p><a href=\"https://gist.github.com/panprog/71dea0fd1875b4d7d5849f7da822ea8b\">https://gist.github.com/panprog/71dea0fd1875b4d7d5849f7da822ea8b</a></p>\n<h3 id=\"recommended-mitigation-steps-7\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-7\" aria-label=\"recommended mitigation steps 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Burning any fuse (including <code>PARENT_CANNOT_CONTROL</code>) must require <code>CANNOT_UNWRAP</code> fuse to be burned (because otherwise it’s possible to unwrap+wrap to clear that fuse).</p>\n<p>In <code>NameWrapper._canFusesBeBurned</code>, condition should be different:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    if (</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        fuses &amp; ~CANNOT_UNWRAP != 0 &amp;&amp;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        fuses &amp; (PARENT_CANNOT_CONTROL | CANNOT_UNWRAP) !=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        (PARENT_CANNOT_CONTROL | CANNOT_UNWRAP)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        revert OperationProhibited(node);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/119#issuecomment-1189822680\">jefflau (ENS) commented</a>:</strong></p>\n<blockquote>\n<p>A mitigation step for this could be to not burn fuses when unwrapping domains to prevent the <code>PARENT_CANNOT_CONTROL</code> from being reset.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/119#issuecomment-1196222115\">Arachnid (ENS) disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>Since this has to be self-inflicted by the victim, this should be severity 2.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/119#issuecomment-1203925662\">LSDan (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>Agree with the sponsor that this is a medium severity issue due to the external requirement that Bob unwraps and rewraps the domain. Additionally, this requires Alice to all of a sudden become a bad actor, making it highly unlikely that this would occur.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-08-wrong-equals-logic\" style=\"position:relative;\"><a href=\"#m-08-wrong-equals-logic\" aria-label=\"m 08 wrong equals logic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/118\">[M-08] Wrong Equals Logic</a></h2>\n<p><em>Submitted by 0x1f8b, also found by alan724</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L115-L127\">BytesUtils.sol#L115-L127</a><br></p>\n<p><code>equals</code> with offset might return true when <code>equals</code> without offset returns false.</p>\n<h3 id=\"proof-of-concept-8\" style=\"position:relative;\"><a href=\"#proof-of-concept-8\" aria-label=\"proof of concept 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>The problem is that <code>self.length</code> could be greater than <code>other.length + offset</code>, it should be <code>==</code>, or it should contain a length argument.</p>\n<p>Here you have an example of the failure:</p>\n<ul>\n<li><code>equals(0x0102030000, 0, 0x010203)</code> => <code>return true</code></li>\n</ul>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"json\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">decoded input\t{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk12\">&quot;bytes self&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;0x0102030000&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk12\">&quot;uint256 offset&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;0&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk12\">&quot;bytes other&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;0x010203&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">decoded output\t{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk12\">&quot;0&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;bool: true&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-8\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-8\" aria-label=\"recommended mitigation steps 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    function equals(bytes memory self, uint offset, bytes memory other) internal pure returns (bool) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">-       return self.length &gt;= offset + other.length &amp;&amp; equals(self, offset, other, 0, other.length);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">+       return self.length == offset + other.length &amp;&amp; equals(self, offset, other, 0, other.length);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/118\">makoto (ENS) confirmed</a></strong></p>\n<hr>\n<h2 id=\"m-09-the-unwrapeth2ld-use-transferfrom-instead-of-safetransferfrom-to-transfer-erc721-token\" style=\"position:relative;\"><a href=\"#m-09-the-unwrapeth2ld-use-transferfrom-instead-of-safetransferfrom-to-transfer-erc721-token\" aria-label=\"m 09 the unwrapeth2ld use transferfrom instead of safetransferfrom to transfer erc721 token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/157\">[M-09] The <code>unwrapETH2LD</code> use <code>transferFrom</code> instead of <code>safeTransferFrom</code> to transfer ERC721 token</a></h2>\n<p><em>Submitted by 0x29A, also found by Amithuddar, benbaessler, berndartmueller, cccz, CRYP70, rbserver, RedOneN, and Sm4rty</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L327-L346\">NameWrapper.sol#L327-L346</a><br></p>\n<p>The <code>unwrapETH2LD</code> use <code>transferFrom</code> to transfer ERC721 token, the <code>newRegistrant</code> could be an unprepared contract.</p>\n<h3 id=\"proof-of-concept-9\" style=\"position:relative;\"><a href=\"#proof-of-concept-9\" aria-label=\"proof of concept 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Should a ERC-721 compatible token be transferred to an unprepared contract, it would end up being locked up there. Moreover, if a contract explicitly wanted to reject ERC-721 safeTransfers.<br>\nPlus take a look to <a href=\"https://docs.openzeppelin.com/contracts/4.x/api/token/erc721#IERC721-transferFrom-address-address-uint256-\">the OZ safeTransfer comments</a>:<br>\n<code>Usage of this method is discouraged, use safeTransferFrom whenever possible.</code></p>\n<h3 id=\"recommended-mitigation-steps-9\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-9\" aria-label=\"recommended mitigation steps 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    function unwrapETH2LD(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        bytes32 labelhash,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        address newRegistrant,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        address newController</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ) public override onlyTokenOwner(_makeNode(ETH_NODE, labelhash)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        _unwrap(_makeNode(ETH_NODE, labelhash), newController);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">-       registrar.transferFrom(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">+       registrar.safeTransferFrom(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            address(this),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            newRegistrant,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            uint256(labelhash)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/157#issuecomment-1196450983\">jefflau (ENS) disputed and commented</a>:</strong></p>\n<blockquote>\n<p>Transfer is to the contract itself, so there is no point in using <code>safeTransferFrom</code>. For other situations where <code>transferFrom</code> the behaviour is intended.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/157#issuecomment-1204004769\">LSDan (judge) commented</a>:</strong></p>\n<blockquote>\n<blockquote>\n<p>Transfer is to the contract itself, so there is no point in using <code>safeTransferFrom</code>. For other situations where <code>transferFrom</code> the behaviour is intended.</p>\n</blockquote>\n<p>That’s incorrect in the report above. This is transferring from, not to, the contract itself.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/157#issuecomment-1204016628\">jefflau (ENS) commented</a>:</strong></p>\n<blockquote>\n<blockquote>\n<p>That’s incorrect in the report above. This is transferring from, not to, the contract itself.</p>\n</blockquote>\n<p>Yes sorry, that is true. I was replying to some of the duplicates that I closed such as: <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/126\">#126</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/147\">#147</a>. </p>\n</blockquote>\n<hr>\n<h2 id=\"m-10-incorrect-implementation-of-rrutilsserialnumbergte\" style=\"position:relative;\"><a href=\"#m-10-incorrect-implementation-of-rrutilsserialnumbergte\" aria-label=\"m 10 incorrect implementation of rrutilsserialnumbergte permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/211\">[M-10] Incorrect implementation of <code>RRUtils.serialNumberGte</code></a></h2>\n<p><em>Submitted by GimelSec, also found by Lambda and zzzitron</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/main/contracts/dnssec-oracle/RRUtils.sol#L266-L268\">RRUtils.sol#L266-L268</a><br></p>\n<p>Comparing serial numbers should follow RFC1982 due to the possibility of numbers wrapping around. <code>RRUtils.serialNumberGte</code> tried to follow the RFC but failed to do so, leading to incorrect results in comparison.</p>\n<h3 id=\"proof-of-concept-10\" style=\"position:relative;\"><a href=\"#proof-of-concept-10\" aria-label=\"proof of concept 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>For a serial number i1 to be greater than i2, the rules provided by RFC1982 is as follow<br>\n<code>((i1 &#x3C; i2) &#x26;&#x26; ((i2 - i1) > (2**31))) || ((i1 > i2) &#x26;&#x26; ((i1 - i2) &#x3C; (2**31)))</code></p>\n<p>ENS implements <code>int32(i1) - int32(i2) > 0</code>, which will suffer from revert in cases such as <code>i1=0x80000000, i2=0x7fffffff</code></p>\n<h3 id=\"recommended-mitigation-steps-10\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-10\" aria-label=\"recommended mitigation steps 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Use the naive implementation instead<br>\n<code>return (i1 == i2) || ((i1 &#x3C; i2) &#x26;&#x26; ((i2 - i1) > (2**31))) || ((i1 > i2) &#x26;&#x26; ((i1 - i2) &#x3C; (2**31)));</code></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/211#issuecomment-1196209242\">Arachnid (ENS) disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>This is intentional, see <a href=\"https://en.wikipedia.org/wiki/Serial_number_arithmetic#General_solution\">https://en.wikipedia.org/wiki/Serial_number_arithmetic#General_solution</a></p>\n<p>Nevertheless, this should be documented. Recommend triaging as QA.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/211#issuecomment-1204468784\">Arachnid (ENS) commented</a>:</strong></p>\n<blockquote>\n<p>Correction - while the operation is correct per the Wikipedia article, it should be in an <code>unchecked</code> block to allow overflow. Recommend triaging as 2.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/211#issuecomment-1205771385\">LSDan (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>Agree with the sponsor. This is a bug and it does potentially impact protocol functionality, but it will not occur until far in the future, making it fairly unlikely. Medium makes sense here.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-11-the-preimage-db-ie-namewrappernames-can-be-maliciously-manipulatedcorrupted\" style=\"position:relative;\"><a href=\"#m-11-the-preimage-db-ie-namewrappernames-can-be-maliciously-manipulatedcorrupted\" aria-label=\"m 11 the preimage db ie namewrappernames can be maliciously manipulatedcorrupted permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/197\">[M-11] The preimage DB (i.e., <code>NameWrapper.names</code>) can be maliciously manipulated/corrupted</a></h2>\n<p><em>Submitted by PwnedNoMore</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L520\">NameWrapper.sol#L520</a><br></p>\n<p>By design, the <code>NameWrapper.names</code> is used as a preimage DB so that the client can query the domain name by providing the token ID. The name should be correctly stored. To do so, the <code>NameWrapper</code> record the domain’s name every time it gets wrapped. And as long as all the parent nodes are recorded in the DB, wrapping a child node will be very efficient by simply querying the parent node’s name.</p>\n<p>However, within a malicious scenario, it is possible that a subdomain can be wrapped without recording its info in the preimage DB.</p>\n<p>Specifically, when <code>NameWrappper.setSubnodeOwner</code> / <code>NameWrappper.setSubnodeRecord</code> on a given subdomain, the following code is used to check whether the subdomain is wrapped or not. The preimage DB is only updated when the subdomain is not wrapped (to save gas I beieve).</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setSubnodeOwner</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">string</span><span class=\"mtk1\"> </span><span class=\"mtk12\">calldata</span><span class=\"mtk1\"> </span><span class=\"mtk12\">label</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint64</span><span class=\"mtk1\"> </span><span class=\"mtk12\">expiry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">public</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">onlyTokenOwner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">canCallSetSubnodeOwner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">, </span><span class=\"mtk12\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">label</span><span class=\"mtk1\">)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">node</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">labelhash</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk11\">bytes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">label</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">node</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">_makeNode</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">, </span><span class=\"mtk12\">labelhash</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    (, , </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">) = </span><span class=\"mtk11\">_getDataAndNormaliseExpiry</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">, </span><span class=\"mtk12\">node</span><span class=\"mtk1\">, </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">ens</span><span class=\"mtk1\">.</span><span class=\"mtk11\">owner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">node</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">ens</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setSubnodeOwner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">, </span><span class=\"mtk12\">labelhash</span><span class=\"mtk1\">, </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">_addLabelAndWrap</span><span class=\"mtk1\">(</span><span class=\"mtk12\">parentNode</span><span class=\"mtk1\">, </span><span class=\"mtk12\">node</span><span class=\"mtk1\">, </span><span class=\"mtk12\">label</span><span class=\"mtk1\">, </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">, </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">, </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">_transferAndBurnFuses</span><span class=\"mtk1\">(</span><span class=\"mtk12\">node</span><span class=\"mtk1\">, </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">, </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">, </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>However, the problem is that <code>ens.owner(node) != address(this)</code> is not sufficient to check whether the node is alreay wrapped. The hacker can manipulate this check by simply invoking <code>EnsRegistry.setSubnodeOwner</code> to set the owner as the <code>NameWrapper</code> contract without wrapping the node.</p>\n<p>Consider the following attack scenario.</p>\n<ul>\n<li>the hacker registers a 2LD domain, e.g., <code>base.eth</code></li>\n<li>\n<p>he assigns a subdomain for himself, e.g., <code>sub1.base.eth</code></p>\n<ul>\n<li>the expiry of <code>sub1.base.eth</code> should be set as expired shortly</li>\n<li>note that the expiry is for <code>sub1.base.eth</code> instead of <code>base.eth</code>, so it is safe to make it soonly expired</li>\n</ul>\n</li>\n<li>the hacker waits for expiration and unwraps his <code>sub1.base.eth</code></li>\n<li>the hacker invokes <code>ens.setSubnodeOwner</code> to set the owner of <code>sub2.sub1.base.eth</code> as NameWrapper contract</li>\n<li>the hacker re-wraps his <code>sub1.base.eth</code></li>\n<li>\n<p>the hacker invokes <code>nameWrapper.setSubnodeOwner</code> for <code>sub2.sub1.base.eth</code></p>\n<ul>\n<li>as such, <code>names[namehash(sub2.sub1.base.eth)]</code> becomes empty</li>\n</ul>\n</li>\n<li>\n<p>the hacker invokes <code>nameWrapper.setSubnodeOwner</code> for <code>eth.sub2.sub1.base.eth</code>.</p>\n<ul>\n<li>as such, <code>names[namehash(eth.sub2.sub1.base.eth)]</code> becomes <code>\\x03eth</code></li>\n</ul>\n</li>\n</ul>\n<p>It is not rated as a High issue since the forged name is not valid, i.e., without the tailed <code>\\x00</code> (note that a valid name should be like <code>\\x03eth\\x00</code>). However, the preimage BD can still be corrupted due to this issue.</p>\n<h3 id=\"suggested-fix-2\" style=\"position:relative;\"><a href=\"#suggested-fix-2\" aria-label=\"suggested fix 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Suggested Fix</h3>\n<p>When wrapping node <code>X</code>, check whether <code>NameWrapper.names[X]</code> is empty directly, and update the preimage DB if it is empty.</p>\n<h3 id=\"proof-of-concept--attack-scenario-2\" style=\"position:relative;\"><a href=\"#proof-of-concept--attack-scenario-2\" aria-label=\"proof of concept  attack scenario 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept / Attack Scenario</h3>\n<p>For full details, please see <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/197\">original warden submission</a>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/197\">jefflau (ENS) confirmed</a></strong></p>\n<hr>\n<h2 id=\"m-12-erc1155fuse-_transfer-does-not-revert-when-sent-to-the-old-owner\" style=\"position:relative;\"><a href=\"#m-12-erc1155fuse-_transfer-does-not-revert-when-sent-to-the-old-owner\" aria-label=\"m 12 erc1155fuse _transfer does not revert when sent to the old owner permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/179\">[M-12] <code>ERC1155Fuse</code>: <code>_transfer</code> does not revert when sent to the old owner</a></h2>\n<p><em>Submitted by zzzitron</em></p>\n<p>The <code>safeTransferFrom</code> does not comply with the ERC1155 standard when the token is sent to the old owner.</p>\n<h3 id=\"proof-of-concept-11\" style=\"position:relative;\"><a href=\"#proof-of-concept-11\" aria-label=\"proof of concept 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>According to the EIP-1155 standard for the <code>safeTransferFrom</code>:</p>\n<blockquote>\n<p>MUST revert if balance of holder for token <code>_id</code> is lower than the <code>_value</code> sent.</p>\n</blockquote>\n<p>Let’s say <code>alice</code> does not hold any token of <code>tokenId</code>, and <code>bob</code> holds one token of <code>tokenId</code>. Then alice tries to send one token of <code>tokenId</code> to bob with <code>safeTranferFrom(alice, bob, tokenId, 1, \"\")</code>.  In this case, even though alice’s balance (= 0) is lower than the amount (= 1) sent, the <code>safeTransferFrom</code> will not revert. Thus, violating the EIP-1155 standard.<br>\nIt can cause problems for other contracts using this token, since they assume the token was transferred if the <code>safeTransferFrom</code> does not revert. However, in the example above, no token was actually transferred.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"284\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"285\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">// wrapper/ERC1155Fuse.sol::_transfer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"286\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">// ERC1155Fuse::safeTransferFrom uses _transfer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"287\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"288\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">274</span><span class=\"mtk1\">     </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">_transfer</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"289\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">275         </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">from</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"290\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">276         </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">to</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"291\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">277         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">id</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"292\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">278         </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">amount</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"293\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">279         </span><span class=\"mtk12\">bytes</span><span class=\"mtk1\"> </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"294\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">280     ) </span><span class=\"mtk11\">internal</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"295\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">281</span><span class=\"mtk1\">         (</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">oldOwner</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">fuses</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint64</span><span class=\"mtk1\"> </span><span class=\"mtk12\">expiry</span><span class=\"mtk1\">) = </span><span class=\"mtk11\">getData</span><span class=\"mtk1\">(</span><span class=\"mtk12\">id</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"296\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">282</span><span class=\"mtk1\">         </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">oldOwner</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">to</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"297\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">283</span><span class=\"mtk1\">             </span><span class=\"mtk15\">return</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"298\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">284</span><span class=\"mtk1\">         }</span></span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-11\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-11\" aria-label=\"recommended mitigation steps 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Revert even if the <code>to</code> address already owns the token.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/179#issuecomment-1196491844\">jefflau (ENS) confirmed and commented</a>:</strong></p>\n<blockquote>\n<p>Recommend severity QA.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/179#issuecomment-1205864807\">LSDan (judge) commented</a>:</strong></p>\n<blockquote>\n<p>I’m going to leave this as Medium. This issue could definitely impact other protocols and potentially cause a loss of funds given external factors.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-13-users-can-create-extra-ens-records-at-no-cost\" style=\"position:relative;\"><a href=\"#m-13-users-can-create-extra-ens-records-at-no-cost\" aria-label=\"m 13 users can create extra ens records at no cost permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/132\">[M-13] Users can create extra ENS records at no cost</a></h2>\n<p><em>Submitted by wastewa, also found by bin2chen, Limbooo, PwnedNoMore, and ronnyx2017</em></p>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L249-L268\">ETHRegistrarController.sol#L249-L268</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L125\">ETHRegistrarController.sol#L125</a><br>\n<a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/BaseRegistrarImplementation.sol#L106\">BaseRegistrarImplementation.sol#L106</a><br></p>\n<p>Users using the <code>register</code> function in <code>ETHRegistrarController.sol</code>, can create an additional bogus ENS entry (Keep the ERC721 and all the glory for as long as they want) for free by exploiting the <code>functionCall</code> in the <code>_setRecords</code> function.<br>\nThe only check there (in the setRecord function) is that the nodehash matches the originally registered ENS entry, this is extremely dangerous because the rest of the functionCall is not checked and the controller has very elevated privileges in ENS ecosystem (and probably beyond).</p>\n<p>The single exploit I am showing is already very bad, but I expect there will be more if this is left in. An example of a potential hack is that some of the functions in other ENS contracts (which give the RegistrarController elevated privilege) have dynamic types as the first variables—if users can generate a hash that is a low enough number, they will be able to unlock more exploits in the ENS ecosystem because of how dynamic types are abi encoded.  Other developers will probably also trust the <code>ETHRegistrarController.sol</code>, so other unknown dangers may come down the road.</p>\n<p>The exploit I made (full code in PoC) can mint another ENS entry and keep it for as long as it wants, without paying more—will show code below.</p>\n<h3 id=\"proof-of-concept-12\" style=\"position:relative;\"><a href=\"#proof-of-concept-12\" aria-label=\"proof of concept 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Put this code in the <code>TestEthRegistrarController.js</code> test suite to run. I just appended this to tests at the bottom of file.</p>\n<p>I called the <code>BaseRegistrarImplementation.register</code> function with the privileges of <code>ETHRegistrarController</code> by passing the base registrar’s address as the <code>resolver</code> param in the <code>ETHRegistrarController.register</code> function call. I was able to set a custom duration at no additional cost.</p>\n<p>The final checks of the PoC show that we own two new ENS entries from a single <code>ETHRegistrarController.register</code> call. The labelhash of the new bogus ENS entry is the nodehash of the first registered ENS entry.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">it</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;Should allow us to make bogus erc721 token in ENS contract&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">label</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&#39;newconfigname&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">name</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">label</span><span class=\"mtk4\">}</span><span class=\"mtk8\">.eth`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">node</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">namehash</span><span class=\"mtk1\">.</span><span class=\"mtk11\">hash</span><span class=\"mtk1\">(</span><span class=\"mtk12\">name</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">secondTokenDuration</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">788400000</span><span class=\"mtk1\"> </span><span class=\"mtk3\">// keep bogus NFT for 25 years;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">commitment</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">controller</span><span class=\"mtk1\">.</span><span class=\"mtk11\">makeCommitment</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">label</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">registrantAccount</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">REGISTRATION_TIME</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">secret</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">baseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk12\">address</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">baseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk12\">interface</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodeFunctionData</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;register(uint256,address,uint)&#39;</span><span class=\"mtk1\">, [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">node</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">registrantAccount</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">secondTokenDuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ]),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">false</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">0</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">tx</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">controller</span><span class=\"mtk1\">.</span><span class=\"mtk11\">commit</span><span class=\"mtk1\">(</span><span class=\"mtk12\">commitment</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">expect</span><span class=\"mtk1\">(</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">controller</span><span class=\"mtk1\">.</span><span class=\"mtk11\">commitments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">commitment</span><span class=\"mtk1\">)).</span><span class=\"mtk12\">to</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equal</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      (</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">web3</span><span class=\"mtk1\">.</span><span class=\"mtk12\">eth</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getBlock</span><span class=\"mtk1\">(</span><span class=\"mtk12\">tx</span><span class=\"mtk1\">.</span><span class=\"mtk12\">blockNumber</span><span class=\"mtk1\">)).</span><span class=\"mtk12\">timestamp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">evm</span><span class=\"mtk1\">.</span><span class=\"mtk11\">advanceTime</span><span class=\"mtk1\">((</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">controller</span><span class=\"mtk1\">.</span><span class=\"mtk11\">minCommitmentAge</span><span class=\"mtk1\">()).</span><span class=\"mtk11\">toNumber</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">balanceBefore</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">web3</span><span class=\"mtk1\">.</span><span class=\"mtk12\">eth</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getBalance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">controller</span><span class=\"mtk1\">.</span><span class=\"mtk12\">address</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">tx2</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">controller</span><span class=\"mtk1\">.</span><span class=\"mtk11\">register</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">label</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">registrantAccount</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">REGISTRATION_TIME</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">secret</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">baseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk12\">address</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">baseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk12\">interface</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodeFunctionData</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;register(uint256,address,uint)&#39;</span><span class=\"mtk1\">, [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">node</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">registrantAccount</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">secondTokenDuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ]),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">false</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">0</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">0</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      { </span><span class=\"mtk12\">value:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">BUFFERED_REGISTRATION_COST</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">expect</span><span class=\"mtk1\">(</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">nameWrapper</span><span class=\"mtk1\">.</span><span class=\"mtk11\">ownerOf</span><span class=\"mtk1\">(</span><span class=\"mtk12\">node</span><span class=\"mtk1\">)).</span><span class=\"mtk12\">to</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equal</span><span class=\"mtk1\">(</span><span class=\"mtk12\">registrantAccount</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">expect</span><span class=\"mtk1\">(</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ens</span><span class=\"mtk1\">.</span><span class=\"mtk11\">owner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">namehash</span><span class=\"mtk1\">.</span><span class=\"mtk11\">hash</span><span class=\"mtk1\">(</span><span class=\"mtk12\">name</span><span class=\"mtk1\">))).</span><span class=\"mtk12\">to</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equal</span><span class=\"mtk1\">(</span><span class=\"mtk12\">nameWrapper</span><span class=\"mtk1\">.</span><span class=\"mtk12\">address</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">expect</span><span class=\"mtk1\">(</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">baseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk11\">ownerOf</span><span class=\"mtk1\">(</span><span class=\"mtk12\">node</span><span class=\"mtk1\">)).</span><span class=\"mtk12\">to</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equal</span><span class=\"mtk1\">( </span><span class=\"mtk3\">// this checks that bogus NFT is owned by us</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">registrantAccount</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">expect</span><span class=\"mtk1\">(</span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">baseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk11\">ownerOf</span><span class=\"mtk1\">(</span><span class=\"mtk11\">sha3</span><span class=\"mtk1\">(</span><span class=\"mtk12\">label</span><span class=\"mtk1\">))).</span><span class=\"mtk12\">to</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equal</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">nameWrapper</span><span class=\"mtk1\">.</span><span class=\"mtk12\">address</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span></code></pre>\n<h3 id=\"tools-used\" style=\"position:relative;\"><a href=\"#tools-used\" aria-label=\"tools used permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools Used</h3>\n<p>chai tests in repo</p>\n<h3 id=\"recommended-mitigation-steps-12\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-12\" aria-label=\"recommended mitigation steps 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>I recommend being stricter on the signatures of the user-provided <code>resolver</code> and the function that is being called (like safeTransfer calls in existing token contracts).<br>\nAn example of how to do this is by creating an interface that ENS can publish for users that want to compose their own resolvers and call that instead of a loose functionCall. Users will be free to handle data however they like, while restricting the space of things that can go wrong.</p>\n<p>I will provide a loose example here:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">interface IUserResolver {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    function registerRecords(bytes32 nodeId, bytes32 labelHash, bytes calldata extraData)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/132\">Arachnid (ENS) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/132#issuecomment-1206584808\">jefflau (ENS) disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>We left this as high severity, but this is a duplicate of this: <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/222#issuecomment-1196396435\">#222 comment</a>.</p>\n<p>I believe this still a low severity, or at a minimum medium.</p>\n<p>The only thing you can pass to <code>register</code> is the node, as the <code>require</code> inside <code>setRecords</code> checks the nodehash. However <code>register</code> in the baseRegistrar itself takes a <code>label</code> not the namehash of the name, so it will register a name with the hash of <code>namehash(namehash('eth') + node)</code>, which will be a very useless name as the label will then be a 32 byte keccak hash so <code>0x123...abc.eth</code>.</p>\n<p>In the warden’s test he tests for the node of the account they originally wanted to buy, not the bogus nft:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">expect(await baseRegistrar.ownerOf(node)).to.equal( // this checks that bogus NFT is owned by us</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      registrantAccount</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    )</span></span></code></pre>\n<p>To test for the bogus nft they would need to do:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">const node2 = sha3(namehash(&#39;eth&#39;) + node)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">expect(await baseRegistrar.ownerOf(node2)).to.equal( // this checks that bogus NFT is owned by us</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      registrantAccount</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    )</span></span></code></pre>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/132#issuecomment-1255167910\">LSDan (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>After a lot of consideration of this issue, I’m going to downgrade it to medium. There are two main considerations in doing this:</p>\n<ol>\n<li>The “free” name created is essentially junk.</li>\n<li>The additional potential exploits are unknown and kinda hand-wavy. If there are additional exploits in the future as a result of this they almost definitely rely on external factors that don’t exist today.</li>\n</ol>\n</blockquote>\n<hr>\n<h1 id=\"low-risk-and-non-critical-issues\" style=\"position:relative;\"><a href=\"#low-risk-and-non-critical-issues\" aria-label=\"low risk and non critical issues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk and Non-Critical Issues</h1>\n<p>For this contest, 71 reports were submitted by wardens detailing low risk and non-critical issues. The <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/221\">report highlighted below</a> by <strong>IllIllI</strong> received the top score from the judge.</p>\n<p><em>The following wardens also submitted reports: <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/71\">Dravee</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/193\">0x29A</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/17\">Bnke0x0</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/300\">Deivitto</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/250\">joestakey</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/144\">rbserver</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/130\">0x1f8b</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/92\">benbaessler</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/233\">TomJ</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/178\">dxdv</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/189\">hake</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/47\">Rolezn</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/273\">0xNazgul</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/225\">0xf15ers</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/238\">alan724</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/248\">Sm4rty</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/237\">Funen</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/289\">sashik_eth</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/52\">Ruhum</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/11\">robee</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/137\">_Adam</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/131\">Aussie_Battlers</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/122\">Waze</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/295\">brgltd</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/270\">c3phas</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/111\">Ch_301</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/317\">hyh</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/57\">Lambda</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/77\">MiloTruck</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/264\">p_crypt0</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/290\">Rohan16</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/146\">0xNineDec</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/45\">8olidity</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/182\">zzzitron</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/212\">GimelSec</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/307\">JC</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/163\">JohnSmith</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/213\">kyteg</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/299\">rokinot</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/109\">asutorufos</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/81\">berndartmueller</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/252\">bulej93</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/313\">cRat1st0s</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/172\">Critical</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/93\">csanuragjain</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/108\">delfin454000</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/21\">fatherOfBlocks</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/87\">sach1r0</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/104\">pedr02b2</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/312\">philogy</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/245\">PwnedNoMore</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/134\">rajatbeladiya</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/169\">__141345__</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/242\">0xDjango</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/34\">rishabh</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/88\">zuhaibmohd</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/259\">cryptphi</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/247\">svskaushik</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/254\">seyni</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/219\">RustyRabbit</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/291\">lcfr_eth</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/309\">minhtrng</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/150\">ReyAdmirado</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/161\">pashov</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/143\">bin2chen</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/261\">cryptonue</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/191\">ElKu</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/171\">exd0tpy</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/265\">simon135</a>, and <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/174\">gogo</a>.</em></p>\n<h2 id=\"low-risk-issues-summary\" style=\"position:relative;\"><a href=\"#low-risk-issues-summary\" aria-label=\"low risk issues summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk Issues Summary</h2>\n<table>\n<thead>\n<tr>\n<th></th>\n<th align=\"left\">Issue</th>\n<th align=\"center\">Instances</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[L‑01]</td>\n<td align=\"left\"><code>require()</code> should be used instead of <code>assert()</code></td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td>[L‑02]</td>\n<td align=\"left\">Missing checks for <code>address(0x0)</code> when assigning values to <code>address</code> state variables</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[L‑03]</td>\n<td align=\"left\">Open TODOs</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[L-04]</td>\n<td align=\"left\">File is missing NatSpec</td>\n<td align=\"center\">10</td>\n</tr>\n<tr>\n<td>[L-05]</td>\n<td align=\"left\">NatSpec is incomplete</td>\n<td align=\"center\">13</td>\n</tr>\n</tbody>\n</table>\n<p>Total: 27 instances over 5 issues</p>\n<h2 id=\"non-critical-issues-summary\" style=\"position:relative;\"><a href=\"#non-critical-issues-summary\" aria-label=\"non critical issues summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non-critical Issues Summary</h2>\n<table>\n<thead>\n<tr>\n<th></th>\n<th align=\"left\">Issue</th>\n<th align=\"center\">Instances</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[N‑01]</td>\n<td align=\"left\">Name validation is not strictly valid</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[N‑02]</td>\n<td align=\"left\">Adding a <code>return</code> statement when the function defines a named return variable, is redundant</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[N‑03]</td>\n<td align=\"left\"><code>require()</code>/<code>revert()</code> statements should have descriptive reason strings</td>\n<td align=\"center\">17</td>\n</tr>\n<tr>\n<td>[N‑04]</td>\n<td align=\"left\"><code>public</code> functions not called by the contract should be declared <code>external</code> instead</td>\n<td align=\"center\">13</td>\n</tr>\n<tr>\n<td>[N‑05]</td>\n<td align=\"left\"><code>constant</code>s should be defined rather than using magic numbers</td>\n<td align=\"center\">150</td>\n</tr>\n<tr>\n<td>[N‑06]</td>\n<td align=\"left\">Redundant cast</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[N‑07]</td>\n<td align=\"left\">Missing event and or timelock for critical parameter change</td>\n<td align=\"center\">3</td>\n</tr>\n<tr>\n<td>[N‑08]</td>\n<td align=\"left\">File is missing version pragma</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[N‑09]</td>\n<td align=\"left\">Use a more recent version of solidity</td>\n<td align=\"center\">7</td>\n</tr>\n<tr>\n<td>[N‑10]</td>\n<td align=\"left\"><code>pragma experimental ABIEncoderV2</code> is deprecated</td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td>[N‑11]</td>\n<td align=\"left\">Constant redefined elsewhere</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td>[N‑12]</td>\n<td align=\"left\">Inconsistent spacing in comments</td>\n<td align=\"center\">2</td>\n</tr>\n<tr>\n<td>[N‑13]</td>\n<td align=\"left\">Lines are too long</td>\n<td align=\"center\">8</td>\n</tr>\n<tr>\n<td>[N‑14]</td>\n<td align=\"left\">Inconsistent method of specifying a floating pragma</td>\n<td align=\"center\">10</td>\n</tr>\n<tr>\n<td>[N‑15]</td>\n<td align=\"left\">Non-library/interface files should use fixed compiler versions, not floating ones</td>\n<td align=\"center\">4</td>\n</tr>\n<tr>\n<td>[N‑16]</td>\n<td align=\"left\">Typos</td>\n<td align=\"center\">5</td>\n</tr>\n<tr>\n<td>[N‑17]</td>\n<td align=\"left\">File does not contain an SPDX Identifier</td>\n<td align=\"center\">14</td>\n</tr>\n<tr>\n<td>[N‑18]</td>\n<td align=\"left\">Event is missing <code>indexed</code> fields</td>\n<td align=\"center\">18</td>\n</tr>\n<tr>\n<td>[N‑19]</td>\n<td align=\"left\">Not using the named return variables anywhere in the function is confusing</td>\n<td align=\"center\">4</td>\n</tr>\n<tr>\n<td>[N‑20]</td>\n<td align=\"left\">Duplicated <code>require()</code>/<code>revert()</code> checks should be refactored to a modifier or function</td>\n<td align=\"center\">6</td>\n</tr>\n</tbody>\n</table>\n<p>Total: 268 instances over 20 issues</p>\n<h2 id=\"l01-require-should-be-used-instead-of-assert\" style=\"position:relative;\"><a href=\"#l01-require-should-be-used-instead-of-assert\" aria-label=\"l01 require should be used instead of assert permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L‑01] <code>require()</code> should be used instead of <code>assert()</code></h2>\n<p>Prior to solidity version 0.8.0, hitting an assert consumes the <strong>remainder of the transaction’s available gas</strong> rather than returning it, as <code>require()</code>/<code>revert()</code> do. <code>assert()</code> should be avoided even past solidity version 0.8.0 as its <a href=\"https://docs.soliditylang.org/en/v0.8.14/control-structures.html#panic-via-assert-and-error-via-require\">documentation</a> states that “The assert function creates an error of type Panic(uint256). … Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix”.</p>\n<p><em>There are 2 instances of this issue.</em> (For in-depth details on this and all further issues with multiple instances, please see the warden’s <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/221\">full report</a>.)</p>\n<h2 id=\"l02-missing-checks-for-address0x0-when-assigning-values-to-address-state-variables\" style=\"position:relative;\"><a href=\"#l02-missing-checks-for-address0x0-when-assigning-values-to-address-state-variables\" aria-label=\"l02 missing checks for address0x0 when assigning values to address state variables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L‑02] Missing checks for <code>address(0x0)</code> when assigning values to <code>address</code> state variables</h2>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">dnssec</span><span class=\"mtk1\">-</span><span class=\"mtk12\">oracle</span><span class=\"mtk1\">/</span><span class=\"mtk12\">Owned</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">19</span><span class=\"mtk1\">:           </span><span class=\"mtk12\">owner</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/Owned.sol#L19\">https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/Owned.sol#L19</a></p>\n<h2 id=\"l03-open-todos\" style=\"position:relative;\"><a href=\"#l03-open-todos\" aria-label=\"l03 open todos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L‑03] Open TODOs</h2>\n<p>Code architecture, incentives, and error handling/reporting questions/issues should be resolved before deployment</p>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">dnssec</span><span class=\"mtk1\">-</span><span class=\"mtk12\">oracle</span><span class=\"mtk1\">/</span><span class=\"mtk12\">DNSSECImpl</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">238</span><span class=\"mtk1\">:          </span><span class=\"mtk3\">// TODO: Check key isn&#39;t expired, unless updating key itself</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/DNSSECImpl.sol#L238\">https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/DNSSECImpl.sol#L238</a></p>\n<h2 id=\"l-04-file-is-missing-natspec\" style=\"position:relative;\"><a href=\"#l-04-file-is-missing-natspec\" aria-label=\"l 04 file is missing natspec permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-04] File is missing NatSpec</h2>\n<p><em>There are 10 instances of this issue.</em></p>\n<h2 id=\"l-05-natspec-is-incomplete\" style=\"position:relative;\"><a href=\"#l-05-natspec-is-incomplete\" aria-label=\"l 05 natspec is incomplete permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-05] NatSpec is incomplete</h2>\n<p><em>There are 13 instances of this issue.</em></p>\n<h2 id=\"n01-name-validation-is-not-strictly-valid\" style=\"position:relative;\"><a href=\"#n01-name-validation-is-not-strictly-valid\" aria-label=\"n01 name validation is not strictly valid permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑01] Name validation is not strictly valid</h2>\n<p>While the documentation does in fact <a href=\"https://docs.ens.domains/ens-improvement-proposals/ensip-1-ens#name-syntax\">say</a> that there are other validations necessary to be compatible with the legacy DNS system, it would be better to have the following function signature instead <code>function valid(string calldata name, bool isEnforceLegacyRules) public pure returns (bool)</code>, so it’s clear what the caller is validating</p>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ethregistrar</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ETHRegistrarController</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">77</span><span class=\"mtk1\">       </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">valid</span><span class=\"mtk1\">(</span><span class=\"mtk12\">string</span><span class=\"mtk1\"> </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">name</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">bool</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">78</span><span class=\"mtk1\">           </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">name</span><span class=\"mtk1\">.</span><span class=\"mtk11\">strlen</span><span class=\"mtk1\">() &gt;= </span><span class=\"mtk7\">3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">79</span><span class=\"mtk1\">:      }</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/4dfb0e32f586bff3db486349523a93480e3ddfba/contracts/ethregistrar/ETHRegistrarController.sol#L77-L79\">https://github.com/code-423n4/2022-07-ens/blob/4dfb0e32f586bff3db486349523a93480e3ddfba/contracts/ethregistrar/ETHRegistrarController.sol#L77-L79</a></p>\n<h2 id=\"n02-adding-a-return-statement-when-the-function-defines-a-named-return-variable-is-redundant\" style=\"position:relative;\"><a href=\"#n02-adding-a-return-statement-when-the-function-defines-a-named-return-variable-is-redundant\" aria-label=\"n02 adding a return statement when the function defines a named return variable is redundant permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑02] Adding a <code>return</code> statement when the function defines a named return variable, is redundant</h2>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">dnssec</span><span class=\"mtk1\">-</span><span class=\"mtk12\">oracle</span><span class=\"mtk1\">/</span><span class=\"mtk12\">DNSSECImpl</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">139</span><span class=\"mtk1\">:          </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">rrset</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/DNSSECImpl.sol#L139\">https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/DNSSECImpl.sol#L139</a></p>\n<h2 id=\"n03-requirerevert-statements-should-have-descriptive-reason-strings\" style=\"position:relative;\"><a href=\"#n03-requirerevert-statements-should-have-descriptive-reason-strings\" aria-label=\"n03 requirerevert statements should have descriptive reason strings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑03] <code>require()</code>/<code>revert()</code> statements should have descriptive reason strings</h2>\n<p><em>There are 17 instances of this issue.</em></p>\n<h2 id=\"n04-public-functions-not-called-by-the-contract-should-be-declared-external-instead\" style=\"position:relative;\"><a href=\"#n04-public-functions-not-called-by-the-contract-should-be-declared-external-instead\" aria-label=\"n04 public functions not called by the contract should be declared external instead permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑04] <code>public</code> functions not called by the contract should be declared <code>external</code> instead</h2>\n<p>Contracts <a href=\"https://docs.soliditylang.org/en/latest/contracts.html#function-overriding\">are allowed</a> to override their parents’ functions and change the visibility from <code>external</code> to <code>public</code>.</p>\n<p><em>There are 13 instances of this issue.</em></p>\n<h2 id=\"n05--constants-should-be-defined-rather-than-using-magic-numbers\" style=\"position:relative;\"><a href=\"#n05--constants-should-be-defined-rather-than-using-magic-numbers\" aria-label=\"n05  constants should be defined rather than using magic numbers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑05]  <code>constant</code>s should be defined rather than using magic numbers</h2>\n<p>Even <a href=\"https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39\">assembly</a> can benefit from using readable constants instead of hex/numeric literals.</p>\n<p><em>There are 150 instances of this issue.</em></p>\n<h2 id=\"n06-redundant-cast\" style=\"position:relative;\"><a href=\"#n06-redundant-cast\" aria-label=\"n06 redundant cast permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑06] Redundant cast</h2>\n<p>The type of the variable is the same as the type to which the variable is being cast.</p>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">registry</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ReverseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/// @audit address(resolver)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">53</span><span class=\"mtk1\">:               </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">resolver</span><span class=\"mtk1\">) != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">),</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/registry/ReverseRegistrar.sol#L53\">https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/registry/ReverseRegistrar.sol#L53</a></p>\n<h2 id=\"n07-missing-event-and-or-timelock-for-critical-parameter-change\" style=\"position:relative;\"><a href=\"#n07-missing-event-and-or-timelock-for-critical-parameter-change\" aria-label=\"n07 missing event and or timelock for critical parameter change permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑07] Missing event and or timelock for critical parameter change</h2>\n<p>Events help non-contract tools to track changes, and events prevent users from being surprised by changes</p>\n<p><em>There are 3 instances of this issue.</em></p>\n<h2 id=\"n08-file-is-missing-version-pragma\" style=\"position:relative;\"><a href=\"#n08-file-is-missing-version-pragma\" aria-label=\"n08 file is missing version pragma permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑08] File is missing version pragma</h2>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">ethregistrar</span><span class=\"mtk1\">/</span><span class=\"mtk12\">IBaseRegistrar</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">0</span><span class=\"mtk1\">:    </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;../registry/ENS.sol&quot;</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/IBaseRegistrar.sol#L0\">https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/IBaseRegistrar.sol#L0</a></p>\n<h2 id=\"n09-use-a-more-recent-version-of-solidity\" style=\"position:relative;\"><a href=\"#n09-use-a-more-recent-version-of-solidity\" aria-label=\"n09 use a more recent version of solidity permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑09] Use a more recent version of solidity</h2>\n<ul>\n<li>Use a solidity version of at least 0.8.12 to get <code>string.concat()</code> to be used instead of <code>abi.encodePacked(&#x3C;str>,&#x3C;str>)</code><br>\n<em>There are 4 instances of this issue.</em></li>\n<li>Use a solidity version of at least 0.8.13 to get the ability to use <code>using for</code> with a list of free functions<br>\n<em>There are 3 instances of this issue.</em></li>\n</ul>\n<h2 id=\"n10-pragma-experimental-abiencoderv2-is-deprecated\" style=\"position:relative;\"><a href=\"#n10-pragma-experimental-abiencoderv2-is-deprecated\" aria-label=\"n10 pragma experimental abiencoderv2 is deprecated permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑10] <code>pragma experimental ABIEncoderV2</code> is deprecated</h2>\n<p>Use <code>pragma abicoder v2</code> <a href=\"https://github.com/ethereum/solidity/blob/69411436139acf5dbcfc5828446f18b9fcfee32c/docs/080-breaking-changes.rst#silent-changes-of-the-semantics\">instead</a></p>\n<p><em>There are 2 instances of this issue.</em></p>\n<h2 id=\"n11-constant-redefined-elsewhere\" style=\"position:relative;\"><a href=\"#n11-constant-redefined-elsewhere\" aria-label=\"n11 constant redefined elsewhere permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑11] Constant redefined elsewhere</h2>\n<p>Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A <a href=\"https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678\">cheap way</a> to store constants in a single location is to create an <code>internal constant</code> in a <code>library</code>. If the variable is a local cache of another contract’s value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don’t get out of sync.</p>\n<p><em>There is 1 instance of this issue:</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">File: </span><span class=\"mtk12\">contracts</span><span class=\"mtk1\">/</span><span class=\"mtk12\">wrapper</span><span class=\"mtk1\">/</span><span class=\"mtk12\">NameWrapper</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/// @audit seen in contracts/registry/ReverseRegistrar.sol </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">35</span><span class=\"mtk1\">:       </span><span class=\"mtk12\">ENS</span><span class=\"mtk1\"> </span><span class=\"mtk12\">public</span><span class=\"mtk1\"> </span><span class=\"mtk12\">immutable</span><span class=\"mtk1\"> </span><span class=\"mtk12\">override</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ens</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L35\">https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L35</a></p>\n<h2 id=\"n12-inconsistent-spacing-in-comments\" style=\"position:relative;\"><a href=\"#n12-inconsistent-spacing-in-comments\" aria-label=\"n12 inconsistent spacing in comments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑12] Inconsistent spacing in comments</h2>\n<p>Some lines use <code>// x</code> and some use <code>//x</code>. The instances below point out the usages that don’t follow the majority, within each file</p>\n<p><em>There are 2 instances of this issue.</em></p>\n<h2 id=\"n13-lines-are-too-long\" style=\"position:relative;\"><a href=\"#n13-lines-are-too-long\" aria-label=\"n13 lines are too long permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑13] Lines are too long</h2>\n<p>Usually lines in source code are limited to <a href=\"https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width\">80</a> characters. Today’s screens are much larger so it’s reasonable to stretch this in some cases. Since the files will most likely reside in GitHub, and GitHub starts using a scroll bar in all cases when the length is over <a href=\"https://github.com/aizatto/character-length\">164</a> characters, the lines below should be split when they reach that length</p>\n<p><em>There are 8 instances of this issue.</em></p>\n<h2 id=\"n14-inconsistent-method-of-specifying-a-floating-pragma\" style=\"position:relative;\"><a href=\"#n14-inconsistent-method-of-specifying-a-floating-pragma\" aria-label=\"n14 inconsistent method of specifying a floating pragma permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑14] Inconsistent method of specifying a floating pragma</h2>\n<p>Some files use <code>>=</code>, some use <code>^</code>. The instances below are examples of the method that has the fewest instances for a specific version. Note that using <code>>=</code> without also specifying <code>&#x3C;=</code> will lead to failures to compile, or external project incompatability, when the major version changes and there are breaking-changes, so <code>^</code> should be preferred regardless of the instance counts</p>\n<p><em>There are 10 instances of this issue.</em></p>\n<h2 id=\"n15-non-libraryinterface-files-should-use-fixed-compiler-versions-not-floating-ones\" style=\"position:relative;\"><a href=\"#n15-non-libraryinterface-files-should-use-fixed-compiler-versions-not-floating-ones\" aria-label=\"n15 non libraryinterface files should use fixed compiler versions not floating ones permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑15] Non-library/interface files should use fixed compiler versions, not floating ones</h2>\n<p><em>There are 4 instances of this issue.</em></p>\n<h2 id=\"n16-typos\" style=\"position:relative;\"><a href=\"#n16-typos\" aria-label=\"n16 typos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑16] Typos</h2>\n<p><em>There are 5 instances of this issue.</em></p>\n<h2 id=\"n17-file-does-not-contain-an-spdx-identifier\" style=\"position:relative;\"><a href=\"#n17-file-does-not-contain-an-spdx-identifier\" aria-label=\"n17 file does not contain an spdx identifier permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑17] File does not contain an SPDX Identifier</h2>\n<p><em>There are 14 instances of this issue.</em></p>\n<h2 id=\"n18-event-is-missing-indexed-fields\" style=\"position:relative;\"><a href=\"#n18-event-is-missing-indexed-fields\" aria-label=\"n18 event is missing indexed fields permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑18] Event is missing <code>indexed</code> fields</h2>\n<p>Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it’s not necessarily best to index the maximum allowed per event (threefields). Each <code>event</code> should use three <code>indexed</code> fields if there are three or more fields, and gas usage is not particularly of concern for the events in question.</p>\n<p><em>There are 18 instances of this issue.</em></p>\n<h2 id=\"n19-not-using-the-named-return-variables-anywhere-in-the-function-is-confusing\" style=\"position:relative;\"><a href=\"#n19-not-using-the-named-return-variables-anywhere-in-the-function-is-confusing\" aria-label=\"n19 not using the named return variables anywhere in the function is confusing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑19] Not using the named return variables anywhere in the function is confusing</h2>\n<p>Consider changing the variable to be an unnamed one.</p>\n<p><em>There are 4 instances of this issue.</em></p>\n<h2 id=\"n20-duplicated-requirerevert-checks-should-be-refactored-to-a-modifier-or-function\" style=\"position:relative;\"><a href=\"#n20-duplicated-requirerevert-checks-should-be-refactored-to-a-modifier-or-function\" aria-label=\"n20 duplicated requirerevert checks should be refactored to a modifier or function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N‑20] Duplicated <code>require()</code>/<code>revert()</code> checks should be refactored to a modifier or function</h2>\n<p>The compiler will inline the function, which will avoid <code>JUMP</code> instructions usually associated with functions</p>\n<p><em>There are 6 instances of this issue.</em></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/221#issuecomment-1200790544\">jefflau (ENS) commented</a>:</strong></p>\n<blockquote>\n<p>High quality submission, documented well with links and code examples.</p>\n</blockquote>\n<hr>\n<h1 id=\"gas-optimizations\" style=\"position:relative;\"><a href=\"#gas-optimizations\" aria-label=\"gas optimizations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations</h1>\n<p>For this contest, 70 reports were submitted by wardens detailing gas optimizations. The <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176\">report highlighted below</a> by <strong>0xKitsune</strong> received the top score from the judge.</p>\n<p><em>The following wardens also submitted reports: <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/138\">joestakey</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/220\">IllIllI</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/103\">gogo</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/95\">Dravee</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/304\">m_Rassska</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/76\">MiloTruck</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/198\">rbserver</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/186\">hake</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/184\">TomJ</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/128\">0x1f8b</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/315\">ajtra</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/19\">Bnke0x0</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/301\">c3phas</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/316\">Deivitto</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/205\">kyteg</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/244\">RedOneN</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/249\">Sm4rty</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/231\">Tomio</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/170\">__141345__</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/296\">brgltd</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/246\">bulej93</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/110\">Ch_301</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/298\">cRat1st0s</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/37\">durianSausage</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/306\">JC</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/162\">JohnSmith</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/136\">_Adam</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/272\">0xNazgul</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/258\">asutorufos</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/107\">delfin454000</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/20\">fatherOfBlocks</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/318\">rokinot</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/115\">Waze</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/145\">0xNineDec</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/305\">0x040</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/192\">0x29A</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/33\">0xsam</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/123\">Aussie_Battlers</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/311\">Aymen0909</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/297\">Fitraldys</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/190\">lucacez</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/46\">Noah3o6</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/149\">ReyAdmirado</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/12\">robee</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/286\">Rohan16</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/48\">Rolezn</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/86\">sach1r0</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/2\">samruna</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/44\">8olidity</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/99\">arcoun</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/90\">benbaessler</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/94\">CRYP70</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/239\">karanctf</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/303\">lcfr_eth</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/135\">rajatbeladiya</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/148\">sahar</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/288\">sashik_eth</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/271\">simon135</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/91\">zuhaibmohd</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/260\">cryptonue</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/183\">ElKu</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/235\">Funen</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/228\">hyh</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/308\">seyni</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/284\">ak1</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/251\">Chom</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/199\">GimelSec</a>, <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/56\">Lambda</a>, and <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/53\">Ruhum</a>.</em></p>\n<h2 id=\"gas-optimizations-summary\" style=\"position:relative;\"><a href=\"#gas-optimizations-summary\" aria-label=\"gas optimizations summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations Summary</h2>\n<p>The following sections detail the gas optimizations found throughout the codebase. Each optimization is documented with the setup, an explainer for the optimization, a gas report and line identifiers for each optimization across the codebase. For each section’s gas report, the optimizer was turned on and set to 10000 runs. You can replicate any tests/gas reports by heading to <a href=\"https://github.com/0xKitsune/gas-lab\">0xKitsune/gas-lab</a> and cloning the repo. Then, simply copy/paste the contract examples from any section and run <code>forge test --gas-report</code>. You can also easily update the optimizer runs in the <code>foundry.toml</code>.</p>\n<hr>\n<h2 id=\"g-01-use-assembly-to-hash-instead-of-solidity\" style=\"position:relative;\"><a href=\"#g-01-use-assembly-to-hash-instead-of-solidity\" aria-label=\"g 01 use assembly to hash instead of solidity permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-01] Use assembly to hash instead of Solidity</h2>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">solidityHash</span><span class=\"mtk1\">(</span><span class=\"mtk7\">2309349</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2304923409</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">assemblyHash</span><span class=\"mtk1\">(</span><span class=\"mtk7\">2309349</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2304923409</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">solidityHash</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">//unoptimized</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">assemblyHash</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">//optimized</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk12\">a</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">hashedVal</span><span class=\"mtk1\"> := </span><span class=\"mtk10\">keccak256</span><span class=\"mtk1\">(0x00, 0x40)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report\" style=\"position:relative;\"><a href=\"#gas-report\" aria-label=\"gas report permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">36687</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">214</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">solidityHash</span><span class=\"mtk1\">       ┆ </span><span class=\"mtk7\">313</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">313</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">313</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">313</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">31281</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">186</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">assemblyHash</span><span class=\"mtk1\">       ┆ </span><span class=\"mtk7\">231</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">231</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">231</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">231</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines\" style=\"position:relative;\"><a href=\"#lines\" aria-label=\"lines permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<p>For full list of line references, see warden’s <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176\">original submission</a>.</p>\n<h2 id=\"g-02-uncheckedi-instead-of-i-or-use-assembly-when-applicable\" style=\"position:relative;\"><a href=\"#g-02-uncheckedi-instead-of-i-or-use-assembly-when-applicable\" aria-label=\"g 02 uncheckedi instead of i or use assembly when applicable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-02] <code>unchecked{++i}</code> instead of <code>i++</code> (or use assembly when applicable)</h2>\n<p>Use <code>++i</code> instead of <code>i++</code>. This is especially useful in for loops but this optimization can be used anywhere in your code. You can also use <code>unchecked{++i;}</code> for even more gas savings but this will not check to see if <code>i</code> overflows. For extra safety if you are worried about this, you can add a require statement after the loop checking if <code>i</code> is equal to the final incremented value. For best gas savings, use inline assembly, however this limits the functionality you can achieve. For example you cant use Solidity syntax to internally call your own contract within an assembly block and external calls must be done with the <code>call()</code> or <code>delegatecall()</code> instruction. However when applicable, inline assembly will save much more gas.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract4</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c4</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract2</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract3</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c4</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract4</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">iPlusPlus</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">plusPlusI</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">uncheckedPlusPlusI</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">.</span><span class=\"mtk11\">safeUncheckedPlusPlusI</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c4</span><span class=\"mtk1\">.</span><span class=\"mtk11\">inlineAssemblyLoop</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//loop with i++</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">iPlusPlus</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//loop with ++i</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">plusPlusI</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">; ++</span><span class=\"mtk12\">i</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//loop with unchecked{++i}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">uncheckedPlusPlusI</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">; ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">unchecked</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                ++</span><span class=\"mtk12\">i</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//loop with unchecked{++i} with additional overflow check</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">safeUncheckedPlusPlusI</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">; ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">unchecked</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                ++</span><span class=\"mtk12\">i</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">//check for overflow</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk11\">lt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">i</span><span class=\"mtk1\">, </span><span class=\"mtk7\">10</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;loop overflow&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">revert</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract4</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//loop with inline assembly</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">inlineAssemblyLoop</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> := </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">for</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> := </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            } </span><span class=\"mtk11\">lt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">i</span><span class=\"mtk1\">, </span><span class=\"mtk7\">10</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                i := </span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk12\">i</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x01</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            } {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                j := </span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk12\">j</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x01</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-1\" style=\"position:relative;\"><a href=\"#gas-report-1\" aria-label=\"gas report 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">37687</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">219</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">iPlusPlus</span><span class=\"mtk1\">          ┆ </span><span class=\"mtk7\">2039</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">2039</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">2039</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">2039</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">37287</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">217</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">plusPlusI</span><span class=\"mtk1\">          ┆ </span><span class=\"mtk7\">1989</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">1989</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1989</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">1989</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">     ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">        ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">42693</span><span class=\"mtk1\">                  ┆ </span><span class=\"mtk7\">244</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">          ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">safeUncheckedPlusPlusI</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1355</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">1355</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1355</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">1355</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">35887</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">210</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">uncheckedPlusPlusI</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1329</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">1329</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1329</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">1329</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract4</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">26881</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">164</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">inlineAssemblyLoop</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">709</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">709</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">709</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">709</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-1\" style=\"position:relative;\"><a href=\"#lines-1\" aria-label=\"lines 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<ul>\n<li>DNSSECImpl.sol:93</li>\n<li>ETHRegistrarController.sol:256</li>\n<li>BytesUtils.sol:266</li>\n<li>BytesUtils.sol:313</li>\n<li>ERC1155Fuse.sol:92</li>\n<li>ERC1155Fuse.sol:205</li>\n<li>StringUtils.sol:14</li>\n</ul>\n<h2 id=\"g-03-use-assembly-for-math-add-sub-mul-div\" style=\"position:relative;\"><a href=\"#g-03-use-assembly-for-math-add-sub-mul-div\" aria-label=\"g 03 use assembly for math add sub mul div permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-03] Use assembly for math (add, sub, mul, div)</h2>\n<p>Use assembly for math instead of Solidity. You can check for overflow/underflow in assembly to ensure safety. If using Solidity versions &#x3C; 0.8.0 and you are using Safemath, you can gain significant gas savings by using assembly to calculate values and checking for overflow/underflow.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"28\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract4</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c4</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract5</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c5</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract6</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c6</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract7</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c7</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract2</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract3</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c4</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract4</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c5</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract5</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c6</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract6</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c7</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract7</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">subTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">.</span><span class=\"mtk11\">subAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c4</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mulTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c5</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mulAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c6</span><span class=\"mtk1\">.</span><span class=\"mtk11\">divTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c7</span><span class=\"mtk1\">.</span><span class=\"mtk11\">divAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk7\">34598345</span><span class=\"mtk1\">, </span><span class=\"mtk7\">100</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//addition in Solidity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">addTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">a</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">b</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//addition in assembly</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">addAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> := </span><span class=\"mtk10\">add</span><span class=\"mtk1\">(</span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk11\">lt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">c</span><span class=\"mtk1\">, </span><span class=\"mtk12\">a</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;overflow&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">revert</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//subtraction in Solidity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">subTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">a</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">b</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//subtraction in assembly</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">subAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> := </span><span class=\"mtk10\">sub</span><span class=\"mtk1\">(</span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk11\">gt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">c</span><span class=\"mtk1\">, </span><span class=\"mtk12\">a</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;underflow&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">revert</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract4</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//multiplication in Solidity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mulTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">a</span><span class=\"mtk1\"> * </span><span class=\"mtk12\">b</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract5</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//multiplication in assembly</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mulAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> := </span><span class=\"mtk10\">mul</span><span class=\"mtk1\">(</span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk11\">lt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">c</span><span class=\"mtk1\">, </span><span class=\"mtk12\">a</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;overflow&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">revert</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract6</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//division in Solidity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">divTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">a</span><span class=\"mtk1\"> * </span><span class=\"mtk12\">b</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract7</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//division in assembly</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">divAssemblyTest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">b</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> := </span><span class=\"mtk10\">div</span><span class=\"mtk1\">(</span><span class=\"mtk12\">a</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk11\">gt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">c</span><span class=\"mtk1\">, </span><span class=\"mtk12\">a</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;underflow&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">revert</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-2\" style=\"position:relative;\"><a href=\"#gas-report-2\" aria-label=\"gas report 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"29\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">40493</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">233</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">addTest</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">303</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">303</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">303</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">303</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">37087</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">216</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">addAssemblyTest</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">40293</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">232</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">subTest</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">300</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">300</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">300</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">300</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">37287</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">217</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">subAssemblyTest</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">263</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract4</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">41893</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">240</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">mulTest</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract5</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">37087</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">216</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">mulAssemblyTest</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract6</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">41893</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">240</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">divTest</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">325</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract7</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">37287</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">217</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">divAssemblyTest</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">265</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-2\" style=\"position:relative;\"><a href=\"#lines-2\" aria-label=\"lines 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<p>For full list of line references, see warden’s <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176\">original submission</a>.</p>\n<h2 id=\"g-04-use-calldata-instead-of-memory-for-function-arguments-that-do-not-get-mutated\" style=\"position:relative;\"><a href=\"#g-04-use-calldata-instead-of-memory-for-function-arguments-that-do-not-get-mutated\" aria-label=\"g 04 use calldata instead of memory for function arguments that do not get mutated permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-04] Use <code>calldata</code> instead of <code>memory</code> for function arguments that do not get mutated.</h2>\n<p>Mark data types as <code>calldata</code> instead of <code>memory</code> where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as <code>calldata</code>. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies <code>memory</code> storage.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"30\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract2</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract3</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">arr</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">uint256</span><span class=\"mtk1\">[](</span><span class=\"mtk7\">10</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">calldataArray</span><span class=\"mtk1\">(</span><span class=\"mtk12\">arr</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">memoryArray</span><span class=\"mtk1\">(</span><span class=\"mtk12\">arr</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bytes</span><span class=\"mtk1\"> </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encode</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;someText&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">calldataBytes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">data</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">.</span><span class=\"mtk11\">memoryBytes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">data</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">calldataArray</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">calldata</span><span class=\"mtk1\"> </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">] + </span><span class=\"mtk7\">10</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">memoryArray</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">] + </span><span class=\"mtk7\">10</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">calldataBytes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes</span><span class=\"mtk1\"> </span><span class=\"mtk12\">calldata</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">val</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">val</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encode</span><span class=\"mtk1\">(</span><span class=\"mtk12\">data</span><span class=\"mtk1\">, </span><span class=\"mtk12\">i</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">memoryBytes</span><span class=\"mtk1\">(</span><span class=\"mtk12\">bytes</span><span class=\"mtk1\"> </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bytes32</span><span class=\"mtk1\"> </span><span class=\"mtk12\">val</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">val</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encode</span><span class=\"mtk1\">(</span><span class=\"mtk12\">data</span><span class=\"mtk1\">, </span><span class=\"mtk12\">i</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-3\" style=\"position:relative;\"><a href=\"#gas-report-3\" aria-label=\"gas report 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"31\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">97947</span><span class=\"mtk1\">                                     ┆ </span><span class=\"mtk7\">521</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">calldataArray</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk7\">2824</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">2824</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">2824</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">2824</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">128171</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">672</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">memoryArray</span><span class=\"mtk1\">                               ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">100547</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">534</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">calldataBytes</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk7\">4934</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">4934</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">4934</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">4934</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">135183</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">707</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">memoryBytes</span><span class=\"mtk1\">                               ┆ </span><span class=\"mtk7\">7551</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">7551</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">7551</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">7551</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-3\" style=\"position:relative;\"><a href=\"#lines-3\" aria-label=\"lines 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<p>For full list of line references, see warden’s <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176\">original submission</a>.</p>\n<h2 id=\"g-05-use-multiple-require-statements-instead-of-requireexpression--expression--\" style=\"position:relative;\"><a href=\"#g-05-use-multiple-require-statements-instead-of-requireexpression--expression--\" aria-label=\"g 05 use multiple require statements instead of requireexpression  expression   permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-05] Use multiple require() statements instead of require(expression &#x26;&#x26; expression &#x26;&#x26; …)</h2>\n<p>You can save gas by breaking up a require statement with multiple conditions, into multiple require statements with a single condition.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"32\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">singleRequire</span><span class=\"mtk1\">(</span><span class=\"mtk7\">3</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">multipleRequire</span><span class=\"mtk1\">(</span><span class=\"mtk7\">3</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">singleRequire</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">num</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">num</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">1</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">num</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">num</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">3</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">multipleRequire</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">num</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">num</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">1</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">num</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">10</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">num</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">3</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-4\" style=\"position:relative;\"><a href=\"#gas-report-4\" aria-label=\"gas report 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"33\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">35487</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">208</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">singleRequire</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk7\">286</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">286</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">286</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">286</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">35887</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">210</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">multipleRequire</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">270</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">270</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">270</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">270</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-4\" style=\"position:relative;\"><a href=\"#lines-4\" aria-label=\"lines 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<ul>\n<li>BytesUtils.sol:268</li>\n<li>ERC1155Fuse.sol:216</li>\n<li>ERC1155Fuse.sol:291</li>\n</ul>\n<h2 id=\"g-06-use-assembly-to-write-storage-values\" style=\"position:relative;\"><a href=\"#g-06-use-assembly-to-write-storage-values\" aria-label=\"g 06 use assembly to write storage values permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-06] Use assembly to write storage values</h2>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"34\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">updateOwner</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x158B28A1b1CB1BE12C6bD8f5a646a0e3B2024734</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">assemblyUpdateOwner</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x158B28A1b1CB1BE12C6bD8f5a646a0e3B2024734</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">owner</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0xb4c79daB8f259C7Aee6E5b2Aa729821864227e84</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">updateOwner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">owner</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">owner</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0xb4c79daB8f259C7Aee6E5b2Aa729821864227e84</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">assemblyUpdateOwner</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">sstore</span><span class=\"mtk1\">(</span><span class=\"mtk12\">owner</span><span class=\"mtk1\">.</span><span class=\"mtk12\">slot</span><span class=\"mtk1\">, </span><span class=\"mtk12\">newOwner</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-5\" style=\"position:relative;\"><a href=\"#gas-report-5\" aria-label=\"gas report 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"35\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">60623</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">261</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">updateOwner</span><span class=\"mtk1\">        ┆ </span><span class=\"mtk7\">5302</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">5302</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">5302</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">5302</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">54823</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">232</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">assemblyUpdateOwner</span><span class=\"mtk1\">┆ </span><span class=\"mtk7\">5236</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">5236</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">5236</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">5236</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-5\" style=\"position:relative;\"><a href=\"#lines-5\" aria-label=\"lines 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<ul>\n<li>Owned.sol:15</li>\n<li>Owned.sol:19</li>\n<li>ETHRegistrarController.sol:61</li>\n<li>ETHRegistrarController.sol:62</li>\n</ul>\n<h2 id=\"g-07-use-assembly-to-check-for-address0\" style=\"position:relative;\"><a href=\"#g-07-use-assembly-to-check-for-address0\" aria-label=\"g 07 use assembly to check for address0 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-07] Use assembly to check for address(0)</h2>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"36\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">ownerNotZero</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">assemblyOwnerNotZero</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ownerNotZero</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">_addr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">_addr</span><span class=\"mtk1\"> != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&quot;zero address)&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">assemblyOwnerNotZero</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">_addr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk11\">iszero</span><span class=\"mtk1\">(</span><span class=\"mtk12\">_addr</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;zero address&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk11\">revert</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-6\" style=\"position:relative;\"><a href=\"#gas-report-6\" aria-label=\"gas report 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"37\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">61311</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">338</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">ownerNotZero</span><span class=\"mtk1\">       ┆ </span><span class=\"mtk7\">258</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">258</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">258</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">258</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭──────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">   ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞══════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">44893</span><span class=\"mtk1\">                ┆ </span><span class=\"mtk7\">255</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">        ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">assemblyOwnerNotZero</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">252</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">252</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">252</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">252</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰──────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-6\" style=\"position:relative;\"><a href=\"#lines-6\" aria-label=\"lines 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<ul>\n<li>ReverseRegistrar.sol:53</li>\n<li>DNSSECImpl.sol:336</li>\n<li>ETHRegistrarController.sol:100</li>\n<li>NameWrapper.sol:132</li>\n<li>NameWrapper.sol:139</li>\n<li>NameWrapper.sol:318</li>\n<li>NameWrapper.sol:661</li>\n<li>NameWrapper.sol:763</li>\n<li>NameWrapper.sol:799</li>\n<li>NameWrapper.sol:911</li>\n<li>ERC1155Fuse.sol:61</li>\n<li>ERC1155Fuse.sol:176</li>\n<li>ERC1155Fuse.sol:199</li>\n<li>ERC1155Fuse.sol:248</li>\n<li>ERC1155Fuse.sol:249</li>\n</ul>\n<h2 id=\"g-08-use-assembly-when-getting-a-contracts-balance-of-eth\" style=\"position:relative;\"><a href=\"#g-08-use-assembly-when-getting-a-contracts-balance-of-eth\" aria-label=\"g 08 use assembly when getting a contracts balance of eth permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-08] Use assembly when getting a contract’s balance of ETH.</h2>\n<p>You can use <code>selfbalance()</code> instead of <code>address(this).balance</code> when getting your contract’s balance of ETH to save gas. Additionally, you can use <code>balance(address)</code> instead of <code>address.balance()</code> when getting an external contract’s balance of ETH.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"38\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract2</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract3</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addressInternalBalance</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">assemblyInternalBalance</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addressExternalBalance</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">.</span><span class=\"mtk11\">assemblyExternalBalance</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">addressInternalBalance</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">assemblyInternalBalance</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c</span><span class=\"mtk1\"> := </span><span class=\"mtk10\">selfbalance</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">mstore</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk12\">c</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0x00</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0x20</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">addressExternalBalance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">addr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">bal</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">addr</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bal</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">assemblyExternalBalance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">addr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">bal</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">assembly</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            bal := </span><span class=\"mtk11\">balance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">addr</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bal</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-7\" style=\"position:relative;\"><a href=\"#gas-report-7\" aria-label=\"gas report 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"39\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">     ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">        ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">23675</span><span class=\"mtk1\">                  ┆ </span><span class=\"mtk7\">147</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">          ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">addressInternalBalance</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">148</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">148</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">148</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">148</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭─────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">      ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">         ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">27081</span><span class=\"mtk1\">                   ┆ </span><span class=\"mtk7\">165</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">           ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">assemblyInternalBalance</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">133</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">133</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">133</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">133</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰─────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">     ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">        ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">61511</span><span class=\"mtk1\">                  ┆ </span><span class=\"mtk7\">339</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">          ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">addressExternalBalance</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">417</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">417</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">417</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">417</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭─────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\">      ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">         ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">57105</span><span class=\"mtk1\">                   ┆ </span><span class=\"mtk7\">317</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">           ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">assemblyExternalBalance</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">411</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">411</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">411</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">411</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰─────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-7\" style=\"position:relative;\"><a href=\"#lines-7\" aria-label=\"lines 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<ul>\n<li>ETHRegistrarController.sol:211</li>\n</ul>\n<h2 id=\"g-09-cache-array-length-during-for-loop-definition\" style=\"position:relative;\"><a href=\"#g-09-cache-array-length-during-for-loop-definition\" aria-label=\"g 09 cache array length during for loop definition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-09] Cache array length during for loop definition.</h2>\n<p>A typical for loop definition may look like: <code>for (uint256 i; i &#x3C; arr.length; i++){}</code>. Instead of using <code>array.length</code>, cache the array length before the loop, and use the cached value to safe gas. This will avoid an <code>MLOAD</code> every loop for arrays stored in memory and an <code>SLOAD</code> for arrays stored in storage. This can have significant gas savings for arrays with a large length, especially if the array is stored in storage.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"40\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract2</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract3</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">arr</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">uint256</span><span class=\"mtk1\">[](</span><span class=\"mtk7\">10</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">nonCachedMemoryListLength</span><span class=\"mtk1\">(</span><span class=\"mtk12\">arr</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">cachedMemoryListLength</span><span class=\"mtk1\">(</span><span class=\"mtk12\">arr</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">nonCachedStorageListLength</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c3</span><span class=\"mtk1\">.</span><span class=\"mtk11\">cachedStorageListLength</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">nonCachedMemoryListLength</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">] + </span><span class=\"mtk7\">10</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">cachedMemoryListLength</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">memory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">length</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">] + </span><span class=\"mtk7\">10</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">arr</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">uint256</span><span class=\"mtk1\">[](</span><span class=\"mtk7\">10</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">nonCachedStorageListLength</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">] + </span><span class=\"mtk7\">10</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">arr</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">uint256</span><span class=\"mtk1\">[](</span><span class=\"mtk7\">10</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">cachedStorageListLength</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">j</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">length</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">j</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">arr</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">] + </span><span class=\"mtk7\">10</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-8\" style=\"position:relative;\"><a href=\"#gas-report-8\" aria-label=\"gas report 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"41\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">128171</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">672</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">nonCachedMemoryListLength</span><span class=\"mtk1\">                 ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">3755</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">128777</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">675</span><span class=\"mtk1\">             ┆      ┆        ┆      ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">  ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">cachedMemoryListLength</span><span class=\"mtk1\">                    ┆ </span><span class=\"mtk7\">3733</span><span class=\"mtk1\">            ┆ </span><span class=\"mtk7\">3733</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">3733</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk7\">3733</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬───────┬────────┬───────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract2</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆       ┆        ┆       ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪═══════╪════════╪═══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆       ┆        ┆       ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">118474</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">539</span><span class=\"mtk1\">             ┆       ┆        ┆       ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">   ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">nonCachedStorageListLength</span><span class=\"mtk1\">                ┆ </span><span class=\"mtk7\">27979</span><span class=\"mtk1\">           ┆ </span><span class=\"mtk7\">27979</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">27979</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk7\">27979</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴───────┴────────┴───────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭───────────────────────────────────────────┬─────────────────┬───────┬────────┬───────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">src</span><span class=\"mtk1\">/</span><span class=\"mtk12\">test</span><span class=\"mtk1\">/</span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\">.</span><span class=\"mtk12\">t</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sol</span><span class=\"mtk1\">:</span><span class=\"mtk12\">Contract3</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆       ┆        ┆       ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞═══════════════════════════════════════════╪═════════════════╪═══════╪════════╪═══════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">                           ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆       ┆        ┆       ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">118674</span><span class=\"mtk1\">                                    ┆ </span><span class=\"mtk7\">540</span><span class=\"mtk1\">             ┆       ┆        ┆       ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">                             ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\">   ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\">   ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">cachedStorageListLength</span><span class=\"mtk1\">                   ┆ </span><span class=\"mtk7\">26984</span><span class=\"mtk1\">           ┆ </span><span class=\"mtk7\">26984</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">26984</span><span class=\"mtk1\">  ┆ </span><span class=\"mtk7\">26984</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰───────────────────────────────────────────┴─────────────────┴───────┴────────┴───────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-8\" style=\"position:relative;\"><a href=\"#lines-8\" aria-label=\"lines 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<ul>\n<li>DNSSECImpl.sol:93</li>\n<li>ETHRegistrarController.sol:256</li>\n<li>ERC1155Fuse.sol:92</li>\n<li>ERC1155Fuse.sol:205</li>\n<li>RRUtils.sol:310</li>\n</ul>\n<h2 id=\"g-10-consider-marking-functions-as-payable\" style=\"position:relative;\"><a href=\"#g-10-consider-marking-functions-as-payable\" aria-label=\"g 10 consider marking functions as payable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-10] Consider marking functions as payable</h2>\n<p>You can mark public or external functions as payable to save gas. Functions that are not payable have additional logic to check if there was a value sent with a call, however, making a function payable eliminates this check. This optimization should be carefully considered due to potentially unwanted behavior when a function does not need to accept ether.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"42\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isNotPayable</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isPayable</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">isNotPayable</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">val</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">val</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">isPayable</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">payable</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">val</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">val</span><span class=\"mtk1\">++;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-9\" style=\"position:relative;\"><a href=\"#gas-report-9\" aria-label=\"gas report 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"43\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">32081</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">190</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">isNotPayable</span><span class=\"mtk1\">       ┆ </span><span class=\"mtk7\">198</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">198</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">198</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">198</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">29681</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">178</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">isPayable</span><span class=\"mtk1\">          ┆ </span><span class=\"mtk7\">174</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">174</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">174</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">174</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-9\" style=\"position:relative;\"><a href=\"#lines-9\" aria-label=\"lines 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<p>For full list of line references, see warden’s <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176\">original submission</a>.</p>\n<h2 id=\"g-11-use-custom-errors-instead-of-string-error-messages\" style=\"position:relative;\"><a href=\"#g-11-use-custom-errors-instead-of-string-error-messages\" aria-label=\"g 11 use custom errors instead of string error messages permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-11] Use custom errors instead of string error messages</h2>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"44\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GasTest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">is</span><span class=\"mtk1\"> </span><span class=\"mtk12\">DSTest</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setUp</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Contract1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">testFailGas</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">stringErrorMessage</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">c1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">customErrorMessage</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">stringErrorMessage</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bool</span><span class=\"mtk1\"> </span><span class=\"mtk12\">check</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">check</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;error message&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">contract</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">error</span><span class=\"mtk1\"> </span><span class=\"mtk11\">CustomError</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">customErrorMessage</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">bool</span><span class=\"mtk1\"> </span><span class=\"mtk12\">check</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (!</span><span class=\"mtk12\">check</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">revert</span><span class=\"mtk1\"> </span><span class=\"mtk11\">CustomError</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"gas-report-10\" style=\"position:relative;\"><a href=\"#gas-report-10\" aria-label=\"gas report 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Report</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"js\" data-index=\"45\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract0</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">34087</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">200</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">stringErrorMessage</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">218</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">218</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">218</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">218</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Contract1</span><span class=\"mtk1\"> </span><span class=\"mtk12\">contract</span><span class=\"mtk1\"> ┆                 ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Cost</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk12\">Deployment</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Size</span><span class=\"mtk1\"> ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk7\">26881</span><span class=\"mtk1\">              ┆ </span><span class=\"mtk7\">164</span><span class=\"mtk1\">             ┆     ┆        ┆     ┆         │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk10\">Function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Name</span><span class=\"mtk1\">      ┆ </span><span class=\"mtk12\">min</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk12\">avg</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">median</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk12\">max</span><span class=\"mtk1\"> ┆ # </span><span class=\"mtk12\">calls</span><span class=\"mtk1\"> │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">│ </span><span class=\"mtk12\">customErrorMessage</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">161</span><span class=\"mtk1\">             ┆ </span><span class=\"mtk7\">161</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">161</span><span class=\"mtk1\">    ┆ </span><span class=\"mtk7\">161</span><span class=\"mtk1\"> ┆ </span><span class=\"mtk7\">1</span><span class=\"mtk1\">       │</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯</span></span></span></code></pre>\n<h3 id=\"lines-10\" style=\"position:relative;\"><a href=\"#lines-10\" aria-label=\"lines 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lines</h3>\n<p>For full list of line references, see warden’s <a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176\">original submission</a>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-07-ens-findings/issues/176#issuecomment-1200872608\">jefflau (ENS) commented</a>:</strong></p>\n<blockquote>\n<p>High quality submission with gas tables and reproduction.</p>\n</blockquote>\n<hr>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk10 { color: #4EC9B0; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li>\n<p><a href=\"#high-risk-findings-3\">High Risk Findings (3)</a></p>\n<ul>\n<li><a href=\"#h-01-it-is-possible-to-create-fake-erc1155-namewrapper-token-for-subdomain-which-is-not-owned-by-namewrapper\">[H-01] It is possible to create fake ERC1155 <code>NameWrapper</code> token for subdomain, which is not owned by <code>NameWrapper</code></a></li>\n<li><a href=\"#h-02-the-expiry-of-the-parent-node-can-be-smaller-than-the-one-of-a-child-node-violating-the-guarantee-policy\">[H-02] The expiry of the parent node can be smaller than the one of a child node, violating the guarantee policy</a></li>\n<li><a href=\"#h-03-parent_cannot_control-can-be-bypassed-by-maliciously-unwrapping-parent-node\">[H-03] <code>PARENT_CANNOT_CONTROL</code> can be bypassed by maliciously unwrapping parent node</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#medium-risk-findings-13\">Medium Risk Findings (13)</a></p>\n<ul>\n<li><a href=\"#m-01-wrapeth2ld-permissioning-is-over-extended\">[M-01] <code>wrapETH2LD</code> permissioning is over-extended</a></li>\n<li><a href=\"#m-02-renew-of-2nd-level-domain-is-not-done-properly\">[M-02] Renew of 2nd level domain is not done properly</a></li>\n<li><a href=\"#m-03-transfer-depends-on-gas-consts\">[M-03] <code>transfer()</code> depends on gas consts</a></li>\n<li><a href=\"#m-04-bytesutilcompare-returns-wrong-result-on-some-strings-longer-than-32-characters\">[M-04] <code>BytesUtil.compare</code> returns wrong result on some strings longer than 32 characters</a></li>\n<li><a href=\"#m-05-dnssecimplverifysignature-compares-strings-incorrectly-allowing-malicious-zones-to-forge-dnssec-trust-chain\">[M-05] <code>DNSSECImpl.verifySignature</code> compares strings incorrectly, allowing malicious zones to forge DNSSEC trust chain</a></li>\n<li><a href=\"#m-06-bytesutils-compare-will-not-revert-when-the-offset-and-len-exceeds-the-bytes-lengths\">[M-06] <code>BytesUtils</code>: compare will not revert when the <code>offset</code> and <code>len</code> exceeds the bytes lengths</a></li>\n<li><a href=\"#m-07-if-parent_cannot_control-is-set-on-subdomain-it-can-be-unwrapped-then-wrapped-by-its-owner-and-then-parent-can-control-it-again-before-the-expiry\">[M-07] If <code>PARENT_CANNOT_CONTROL</code> is set on subdomain, it can be unwrapped then wrapped by its owner and then parent can control it again before the expiry</a></li>\n<li><a href=\"#m-08-wrong-equals-logic\">[M-08] Wrong Equals Logic</a></li>\n<li><a href=\"#m-09-the-unwrapeth2ld-use-transferfrom-instead-of-safetransferfrom-to-transfer-erc721-token\">[M-09] The <code>unwrapETH2LD</code> use <code>transferFrom</code> instead of <code>safeTransferFrom</code> to transfer ERC721 token</a></li>\n<li><a href=\"#m-10-incorrect-implementation-of-rrutilsserialnumbergte\">[M-10] Incorrect implementation of <code>RRUtils.serialNumberGte</code></a></li>\n<li><a href=\"#m-11-the-preimage-db-ie-namewrappernames-can-be-maliciously-manipulatedcorrupted\">[M-11] The preimage DB (i.e., <code>NameWrapper.names</code>) can be maliciously manipulated/corrupted</a></li>\n<li><a href=\"#m-12-erc1155fuse-_transfer-does-not-revert-when-sent-to-the-old-owner\">[M-12] <code>ERC1155Fuse</code>: <code>_transfer</code> does not revert when sent to the old owner</a></li>\n<li><a href=\"#m-13-users-can-create-extra-ens-records-at-no-cost\">[M-13] Users can create extra ENS records at no cost</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#low-risk-and-non-critical-issues\">Low Risk and Non-Critical Issues</a></p>\n<ul>\n<li><a href=\"#low-risk-issues-summary\">Low Risk Issues Summary</a></li>\n<li><a href=\"#non-critical-issues-summary\">Non-critical Issues Summary</a></li>\n<li><a href=\"#l01-require-should-be-used-instead-of-assert\">L‑01 <code>require()</code> should be used instead of <code>assert()</code></a></li>\n<li><a href=\"#l02-missing-checks-for-address0x0-when-assigning-values-to-address-state-variables\">L‑02 Missing checks for <code>address(0x0)</code> when assigning values to <code>address</code> state variables</a></li>\n<li><a href=\"#l03-open-todos\">L‑03 Open TODOs</a></li>\n<li><a href=\"#l-04-file-is-missing-natspec\">L-04 File is missing NatSpec</a></li>\n<li><a href=\"#l-05-natspec-is-incomplete\">L-05 NatSpec is incomplete</a></li>\n<li><a href=\"#n01-name-validation-is-not-strictly-valid\">N‑01 Name validation is not strictly valid</a></li>\n<li><a href=\"#n02-adding-a-return-statement-when-the-function-defines-a-named-return-variable-is-redundant\">N‑02 Adding a <code>return</code> statement when the function defines a named return variable, is redundant</a></li>\n<li><a href=\"#n03-requirerevert-statements-should-have-descriptive-reason-strings\">N‑03 <code>require()</code>/<code>revert()</code> statements should have descriptive reason strings</a></li>\n<li><a href=\"#n04-public-functions-not-called-by-the-contract-should-be-declared-external-instead\">N‑04 <code>public</code> functions not called by the contract should be declared <code>external</code> instead</a></li>\n<li><a href=\"#n05--constants-should-be-defined-rather-than-using-magic-numbers\">N‑05  <code>constant</code>s should be defined rather than using magic numbers</a></li>\n<li><a href=\"#n06-redundant-cast\">N‑06 Redundant cast</a></li>\n<li><a href=\"#n07-missing-event-and-or-timelock-for-critical-parameter-change\">N‑07 Missing event and or timelock for critical parameter change</a></li>\n<li><a href=\"#n08-file-is-missing-version-pragma\">N‑08 File is missing version pragma</a></li>\n<li><a href=\"#n09-use-a-more-recent-version-of-solidity\">N‑09 Use a more recent version of solidity</a></li>\n<li><a href=\"#n10-pragma-experimental-abiencoderv2-is-deprecated\">N‑10 <code>pragma experimental ABIEncoderV2</code> is deprecated</a></li>\n<li><a href=\"#n11-constant-redefined-elsewhere\">N‑11 Constant redefined elsewhere</a></li>\n<li><a href=\"#n12-inconsistent-spacing-in-comments\">N‑12 Inconsistent spacing in comments</a></li>\n<li><a href=\"#n13-lines-are-too-long\">N‑13 Lines are too long</a></li>\n<li><a href=\"#n14-inconsistent-method-of-specifying-a-floating-pragma\">N‑14 Inconsistent method of specifying a floating pragma</a></li>\n<li><a href=\"#n15-non-libraryinterface-files-should-use-fixed-compiler-versions-not-floating-ones\">N‑15 Non-library/interface files should use fixed compiler versions, not floating ones</a></li>\n<li><a href=\"#n16-typos\">N‑16 Typos</a></li>\n<li><a href=\"#n17-file-does-not-contain-an-spdx-identifier\">N‑17 File does not contain an SPDX Identifier</a></li>\n<li><a href=\"#n18-event-is-missing-indexed-fields\">N‑18 Event is missing <code>indexed</code> fields</a></li>\n<li><a href=\"#n19-not-using-the-named-return-variables-anywhere-in-the-function-is-confusing\">N‑19 Not using the named return variables anywhere in the function is confusing</a></li>\n<li><a href=\"#n20-duplicated-requirerevert-checks-should-be-refactored-to-a-modifier-or-function\">N‑20 Duplicated <code>require()</code>/<code>revert()</code> checks should be refactored to a modifier or function</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#gas-optimizations\">Gas Optimizations</a></p>\n<ul>\n<li><a href=\"#gas-optimizations-summary\">Gas Optimizations Summary</a></li>\n<li><a href=\"#g-01-use-assembly-to-hash-instead-of-solidity\">G-01 Use assembly to hash instead of Solidity</a></li>\n<li><a href=\"#g-02-uncheckedi-instead-of-i-or-use-assembly-when-applicable\">G-02 <code>unchecked{++i}</code> instead of <code>i++</code> (or use assembly when applicable)</a></li>\n<li><a href=\"#g-03-use-assembly-for-math-add-sub-mul-div\">G-03 Use assembly for math (add, sub, mul, div)</a></li>\n<li><a href=\"#g-04-use-calldata-instead-of-memory-for-function-arguments-that-do-not-get-mutated\">G-04 Use <code>calldata</code> instead of <code>memory</code> for function arguments that do not get mutated.</a></li>\n<li><a href=\"#g-05-use-multiple-require-statements-instead-of-requireexpression--expression--\">G-05 Use multiple require() statements instead of require(expression &#x26;&#x26; expression &#x26;&#x26; …)</a></li>\n<li><a href=\"#g-06-use-assembly-to-write-storage-values\">G-06 Use assembly to write storage values</a></li>\n<li><a href=\"#g-07-use-assembly-to-check-for-address0\">G-07 Use assembly to check for address(0)</a></li>\n<li><a href=\"#g-08-use-assembly-when-getting-a-contracts-balance-of-eth\">G-08 Use assembly when getting a contract’s balance of ETH.</a></li>\n<li><a href=\"#g-09-cache-array-length-during-for-loop-definition\">G-09 Cache array length during for loop definition.</a></li>\n<li><a href=\"#g-10-consider-marking-functions-as-payable\">G-10 Consider marking functions as payable</a></li>\n<li><a href=\"#g-11-use-custom-errors-instead-of-string-error-messages\">G-11 Use custom errors instead of string error messages</a></li>\n</ul>\n</li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>",
  "md": "\n# Overview\n\n## About C4\n\nCode4rena (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.\n\nA C4 audit contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\n\nDuring the audit contest outlined in this document, C4 conducted an analysis of the ENS smart contract system written in Solidity. The audit contest took place between July 12—July 19 2022.\n\n## Wardens\n\n107 Wardens contributed reports to the ENS contest:\n\n  1. PwnedNoMore ([izhuer](https://www.cs.purdue.edu/homes/zhan3299/index.html), ItsNio, papr1ka2, and [wen](https://twitter.com/0xtarafans))\n  1. zzzitron\n  1. [panprog](https://www.linkedin.com/in/pavel-anokhin/)\n  1. GimelSec ([rayn](https://twitter.com/rayn731) and sces60107)\n  1. 0x52\n  1. alan724\n  1. [csanuragjain](https://twitter.com/csanuragjain)\n  1. 0x1f8b\n  1. [wastewa](https://twitter.com/WahWaste)\n  1. Aussie\\_Battlers ([sseefried](http://seanseefried.org/blog) and [oyc\\_109](https://twitter.com/andyfeili))\n  1. brgltd\n  1. cryptphi\n  1. peritoflores\n  1. cccz\n  1. Lambda\n  1. IllIllI\n  1. [Dravee](https://twitter.com/BowTiedDravee)\n  1. [bin2chen](https://twitter.com/bin2chen)\n  1. 0x29A (0x4non and rotcivegaf)\n  1. Limbooo\n  1. ronnyx2017\n  1. [joestakey](https://twitter.com/JoeStakey)\n  1. rbserver\n  1. [0xKitsune](https://github.com/0xKitsune)\n  1. [benbaessler](https://benbaessler.com)\n  1. [Sm4rty](https://twitter.com/Sm4rty_)\n  1. [berndartmueller](https://twitter.com/berndartmueller)\n  1. Bnke0x0\n  1. [Deivitto](https://twitter.com/Deivitto)\n  1. RedOneN\n  1. CRYP70\n  1. [gogo](https://www.linkedin.com/in/georgi-nikolaev-georgiev-978253219)\n  1. Amithuddar\n  1. hake\n  1. [TomJ](https://mobile.twitter.com/tomj_bb)\n  1. [MiloTruck](https://milotruck.github.io/)\n  1. Rolezn\n  1. [c3phas](https://twitter.com/c3ph_)\n  1. [Ruhum](https://twitter.com/0xruhum)\n  1. [Ch\\_301](https://twitter.com/0xch301)\n  1. \\_Adam\n  1. [hyh](https://twitter.com/0xhyh)\n  1. \\_\\_141345\\_\\_\n  1. asutorufos\n  1. [fatherOfBlocks](https://twitter.com/father0fBl0cks)\n  1. 0xNineDec\n  1. [rajatbeladiya](https://twitter.com/rajat_beladiya)\n  1. [0xNazgul](https://twitter.com/0xNazgul)\n  1. robee\n  1. sashik\\_eth\n  1. [Funen](https://instagram.com/vanensurya)\n  1. kyteg\n  1. Waze\n  1. [JC](https://twitter.com/sm4rtcontr4ct)\n  1. JohnSmith\n  1. [Rohan16](https://twitter.com/ROHANJH56009256)\n  1. bulej93\n  1. cRat1st0s\n  1. [rokinot](twitter.com/rokinot)\n  1. delfin454000\n  1. [8olidity](https://twitter.com/8olidity)\n  1. sach1r0\n  1. ReyAdmirado\n  1. zuhaibmohd\n  1. lcfr\\_eth\n  1. simon135\n  1. [seyni](https://twitter.com/seynixyz)\n  1. cryptonue\n  1. [ElKu](https://twitter.com/ElKu_crypto)\n  1. dxdv\n  1. pashov\n  1. 0xf15ers (remora and twojoy)\n  1. p\\_crypt0\n  1. Critical\n  1. pedr02b2\n  1. [philogy](https://twitter.com/real_philogy)\n  1. 0xDjango\n  1. rishabh\n  1. [svskaushik](https://twitter.com/svs_kaushik)\n  1. RustyRabbit\n  1. minhtrng\n  1. [exd0tpy](https://github.com/exd0tpy)\n  1. [m\\_Rassska](https://t.me/Road220)\n  1. [durianSausage](https://github.com/lyciumlee)\n  1. ajtra\n  1. [Tomio](https://twitter.com/meidhiwirara)\n  1. 0x040\n  1. 0xsam\n  1. [Aymen0909](https://github.com/Aymen1001)\n  1. [Fitraldys](https://twitter.com/fitraldys)\n  1. lucacez\n  1. Noah3o6\n  1. samruna\n  1. arcoun\n  1. karanctf\n  1. sahar\n  1. ak1\n  1. [Chom](https://chom.dev)\n  1. Jujic\n  1. scaraven\n\nThis contest was judged by [LSDan](https://twitter.com/lsdan_defi).\n\nFinal report assembled by [liveactionllama](https://twitter.com/liveactionllama).\n\n# Summary\n\nThe C4 analysis yielded an aggregated total of 16 unique vulnerabilities. Of these vulnerabilities, 3 received a risk rating in the category of HIGH severity and 13 received a risk rating in the category of MEDIUM severity.\n\nAdditionally, C4 analysis included 71 reports detailing issues with a risk rating of LOW severity or non-critical. There were also 70 reports recommending gas optimizations.\n\nAll of the issues presented here are linked back to their original finding.\n\n# Scope\n\nThe code under review can be found within the [C4 ENS contest repository](https://github.com/code-423n4/2022-07-ens), and is composed of 23 smart contracts written in the Solidity programming language and includes 2,132 lines of Solidity code.\n\n# Severity Criteria\n\nC4 assesses the severity of disclosed vulnerabilities according to a methodology based on [OWASP standards](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).\n\nVulnerabilities are divided into three primary risk categories: high, medium, and low/non-critical.\n\nHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\n\n- Malicious Input Handling\n- Escalation of privileges\n- Arithmetic\n- Gas use\n\nFurther information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on [the C4 website](https://code4rena.com).\n\n# High Risk Findings (3)\n## [[H-01] It is possible to create fake ERC1155 `NameWrapper` token for subdomain, which is not owned by `NameWrapper`](https://github.com/code-423n4/2022-07-ens-findings/issues/84)\n*Submitted by panprog, also found by Aussie\\_Battlers, brgltd, cryptphi, peritoflores, and wastewa*\n\n[NameWrapper.sol#L820-L821](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L820-L821)<br>\n[NameWrapper.sol#L524](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L524)<br>\n[NameWrapper.sol#L572](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L572)<br>\n\nDue to re-entrancy possibility in `NameWrapper._transferAndBurnFuses` (called from `setSubnodeOwner` and `setSubnodeRecord`), it is possible to do some stuff in `onERC1155Received` right after transfer but before new owner and new fuses are set. This makes it possible, for example, to unwrap the subdomain, but owner and fuses will still be set even for unwrapped domain, creating fake `ERC1155` `NameWrapper` token for domain, which is not owned by `NameWrapper`.\n\nFake token creation scenario:\n\n1.  `Account1` registers and wraps `test.eth` domain\n2.  `Account1` calls `NameWrapper.setSubnodeOwner` for `sub.test.eth` subdomain with `Account1` as owner (to make NameWrapper owner of subdomain)\n3.  `Contract1` smart contract is created, which calls unwrap in its `onERC1155Received` function, and a function to send `sub.test.eth` ERC1155 NameWrapper token back to `Account1`\n4.  `Account1` calls `NameWrapper.setSubnodeOwner` for `sub.test.eth` with `Contract1` as new owner, which unwraps domain back to `Account1` but due to re-entrancy, NameWrapper sets fuses and ownership to `Contract1`\n5.  `Account1` calls function to send ERC1155 token from `Contract1` back to self.\n\nAfter this sequence of events, `sub.test.eth` subdomain is owned by `Account1` both in `ENS` registry and in `NameWrapper` (with fuses and expiry correctly set to the future date). Lots (but not all) of functions in `NameWrapper` will fail to execute for this subdomain, because they expect `NameWrapper` to have ownership of the domain in `ENS`, but some functions will still work, making it possible to make the impression of good domain.\n\nAt this point, ownership in `NameWrapper` is \"detached\" from ownership in `ENS` and `Account1` can do all kinds of malcious stuff with its ERC1155 token. For example:\n\n1.  Sell subdomain to the other user, transfering `ERC1155` to that user and burning `PARENT_CANNOT_CONTROL` to create impression that he can't control the domain. After receiving the payment, `Account1` can wrap the domain again, which burns existing ownership record and replaces with the new one with clear fuses and `Account1` ownership, effectively stealing domain back from unsuspecting user, who thought that `ERC1155` gives him the right to the domain (and didn't expect that parent can clear fuses when `PARENT_CANNOT_CONTROL` is set).\n\n2.  Transfer subdomain to some other smart contract, which implements `onERC1155Received`, then take it back, fooling smart contract into believing that it has received the domain.\n\n### Proof of Concept\n\nCopy these to test/wrapper and run:<br>\nyarn test test/wrapper/NameWrapperReentrancy.js\n\n<https://gist.github.com/panprog/3cd94e3fbb0c52410a4c6609e55b863e>\n\n### Recommended Mitigation Steps\n\nConsider adding `nonReentrant` modifiers with `ReentrancyGuard` implementation from `openzeppelin`. Alternatively just fix this individual re-entrancy issue. There are multiple ways to fix it depending on expected behaviour, for example saving `ERC1155` data and requiring it to match the data after transfer (restricting `onERC1155Received` to not change any data for the token received):\n\n    function _transferAndBurnFuses(\n        bytes32 node,\n        address newOwner,\n        uint32 fuses,\n        uint64 expiry\n    ) internal {\n        (address owner, uint32 saveFuses, uint64 saveExpiry) = getData(uint256(node));\n        _transfer(owner, newOwner, uint256(node), 1, \"\");\n        uint32 curFuses;\n        uint64 curExpiry;\n        (owner, curFuses, curExpiry) = getData(uint256(node));\n        require(owner == newOwner && saveFuses == curFuses && saveExpiry == curExpiry);\n        _setFuses(node, newOwner, fuses, expiry);\n    }\n\n**[Arachnid (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/84)**\n\n\n\n***\n\n## [[H-02] The expiry of the parent node can be smaller than the one of a child node, violating the guarantee policy](https://github.com/code-423n4/2022-07-ens-findings/issues/187)\n*Submitted by PwnedNoMore*\n\n[NameWrapper.sol#L504](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L504)<br>\n[NameWrapper.sol#L356](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L356)<br>\n\nBy design, the child node's expiry can only be extended up to the parent's current one. Adding these restrictions means that the ENS users only have to look at the name itself's fuses and expiry (without traversing the hierarchy) to understand what guarantees the users have.\n\nWhen a parent node tries to `setSubnodeOwner` / `setSubnodeRecord`, the following code is used to guarantee that the new expiry can only be extended up to the current one.\n\n```solidity\nfunction _getDataAndNormaliseExpiry(\n    bytes32 parentNode,\n    bytes32 node,\n    uint64 expiry\n)\n    internal\n    view\n    returns (\n        address owner,\n        uint32 fuses,\n        uint64\n    )\n{\n    uint64 oldExpiry;\n    (owner, fuses, oldExpiry) = getData(uint256(node));\n    (, , uint64 maxExpiry) = getData(uint256(parentNode));\n    expiry = _normaliseExpiry(expiry, oldExpiry, maxExpiry);\n    return (owner, fuses, expiry);\n}\n```\n\nHowever, the problem shows when\n\n*   The sub-domain (e.g., `sub1.base.eth`) has its own sub-sub-domain (e.g., `sub2.sub1.base.eth`)\n*   The sub-domain is unwrapped later, and thus its `oldExpiry` becomes zero.\n*   When `base.eth` calls `NameWrapper.setSubnodeOwner`, there is not constraint of `sub1.base.eth`'s expiry, since `oldExpiry == 0`. As a result, the new expiry of `sub1.base.eth` can be arbitrary and smaller than the one of `sub2.sub1.base.eth`\n\nThe point here is that the `oldExpiry` will be set as 0 when unwrapping the node even it holds child nodes, relaxing the constraint.\n\nSpecifically, considering the following scenario\n\n*   The hacker owns a domain (or a 2LD), e.g., `base.eth`\n*   The hacker assigns a sub-domain to himself, e.g., `sub1.base.eth`\n    *   The expiry should be as large as possible\n*   Hacker assigns a sub-sub-domain, e.g., `sub2.sub1.base.eth`\n    *   The expiry should be as large as possible\n*   The hacker unwraps his sub-domain, i.e., `sub1.base.eth`\n*   The hacker re-wraps his sub-domain via `NameWrapper.setSubnodeOwner`\n    *   The expiry can be small than the one of sub2.sub1.base.eth\n\nThe root cause *seems* that we should not zero out the expiry when burning a node if the node holds any subnode.\n\n### Suggested Fix\n\n*   Potential fix 1: auto-burn `CANNOT_UNWRAP` which thus lets `expiry` decide whether a node can be unwrapped.\n*   Potential fix 2: force the parent to have `CANNOT_UNWRAP` burnt if they want to set expiries on a child via `setSubnodeOwner` / `setSubnodeRecord` / `setChildFuses`\n\n### Proof of Concept / Attack Scenario\n\nFor full details, please see [original warden submission](https://github.com/code-423n4/2022-07-ens-findings/issues/187).\n\n**[Arachnid (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/187)**\n\n\n\n***\n\n## [[H-03] `PARENT_CANNOT_CONTROL` can be bypassed by maliciously unwrapping parent node](https://github.com/code-423n4/2022-07-ens-findings/issues/173)\n*Submitted by PwnedNoMore, also found by panprog, and zzzitron*\n\n[NameWrapper.sol#L356](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L356)<br>\n[NameWrapper.sol#L295](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L295)<br>\n[ENSRegistry.sol#L74](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/registry/ENSRegistry.sol#L74)<br>\n\nBy design, for any subdomain, as long as its `PARENT_CANNOT_CONTROL` fuse is burnt (and does not expire), its parent should not be able to burn its fuses or change its owner.\n\nHowever, this contraint can be bypassed by a parent node maliciously unwrapping itself. As long as the hacker becomes the ENS owner of the parent node, he can leverage `ENSRegistry::setSubnodeOwner` to re-set himself as the ENS owner of the subdomain, and thus re-invoking `NameWrapper.wrap` can rewrite the fuses and wrapper owner of the given subdoamin.\n\nConsidering the following attack scenario:\n\n*   Someone owns a domain (or a 2LD), e.g., *poc.eth*\n*   The domain owner assigns a sub-domain to the hacker, e.g., *hack.poc.eth*\n    *   This sub-domain should not burn `CANNOT_UNWRAP`\n    *   This sub-domain can burn `PARENT_CANNOT_CONTROL`\n*   Hacker assigns a sub-sub-domain to a victim user, e.g., *victim.hack.poc.eth*\n*   The victim user burns arbitrary fuses, including `PARENT_CANNOT_CONTROL`\n    *   The hacker should not be able to change the owner and the fuses of `victim.hack.poc.eth` ideally\n*   However, the hacker then unwraps his sub-domain, i.e., *hack.poc.eth*\n*   The hacker invokes `ENSRegistry::setSubnodeOwner(hacker.poc.eth, victim)` on the sub-sub-domain\n    *   He can reassign himself as the owner of the *victim.hack.poc.eth*\n*   The hacker invokes `NameWrapper.wrap(victim.hacker.poc.eth)` to over-write the fuses and owner of the sub-sub-domain, i.e., *victim.hacker.poc.eth*\n\nThe root cause here is that, for any node, when one of its subdomains burns `PARENT_CANNOT_CONTROL`, the node itself fails to burn `CANNOT_UNWRAP`. Theoretically, this should check to the root, which however is very gas-consuming.\n\n### Suggested Fix\n\n*   Potential fix 1: auto-burn `CANNOT_UNWRAP` which thus lets `expiry` decide whether a node can be unwrapped.\n*   Potential fix 2: leave fuses as is when unwrapping and re-wrapping, unless name expires. Meanwhile, check the old fuses even wrapping.\n\n### Proof of Concept / Attack Scenario\n\nFor full details, please see [original warden submission](https://github.com/code-423n4/2022-07-ens-findings/issues/173).\n\n**[Arachnid (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/173)**\n\n\n\n***\n\n \n# Medium Risk Findings (13)\n## [[M-01] `wrapETH2LD` permissioning is over-extended](https://github.com/code-423n4/2022-07-ens-findings/issues/51)\n*Submitted by 0x52*\n\nUndesired use of ENS wrapper.\n\n### Proof of Concept\n\n[NameWrapper.sol#L219-L223](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L219-L223)<br>\n\nCurrent permissioning for wrapETH2LD allows msg.senders who are not owner to call it if they are EITHER approved for all on the ERC721 registrar or approved on the wrapper. Allowing users who are approved for the ERC721 registrar makes sense. By giving them approval, you are giving them approval to do what they wish with the token. Any other restrictions are moot regardless because they could use approval to transfer themselves the token anyways and bypass them as the new owner. The issue is allowing users who are approved for the wrapper contract to wrap the underlying domain. By giving approval to the contract the user should only be giving approval for the wrapped domains. As it is currently setup, once a user has given approval on the wrapper contract they have essentially given approval for every domain, wrapped or unwrapped, because any unwrapped domain can be wrapped and taken control of. This is an over-extension of approval which should be limited to the tokens managed by the wrapper contract and not extend to unwrapped domains\n\n### Recommended Mitigation Steps\n\nRemove L221.\n\n**[Arachnid (ENS) disagreed with severity and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/51#issuecomment-1196225256):**\n > This was by design, but the warden raises a good point about the implications of this permission model. Recommend downgrading to QA.\n\n**[LSDan (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/51#issuecomment-1203751996):**\n > I'm going to downgrade this to medium. There are not assets at direct risk, but with external factors the assets could be at risk due to the user being unaware that in approving wrapped domains, they are also approving unwrapped domains.\n\n\n\n***\n\n## [[M-02] Renew of 2nd level domain is not done properly](https://github.com/code-423n4/2022-07-ens-findings/issues/63)\n*Submitted by csanuragjain, also found by cccz and GimelSec*\n\n[ETHRegistrarController.sol#L201](https://github.com/code-423n4/2022-07-ens/blob/main/contracts/ethregistrar/ETHRegistrarController.sol#L201)<br>\n[NameWrapper.sol#L271](https://github.com/ensdomains/ens-contracts/blob/master/contracts/wrapper/NameWrapper.sol#L271)<br>\n\nThe ETHRegistrarController is calling renew from base registrar and not through Namewrapper. This means the fuses for the subdomain will not be updated via [\\_setData](https://github.com/code-423n4/2022-07-ens/blob/main/contracts/wrapper/NameWrapper.sol#L284). This impacts the permission model set over subdomain and could lead to takeover\n\n### Proof of Concept\n\n1.  Observe the [renew](https://github.com/code-423n4/2022-07-ens/blob/main/contracts/ethregistrar/ETHRegistrarController.sol#L189) function\n\n<!---->\n\n    function renew(string calldata name, uint256 duration)\n            external\n            payable\n            override\n        {\n            ...\n\n            uint256 expires = base.renew(uint256(label), duration);\n\n            ....\n        }\n\n2.  As we can see this is calling renew function of Base Registrar instead of NameWrapper. Since this is not going via NameWrapper fuses will not be set\n\n3.  Also since renew in NameWrapper can only be called via Controller which is ETHRegistrarController so there is no way to renew subdomain\n\n### Recommended Mitigation Steps\n\nThe ETHRegistrarController must renew using Namewrapper's renew contract.\n\n**[Arachnid (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/63#issuecomment-1196218068):**\n > Duplicate of [#223](https://github.com/code-423n4/2022-07-ens-findings/issues/223).\n\n**[LSDan (judge) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/63#issuecomment-1203797392):**\n > On [#223](https://github.com/code-423n4/2022-07-ens-findings/issues/223), which I've invalidated, @Arachnid notes that:\n> > In fact, this should only be severity QA, as it can be worked around by calling `renew` on the registrar controller followed by `setChildFuses`.\n> \n> I'm going to make this report the main one and leave the risk rating of Medium in place. While there is a workaround, if the workaround is not employed, permissions will be incorrect and may lead to a breakdown in the functioning of the protocol. \n\n\n\n***\n\n## [[M-03] `transfer()` depends on gas consts](https://github.com/code-423n4/2022-07-ens-findings/issues/133)\n*Submitted by rajatbeladiya, also found by \\_\\_141345\\_\\_, \\_Adam, 0x29A, 0xNineDec, alan724, Amithuddar, asutorufos, Aussie\\_Battlers, berndartmueller, c3phas, cccz, Ch\\_301, cryptphi, csanuragjain, Dravee, durianSausage, fatherOfBlocks, GimelSec, hake, hyh, IllIllI, Jujic, Limbooo, pashov, RedOneN, Ruhum, scaraven, TomJ, and zzzitron*\n\n[ETHRegistrarController.sol#L183-L185](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L183-L185)<br>\n[ETHRegistrarController.sol#L204](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L204)<br>\n\n`transfer()` forwards 2300 gas only, which may not be enough in future if the recipient is a contract and gas costs change. it could break existing contracts functionality.\n\n### Proof of Concept\n\n`.transfer` or `.send` method, only 2300 gas will be “forwarded” to fallback function. Specifically, the SLOAD instruction, will go from costing 200 gas to 800 gas.\n\nIf any smart contract has a functionality of register ens and it has fallback function which is making some state change in contract on ether receive, it could use more than 2300 gas and revert every transaction.\n\nFor reference, check out:\n* <https://docs.soliditylang.org/en/v0.8.15/security-considerations.html?highlight=transfer#sending-and-receiving-ether>\n* <https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/>\n\n### Recommended Mitigation Steps\n\nUse `.call` insted `.transfer`\n\n     (bool success, ) = msg.sender.call.value(amount)(\"\");\n     require(success, \"Transfer failed.\");\n\n**[jefflau (ENS) confirmed, but disagreed with severity and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1196371402):**\n > Recommend reducing severity to QA\n\n**[LSDan (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1203817454):**\n > I'm downgrading this to Medium. There are external factors required to make this problem occur, but if it does the functionality of the protocol as a whole could be severely impacted.\n\n**[Arachnid (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1206025827):**\n > It's unclear to me how this could be a significant issue. Anyone writing code to register names knows that any excess funds will be returned, and therefore that they need a fallback that consumes minimal gas. Any EVM change that increases the gas of fallback functions would be breaking for a great number of contracts beyond ENS.\n\n**[LSDan (judge) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1208062192):**\n > > It's unclear to me how this could be a significant issue.\n> \n> The register functions will fail, consuming a good bit of gas along the way if this occurs. If this were not such a critical piece of functionality I would have considered it QA, but a failure here breaks the protocol.\n> \n> > Anyone writing code to register names knows that any excess funds will be returned, and therefore that they need a fallback that consumes minimal gas. Any EVM change that increases the gas of fallback functions would be breaking for a great number of contracts beyond ENS.\n> \n> The fact that other contracts will break along with ENS does not invalidate the issue. This is a clearly documented problem that has been known for years (see ref links). There is no reason to introduce more critical contracts to the ecosystem that will fail in this scenario, particularly when it is so easy to avoid.\n\n**[Arachnid (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/133#issuecomment-1214550653):**\n > > The register functions will fail, consuming a good bit of gas along the way if this occurs. If this were not such a critical piece of functionality I would have considered it QA, but a failure here breaks the protocol.\n> \n> I think the implied API here is that any contract registering names with the controller must either send the right amount of ether, or have a fallback function that can accept ether. Changes to the consensus layer that invalidate that assumption for a given contract are out-of-scope for ENS.\n> \n> Sending all remaining gas with the refund increases the threat surface by allowing possible reentrancy etc, which we haven't examined as a threat model here.\n\n\n\n***\n\n## [[M-04] `BytesUtil.compare` returns wrong result on some strings longer than 32 characters](https://github.com/code-423n4/2022-07-ens-findings/issues/78)\n*Submitted by panprog, also found by alan724 and GimelSec*\n\n[BytesUtils.sol#L66-L70](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L66-L70)<br>\n\nDue to incorrect condition in `ByteUtil.compare` function, irrelevant characters are masked out only for strings shorter than `32` characters. However, they must be masked out for strings of all lengths in the last pass of the loop (when remainder of the string is 32 characters or less). This leads to incorrect comparision of strings longer than `32` characters where `len` or `otherlen` is smaller than string length (characters beyond provided length are still accounted for in the comparision in this case while they should be ignored).\n\nThis wrong `compare` behaviour also makes `RRUtils.compareNames` fail to correctly compare DNS names in certain cases.\n\nWhile the `BytesUtil.compare` and `RRUtils.compareNames` methods are currently not used in the functions in the scope (but are used in mainnet's `DNSSECImpl.checkNsecName`, which is out of scope here), they're public library functions relied upon and can be used by the other users or the ENS project in the future. And since the functions in scope provide incorrect result, that's a wrong (unexpected) behaviour of the smart contract. Moreover, since the problem can be seen only with the large strings (more than `32` characters), this might go unnoticed with any code that uses `compare` or `compareNames` method and can potentially lead to high security risk of any integration project or ENS itself.\n\nExample strings to compare which give incorrect result:\n`01234567890123450123456789012345ab`\n`01234567890123450123456789012345aa`\n\nEach string is `34` characters long, first `33` characters are the same, the last one is different. If we compare first `33` characters of both strings, the result should be `equal` (as they only differ in the 34th character), but `compare` will return `>`, because it fails to ignore the last character of both strings and simply compares strings themselves.\n\nIf we compare the first `33` characters from the first string vs all `34` characters of the second string, the result of `compare` will be `>`, while the correct result is `<`, because `compare` fails to ignore the last character of the first string.\n\nExample dns names to compare which give incorrect result:<br>\n`01234567890123456789012345678901a0.0123456789012345678901234567890123456789012345678.eth`<br>\n`01234567890123456789012345678901a.0123456789012345678901234567890123456789012345678.eth`<br>\n\nThe first dns name should come after the second, but `dnsCompare` returns `-1` (the first name to come before), because the length of the 2nd domain (49 characters) is ASCII character `1` and is not correctly masked off during strings comparision.\n\n### Proof of Concept\n\ngit diff\n\n<https://gist.github.com/panprog/32adefdc853ccd0fd0f1aad85c526bea>\n\nthen:\n\nyarn test test/dnssec-oracle/TestSolidityTests.js\n\n### Recommended Mitigation Steps\n\nIn addition to the incorrect condition, the mask calculation formula: `32 - shortest + idx` will also overflow since `shortest` can be more than `32`, so addition should be performed before subtractions.\n\n                if (shortest - idx >= 32) {\n                    mask = type(uint256).max;\n                } else {\n                    mask = ~(2 ** (8 * (idx + 32 - shortest)) - 1);\n                }\n\n**[Arachnid (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/78)**\n\n\n\n***\n\n## [[M-05] `DNSSECImpl.verifySignature` compares strings incorrectly, allowing malicious zones to forge DNSSEC trust chain](https://github.com/code-423n4/2022-07-ens-findings/issues/207)\n*Submitted by GimelSec, also found by csanuragjain*\n\n[DNSSECImpl.sol#L186-L190](https://github.com/code-423n4/2022-07-ens/blob/main/contracts/dnssec-oracle/DNSSECImpl.sol#L186-L190)<br>\n\nDNSSEC allows parent zones to sign for its child zones. To check validity of a signature, RFC4034 3.1.7 requires the `Signer's Name` in any RRSIG RDATA to contain the zone of covered RRset. This requirement is reasonable since any child zone should be covered by its parent zone.\n\nENS tries to implement the concept of name coverage in `DNSSECImpl.verifySignature`, but unfortuantely does it wrong, resulting in possibiliy of coverage between two unrelated domains. In the worst case, an attacker can utilize this bug to forge malicious trust chains and authenticate invalid domains.\n\n### Proof of Concept\n\nIn `DNSSECImpl.verifySignature`, ENS tries to verify the name of RRSet zone (`name`) is contained by Signer's Name (`rrset.signerName`).\n\n        if(rrset.signerName.length > name.length\n                || !rrset.signerName.equals(0, name, name.length - rrset.signerName.length))    //## This allows matches such as name=\"SubString.com\" signerName=\"String.com\", which is clearly incorrect, use label counts instead\n            {\n                revert InvalidSignerName(name, rrset.signerName);\n            }\n\nIn DNS, for a parent zone to contain another child zone, we generally require the child zone to be a subdomain of the parent. For instance, `example.eth.` in considered to cover `sub.example.eth.`, while `xample.eth.` should not be cover `example.eth.`.\n\nUnfortunately in the implementation shown above, both cases will path the check, and `ample.eth.` will be considered appropriate to sign for `example.eth.`. This is against the original design of DNS, and would result in breach of zone hierarchy.\n\nIn practice, the requirement to exploit this is a bit more complex. Since names are stored as a sequence of packed labels, `example.eth.` should be stored as `\\x06example\\x03eth\\x00`, while `xample.eth.` is stored as `\\x05xample\\x03eth\\x00`. Thus to successfully pull off the attack ,we have to make sure that the packed signer's name is actually a substring of child zone.\n\nA simple (yet unrealistic) example can be like this `xample.eth.` can sign for `e\\x05xample.eth.`, since packed format of those two names are `\\x05xample\\x03eth\\x00` and `\\x07e\\x05ample\\x03eth\\x00`.\n\nIn general, it would require some effort for an attacker to find attackable zones, nevertheless, this should still be considered as a potential threat to the integrity of ENS.\n\n### Recommended Mitigation Steps\n\nCheck label by label instead of comparing the entire name.<br>\nTo actually meet all requirements specified in RFC4034 and RFC4035, there are still a lot to do, but we will discuss that in a separate issue for clarity.\n\n**[Arachnid (ENS) disagreed with severity and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/207#issuecomment-1196205728):**\n > This is a valid issue, but unexploitable in the wild; RFC 1035 specifies labels are limited to 63 octets or less, and the ASCII code of lowercase 'a' is 97. As a result, no vulnerable names should exist.\n> \n> Recommend that this be triaged as severity 2 as a result.\n\n**[LSDan (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/207#issuecomment-1203857417):**\n > I agree with @Arachnid on this. The lack of real world likelihood makes this a Medium severity.\n\n\n\n***\n\n## [[M-06] `BytesUtils`: compare will not revert when the `offset` and `len` exceeds the bytes lengths](https://github.com/code-423n4/2022-07-ens-findings/issues/180)\n*Submitted by zzzitron*\n\n[BytesUtils.sol#L44-L51](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L44-L51)<br>\n\nCompare will return false answer without reverting when the inputs are not valid.\n\n### Proof of Concept\n\nThe `compare` function is used for `compareNames`. The names are supposed to be DNS wire format. If the strings are malformed, it is possible to give out-of-range `offset`, `len`, `otheroffset`, and `otherlen`. When it happens, the `compare` will return some false values, without reverting, since the validity of `offset` and `len` are not checked.\n\n```solidity\n// https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L44-L51\n// dnssec-oracle/BytesUtils.sol::compare\n// The length of self and other are not enforced\n\n 44     function compare(bytes memory self, uint offset, uint len, bytes memory other, uint otheroffset, uint otherlen) internal pure returns (int) {\n 45         uint shortest = len;\n 46         if (otherlen < len)\n 47         shortest = otherlen;\n 48\n 49         uint selfptr;\n 50         uint otherptr;\n```\n\n### Recommended Mitigation Steps\n\nCheck whether the `offset`, `len` are within the length of `self`, as well as for the `other`.\n\n**[makoto (ENS) acknowledged and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/180#issuecomment-1196600009):**\n > It's lacking enough test to prove the bug.\n\n**[Arachnid (ENS) confirmed and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/180#issuecomment-1198703171):**\n > `compareNames` does not sanity check the lengths passed in, so this is a legitimate bug.\n\n\n\n***\n\n## [[M-07] If `PARENT_CANNOT_CONTROL` is set on subdomain, it can be unwrapped then wrapped by its owner and then parent can control it again before the expiry](https://github.com/code-423n4/2022-07-ens-findings/issues/119)\n*Submitted by panprog*\n\n[NameWrapper.sol#L955-L961](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L955-L961)<br>\n\nThere is a general incorrect logic of allowing to burn only `PARENT_CANNOT_CONTROL` fuse without burning `CANNOT_UNWRAP` fuse. If only `PARENT_CANNOT_CONTROL` fuse is burnt, then domain can be unwrapped by its owner and then wrapped again, which clears `PARENT_CANNOT_CONTROL` fuse, making it possible for parent to bypass the limitation of parent control before the expiry.\n\nBypassing parent control scenario:\n\n1.  Alice registers and wraps `test.eth` domain\n2.  Alice creates subdomain `bob.test.eth` and burns `PARENT_CANNOT_CONTROL` fuse with max expiry, transferring this domain to Bob\n3.  At this point Bob can verify that he is indeed domain owner of `bob.test.eth` in `NameWrapper`, `PARENT_CANNOT_CONTROL` fuse is burnt for this domain and fuse expiry is set to expiry of `test.eth` domain. So Bob thinks his domain is secure and can not be taken from him before the expiry.\n4.  Bob unwraps `bob.test.eth` domain.\n5.  Bob wraps `bob.test.eth` domain, which clears fuses and expiry\n6.  Alice changes `bob.test.eth` domain ownership to her breaking Bob's impression that his domain was secure until expiry.\n\n### Proof of Concept\n\nCopy this to test/wrapper and run:<br>\nyarn test test/wrapper/NameWrapperBypassPCC.js\n\n<https://gist.github.com/panprog/71dea0fd1875b4d7d5849f7da822ea8b>\n\n### Recommended Mitigation Steps\n\nBurning any fuse (including `PARENT_CANNOT_CONTROL`) must require `CANNOT_UNWRAP` fuse to be burned (because otherwise it's possible to unwrap+wrap to clear that fuse).\n\nIn `NameWrapper._canFusesBeBurned`, condition should be different:\n\n        if (\n            fuses & ~CANNOT_UNWRAP != 0 &&\n            fuses & (PARENT_CANNOT_CONTROL | CANNOT_UNWRAP) !=\n            (PARENT_CANNOT_CONTROL | CANNOT_UNWRAP)\n        ) {\n            revert OperationProhibited(node);\n        }\n\n**[jefflau (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/119#issuecomment-1189822680):**\n > A mitigation step for this could be to not burn fuses when unwrapping domains to prevent the `PARENT_CANNOT_CONTROL` from being reset.\n\n**[Arachnid (ENS) disagreed with severity and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/119#issuecomment-1196222115):**\n > Since this has to be self-inflicted by the victim, this should be severity 2.\n\n**[LSDan (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/119#issuecomment-1203925662):**\n > Agree with the sponsor that this is a medium severity issue due to the external requirement that Bob unwraps and rewraps the domain. Additionally, this requires Alice to all of a sudden become a bad actor, making it highly unlikely that this would occur.\n\n\n\n***\n\n## [[M-08] Wrong Equals Logic](https://github.com/code-423n4/2022-07-ens-findings/issues/118)\n*Submitted by 0x1f8b, also found by alan724*\n\n[BytesUtils.sol#L115-L127](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/BytesUtils.sol#L115-L127)<br>\n\n`equals` with offset might return true when `equals` without offset returns false.\n\n### Proof of Concept\n\nThe problem is that `self.length` could be greater than `other.length + offset`, it should be `==`, or it should contain a length argument.\n\nHere you have an example of the failure:\n\n*   `equals(0x0102030000, 0, 0x010203)` => `return true`\n\n```json\ndecoded input\t{\n\t\"bytes self\": \"0x0102030000\",\n\t\"uint256 offset\": \"0\",\n\t\"bytes other\": \"0x010203\"\n}\ndecoded output\t{\n\t\"0\": \"bool: true\"\n}\n```\n\n### Recommended Mitigation Steps\n\n```diff\n    function equals(bytes memory self, uint offset, bytes memory other) internal pure returns (bool) {\n-       return self.length >= offset + other.length && equals(self, offset, other, 0, other.length);\n+       return self.length == offset + other.length && equals(self, offset, other, 0, other.length);\n    }\n```\n\n**[makoto (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/118)**\n\n\n\n***\n\n## [[M-09] The `unwrapETH2LD` use `transferFrom` instead of `safeTransferFrom` to transfer ERC721 token](https://github.com/code-423n4/2022-07-ens-findings/issues/157)\n*Submitted by 0x29A, also found by Amithuddar, benbaessler, berndartmueller, cccz, CRYP70, rbserver, RedOneN, and Sm4rty*\n\n[NameWrapper.sol#L327-L346](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L327-L346)<br>\n\nThe `unwrapETH2LD` use `transferFrom` to transfer ERC721 token, the `newRegistrant` could be an unprepared contract.\n\n### Proof of Concept\n\nShould a ERC-721 compatible token be transferred to an unprepared contract, it would end up being locked up there. Moreover, if a contract explicitly wanted to reject ERC-721 safeTransfers.<br>\nPlus take a look to [the OZ safeTransfer comments](https://docs.openzeppelin.com/contracts/4.x/api/token/erc721#IERC721-transferFrom-address-address-uint256-):<br>\n`Usage of this method is discouraged, use safeTransferFrom whenever possible.`\n\n### Recommended Mitigation Steps\n\n```diff\n    function unwrapETH2LD(\n        bytes32 labelhash,\n        address newRegistrant,\n        address newController\n    ) public override onlyTokenOwner(_makeNode(ETH_NODE, labelhash)) {\n        _unwrap(_makeNode(ETH_NODE, labelhash), newController);\n-       registrar.transferFrom(\n+       registrar.safeTransferFrom(\n            address(this),\n            newRegistrant,\n            uint256(labelhash)\n        );\n    }\n```\n\n**[jefflau (ENS) disputed and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/157#issuecomment-1196450983):**\n > Transfer is to the contract itself, so there is no point in using `safeTransferFrom`. For other situations where `transferFrom` the behaviour is intended.\n\n**[LSDan (judge) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/157#issuecomment-1204004769):**\n > > Transfer is to the contract itself, so there is no point in using `safeTransferFrom`. For other situations where `transferFrom` the behaviour is intended.\n> \n> That's incorrect in the report above. This is transferring from, not to, the contract itself.\n\n**[jefflau (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/157#issuecomment-1204016628):**\n > > That's incorrect in the report above. This is transferring from, not to, the contract itself.\n> \n> Yes sorry, that is true. I was replying to some of the duplicates that I closed such as: [#126](https://github.com/code-423n4/2022-07-ens-findings/issues/126), [#147](https://github.com/code-423n4/2022-07-ens-findings/issues/147). \n\n\n\n***\n\n## [[M-10] Incorrect implementation of `RRUtils.serialNumberGte`](https://github.com/code-423n4/2022-07-ens-findings/issues/211)\n*Submitted by GimelSec, also found by Lambda and zzzitron*\n\n[RRUtils.sol#L266-L268](https://github.com/code-423n4/2022-07-ens/blob/main/contracts/dnssec-oracle/RRUtils.sol#L266-L268)<br>\n\nComparing serial numbers should follow RFC1982 due to the possibility of numbers wrapping around. `RRUtils.serialNumberGte` tried to follow the RFC but failed to do so, leading to incorrect results in comparison.\n\n### Proof of Concept\n\nFor a serial number i1 to be greater than i2, the rules provided by RFC1982 is as follow<br>\n`((i1 < i2) && ((i2 - i1) > (2**31))) || ((i1 > i2) && ((i1 - i2) < (2**31)))`\n\nENS implements `int32(i1) - int32(i2) > 0`, which will suffer from revert in cases such as `i1=0x80000000, i2=0x7fffffff`\n\n### Recommended Mitigation Steps\n\nUse the naive implementation instead<br>\n`return (i1 == i2) || ((i1 < i2) && ((i2 - i1) > (2**31))) || ((i1 > i2) && ((i1 - i2) < (2**31)));`\n\n**[Arachnid (ENS) disagreed with severity and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/211#issuecomment-1196209242):**\n > This is intentional, see https://en.wikipedia.org/wiki/Serial_number_arithmetic#General_solution\n> \n> Nevertheless, this should be documented. Recommend triaging as QA.\n\n**[Arachnid (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/211#issuecomment-1204468784):**\n > Correction - while the operation is correct per the Wikipedia article, it should be in an `unchecked` block to allow overflow. Recommend triaging as 2.\n\n**[LSDan (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/211#issuecomment-1205771385):**\n > Agree with the sponsor. This is a bug and it does potentially impact protocol functionality, but it will not occur until far in the future, making it fairly unlikely. Medium makes sense here.\n\n\n\n***\n\n## [[M-11] The preimage DB (i.e., `NameWrapper.names`) can be maliciously manipulated/corrupted](https://github.com/code-423n4/2022-07-ens-findings/issues/197)\n*Submitted by PwnedNoMore*\n\n[NameWrapper.sol#L520](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L520)<br>\n\nBy design, the `NameWrapper.names` is used as a preimage DB so that the client can query the domain name by providing the token ID. The name should be correctly stored. To do so, the `NameWrapper` record the domain's name every time it gets wrapped. And as long as all the parent nodes are recorded in the DB, wrapping a child node will be very efficient by simply querying the parent node's name.\n\nHowever, within a malicious scenario, it is possible that a subdomain can be wrapped without recording its info in the preimage DB.\n\nSpecifically, when `NameWrappper.setSubnodeOwner` / `NameWrappper.setSubnodeRecord` on a given subdomain, the following code is used to check whether the subdomain is wrapped or not. The preimage DB is only updated when the subdomain is not wrapped (to save gas I beieve).\n\n```solidity\nfunction setSubnodeOwner(\n    bytes32 parentNode,\n    string calldata label,\n    address newOwner,\n    uint32 fuses,\n    uint64 expiry\n)\n    public\n    onlyTokenOwner(parentNode)\n    canCallSetSubnodeOwner(parentNode, keccak256(bytes(label)))\n    returns (bytes32 node)\n{\n    bytes32 labelhash = keccak256(bytes(label));\n    node = _makeNode(parentNode, labelhash);\n    (, , expiry) = _getDataAndNormaliseExpiry(parentNode, node, expiry);\n    if (ens.owner(node) != address(this)) {\n        ens.setSubnodeOwner(parentNode, labelhash, address(this));\n        _addLabelAndWrap(parentNode, node, label, newOwner, fuses, expiry);\n    } else {\n        _transferAndBurnFuses(node, newOwner, fuses, expiry);\n    }\n}\n```\n\nHowever, the problem is that `ens.owner(node) != address(this)` is not sufficient to check whether the node is alreay wrapped. The hacker can manipulate this check by simply invoking `EnsRegistry.setSubnodeOwner` to set the owner as the `NameWrapper` contract without wrapping the node.\n\nConsider the following attack scenario.\n\n*   the hacker registers a 2LD domain, e.g., `base.eth`\n*   he assigns a subdomain for himself, e.g., `sub1.base.eth`\n    *   the expiry of `sub1.base.eth` should be set as expired shortly\n    *   note that the expiry is for `sub1.base.eth` instead of `base.eth`, so it is safe to make it soonly expired\n*   the hacker waits for expiration and unwraps his `sub1.base.eth`\n*   the hacker invokes `ens.setSubnodeOwner` to set the owner of `sub2.sub1.base.eth` as NameWrapper contract\n*   the hacker re-wraps his `sub1.base.eth`\n*   the hacker invokes `nameWrapper.setSubnodeOwner` for `sub2.sub1.base.eth`\n    *   as such, `names[namehash(sub2.sub1.base.eth)]` becomes empty\n*   the hacker invokes `nameWrapper.setSubnodeOwner` for `eth.sub2.sub1.base.eth`.\n    *   as such, `names[namehash(eth.sub2.sub1.base.eth)]` becomes `\\x03eth`\n\nIt is not rated as a High issue since the forged name is not valid, i.e., without the tailed `\\x00` (note that a valid name should be like `\\x03eth\\x00`). However, the preimage BD can still be corrupted due to this issue.\n\n### Suggested Fix\n\nWhen wrapping node `X`, check whether `NameWrapper.names[X]` is empty directly, and update the preimage DB if it is empty.\n\n### Proof of Concept / Attack Scenario\n\nFor full details, please see [original warden submission](https://github.com/code-423n4/2022-07-ens-findings/issues/197).\n\n**[jefflau (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/197)**\n\n\n\n***\n\n## [[M-12] `ERC1155Fuse`: `_transfer` does not revert when sent to the old owner](https://github.com/code-423n4/2022-07-ens-findings/issues/179)\n*Submitted by zzzitron*\n\nThe `safeTransferFrom` does not comply with the ERC1155 standard when the token is sent to the old owner.\n\n### Proof of Concept\n\nAccording to the EIP-1155 standard for the `safeTransferFrom`:\n\n> MUST revert if balance of holder for token `_id` is lower than the `_value` sent.\n\nLet's say `alice` does not hold any token of `tokenId`, and `bob` holds one token of `tokenId`. Then alice tries to send one token of `tokenId` to bob with `safeTranferFrom(alice, bob, tokenId, 1, \"\")`.  In this case, even though alice's balance (= 0) is lower than the amount (= 1) sent, the `safeTransferFrom` will not revert. Thus, violating the EIP-1155 standard.<br>\nIt can cause problems for other contracts using this token, since they assume the token was transferred if the `safeTransferFrom` does not revert. However, in the example above, no token was actually transferred.\n\n```solidity\n// https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/ERC1155Fuse.sol#L274-L284\n// wrapper/ERC1155Fuse.sol::_transfer\n// ERC1155Fuse::safeTransferFrom uses _transfer\n\n274     function _transfer(\n275         address from,\n276         address to,\n277         uint256 id,\n278         uint256 amount,\n279         bytes memory data\n280     ) internal {\n281         (address oldOwner, uint32 fuses, uint64 expiry) = getData(id);\n282         if (oldOwner == to) {\n283             return;\n284         }\n```\n\n### Recommended Mitigation Steps\n\nRevert even if the `to` address already owns the token.\n\n**[jefflau (ENS) confirmed and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/179#issuecomment-1196491844):**\n > Recommend severity QA.\n\n**[LSDan (judge) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/179#issuecomment-1205864807):**\n > I'm going to leave this as Medium. This issue could definitely impact other protocols and potentially cause a loss of funds given external factors.\n\n\n\n***\n\n## [[M-13] Users can create extra ENS records at no cost](https://github.com/code-423n4/2022-07-ens-findings/issues/132)\n*Submitted by wastewa, also found by bin2chen, Limbooo, PwnedNoMore, and ronnyx2017*\n\n[ETHRegistrarController.sol#L249-L268](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L249-L268)<br>\n[ETHRegistrarController.sol#L125](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/ETHRegistrarController.sol#L125)<br>\n[BaseRegistrarImplementation.sol#L106](https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/BaseRegistrarImplementation.sol#L106)<br>\n\nUsers using the `register` function in `ETHRegistrarController.sol`, can create an additional bogus ENS entry (Keep the ERC721 and all the glory for as long as they want) for free by exploiting the `functionCall` in the `_setRecords` function.<br>\nThe only check there (in the setRecord function) is that the nodehash matches the originally registered ENS entry, this is extremely dangerous because the rest of the functionCall is not checked and the controller has very elevated privileges in ENS ecosystem (and probably beyond).\n\nThe single exploit I am showing is already very bad, but I expect there will be more if this is left in. An example of a potential hack is that some of the functions in other ENS contracts (which give the RegistrarController elevated privilege) have dynamic types as the first variables--if users can generate a hash that is a low enough number, they will be able to unlock more exploits in the ENS ecosystem because of how dynamic types are abi encoded.  Other developers will probably also trust the `ETHRegistrarController.sol`, so other unknown dangers may come down the road.\n\nThe exploit I made (full code in PoC) can mint another ENS entry and keep it for as long as it wants, without paying more--will show code below.\n\n### Proof of Concept\n\nPut this code in the `TestEthRegistrarController.js` test suite to run. I just appended this to tests at the bottom of file.\n\nI called the `BaseRegistrarImplementation.register` function with the privileges of `ETHRegistrarController` by passing the base registrar's address as the `resolver` param in the `ETHRegistrarController.register` function call. I was able to set a custom duration at no additional cost.\n\nThe final checks of the PoC show that we own two new ENS entries from a single `ETHRegistrarController.register` call. The labelhash of the new bogus ENS entry is the nodehash of the first registered ENS entry.\n\n```js\n  it('Should allow us to make bogus erc721 token in ENS contract', async () => {\n    const label = 'newconfigname'\n    const name = `${label}.eth`\n    const node = namehash.hash(name)\n    const secondTokenDuration = 788400000 // keep bogus NFT for 25 years;\n\n    var commitment = await controller.makeCommitment(\n      label,\n      registrantAccount,\n      REGISTRATION_TIME,\n      secret,\n      baseRegistrar.address,\n      [\n        baseRegistrar.interface.encodeFunctionData('register(uint256,address,uint)', [\n          node,\n          registrantAccount,\n          secondTokenDuration\n        ]),\n      ],\n      false,\n      0,\n      0\n    )\n    var tx = await controller.commit(commitment)\n    expect(await controller.commitments(commitment)).to.equal(\n      (await web3.eth.getBlock(tx.blockNumber)).timestamp\n    )\n\n    await evm.advanceTime((await controller.minCommitmentAge()).toNumber())\n    var balanceBefore = await web3.eth.getBalance(controller.address)\n\n    let tx2 = await controller.register(\n      label,\n      registrantAccount,\n      REGISTRATION_TIME,\n      secret,\n      baseRegistrar.address,\n      [\n        baseRegistrar.interface.encodeFunctionData('register(uint256,address,uint)', [\n          node,\n          registrantAccount,\n          secondTokenDuration\n        ]),\n      ],\n      false,\n      0,\n      0,\n      { value: BUFFERED_REGISTRATION_COST }\n    )\n\n    expect(await nameWrapper.ownerOf(node)).to.equal(registrantAccount)\n    expect(await ens.owner(namehash.hash(name))).to.equal(nameWrapper.address)\n\n\n    expect(await baseRegistrar.ownerOf(node)).to.equal( // this checks that bogus NFT is owned by us\n      registrantAccount\n    )\n    expect(await baseRegistrar.ownerOf(sha3(label))).to.equal(\n      nameWrapper.address\n    )\n  })\n```\n\n### Tools Used\n\nchai tests in repo\n\n### Recommended Mitigation Steps\n\nI recommend being stricter on the signatures of the user-provided `resolver` and the function that is being called (like safeTransfer calls in existing token contracts).<br>\nAn example of how to do this is by creating an interface that ENS can publish for users that want to compose their own resolvers and call that instead of a loose functionCall. Users will be free to handle data however they like, while restricting the space of things that can go wrong.\n\nI will provide a loose example here:\n\n    interface IUserResolver {\n        function registerRecords(bytes32 nodeId, bytes32 labelHash, bytes calldata extraData)\n\n    }\n\n**[Arachnid (ENS) confirmed](https://github.com/code-423n4/2022-07-ens-findings/issues/132)**\n\n**[jefflau (ENS) disagreed with severity and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/132#issuecomment-1206584808):**\n > We left this as high severity, but this is a duplicate of this: [#222 comment](https://github.com/code-423n4/2022-07-ens-findings/issues/222#issuecomment-1196396435).\n> \n> I believe this still a low severity, or at a minimum medium.\n> \n> The only thing you can pass to `register` is the node, as the `require` inside `setRecords` checks the nodehash. However `register` in the baseRegistrar itself takes a `label` not the namehash of the name, so it will register a name with the hash of `namehash(namehash('eth') + node)`, which will be a very useless name as the label will then be a 32 byte keccak hash so `0x123...abc.eth`.\n> \n> In the warden's test he tests for the node of the account they originally wanted to buy, not the bogus nft:\n> \n> ```\n> expect(await baseRegistrar.ownerOf(node)).to.equal( // this checks that bogus NFT is owned by us\n>       registrantAccount\n>     )\n> ```\n> \n> To test for the bogus nft they would need to do:\n> \n> ```\n> const node2 = sha3(namehash('eth') + node)\n> expect(await baseRegistrar.ownerOf(node2)).to.equal( // this checks that bogus NFT is owned by us\n>       registrantAccount\n>     )\n> ```\n\n**[LSDan (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-07-ens-findings/issues/132#issuecomment-1255167910):**\n > After a lot of consideration of this issue, I'm going to downgrade it to medium. There are two main considerations in doing this:\n> \n> 1) The \"free\" name created is essentially junk.\n> 2) The additional potential exploits are unknown and kinda hand-wavy. If there are additional exploits in the future as a result of this they almost definitely rely on external factors that don't exist today.\n\n\n\n***\n\n# Low Risk and Non-Critical Issues\n\nFor this contest, 71 reports were submitted by wardens detailing low risk and non-critical issues. The [report highlighted below](https://github.com/code-423n4/2022-07-ens-findings/issues/221) by **IllIllI** received the top score from the judge.\n\n*The following wardens also submitted reports: [Dravee](https://github.com/code-423n4/2022-07-ens-findings/issues/71), [0x29A](https://github.com/code-423n4/2022-07-ens-findings/issues/193), [Bnke0x0](https://github.com/code-423n4/2022-07-ens-findings/issues/17), [Deivitto](https://github.com/code-423n4/2022-07-ens-findings/issues/300), [joestakey](https://github.com/code-423n4/2022-07-ens-findings/issues/250), [rbserver](https://github.com/code-423n4/2022-07-ens-findings/issues/144), [0x1f8b](https://github.com/code-423n4/2022-07-ens-findings/issues/130), [benbaessler](https://github.com/code-423n4/2022-07-ens-findings/issues/92), [TomJ](https://github.com/code-423n4/2022-07-ens-findings/issues/233), [dxdv](https://github.com/code-423n4/2022-07-ens-findings/issues/178), [hake](https://github.com/code-423n4/2022-07-ens-findings/issues/189), [Rolezn](https://github.com/code-423n4/2022-07-ens-findings/issues/47), [0xNazgul](https://github.com/code-423n4/2022-07-ens-findings/issues/273), [0xf15ers](https://github.com/code-423n4/2022-07-ens-findings/issues/225), [alan724](https://github.com/code-423n4/2022-07-ens-findings/issues/238), [Sm4rty](https://github.com/code-423n4/2022-07-ens-findings/issues/248), [Funen](https://github.com/code-423n4/2022-07-ens-findings/issues/237), [sashik\\_eth](https://github.com/code-423n4/2022-07-ens-findings/issues/289), [Ruhum](https://github.com/code-423n4/2022-07-ens-findings/issues/52), [robee](https://github.com/code-423n4/2022-07-ens-findings/issues/11), [\\_Adam](https://github.com/code-423n4/2022-07-ens-findings/issues/137), [Aussie\\_Battlers](https://github.com/code-423n4/2022-07-ens-findings/issues/131), [Waze](https://github.com/code-423n4/2022-07-ens-findings/issues/122), [brgltd](https://github.com/code-423n4/2022-07-ens-findings/issues/295), [c3phas](https://github.com/code-423n4/2022-07-ens-findings/issues/270), [Ch\\_301](https://github.com/code-423n4/2022-07-ens-findings/issues/111), [hyh](https://github.com/code-423n4/2022-07-ens-findings/issues/317), [Lambda](https://github.com/code-423n4/2022-07-ens-findings/issues/57), [MiloTruck](https://github.com/code-423n4/2022-07-ens-findings/issues/77), [p\\_crypt0](https://github.com/code-423n4/2022-07-ens-findings/issues/264), [Rohan16](https://github.com/code-423n4/2022-07-ens-findings/issues/290), [0xNineDec](https://github.com/code-423n4/2022-07-ens-findings/issues/146), [8olidity](https://github.com/code-423n4/2022-07-ens-findings/issues/45), [zzzitron](https://github.com/code-423n4/2022-07-ens-findings/issues/182), [GimelSec](https://github.com/code-423n4/2022-07-ens-findings/issues/212), [JC](https://github.com/code-423n4/2022-07-ens-findings/issues/307), [JohnSmith](https://github.com/code-423n4/2022-07-ens-findings/issues/163), [kyteg](https://github.com/code-423n4/2022-07-ens-findings/issues/213), [rokinot](https://github.com/code-423n4/2022-07-ens-findings/issues/299), [asutorufos](https://github.com/code-423n4/2022-07-ens-findings/issues/109), [berndartmueller](https://github.com/code-423n4/2022-07-ens-findings/issues/81), [bulej93](https://github.com/code-423n4/2022-07-ens-findings/issues/252), [cRat1st0s](https://github.com/code-423n4/2022-07-ens-findings/issues/313), [Critical](https://github.com/code-423n4/2022-07-ens-findings/issues/172), [csanuragjain](https://github.com/code-423n4/2022-07-ens-findings/issues/93), [delfin454000](https://github.com/code-423n4/2022-07-ens-findings/issues/108), [fatherOfBlocks](https://github.com/code-423n4/2022-07-ens-findings/issues/21), [sach1r0](https://github.com/code-423n4/2022-07-ens-findings/issues/87), [pedr02b2](https://github.com/code-423n4/2022-07-ens-findings/issues/104), [philogy](https://github.com/code-423n4/2022-07-ens-findings/issues/312), [PwnedNoMore](https://github.com/code-423n4/2022-07-ens-findings/issues/245), [rajatbeladiya](https://github.com/code-423n4/2022-07-ens-findings/issues/134), [\\_\\_141345\\_\\_](https://github.com/code-423n4/2022-07-ens-findings/issues/169), [0xDjango](https://github.com/code-423n4/2022-07-ens-findings/issues/242), [rishabh](https://github.com/code-423n4/2022-07-ens-findings/issues/34), [zuhaibmohd](https://github.com/code-423n4/2022-07-ens-findings/issues/88), [cryptphi](https://github.com/code-423n4/2022-07-ens-findings/issues/259), [svskaushik](https://github.com/code-423n4/2022-07-ens-findings/issues/247), [seyni](https://github.com/code-423n4/2022-07-ens-findings/issues/254), [RustyRabbit](https://github.com/code-423n4/2022-07-ens-findings/issues/219), [lcfr\\_eth](https://github.com/code-423n4/2022-07-ens-findings/issues/291), [minhtrng](https://github.com/code-423n4/2022-07-ens-findings/issues/309), [ReyAdmirado](https://github.com/code-423n4/2022-07-ens-findings/issues/150), [pashov](https://github.com/code-423n4/2022-07-ens-findings/issues/161), [bin2chen](https://github.com/code-423n4/2022-07-ens-findings/issues/143), [cryptonue](https://github.com/code-423n4/2022-07-ens-findings/issues/261), [ElKu](https://github.com/code-423n4/2022-07-ens-findings/issues/191), [exd0tpy](https://github.com/code-423n4/2022-07-ens-findings/issues/171), [simon135](https://github.com/code-423n4/2022-07-ens-findings/issues/265), and [gogo](https://github.com/code-423n4/2022-07-ens-findings/issues/174).*\n\n## Low Risk Issues Summary\n\n|        | Issue                                                                                | Instances |\n| ------ | :----------------------------------------------------------------------------------- | :-------: |\n| [L‑01] | `require()` should be used instead of `assert()`                                     |     2     |\n| [L‑02] | Missing checks for `address(0x0)` when assigning values to `address` state variables |     1     |\n| [L‑03] | Open TODOs                                                                           |     1     |\n| [L-04] | File is missing NatSpec                                                              |     10    |\n| [L-05] | NatSpec is incomplete                                                                |     13    |\n\nTotal: 27 instances over 5 issues\n\n## Non-critical Issues Summary\n\n|        | Issue                                                                                       | Instances |\n| ------ | :------------------------------------------------------------------------------------------ | :-------: |\n| [N‑01] | Name validation is not strictly valid                                                       |     1     |\n| [N‑02] | Adding a `return` statement when the function defines a named return variable, is redundant |     1     |\n| [N‑03] | `require()`/`revert()` statements should have descriptive reason strings                    |     17    |\n| [N‑04] | `public` functions not called by the contract should be declared `external` instead         |     13    |\n| [N‑05] | `constant`s should be defined rather than using magic numbers                               |    150    |\n| [N‑06] | Redundant cast                                                                              |     1     |\n| [N‑07] | Missing event and or timelock for critical parameter change                                 |     3     |\n| [N‑08] | File is missing version pragma                                                              |     1     |\n| [N‑09] | Use a more recent version of solidity                                                       |     7     |\n| [N‑10] | `pragma experimental ABIEncoderV2` is deprecated                                            |     2     |\n| [N‑11] | Constant redefined elsewhere                                                                |     1     |\n| [N‑12] | Inconsistent spacing in comments                                                            |     2     |\n| [N‑13] | Lines are too long                                                                          |     8     |\n| [N‑14] | Inconsistent method of specifying a floating pragma                                         |     10    |\n| [N‑15] | Non-library/interface files should use fixed compiler versions, not floating ones           |     4     |\n| [N‑16] | Typos                                                                                       |     5     |\n| [N‑17] | File does not contain an SPDX Identifier                                                    |     14    |\n| [N‑18] | Event is missing `indexed` fields                                                           |     18    |\n| [N‑19] | Not using the named return variables anywhere in the function is confusing                  |     4     |\n| [N‑20] | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function     |     6     |\n\nTotal: 268 instances over 20 issues\n\n## [L‑01] `require()` should be used instead of `assert()`\n\nPrior to solidity version 0.8.0, hitting an assert consumes the **remainder of the transaction's available gas** rather than returning it, as `require()`/`revert()` do. `assert()` should be avoided even past solidity version 0.8.0 as its [documentation](https://docs.soliditylang.org/en/v0.8.14/control-structures.html#panic-via-assert-and-error-via-require) states that \"The assert function creates an error of type Panic(uint256). ... Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix\".\n\n*There are 2 instances of this issue.* (For in-depth details on this and all further issues with multiple instances, please see the warden's [full report](https://github.com/code-423n4/2022-07-ens-findings/issues/221).)\n\n## [L‑02] Missing checks for `address(0x0)` when assigning values to `address` state variables\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/dnssec-oracle/Owned.sol\n\n19:           owner = newOwner;\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/Owned.sol#L19>\n\n## [L‑03] Open TODOs\n\nCode architecture, incentives, and error handling/reporting questions/issues should be resolved before deployment\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/dnssec-oracle/DNSSECImpl.sol\n\n238:          // TODO: Check key isn't expired, unless updating key itself\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/DNSSECImpl.sol#L238>\n\n## [L-04] File is missing NatSpec\n\n*There are 10 instances of this issue.*\n\n## [L-05] NatSpec is incomplete\n\n*There are 13 instances of this issue.*\n\n## [N‑01] Name validation is not strictly valid\n\nWhile the documentation does in fact [say](https://docs.ens.domains/ens-improvement-proposals/ensip-1-ens#name-syntax) that there are other validations necessary to be compatible with the legacy DNS system, it would be better to have the following function signature instead `function valid(string calldata name, bool isEnforceLegacyRules) public pure returns (bool)`, so it's clear what the caller is validating\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/ethregistrar/ETHRegistrarController.sol\n\n77       function valid(string memory name) public pure returns (bool) {\n78           return name.strlen() >= 3;\n79:      }\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/4dfb0e32f586bff3db486349523a93480e3ddfba/contracts/ethregistrar/ETHRegistrarController.sol#L77-L79>\n\n## [N‑02] Adding a `return` statement when the function defines a named return variable, is redundant\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/dnssec-oracle/DNSSECImpl.sol\n\n139:          return rrset;\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/dnssec-oracle/DNSSECImpl.sol#L139>\n\n## [N‑03] `require()`/`revert()` statements should have descriptive reason strings\n\n*There are 17 instances of this issue.*\n\n## [N‑04] `public` functions not called by the contract should be declared `external` instead\n\nContracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`.\n\n*There are 13 instances of this issue.*\n\n## [N‑05]  `constant`s should be defined rather than using magic numbers\n\nEven [assembly](https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39) can benefit from using readable constants instead of hex/numeric literals.\n\n*There are 150 instances of this issue.*\n\n## [N‑06] Redundant cast\n\nThe type of the variable is the same as the type to which the variable is being cast.\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/registry/ReverseRegistrar.sol\n\n/// @audit address(resolver)\n53:               address(resolver) != address(0),\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/registry/ReverseRegistrar.sol#L53>\n\n## [N‑07] Missing event and or timelock for critical parameter change\n\nEvents help non-contract tools to track changes, and events prevent users from being surprised by changes\n\n*There are 3 instances of this issue.*\n\n## [N‑08] File is missing version pragma\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/ethregistrar/IBaseRegistrar.sol\n\n0:    import \"../registry/ENS.sol\";\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/ethregistrar/IBaseRegistrar.sol#L0>\n\n## [N‑09] Use a more recent version of solidity\n\n* Use a solidity version of at least 0.8.12 to get `string.concat()` to be used instead of `abi.encodePacked(<str>,<str>)`<br>\n  *There are 4 instances of this issue.*\n\n* Use a solidity version of at least 0.8.13 to get the ability to use `using for` with a list of free functions<br>\n  *There are 3 instances of this issue.*\n\n## [N‑10] `pragma experimental ABIEncoderV2` is deprecated\n\nUse `pragma abicoder v2` [instead](https://github.com/ethereum/solidity/blob/69411436139acf5dbcfc5828446f18b9fcfee32c/docs/080-breaking-changes.rst#silent-changes-of-the-semantics)\n\n*There are 2 instances of this issue.*\n\n## [N‑11] Constant redefined elsewhere\n\nConsider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.\n\n*There is 1 instance of this issue:*\n\n```solidity\nFile: contracts/wrapper/NameWrapper.sol\n\n/// @audit seen in contracts/registry/ReverseRegistrar.sol \n35:       ENS public immutable override ens;\n\n```\n\n<https://github.com/code-423n4/2022-07-ens/blob/ff6e59b9415d0ead7daf31c2ed06e86d9061ae22/contracts/wrapper/NameWrapper.sol#L35>\n\n## [N‑12] Inconsistent spacing in comments\n\nSome lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file\n\n*There are 2 instances of this issue.*\n\n## [N‑13] Lines are too long\n\nUsually lines in source code are limited to [80](https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width) characters. Today's screens are much larger so it's reasonable to stretch this in some cases. Since the files will most likely reside in GitHub, and GitHub starts using a scroll bar in all cases when the length is over [164](https://github.com/aizatto/character-length) characters, the lines below should be split when they reach that length\n\n*There are 8 instances of this issue.*\n\n## [N‑14] Inconsistent method of specifying a floating pragma\n\nSome files use `>=`, some use `^`. The instances below are examples of the method that has the fewest instances for a specific version. Note that using `>=` without also specifying `<=` will lead to failures to compile, or external project incompatability, when the major version changes and there are breaking-changes, so `^` should be preferred regardless of the instance counts\n\n*There are 10 instances of this issue.*\n\n## [N‑15] Non-library/interface files should use fixed compiler versions, not floating ones\n\n*There are 4 instances of this issue.*\n\n## [N‑16] Typos\n\n*There are 5 instances of this issue.*\n\n## [N‑17] File does not contain an SPDX Identifier\n\n*There are 14 instances of this issue.*\n\n## [N‑18] Event is missing `indexed` fields\n\nIndex event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (threefields). Each `event` should use three `indexed` fields if there are three or more fields, and gas usage is not particularly of concern for the events in question.\n\n*There are 18 instances of this issue.*\n\n## [N‑19] Not using the named return variables anywhere in the function is confusing\n\nConsider changing the variable to be an unnamed one.\n\n*There are 4 instances of this issue.*\n\n## [N‑20] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function\n\nThe compiler will inline the function, which will avoid `JUMP` instructions usually associated with functions\n\n*There are 6 instances of this issue.*\n\n**[jefflau (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/221#issuecomment-1200790544):**\n > High quality submission, documented well with links and code examples.\n\n\n\n***\n\n# Gas Optimizations\n\nFor this contest, 70 reports were submitted by wardens detailing gas optimizations. The [report highlighted below](https://github.com/code-423n4/2022-07-ens-findings/issues/176) by **0xKitsune** received the top score from the judge.\n\n*The following wardens also submitted reports: [joestakey](https://github.com/code-423n4/2022-07-ens-findings/issues/138), [IllIllI](https://github.com/code-423n4/2022-07-ens-findings/issues/220), [gogo](https://github.com/code-423n4/2022-07-ens-findings/issues/103), [Dravee](https://github.com/code-423n4/2022-07-ens-findings/issues/95), [m\\_Rassska](https://github.com/code-423n4/2022-07-ens-findings/issues/304), [MiloTruck](https://github.com/code-423n4/2022-07-ens-findings/issues/76), [rbserver](https://github.com/code-423n4/2022-07-ens-findings/issues/198), [hake](https://github.com/code-423n4/2022-07-ens-findings/issues/186), [TomJ](https://github.com/code-423n4/2022-07-ens-findings/issues/184), [0x1f8b](https://github.com/code-423n4/2022-07-ens-findings/issues/128), [ajtra](https://github.com/code-423n4/2022-07-ens-findings/issues/315), [Bnke0x0](https://github.com/code-423n4/2022-07-ens-findings/issues/19), [c3phas](https://github.com/code-423n4/2022-07-ens-findings/issues/301), [Deivitto](https://github.com/code-423n4/2022-07-ens-findings/issues/316), [kyteg](https://github.com/code-423n4/2022-07-ens-findings/issues/205), [RedOneN](https://github.com/code-423n4/2022-07-ens-findings/issues/244), [Sm4rty](https://github.com/code-423n4/2022-07-ens-findings/issues/249), [Tomio](https://github.com/code-423n4/2022-07-ens-findings/issues/231), [\\_\\_141345\\_\\_](https://github.com/code-423n4/2022-07-ens-findings/issues/170), [brgltd](https://github.com/code-423n4/2022-07-ens-findings/issues/296), [bulej93](https://github.com/code-423n4/2022-07-ens-findings/issues/246), [Ch\\_301](https://github.com/code-423n4/2022-07-ens-findings/issues/110), [cRat1st0s](https://github.com/code-423n4/2022-07-ens-findings/issues/298), [durianSausage](https://github.com/code-423n4/2022-07-ens-findings/issues/37), [JC](https://github.com/code-423n4/2022-07-ens-findings/issues/306), [JohnSmith](https://github.com/code-423n4/2022-07-ens-findings/issues/162), [\\_Adam](https://github.com/code-423n4/2022-07-ens-findings/issues/136), [0xNazgul](https://github.com/code-423n4/2022-07-ens-findings/issues/272), [asutorufos](https://github.com/code-423n4/2022-07-ens-findings/issues/258), [delfin454000](https://github.com/code-423n4/2022-07-ens-findings/issues/107), [fatherOfBlocks](https://github.com/code-423n4/2022-07-ens-findings/issues/20), [rokinot](https://github.com/code-423n4/2022-07-ens-findings/issues/318), [Waze](https://github.com/code-423n4/2022-07-ens-findings/issues/115), [0xNineDec](https://github.com/code-423n4/2022-07-ens-findings/issues/145), [0x040](https://github.com/code-423n4/2022-07-ens-findings/issues/305), [0x29A](https://github.com/code-423n4/2022-07-ens-findings/issues/192), [0xsam](https://github.com/code-423n4/2022-07-ens-findings/issues/33), [Aussie\\_Battlers](https://github.com/code-423n4/2022-07-ens-findings/issues/123), [Aymen0909](https://github.com/code-423n4/2022-07-ens-findings/issues/311), [Fitraldys](https://github.com/code-423n4/2022-07-ens-findings/issues/297), [lucacez](https://github.com/code-423n4/2022-07-ens-findings/issues/190), [Noah3o6](https://github.com/code-423n4/2022-07-ens-findings/issues/46), [ReyAdmirado](https://github.com/code-423n4/2022-07-ens-findings/issues/149), [robee](https://github.com/code-423n4/2022-07-ens-findings/issues/12), [Rohan16](https://github.com/code-423n4/2022-07-ens-findings/issues/286), [Rolezn](https://github.com/code-423n4/2022-07-ens-findings/issues/48), [sach1r0](https://github.com/code-423n4/2022-07-ens-findings/issues/86), [samruna](https://github.com/code-423n4/2022-07-ens-findings/issues/2), [8olidity](https://github.com/code-423n4/2022-07-ens-findings/issues/44), [arcoun](https://github.com/code-423n4/2022-07-ens-findings/issues/99), [benbaessler](https://github.com/code-423n4/2022-07-ens-findings/issues/90), [CRYP70](https://github.com/code-423n4/2022-07-ens-findings/issues/94), [karanctf](https://github.com/code-423n4/2022-07-ens-findings/issues/239), [lcfr\\_eth](https://github.com/code-423n4/2022-07-ens-findings/issues/303), [rajatbeladiya](https://github.com/code-423n4/2022-07-ens-findings/issues/135), [sahar](https://github.com/code-423n4/2022-07-ens-findings/issues/148), [sashik\\_eth](https://github.com/code-423n4/2022-07-ens-findings/issues/288), [simon135](https://github.com/code-423n4/2022-07-ens-findings/issues/271), [zuhaibmohd](https://github.com/code-423n4/2022-07-ens-findings/issues/91), [cryptonue](https://github.com/code-423n4/2022-07-ens-findings/issues/260), [ElKu](https://github.com/code-423n4/2022-07-ens-findings/issues/183), [Funen](https://github.com/code-423n4/2022-07-ens-findings/issues/235), [hyh](https://github.com/code-423n4/2022-07-ens-findings/issues/228), [seyni](https://github.com/code-423n4/2022-07-ens-findings/issues/308), [ak1](https://github.com/code-423n4/2022-07-ens-findings/issues/284), [Chom](https://github.com/code-423n4/2022-07-ens-findings/issues/251), [GimelSec](https://github.com/code-423n4/2022-07-ens-findings/issues/199), [Lambda](https://github.com/code-423n4/2022-07-ens-findings/issues/56), and [Ruhum](https://github.com/code-423n4/2022-07-ens-findings/issues/53).*\n\n## Gas Optimizations Summary\n\nThe following sections detail the gas optimizations found throughout the codebase. Each optimization is documented with the setup, an explainer for the optimization, a gas report and line identifiers for each optimization across the codebase. For each section's gas report, the optimizer was turned on and set to 10000 runs. You can replicate any tests/gas reports by heading to [0xKitsune/gas-lab](https://github.com/0xKitsune/gas-lab) and cloning the repo. Then, simply copy/paste the contract examples from any section and run `forge test --gas-report`. You can also easily update the optimizer runs in the `foundry.toml`.\n\n***\n\n## [G-01] Use assembly to hash instead of Solidity\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n    }\n\n    function testGas() public view {\n        c0.solidityHash(2309349, 2304923409);\n        c1.assemblyHash(2309349, 2304923409);\n    }\n}\n\ncontract Contract0 {\n    function solidityHash(uint256 a, uint256 b) public view {\n        //unoptimized\n        keccak256(abi.encodePacked(a, b));\n    }\n}\n\ncontract Contract1 {\n    function assemblyHash(uint256 a, uint256 b) public view {\n        //optimized\n        assembly {\n            mstore(0x00, a)\n            mstore(0x20, b)\n            let hashedVal := keccak256(0x00, 0x40)\n        }\n    }\n}\n```\n\n### Gas Report\n\n```js\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 36687              ┆ 214             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ solidityHash       ┆ 313             ┆ 313 ┆ 313    ┆ 313 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 31281              ┆ 186             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ assemblyHash       ┆ 231             ┆ 231 ┆ 231    ┆ 231 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n```\n\n### Lines\n\nFor full list of line references, see warden's [original submission](https://github.com/code-423n4/2022-07-ens-findings/issues/176).\n\n## [G-02] `unchecked{++i}` instead of `i++` (or use assembly when applicable)\n\nUse `++i` instead of `i++`. This is especially useful in for loops but this optimization can be used anywhere in your code. You can also use `unchecked{++i;}` for even more gas savings but this will not check to see if `i` overflows. For extra safety if you are worried about this, you can add a require statement after the loop checking if `i` is equal to the final incremented value. For best gas savings, use inline assembly, however this limits the functionality you can achieve. For example you cant use Solidity syntax to internally call your own contract within an assembly block and external calls must be done with the `call()` or `delegatecall()` instruction. However when applicable, inline assembly will save much more gas.\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n    Contract2 c2;\n    Contract3 c3;\n    Contract4 c4;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n        c2 = new Contract2();\n        c3 = new Contract3();\n        c4 = new Contract4();\n    }\n\n    function testGas() public {\n        c0.iPlusPlus();\n        c1.plusPlusI();\n        c2.uncheckedPlusPlusI();\n        c3.safeUncheckedPlusPlusI();\n        c4.inlineAssemblyLoop();\n    }\n}\n\ncontract Contract0 {\n    //loop with i++\n    function iPlusPlus() public pure {\n        uint256 j = 0;\n        for (uint256 i; i < 10; i++) {\n            j++;\n        }\n    }\n}\n\ncontract Contract1 {\n    //loop with ++i\n    function plusPlusI() public pure {\n        uint256 j = 0;\n        for (uint256 i; i < 10; ++i) {\n            j++;\n        }\n    }\n}\n\ncontract Contract2 {\n    //loop with unchecked{++i}\n    function uncheckedPlusPlusI() public pure {\n        uint256 j = 0;\n        for (uint256 i; i < 10; ) {\n            j++;\n\n            unchecked {\n                ++i;\n            }\n        }\n    }\n}\n\ncontract Contract3 {\n    //loop with unchecked{++i} with additional overflow check\n    function safeUncheckedPlusPlusI() public pure {\n        uint256 j = 0;\n        uint256 i = 0;\n        for (i; i < 10; ) {\n            j++;\n\n            unchecked {\n                ++i;\n            }\n        }\n\n        //check for overflow\n        assembly {\n            if lt(i, 10) {\n                mstore(0x00, \"loop overflow\")\n                revert(0x00, 0x20)\n            }\n        }\n    }\n}\n\ncontract Contract4 {\n    //loop with inline assembly\n    function inlineAssemblyLoop() public pure {\n        assembly {\n            let j := 0\n\n            for {\n                let i := 0\n            } lt(i, 10) {\n                i := add(i, 0x01)\n            } {\n                j := add(j, 0x01)\n            }\n        }\n    }\n}\n\n```\n\n### Gas Report\n\n```js\n\n╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ Contract0 contract ┆                 ┆      ┆        ┆      ┆         │\n╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 37687              ┆ 219             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ iPlusPlus          ┆ 2039            ┆ 2039 ┆ 2039   ┆ 2039 ┆ 1       │\n╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ Contract1 contract ┆                 ┆      ┆        ┆      ┆         │\n╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 37287              ┆ 217             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ plusPlusI          ┆ 1989            ┆ 1989 ┆ 1989   ┆ 1989 ┆ 1       │\n╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ Contract3 contract     ┆                 ┆      ┆        ┆      ┆         │\n╞════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost        ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 42693                  ┆ 244             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name          ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ safeUncheckedPlusPlusI ┆ 1355            ┆ 1355 ┆ 1355   ┆ 1355 ┆ 1       │\n╰────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ Contract2 contract ┆                 ┆      ┆        ┆      ┆         │\n╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 35887              ┆ 210             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ uncheckedPlusPlusI ┆ 1329            ┆ 1329 ┆ 1329   ┆ 1329 ┆ 1       │\n╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract4 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 26881              ┆ 164             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ inlineAssemblyLoop ┆ 709             ┆ 709 ┆ 709    ┆ 709 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n\n```\n\n### Lines\n\n*   DNSSECImpl.sol:93\n\n*   ETHRegistrarController.sol:256\n\n*   BytesUtils.sol:266\n\n*   BytesUtils.sol:313\n\n*   ERC1155Fuse.sol:92\n\n*   ERC1155Fuse.sol:205\n\n*   StringUtils.sol:14\n\n## [G-03] Use assembly for math (add, sub, mul, div)\n\nUse assembly for math instead of Solidity. You can check for overflow/underflow in assembly to ensure safety. If using Solidity versions < 0.8.0 and you are using Safemath, you can gain significant gas savings by using assembly to calculate values and checking for overflow/underflow.\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n    Contract2 c2;\n    Contract3 c3;\n    Contract4 c4;\n    Contract5 c5;\n    Contract6 c6;\n    Contract7 c7;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n        c2 = new Contract2();\n        c3 = new Contract3();\n        c4 = new Contract4();\n        c5 = new Contract5();\n        c6 = new Contract6();\n        c7 = new Contract7();\n    }\n\n    function testGas() public {\n        c0.addTest(34598345, 100);\n        c1.addAssemblyTest(34598345, 100);\n        c2.subTest(34598345, 100);\n        c3.subAssemblyTest(34598345, 100);\n        c4.mulTest(34598345, 100);\n        c5.mulAssemblyTest(34598345, 100);\n        c6.divTest(34598345, 100);\n        c7.divAssemblyTest(34598345, 100);\n    }\n}\n\ncontract Contract0 {\n    //addition in Solidity\n    function addTest(uint256 a, uint256 b) public pure {\n        uint256 c = a + b;\n    }\n}\n\ncontract Contract1 {\n    //addition in assembly\n    function addAssemblyTest(uint256 a, uint256 b) public pure {\n        assembly {\n            let c := add(a, b)\n\n            if lt(c, a) {\n                mstore(0x00, \"overflow\")\n                revert(0x00, 0x20)\n            }\n        }\n    }\n}\n\ncontract Contract2 {\n    //subtraction in Solidity\n    function subTest(uint256 a, uint256 b) public pure {\n        uint256 c = a - b;\n    }\n}\n\ncontract Contract3 {\n    //subtraction in assembly\n    function subAssemblyTest(uint256 a, uint256 b) public pure {\n        assembly {\n            let c := sub(a, b)\n\n            if gt(c, a) {\n                mstore(0x00, \"underflow\")\n                revert(0x00, 0x20)\n            }\n        }\n    }\n}\n\ncontract Contract4 {\n    //multiplication in Solidity\n    function mulTest(uint256 a, uint256 b) public pure {\n        uint256 c = a * b;\n    }\n}\n\ncontract Contract5 {\n    //multiplication in assembly\n    function mulAssemblyTest(uint256 a, uint256 b) public pure {\n        assembly {\n            let c := mul(a, b)\n\n            if lt(c, a) {\n                mstore(0x00, \"overflow\")\n                revert(0x00, 0x20)\n            }\n        }\n    }\n}\n\ncontract Contract6 {\n    //division in Solidity\n    function divTest(uint256 a, uint256 b) public pure {\n        uint256 c = a * b;\n    }\n}\n\ncontract Contract7 {\n    //division in assembly\n    function divAssemblyTest(uint256 a, uint256 b) public pure {\n        assembly {\n            let c := div(a, b)\n\n            if gt(c, a) {\n                mstore(0x00, \"underflow\")\n                revert(0x00, 0x20)\n            }\n        }\n    }\n}\n\n\n```\n\n### Gas Report\n\n```js\n\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 40493              ┆ 233             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ addTest            ┆ 303             ┆ 303 ┆ 303    ┆ 303 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 37087              ┆ 216             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ addAssemblyTest    ┆ 263             ┆ 263 ┆ 263    ┆ 263 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract2 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 40293              ┆ 232             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ subTest            ┆ 300             ┆ 300 ┆ 300    ┆ 300 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract3 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 37287              ┆ 217             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ subAssemblyTest    ┆ 263             ┆ 263 ┆ 263    ┆ 263 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract4 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 41893              ┆ 240             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ mulTest            ┆ 325             ┆ 325 ┆ 325    ┆ 325 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract5 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 37087              ┆ 216             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ mulAssemblyTest    ┆ 265             ┆ 265 ┆ 265    ┆ 265 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract6 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 41893              ┆ 240             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ divTest            ┆ 325             ┆ 325 ┆ 325    ┆ 325 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract7 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 37287              ┆ 217             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ divAssemblyTest    ┆ 265             ┆ 265 ┆ 265    ┆ 265 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n\n```\n\n### Lines\n\nFor full list of line references, see warden's [original submission](https://github.com/code-423n4/2022-07-ens-findings/issues/176).\n\n## [G-04] Use `calldata` instead of `memory` for function arguments that do not get mutated.\n\nMark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n    Contract2 c2;\n    Contract3 c3;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n        c2 = new Contract2();\n        c3 = new Contract3();\n    }\n\n    function testGas() public {\n        uint256[] memory arr = new uint256[](10);\n        c0.calldataArray(arr);\n        c1.memoryArray(arr);\n\n        bytes memory data = abi.encode(\"someText\");\n        c2.calldataBytes(data);\n        c3.memoryBytes(data);\n    }\n}\n\ncontract Contract0 {\n    function calldataArray(uint256[] calldata arr) public {\n        uint256 j;\n        for (uint256 i; i < arr.length; i++) {\n            j = arr[i] + 10;\n        }\n    }\n}\n\ncontract Contract1 {\n    function memoryArray(uint256[] memory arr) public {\n        uint256 j;\n        for (uint256 i; i < arr.length; i++) {\n            j = arr[i] + 10;\n        }\n    }\n}\n\ncontract Contract2 {\n    function calldataBytes(bytes calldata data) public {\n        bytes32 val;\n        for (uint256 i; i < 10; i++) {\n            val = keccak256(abi.encode(data, i));\n        }\n    }\n}\n\ncontract Contract3 {\n    function memoryBytes(bytes memory data) public {\n        bytes32 val;\n        for (uint256 i; i < 10; i++) {\n            val = keccak256(abi.encode(data, i));\n        }\n    }\n}\n```\n\n### Gas Report\n\n```js\n╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ src/test/GasTest.t.sol:Contract0 contract ┆                 ┆      ┆        ┆      ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 97947                                     ┆ 521             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ calldataArray                             ┆ 2824            ┆ 2824 ┆ 2824   ┆ 2824 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ src/test/GasTest.t.sol:Contract1 contract ┆                 ┆      ┆        ┆      ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 128171                                    ┆ 672             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ memoryArray                               ┆ 3755            ┆ 3755 ┆ 3755   ┆ 3755 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ src/test/GasTest.t.sol:Contract2 contract ┆                 ┆      ┆        ┆      ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 100547                                    ┆ 534             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ calldataBytes                             ┆ 4934            ┆ 4934 ┆ 4934   ┆ 4934 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ src/test/GasTest.t.sol:Contract3 contract ┆                 ┆      ┆        ┆      ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 135183                                    ┆ 707             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ memoryBytes                               ┆ 7551            ┆ 7551 ┆ 7551   ┆ 7551 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n\n```\n\n### Lines\n\nFor full list of line references, see warden's [original submission](https://github.com/code-423n4/2022-07-ens-findings/issues/176).\n\n## [G-05] Use multiple require() statements instead of require(expression && expression && ...)\n\nYou can save gas by breaking up a require statement with multiple conditions, into multiple require statements with a single condition.\n\n```js\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n    }\n\n    function testGas() public {\n        c0.singleRequire(3);\n        c1.multipleRequire(3);\n    }\n}\n\ncontract Contract0 {\n    function singleRequire(uint256 num) public {\n        require(num > 1 && num < 10 && num == 3);\n    }\n}\n\ncontract Contract1 {\n    function multipleRequire(uint256 num) public {\n        require(num > 1);\n        require(num < 10);\n        require(num == 3);\n    }\n}\n```\n\n### Gas Report\n\n```js\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 35487              ┆ 208             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ singleRequire      ┆ 286             ┆ 286 ┆ 286    ┆ 286 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 35887              ┆ 210             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ multipleRequire    ┆ 270             ┆ 270 ┆ 270    ┆ 270 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n\n```\n\n### Lines\n\n*   BytesUtils.sol:268\n\n*   ERC1155Fuse.sol:216\n\n*   ERC1155Fuse.sol:291\n\n## [G-06] Use assembly to write storage values\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n    }\n\n    function testGas() public {\n        c0.updateOwner(0x158B28A1b1CB1BE12C6bD8f5a646a0e3B2024734);\n        c1.assemblyUpdateOwner(0x158B28A1b1CB1BE12C6bD8f5a646a0e3B2024734);\n    }\n}\n\ncontract Contract0 {\n    address owner = 0xb4c79daB8f259C7Aee6E5b2Aa729821864227e84;\n\n    function updateOwner(address newOwner) public {\n        owner = newOwner;\n    }\n}\n\ncontract Contract1 {\n    address owner = 0xb4c79daB8f259C7Aee6E5b2Aa729821864227e84;\n\n    function assemblyUpdateOwner(address newOwner) public {\n        assembly {\n            sstore(owner.slot, newOwner)\n        }\n    }\n}\n\n```\n\n### Gas Report\n\n```js\n╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ Contract0 contract ┆                 ┆      ┆        ┆      ┆         │\n╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 60623              ┆ 261             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ updateOwner        ┆ 5302            ┆ 5302 ┆ 5302   ┆ 5302 ┆ 1       │\n╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ Contract1 contract ┆                 ┆      ┆        ┆      ┆         │\n╞════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 54823              ┆ 232             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ assemblyUpdateOwner┆ 5236            ┆ 5236 ┆ 5236   ┆ 5236 ┆ 1       │\n╰────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n```\n\n### Lines\n\n*   Owned.sol:15\n\n*   Owned.sol:19\n\n*   ETHRegistrarController.sol:61\n\n*   ETHRegistrarController.sol:62\n\n## [G-07] Use assembly to check for address(0)\n\n```js\n\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n    }\n\n    function testGas() public view {\n        c0.ownerNotZero(address(this));\n        c1.assemblyOwnerNotZero(address(this));\n    }\n}\n\ncontract Contract0 {\n    function ownerNotZero(address _addr) public pure {\n        require(_addr != address(0), \"zero address)\");\n    }\n}\n\ncontract Contract1 {\n    function assemblyOwnerNotZero(address _addr) public pure {\n        assembly {\n            if iszero(_addr) {\n                mstore(0x00, \"zero address\")\n                revert(0x00, 0x20)\n            }\n        }\n    }\n}\n\n\n```\n\n### Gas Report\n\n```js\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 61311              ┆ 338             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ ownerNotZero       ┆ 258             ┆ 258 ┆ 258    ┆ 258 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭──────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract   ┆                 ┆     ┆        ┆     ┆         │\n╞══════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost      ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 44893                ┆ 255             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name        ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ assemblyOwnerNotZero ┆ 252             ┆ 252 ┆ 252    ┆ 252 ┆ 1       │\n╰──────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n```\n\n### Lines\n\n*   ReverseRegistrar.sol:53\n\n*   DNSSECImpl.sol:336\n\n*   ETHRegistrarController.sol:100\n\n*   NameWrapper.sol:132\n\n*   NameWrapper.sol:139\n\n*   NameWrapper.sol:318\n\n*   NameWrapper.sol:661\n\n*   NameWrapper.sol:763\n\n*   NameWrapper.sol:799\n\n*   NameWrapper.sol:911\n\n*   ERC1155Fuse.sol:61\n\n*   ERC1155Fuse.sol:176\n\n*   ERC1155Fuse.sol:199\n\n*   ERC1155Fuse.sol:248\n\n*   ERC1155Fuse.sol:249\n\n## [G-08] Use assembly when getting a contract's balance of ETH.\n\nYou can use `selfbalance()` instead of `address(this).balance` when getting your contract's balance of ETH to save gas. Additionally, you can use `balance(address)` instead of `address.balance()` when getting an external contract's balance of ETH.\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n    Contract2 c2;\n    Contract3 c3;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n        c2 = new Contract2();\n        c3 = new Contract3();\n    }\n\n    function testGas() public {\n        c0.addressInternalBalance();\n        c1.assemblyInternalBalance();\n        c2.addressExternalBalance(address(this));\n        c3.assemblyExternalBalance(address(this));\n    }\n}\n\ncontract Contract0 {\n    function addressInternalBalance() public returns (uint256) {\n        return address(this).balance;\n    }\n}\n\ncontract Contract1 {\n    function assemblyInternalBalance() public returns (uint256) {\n        assembly {\n            let c := selfbalance()\n            mstore(0x00, c)\n            return(0x00, 0x20)\n        }\n    }\n}\n\ncontract Contract2 {\n    function addressExternalBalance(address addr) public {\n        uint256 bal = address(addr).balance;\n        bal++;\n    }\n}\n\ncontract Contract3 {\n    function assemblyExternalBalance(address addr) public {\n        uint256 bal;\n        assembly {\n            bal := balance(addr)\n        }\n        bal++;\n    }\n}\n```\n\n### Gas Report\n\n```js\n╭────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract     ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost        ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 23675                  ┆ 147             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name          ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ addressInternalBalance ┆ 148             ┆ 148 ┆ 148    ┆ 148 ┆ 1       │\n╰────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭─────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract      ┆                 ┆     ┆        ┆     ┆         │\n╞═════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost         ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 27081                   ┆ 165             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name           ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ assemblyInternalBalance ┆ 133             ┆ 133 ┆ 133    ┆ 133 ┆ 1       │\n╰─────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract2 contract     ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost        ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 61511                  ┆ 339             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name          ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ addressExternalBalance ┆ 417             ┆ 417 ┆ 417    ┆ 417 ┆ 1       │\n╰────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭─────────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract3 contract      ┆                 ┆     ┆        ┆     ┆         │\n╞═════════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost         ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 57105                   ┆ 317             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name           ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ assemblyExternalBalance ┆ 411             ┆ 411 ┆ 411    ┆ 411 ┆ 1       │\n╰─────────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n\n```\n\n### Lines\n\n*   ETHRegistrarController.sol:211\n\n## [G-09] Cache array length during for loop definition.\n\nA typical for loop definition may look like: `for (uint256 i; i < arr.length; i++){}`. Instead of using `array.length`, cache the array length before the loop, and use the cached value to safe gas. This will avoid an `MLOAD` every loop for arrays stored in memory and an `SLOAD` for arrays stored in storage. This can have significant gas savings for arrays with a large length, especially if the array is stored in storage.\n\n```js\n\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n    Contract2 c2;\n    Contract3 c3;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n        c2 = new Contract2();\n        c3 = new Contract3();\n    }\n\n    function testGas() public view {\n        uint256[] memory arr = new uint256[](10);\n        c0.nonCachedMemoryListLength(arr);\n        c1.cachedMemoryListLength(arr);\n        c2.nonCachedStorageListLength();\n        c3.cachedStorageListLength();\n    }\n}\n\ncontract Contract0 {\n    function nonCachedMemoryListLength(uint256[] memory arr) public pure {\n        uint256 j;\n        for (uint256 i; i < arr.length; i++) {\n            j = arr[i] + 10;\n        }\n    }\n}\n\ncontract Contract1 {\n    function cachedMemoryListLength(uint256[] memory arr) public pure {\n        uint256 j;\n\n        uint256 length = arr.length;\n        for (uint256 i; i < length; i++) {\n            j = arr[i] + 10;\n        }\n    }\n}\n\ncontract Contract2 {\n    uint256[] arr = new uint256[](10);\n\n    function nonCachedStorageListLength() public view {\n        uint256 j;\n        for (uint256 i; i < arr.length; i++) {\n            j = arr[i] + 10;\n        }\n    }\n}\n\ncontract Contract3 {\n    uint256[] arr = new uint256[](10);\n\n    function cachedStorageListLength() public view {\n        uint256 j;\n        uint256 length = arr.length;\n\n        for (uint256 i; i < length; i++) {\n            j = arr[i] + 10;\n        }\n    }\n}\n\n\n```\n\n### Gas Report\n\n```js\n╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ src/test/GasTest.t.sol:Contract0 contract ┆                 ┆      ┆        ┆      ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 128171                                    ┆ 672             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ nonCachedMemoryListLength                 ┆ 3755            ┆ 3755 ┆ 3755   ┆ 3755 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭───────────────────────────────────────────┬─────────────────┬──────┬────────┬──────┬─────────╮\n│ src/test/GasTest.t.sol:Contract1 contract ┆                 ┆      ┆        ┆      ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪══════╪════════╪══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 128777                                    ┆ 675             ┆      ┆        ┆      ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg  ┆ median ┆ max  ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ cachedMemoryListLength                    ┆ 3733            ┆ 3733 ┆ 3733   ┆ 3733 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴──────┴────────┴──────┴─────────╯\n╭───────────────────────────────────────────┬─────────────────┬───────┬────────┬───────┬─────────╮\n│ src/test/GasTest.t.sol:Contract2 contract ┆                 ┆       ┆        ┆       ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪═══════╪════════╪═══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆       ┆        ┆       ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 118474                                    ┆ 539             ┆       ┆        ┆       ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg   ┆ median ┆ max   ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ nonCachedStorageListLength                ┆ 27979           ┆ 27979 ┆ 27979  ┆ 27979 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴───────┴────────┴───────┴─────────╯\n╭───────────────────────────────────────────┬─────────────────┬───────┬────────┬───────┬─────────╮\n│ src/test/GasTest.t.sol:Contract3 contract ┆                 ┆       ┆        ┆       ┆         │\n╞═══════════════════════════════════════════╪═════════════════╪═══════╪════════╪═══════╪═════════╡\n│ Deployment Cost                           ┆ Deployment Size ┆       ┆        ┆       ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 118674                                    ┆ 540             ┆       ┆        ┆       ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name                             ┆ min             ┆ avg   ┆ median ┆ max   ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ cachedStorageListLength                   ┆ 26984           ┆ 26984 ┆ 26984  ┆ 26984 ┆ 1       │\n╰───────────────────────────────────────────┴─────────────────┴───────┴────────┴───────┴─────────╯\n\n```\n\n### Lines\n\n*   DNSSECImpl.sol:93\n\n*   ETHRegistrarController.sol:256\n\n*   ERC1155Fuse.sol:92\n\n*   ERC1155Fuse.sol:205\n\n*   RRUtils.sol:310\n\n## [G-10] Consider marking functions as payable\n\nYou can mark public or external functions as payable to save gas. Functions that are not payable have additional logic to check if there was a value sent with a call, however, making a function payable eliminates this check. This optimization should be carefully considered due to potentially unwanted behavior when a function does not need to accept ether.\n\n```js\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n    }\n\n    function testGas() public {\n        c0.isNotPayable();\n        c1.isPayable();\n    }\n}\n\ncontract Contract0 {\n    function isNotPayable() public view {\n        uint256 val = 0;\n        val++;\n    }\n}\n\ncontract Contract1 {\n    function isPayable() public payable {\n        uint256 val = 0;\n        val++;\n    }\n}\n```\n\n### Gas Report\n\n```js\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 32081              ┆ 190             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ isNotPayable       ┆ 198             ┆ 198 ┆ 198    ┆ 198 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 29681              ┆ 178             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ isPayable          ┆ 174             ┆ 174 ┆ 174    ┆ 174 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n```\n\n### Lines\n\nFor full list of line references, see warden's [original submission](https://github.com/code-423n4/2022-07-ens-findings/issues/176).\n\n## [G-11] Use custom errors instead of string error messages\n\n```js\ncontract GasTest is DSTest {\n    Contract0 c0;\n    Contract1 c1;\n\n    function setUp() public {\n        c0 = new Contract0();\n        c1 = new Contract1();\n    }\n\n    function testFailGas() public {\n        c0.stringErrorMessage();\n        c1.customErrorMessage();\n    }\n}\n\ncontract Contract0 {\n    function stringErrorMessage() public {\n        bool check = false;\n        require(check, \"error message\");\n    }\n}\n\ncontract Contract1 {\n    error CustomError();\n\n    function customErrorMessage() public {\n        bool check = false;\n        if (!check) {\n            revert CustomError();\n        }\n    }\n}\n\n```\n\n### Gas Report\n\n```js\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract0 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 34087              ┆ 200             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ stringErrorMessage ┆ 218             ┆ 218 ┆ 218    ┆ 218 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n╭────────────────────┬─────────────────┬─────┬────────┬─────┬─────────╮\n│ Contract1 contract ┆                 ┆     ┆        ┆     ┆         │\n╞════════════════════╪═════════════════╪═════╪════════╪═════╪═════════╡\n│ Deployment Cost    ┆ Deployment Size ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ 26881              ┆ 164             ┆     ┆        ┆     ┆         │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ Function Name      ┆ min             ┆ avg ┆ median ┆ max ┆ # calls │\n├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤\n│ customErrorMessage ┆ 161             ┆ 161 ┆ 161    ┆ 161 ┆ 1       │\n╰────────────────────┴─────────────────┴─────┴────────┴─────┴─────────╯\n```\n\n### Lines\n\nFor full list of line references, see warden's [original submission](https://github.com/code-423n4/2022-07-ens-findings/issues/176).\n\n**[jefflau (ENS) commented](https://github.com/code-423n4/2022-07-ens-findings/issues/176#issuecomment-1200872608):**\n > High quality submission with gas tables and reproduction.\n\n\n\n***\n\n# Disclosures\n\nC4 is an open organization governed by participants in the community.\n\nC4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\n\nC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\n"
}