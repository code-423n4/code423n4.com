{
  "circa": {
    "title": "Slingshot Finance contest",
    "sponsor": "Slingshot Finance",
    "slug": "2021-10-slingshot",
    "date": "2021-11-17",
    "findings": "https://github.com/code-423n4/2021-10-slingshot-findings/issues",
    "contest": 48
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the code contest outlined in this document, C4 conducted an analysis of Slingshot Finance smart contract system written in Solidity. The code contest took place between October 30—November 1 2021.</p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>18 Wardens contributed reports to the Slingshot Finance code contest:</p>\n<ol>\n<li><a href=\"https://twitter.com/WatchPug_\">WatchPug</a></li>\n<li><a href=\"https://daejunpark.github.io/\">daejunpark</a></li>\n<li><a href=\"https://twitter.com/gpersoon\">gpersoon</a></li>\n<li><a href=\"https://twitter.com/HickupH\">hickuphh3</a></li>\n<li><a href=\"https://twitter.com/KenzoAgada\">kenzo</a></li>\n<li><a href=\"https://twitter.com/merkleplant_eth\">pmerkleplant</a></li>\n<li><a href=\"https://twitter.com/SolidityDev\">pauliax</a></li>\n<li><a href=\"https://twitter.com/_ye0lde\">ye0lde</a></li>\n<li><a href=\"https://twitter.com/cmichelio\">cmichel</a></li>\n<li><a href=\"https://github.com/TomAFrench\">TomFrench</a></li>\n<li><a href=\"https://twitter.com/csanuragjain\">csanuragjain</a></li>\n<li>pants</li>\n<li><a href=\"https://twitter.com/onewayfunction\">onewayfunction</a></li>\n<li><a href=\"https://twitter.com/zer0dots\">zer0dot</a></li>\n<li><a href=\"https://twitter.com/defsec_\">defsec</a></li>\n<li>0x0x0x</li>\n<li>elprofesor</li>\n<li><a href=\"https://twitter.com/gzeon\">gzeon</a></li>\n</ol>\n<p>This contest was judged by <a href=\"https://twitter.com/alcueca\">Alberto Cuesta Cañada</a>.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/itsmetechjay\">itsmetechjay</a> and <a href=\"https://twitter.com/CloudEllie1\">CloudEllie</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 14 unique vulnerabilities and 55 total findings. All of the issues presented here are linked back to their original finding.</p>\n<p>Of these vulnerabilities, 0 received a risk rating in the category of HIGH severity, 2 received a risk rating in the category of MEDIUM severity, and 12 received a risk rating in the category of LOW severity.</p>\n<p>C4 analysis also identified 17 non-critical recommendations and 24 gas optimizations.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2021-10-slingshot\">C4 Slingshot Finance contest repository</a>, and is composed of 16 smart contracts written in the Solidity programming language and includes 649 lines of Solidity code and 0 lines of JavaScript.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code423n4.com\">the C4 website</a>.</p>\n<!-- ============ -->\n<!-- ============ -->\n<h1 id=\"medium-risk-findings-2\" style=\"position:relative;\"><a href=\"#medium-risk-findings-2\" aria-label=\"medium risk findings 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings (2)</h1>\n<h2 id=\"m-01-initialbalance-for-native-token-is-wrong\" style=\"position:relative;\"><a href=\"#m-01-initialbalance-for-native-token-is-wrong\" aria-label=\"m 01 initialbalance for native token is wrong permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/59\">[M-01] <code>initialBalance</code> for native token is wrong</a></h2>\n<p><em>Submitted by WatchPug, also found by daejunpark, gpersoon, hickuphh3, kenzo, and pmerkleplant</em>.</p>\n<p><a href=\"https://github.com/code-423n4/2021-10-slingshot/blob/9c0432cca2e43731d5a0ae9c151dacf7835b8719/contracts/Slingshot.sol#L65-L92\">https://github.com/code-423n4/2021-10-slingshot/blob/9c0432cca2e43731d5a0ae9c151dacf7835b8719/contracts/Slingshot.sol#L65-L92</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">executeTrades</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">fromToken</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">toToken</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">fromAmount</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">TradeFormat</span><span class=\"mtk1\">[] </span><span class=\"mtk12\">calldata</span><span class=\"mtk1\"> </span><span class=\"mtk12\">trades</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">finalAmountMin</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">depricated</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">) </span><span class=\"mtk11\">external</span><span class=\"mtk1\"> </span><span class=\"mtk11\">nonReentrant</span><span class=\"mtk1\"> </span><span class=\"mtk11\">payable</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">depricated</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">finalAmountMin</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;Slingshot: finalAmountMin cannot be zero&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">trades</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;Slingshot: trades cannot be empty&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">trades</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Checks to make sure that module exists and is correct</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">moduleRegistry</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isModule</span><span class=\"mtk1\">(</span><span class=\"mtk12\">trades</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">].</span><span class=\"mtk12\">moduleAddress</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&quot;Slingshot: not a module&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">initialBalance</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">_getTokenBalance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">toToken</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">_transferFromOrWrap</span><span class=\"mtk1\">(</span><span class=\"mtk12\">fromToken</span><span class=\"mtk1\">, </span><span class=\"mtk11\">_msgSender</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">fromAmount</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">executioner</span><span class=\"mtk1\">.</span><span class=\"mtk11\">executeTrades</span><span class=\"mtk1\">(</span><span class=\"mtk12\">trades</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">finalBalance</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">toToken</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">nativeToken</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">finalBalance</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">_getTokenBalance</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">wrappedNativeToken</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">finalBalance</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">_getTokenBalance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">toToken</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">finalOutputAmount</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">finalBalance</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">initialBalance</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span></code></pre>\n<p><a href=\"https://github.com/code-423n4/2021-10-slingshot/blob/9c0432cca2e43731d5a0ae9c151dacf7835b8719/contracts/Slingshot.sol#L157-L163\">https://github.com/code-423n4/2021-10-slingshot/blob/9c0432cca2e43731d5a0ae9c151dacf7835b8719/contracts/Slingshot.sol#L157-L163</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">_getTokenBalance</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token</span><span class=\"mtk1\">) </span><span class=\"mtk11\">internal</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint256</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">token</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">nativeToken</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">executioner</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">IERC20</span><span class=\"mtk1\">(</span><span class=\"mtk12\">token</span><span class=\"mtk1\">).</span><span class=\"mtk11\">balanceOf</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">executioner</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>When users swap to native token (ETH), the <code>initialBalance</code> should use the balance of <code>wrappedNativeToken</code> instead of native token balance, because <code>finalBalance</code> is the balance of <code>wrappedNativeToken</code>.</p>\n<p>In the current implementation, when the <code>toToken</code> is the native token, <code>initialBalance</code> will be the ether balance of <code>executioner</code> contract. Therefore, when the ether balance of <code>executioner</code> is not 0, <code>finalOutputAmount</code> will be wrong.</p>\n<p>The attacker can transfer a certain amount of ETH to the <code>executioner</code> contract and malfunction the protocol. Causing fund loss to users because <code>finalOutputAmount</code> is lower than the actual swapped amount, or DoS due to <code>finalAmountMin</code> cant be met.</p>\n<h4 id=\"proof-of-concept\" style=\"position:relative;\"><a href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<p>Given:</p>\n<ul>\n<li>The attacker send 0.25 ETH to the <code>executioner</code> contract;</li>\n<li>The price of ETH in USDC is: 4000</li>\n<li>Alice swaps 5000 USDC to 1.25 ETH with <code>finalAmountMin</code> set to <code>1 ETH</code>;</li>\n<li>Alice will get 1 ETH out and lose 0.25 ETH;</li>\n<li>Bob swaps 1000 USDC to 0.25 ETH with <code>finalAmountMin</code> set to <code>1 wei</code>;</li>\n<li>Bob’s transaction fails due to <code>finalAmountMin</code> cant being met.</li>\n</ul>\n<h4 id=\"recommendation\" style=\"position:relative;\"><a href=\"#recommendation\" aria-label=\"recommendation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommendation</h4>\n<p>Consider updating <code>_getTokenBalance()</code> and return <code>IERC20(wrappedNativeToken).balanceOf(address(executioner));</code> when <code>token == nativeToken</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/59#issuecomment-959279936\">tommyz7 (Slingshot) disagreed with severity</a>:</strong></p>\n<blockquote>\n<p>“Alice swaps 5000 USDC to 1.25 ETH with finalAmountMin set to 1 ETH;” this assumption is wrong because it’s based on huge slippage assumption. There is no way a Slingshot transaction accepts 20% slippage so funds loss scenario is incorrect.</p>\n<p>duplicate of #18, medium risk since no user funds are at risk.</p>\n</blockquote>\n<h2 id=\"m-02-trades-where-totoken-is-feeontransfertoken-might-send-user-less-tokens-than-finalamountmin\" style=\"position:relative;\"><a href=\"#m-02-trades-where-totoken-is-feeontransfertoken-might-send-user-less-tokens-than-finalamountmin\" aria-label=\"m 02 trades where totoken is feeontransfertoken might send user less tokens than finalamountmin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/77\">[M-02] Trades where toToken is feeOnTransferToken might send user less tokens than finalAmountMin</a></h2>\n<p><em>Submitted by kenzo</em>.</p>\n<p>Slingshot’s <code>executeTrades</code> checks that the trade result amount (to be sent to the user) is bigger than <code>finalAmountMin</code>, and <em>after that</em> sends the user the amount. But if the token charges fee on transfer, the final transfer to the user will decrease the amount the user is getting, maybe below <code>finalAmountMin</code>.</p>\n<h4 id=\"proof-of-concept-1\" style=\"position:relative;\"><a href=\"#proof-of-concept-1\" aria-label=\"proof of concept 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<p>Slingshot requires <code>finalOutputAmount >= finalAmountMin</code> <em>before</em> sending the funds to the user:\n<a href=\"https://github.com/code-423n4/2021-10-slingshot/blob/main/contracts/Slingshot.sol#L93:#L98\">https://github.com/code-423n4/2021-10-slingshot/blob/main/contracts/Slingshot.sol#L93:#L98</a>\nSo if the token charges fees on transfer, the user will get less tokens than <code>finalOutputAmount</code> . The check of <code>finalOutputAmount</code> against <code>finalAmountMin</code> is premature.</p>\n<h4 id=\"tools-used\" style=\"position:relative;\"><a href=\"#tools-used\" aria-label=\"tools used permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools Used</h4>\n<p>Manual analysis</p>\n<h4 id=\"recommended-mitigation-steps\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h4>\n<p>Save the user’s (not Executioner’s) <code>toToken</code> balance in the beginning of <code>executeTrades</code> after <code>_transferFromOrWrap(fromToken, _msgSender(), fromAmount)</code>, and also in the very end, after <code>executioner.sendFunds(toToken, _msgSender(), finalOutputAmount)</code> has been called. The subtraction of user’s initial balance from ending balance should be bigger than <code>finalAmountMin</code>.\n<a href=\"https://github.com/code-423n4/2021-10-slingshot/blob/main/contracts/Slingshot.sol#L65:#L99\">https://github.com/code-423n4/2021-10-slingshot/blob/main/contracts/Slingshot.sol#L65:#L99</a></p>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/77#issuecomment-959385967\">tommyz7 (Slingshot) disagreed with severity</a>:</strong></p>\n<blockquote>\n<p>Slingshot concern is to execute the trade as promised and make sure we are sending to the user what has been promised in trade estimation. If the token adds additional taxation on transfer, it is on the user side and users understand and accept this. We have seen this play out on production for the previous version of the contracts and we decided not to make that check. It seems the most practical decision.</p>\n<p>Personally, I think this is non-critical.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/77#issuecomment-962400182\">alcueca (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The severity for the issue is right. The sponsor should add documentation to the fact that some tokens might not conform to common expectations.</p>\n</blockquote>\n<h1 id=\"low-risk-findings-12\" style=\"position:relative;\"><a href=\"#low-risk-findings-12\" aria-label=\"low risk findings 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk Findings (12)</h1>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/25\">[L-01] Unnecessary and risky <code>payable</code> annotation in swap() functions</a> <em>Submitted by daejunpark, also found by pauliax</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/30\">[L-02] Inaccurate comment (rescueTokensFromExecutioner)</a> <em>Submitted by ye0lde</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/38\">[L-03] BalancerV2ModuleMatic: Ensure tokenOut is not native token</a> <em>Submitted by hickuphh3</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/40\">[L-04] Executioner: Restrict funds receivable to be only from wrapped native token</a> <em>Submitted by hickuphh3</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/46\">[L-05] Slingshot: Unnecessary receive()</a> <em>Submitted by hickuphh3</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/47\">[L-06] Function documentation incorrect for <code>ConcatStrings::appendUint</code></a> <em>Submitted by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/53\">[L-07] Function documentation incorrect for <code>Slingshot::_transferFromOrWrap</code></a> <em>Submitted by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/81\">[L-10] <code>LibERC20Token.approveIfBelow</code> should approve(0) first</a> <em>Submitted by cmichel</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/82\">[L-11] Left-over tokens can be stolen</a> <em>Submitted by cmichel</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/84\">[L-12] Confusing comment on IUniswapModule</a> <em>Submitted by kenzo</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/85\">[L-13] Confusing comment in CurveModule</a> <em>Submitted by kenzo</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/94\">[L-14] receive function</a> <em>Submitted by pauliax</em>.</li>\n</ul>\n<h1 id=\"non-critical-findings-17\" style=\"position:relative;\"><a href=\"#non-critical-findings-17\" aria-label=\"non critical findings 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non-Critical Findings (17)</h1>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/1\">[N-01] ModuleRegistry doesn’t need to know address of Slingshot.sol</a> <em>Submitted by TomFrench</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/2\">[N-02] Malicious governance can abuse approvals to ApprovalHandler</a> <em>Submitted by TomFrench</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/24\">[N-03] Flaws in Slingshot._sendFunds()</a> <em>Submitted by daejunpark, also found by gpersoon, hickuphh3, kenzo, and pauliax</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/37\">[N-04] String concatenation in revert messages results in increased gas costs + code complexity</a> <em>Submitted by TomFrench</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/43\">[N-05] Slingshot: Incorrect comment for rescueTokensFromExecutioner()</a> <em>Submitted by hickuphh3</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/45\">[N-06] Slingshot: Index fromToken and toToken for Trade event</a> <em>Submitted by hickuphh3</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/48\">[N-07] Inconsistent naming for functions in <code>ConcatStrings.sol</code></a> <em>Submitted by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/49\">[N-08] Error messages in <code>ModuleRegistry.sol</code> inconsistent to the rest of the project</a> <em>Submitted by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/50\">[N-09] <code>Adminable::setupAdmin</code> uses deprecated function</a> <em>Submitted by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/65\">[N-10] Code Style: Abstract contracts should not be prefixed by <code>I</code></a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/66\">[N-11] <code>SlingshotI</code> is unnecessary</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/67\">[N-12] Code Style: consistency</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/70\">[N-13] Outdated compiler version</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/71\">[N-14] Typos</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/80\">[N-15] <code>Slingshot._sendFunds</code> function not used and wrong</a> <em>Submitted by cmichel, also found by csanuragjain, WatchPug, WatchPug, and ye0lde</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/56\">[N-16] <code>CurveModule.sol#swap()</code> Unused parameter</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/55\">[N-17] Redundant code</a> <em>Submitted by WatchPug</em>.</li>\n</ul>\n<h1 id=\"gas-optimizations-24\" style=\"position:relative;\"><a href=\"#gas-optimizations-24\" aria-label=\"gas optimizations 24 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations (24)</h1>\n<ul>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/3\">[G-01] Use of constant <code>keccak</code> variables results in extra hashing (and so gas).</a> <em>Submitted by TomFrench</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/5\">[G-02] _transferFromOrWrap could be set private to save gas</a> <em>Submitted by pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/6\">[G-03] The function _getTokenBalance could be set private to save gas</a> <em>Submitted by pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/7\">[G-04] The function _sendFunds could be set private to save gas</a> <em>Submitted by pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/9\">[G-05] A more efficient for loop index proceeding</a> <em>Submitted by pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/15\">[G-06] nonReentrant modifier isn’t necessary for executeTrades function</a> <em>Submitted by pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/16\">[G-07] getRouter methods could be set external instead public</a> <em>Submitted by pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/90\">[G-08] Small gas improvement</a> <em>Submitted by onewayfunction</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/22\">[G-09] Unnecessary Use of _msgSender()</a> <em>Submitted by zer0dot</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/27\">[G-10] Redundant Code Statement</a> <em>Submitted by defsec</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/31\">[G-11] Unused Named Returns (ConcatStrings.sol)</a> <em>Submitted by ye0lde</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/32\">[G-12] Long Revert Strings</a> <em>Submitted by ye0lde, also found by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/35\">[G-13] <code>> 0</code> can be replaced with <code>!= 0</code> for gas optimisation</a> <em>Submitted by 0x0x0x</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/39\">[G-14] CurveModule: Redundant jToken</a> <em>Submitted by hickuphh3, also found by pmerkleplant</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/41\">[G-15] ModuleRegistry: Rename modulesIndex → isModule</a> <em>Submitted by hickuphh3</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/57\">[G-16] Avoid unnecessary code execution can save gas</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/61\">[G-17] <code>IUniswapModule.sol</code> use an immutable variable <code>router</code> can save gas and simplify implementation</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/62\">[G-18] Remove redundant access control checks can save gas</a> <em>Submitted by WatchPug, also found by pauliax</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/63\">[G-19] Cache array length in for loops can save gas</a> <em>Submitted by WatchPug, also found by 0x0x0x, pants, and pants</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/68\">[G-20] Adding unchecked directive can save gas</a> <em>Submitted by WatchPug, also found by pauliax</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/69\">[G-21] Avoid unnecessary storage read can save gas</a> <em>Submitted by WatchPug, also found by 0x0x0x</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/73\">[G-22] Combine external calls into one can save gas</a> <em>Submitted by WatchPug</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/83\">[G-23] Gas: Use a constant instead of <code>block.timestamp</code> for the deadline</a> <em>Submitted by cmichel</em>.</li>\n<li><a href=\"https://github.com/code-423n4/2021-10-slingshot-findings/issues/88\">[G-24] ConcatStrings prependNumber is not used</a> <em>Submitted by kenzo, also found by pauliax</em>.</li>\n</ul>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li>\n<p><a href=\"#medium-risk-findings-2\">Medium Risk Findings (2)</a></p>\n<ul>\n<li><a href=\"#m-01-initialbalance-for-native-token-is-wrong\">[M-01] <code>initialBalance</code> for native token is wrong</a></li>\n<li><a href=\"#m-02-trades-where-totoken-is-feeontransfertoken-might-send-user-less-tokens-than-finalamountmin\">[M-02] Trades where toToken is feeOnTransferToken might send user less tokens than finalAmountMin</a></li>\n</ul>\n</li>\n<li><a href=\"#low-risk-findings-12\">Low Risk Findings (12)</a></li>\n<li><a href=\"#non-critical-findings-17\">Non-Critical Findings (17)</a></li>\n<li><a href=\"#gas-optimizations-24\">Gas Optimizations (24)</a></li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>",
  "md": "\n# Overview\n\n## About C4\n\nCode 432n4 (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.\n\nA C4 code contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\n\nDuring the code contest outlined in this document, C4 conducted an analysis of Slingshot Finance smart contract system written in Solidity. The code contest took place between October 30—November 1 2021.\n\n## Wardens\n\n18 Wardens contributed reports to the Slingshot Finance code contest:\n\n1. [WatchPug](https://twitter.com/WatchPug_)\n1. [daejunpark](https://daejunpark.github.io/)\n1. [gpersoon](https://twitter.com/gpersoon)\n1. [hickuphh3](https://twitter.com/HickupH)\n1. [kenzo](https://twitter.com/KenzoAgada)\n1. [pmerkleplant](https://twitter.com/merkleplant_eth)\n1. [pauliax](https://twitter.com/SolidityDev)\n1. [ye0lde](https://twitter.com/_ye0lde)\n1. [cmichel](https://twitter.com/cmichelio)\n1. [TomFrench](https://github.com/TomAFrench)\n1. [csanuragjain](https://twitter.com/csanuragjain)\n1. pants\n1. [onewayfunction](https://twitter.com/onewayfunction)\n1. [zer0dot](https://twitter.com/zer0dots)\n1. [defsec](https://twitter.com/defsec_)\n1. 0x0x0x\n1. elprofesor\n1. [gzeon](https://twitter.com/gzeon)\n\nThis contest was judged by [Alberto Cuesta Cañada](https://twitter.com/alcueca).\n\nFinal report assembled by [itsmetechjay](https://twitter.com/itsmetechjay) and [CloudEllie](https://twitter.com/CloudEllie1).\n\n# Summary\n\nThe C4 analysis yielded an aggregated total of 14 unique vulnerabilities and 55 total findings. All of the issues presented here are linked back to their original finding.\n\nOf these vulnerabilities, 0 received a risk rating in the category of HIGH severity, 2 received a risk rating in the category of MEDIUM severity, and 12 received a risk rating in the category of LOW severity.\n\nC4 analysis also identified 17 non-critical recommendations and 24 gas optimizations.\n\n# Scope\n\nThe code under review can be found within the [C4 Slingshot Finance contest repository](https://github.com/code-423n4/2021-10-slingshot), and is composed of 16 smart contracts written in the Solidity programming language and includes 649 lines of Solidity code and 0 lines of JavaScript.\n\n# Severity Criteria\n\nC4 assesses the severity of disclosed vulnerabilities according to a methodology based on [OWASP standards](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).\n\nVulnerabilities are divided into three primary risk categories: high, medium, and low.\n\nHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\n\n- Malicious Input Handling\n- Escalation of privileges\n- Arithmetic\n- Gas use\n\nFurther information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on [the C4 website](https://code423n4.com).\n\n<!-- ============ -->\n<!-- ============ -->\n# Medium Risk Findings (2)\n## [[M-01] `initialBalance` for native token is wrong](https://github.com/code-423n4/2021-10-slingshot-findings/issues/59)\n_Submitted by WatchPug, also found by daejunpark, gpersoon, hickuphh3, kenzo, and pmerkleplant_.\n\n<https://github.com/code-423n4/2021-10-slingshot/blob/9c0432cca2e43731d5a0ae9c151dacf7835b8719/contracts/Slingshot.sol#L65-L92>\n\n```solidity\nfunction executeTrades(\n    address fromToken,\n    address toToken,\n    uint256 fromAmount,\n    TradeFormat[] calldata trades,\n    uint256 finalAmountMin,\n    address depricated\n) external nonReentrant payable {\n    depricated;\n    require(finalAmountMin > 0, \"Slingshot: finalAmountMin cannot be zero\");\n    require(trades.length > 0, \"Slingshot: trades cannot be empty\");\n    for(uint256 i = 0; i < trades.length; i++) {\n        // Checks to make sure that module exists and is correct\n        require(moduleRegistry.isModule(trades[i].moduleAddress), \"Slingshot: not a module\");\n    }\n\n    uint256 initialBalance = _getTokenBalance(toToken);\n    _transferFromOrWrap(fromToken, _msgSender(), fromAmount);\n\n    executioner.executeTrades(trades);\n\n    uint finalBalance;\n    if (toToken == nativeToken) {\n        finalBalance = _getTokenBalance(address(wrappedNativeToken));\n    } else {\n        finalBalance = _getTokenBalance(toToken);\n    }\n    uint finalOutputAmount = finalBalance - initialBalance;\n    ...\n```\n\n<https://github.com/code-423n4/2021-10-slingshot/blob/9c0432cca2e43731d5a0ae9c151dacf7835b8719/contracts/Slingshot.sol#L157-L163>\n\n```solidity\nfunction _getTokenBalance(address token) internal view returns (uint256) {\n    if (token == nativeToken) {\n        return address(executioner).balance;\n    } else {\n        return IERC20(token).balanceOf(address(executioner));\n    }\n}\n```\n\nWhen users swap to native token (ETH), the `initialBalance` should use the balance of `wrappedNativeToken` instead of native token balance, because `finalBalance` is the balance of `wrappedNativeToken`.\n\nIn the current implementation, when the `toToken` is the native token, `initialBalance` will be the ether balance of `executioner` contract. Therefore, when the ether balance of `executioner` is not 0, `finalOutputAmount` will be wrong.\n\nThe attacker can transfer a certain amount of ETH to the `executioner` contract and malfunction the protocol. Causing fund loss to users because `finalOutputAmount` is lower than the actual swapped amount, or DoS due to `finalAmountMin` cant be met.\n\n#### Proof of Concept\n\nGiven:\n\n*   The attacker send 0.25 ETH to the `executioner` contract;\n*   The price of ETH in USDC is: 4000\n\n1.  Alice swaps 5000 USDC to 1.25 ETH with `finalAmountMin` set to `1 ETH`;\n2.  Alice will get 1 ETH out and lose 0.25 ETH;\n3.  Bob swaps 1000 USDC to 0.25 ETH with `finalAmountMin` set to `1 wei`;\n4.  Bob's transaction fails due to `finalAmountMin` cant being met.\n\n#### Recommendation\n\nConsider updating `_getTokenBalance()` and return `IERC20(wrappedNativeToken).balanceOf(address(executioner));` when `token == nativeToken`.\n\n**[tommyz7 (Slingshot) disagreed with severity](https://github.com/code-423n4/2021-10-slingshot-findings/issues/59#issuecomment-959279936):**\n > \"Alice swaps 5000 USDC to 1.25 ETH with finalAmountMin set to 1 ETH;\" this assumption is wrong because it's based on huge slippage assumption. There is no way a Slingshot transaction accepts 20% slippage so funds loss scenario is incorrect.\n> \n> duplicate of #18, medium risk since no user funds are at risk.\n\n\n\n## [[M-02] Trades where toToken is feeOnTransferToken might send user less tokens than finalAmountMin](https://github.com/code-423n4/2021-10-slingshot-findings/issues/77)\n_Submitted by kenzo_.\n\nSlingshot's `executeTrades` checks that the trade result amount (to be sent to the user) is bigger than `finalAmountMin`, and *after that* sends the user the amount. But if the token charges fee on transfer, the final transfer to the user will decrease the amount the user is getting, maybe below `finalAmountMin`.\n\n#### Proof of Concept\n\nSlingshot requires `finalOutputAmount >= finalAmountMin` *before* sending the funds to the user:\n<https://github.com/code-423n4/2021-10-slingshot/blob/main/contracts/Slingshot.sol#L93:#L98>\nSo if the token charges fees on transfer, the user will get less tokens than `finalOutputAmount` . The check of `finalOutputAmount` against `finalAmountMin` is premature.\n\n#### Tools Used\n\nManual analysis\n\n#### Recommended Mitigation Steps\n\nSave the user's (not Executioner's) `toToken` balance in the beginning of `executeTrades` after `_transferFromOrWrap(fromToken, _msgSender(), fromAmount)`, and also in the very end, after `executioner.sendFunds(toToken, _msgSender(), finalOutputAmount)` has been called. The subtraction of user's initial balance from ending balance should be bigger than `finalAmountMin`.\n<https://github.com/code-423n4/2021-10-slingshot/blob/main/contracts/Slingshot.sol#L65:#L99>\n\n**[tommyz7 (Slingshot) disagreed with severity](https://github.com/code-423n4/2021-10-slingshot-findings/issues/77#issuecomment-959385967):**\n > Slingshot concern is to execute the trade as promised and make sure we are sending to the user what has been promised in trade estimation. If the token adds additional taxation on transfer, it is on the user side and users understand and accept this. We have seen this play out on production for the previous version of the contracts and we decided not to make that check. It seems the most practical decision.\n> \n> Personally, I think this is non-critical.\n\n**[alcueca (judge) commented](https://github.com/code-423n4/2021-10-slingshot-findings/issues/77#issuecomment-962400182):**\n > The severity for the issue is right. The sponsor should add documentation to the fact that some tokens might not conform to common expectations.\n\n# Low Risk Findings (12)\n- [[L-01] Unnecessary and risky `payable` annotation in swap() functions](https://github.com/code-423n4/2021-10-slingshot-findings/issues/25) _Submitted by daejunpark, also found by pauliax_.\n- [[L-02] Inaccurate comment (rescueTokensFromExecutioner)](https://github.com/code-423n4/2021-10-slingshot-findings/issues/30) _Submitted by ye0lde_.\n- [[L-03] BalancerV2ModuleMatic: Ensure tokenOut is not native token](https://github.com/code-423n4/2021-10-slingshot-findings/issues/38) _Submitted by hickuphh3_.\n- [[L-04] Executioner: Restrict funds receivable to be only from wrapped native token](https://github.com/code-423n4/2021-10-slingshot-findings/issues/40) _Submitted by hickuphh3_.\n- [[L-05] Slingshot: Unnecessary receive()](https://github.com/code-423n4/2021-10-slingshot-findings/issues/46) _Submitted by hickuphh3_.\n- [[L-06] Function documentation incorrect for `ConcatStrings::appendUint`](https://github.com/code-423n4/2021-10-slingshot-findings/issues/47) _Submitted by pmerkleplant_.\n- [[L-07] Function documentation incorrect for `Slingshot::_transferFromOrWrap`](https://github.com/code-423n4/2021-10-slingshot-findings/issues/53) _Submitted by pmerkleplant_.\n- [[L-10] `LibERC20Token.approveIfBelow` should approve(0) first](https://github.com/code-423n4/2021-10-slingshot-findings/issues/81) _Submitted by cmichel_.\n- [[L-11] Left-over tokens can be stolen](https://github.com/code-423n4/2021-10-slingshot-findings/issues/82) _Submitted by cmichel_.\n- [[L-12] Confusing comment on IUniswapModule](https://github.com/code-423n4/2021-10-slingshot-findings/issues/84) _Submitted by kenzo_.\n- [[L-13] Confusing comment in CurveModule](https://github.com/code-423n4/2021-10-slingshot-findings/issues/85) _Submitted by kenzo_.\n- [[L-14] receive function](https://github.com/code-423n4/2021-10-slingshot-findings/issues/94) _Submitted by pauliax_.\n\n# Non-Critical Findings (17)\n- [[N-01] ModuleRegistry doesn't need to know address of Slingshot.sol](https://github.com/code-423n4/2021-10-slingshot-findings/issues/1) _Submitted by TomFrench_.\n- [[N-02] Malicious governance can abuse approvals to ApprovalHandler](https://github.com/code-423n4/2021-10-slingshot-findings/issues/2) _Submitted by TomFrench_.\n- [[N-03] Flaws in Slingshot._sendFunds()](https://github.com/code-423n4/2021-10-slingshot-findings/issues/24) _Submitted by daejunpark, also found by gpersoon, hickuphh3, kenzo, and pauliax_.\n- [[N-04] String concatenation in revert messages results in increased gas costs + code complexity](https://github.com/code-423n4/2021-10-slingshot-findings/issues/37) _Submitted by TomFrench_.\n- [[N-05] Slingshot: Incorrect comment for rescueTokensFromExecutioner()](https://github.com/code-423n4/2021-10-slingshot-findings/issues/43) _Submitted by hickuphh3_.\n- [[N-06] Slingshot: Index fromToken and toToken for Trade event](https://github.com/code-423n4/2021-10-slingshot-findings/issues/45) _Submitted by hickuphh3_.\n- [[N-07] Inconsistent naming for functions in `ConcatStrings.sol`](https://github.com/code-423n4/2021-10-slingshot-findings/issues/48) _Submitted by pmerkleplant_.\n- [[N-08] Error messages in `ModuleRegistry.sol` inconsistent to the rest of the project](https://github.com/code-423n4/2021-10-slingshot-findings/issues/49) _Submitted by pmerkleplant_.\n- [[N-09] `Adminable::setupAdmin` uses deprecated function](https://github.com/code-423n4/2021-10-slingshot-findings/issues/50) _Submitted by pmerkleplant_.\n- [[N-10] Code Style: Abstract contracts should not be prefixed by `I`](https://github.com/code-423n4/2021-10-slingshot-findings/issues/65) _Submitted by WatchPug_.\n- [[N-11] `SlingshotI` is unnecessary](https://github.com/code-423n4/2021-10-slingshot-findings/issues/66) _Submitted by WatchPug_.\n- [[N-12] Code Style: consistency](https://github.com/code-423n4/2021-10-slingshot-findings/issues/67) _Submitted by WatchPug_.\n- [[N-13] Outdated compiler version](https://github.com/code-423n4/2021-10-slingshot-findings/issues/70) _Submitted by WatchPug_.\n- [[N-14] Typos](https://github.com/code-423n4/2021-10-slingshot-findings/issues/71) _Submitted by WatchPug_.\n- [[N-15] `Slingshot._sendFunds` function not used and wrong](https://github.com/code-423n4/2021-10-slingshot-findings/issues/80) _Submitted by cmichel, also found by csanuragjain, WatchPug, WatchPug, and ye0lde_.\n- [[N-16] `CurveModule.sol#swap()` Unused parameter](https://github.com/code-423n4/2021-10-slingshot-findings/issues/56) _Submitted by WatchPug_.\n- [[N-17] Redundant code](https://github.com/code-423n4/2021-10-slingshot-findings/issues/55) _Submitted by WatchPug_.\n\n# Gas Optimizations (24)\n- [[G-01] Use of constant `keccak` variables results in extra hashing (and so gas).](https://github.com/code-423n4/2021-10-slingshot-findings/issues/3) _Submitted by TomFrench_.\n- [[G-02] _transferFromOrWrap could be set private to save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/5) _Submitted by pants_.\n- [[G-03] The function _getTokenBalance could be set private to save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/6) _Submitted by pants_.\n- [[G-04] The function _sendFunds could be set private to save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/7) _Submitted by pants_.\n- [[G-05] A more efficient for loop index proceeding](https://github.com/code-423n4/2021-10-slingshot-findings/issues/9) _Submitted by pants_.\n- [[G-06] nonReentrant modifier isn't necessary for executeTrades function](https://github.com/code-423n4/2021-10-slingshot-findings/issues/15) _Submitted by pants_.\n- [[G-07] getRouter methods could be set external instead public](https://github.com/code-423n4/2021-10-slingshot-findings/issues/16) _Submitted by pants_.\n- [[G-08] Small gas improvement](https://github.com/code-423n4/2021-10-slingshot-findings/issues/90) _Submitted by onewayfunction_.\n- [[G-09] Unnecessary Use of _msgSender()](https://github.com/code-423n4/2021-10-slingshot-findings/issues/22) _Submitted by zer0dot_.\n- [[G-10] Redundant Code Statement](https://github.com/code-423n4/2021-10-slingshot-findings/issues/27) _Submitted by defsec_.\n- [[G-11] Unused Named Returns (ConcatStrings.sol)](https://github.com/code-423n4/2021-10-slingshot-findings/issues/31) _Submitted by ye0lde_.\n- [[G-12] Long Revert Strings](https://github.com/code-423n4/2021-10-slingshot-findings/issues/32) _Submitted by ye0lde, also found by WatchPug_.\n- [[G-13] `> 0` can be replaced with ` != 0` for gas optimisation](https://github.com/code-423n4/2021-10-slingshot-findings/issues/35) _Submitted by 0x0x0x_.\n- [[G-14] CurveModule: Redundant jToken](https://github.com/code-423n4/2021-10-slingshot-findings/issues/39) _Submitted by hickuphh3, also found by pmerkleplant_.\n- [[G-15] ModuleRegistry: Rename modulesIndex → isModule](https://github.com/code-423n4/2021-10-slingshot-findings/issues/41) _Submitted by hickuphh3_.\n- [[G-16] Avoid unnecessary code execution can save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/57) _Submitted by WatchPug_.\n- [[G-17] `IUniswapModule.sol` use an immutable variable `router` can save gas and simplify implementation](https://github.com/code-423n4/2021-10-slingshot-findings/issues/61) _Submitted by WatchPug_.\n- [[G-18] Remove redundant access control checks can save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/62) _Submitted by WatchPug, also found by pauliax_.\n- [[G-19] Cache array length in for loops can save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/63) _Submitted by WatchPug, also found by 0x0x0x, pants, and pants_.\n- [[G-20] Adding unchecked directive can save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/68) _Submitted by WatchPug, also found by pauliax_.\n- [[G-21] Avoid unnecessary storage read can save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/69) _Submitted by WatchPug, also found by 0x0x0x_.\n- [[G-22] Combine external calls into one can save gas](https://github.com/code-423n4/2021-10-slingshot-findings/issues/73) _Submitted by WatchPug_.\n- [[G-23] Gas: Use a constant instead of `block.timestamp` for the deadline](https://github.com/code-423n4/2021-10-slingshot-findings/issues/83) _Submitted by cmichel_.\n- [[G-24] ConcatStrings prependNumber is not used](https://github.com/code-423n4/2021-10-slingshot-findings/issues/88) _Submitted by kenzo, also found by pauliax_.\n\n# Disclosures\n\nC4 is an open organization governed by participants in the community.\n\nC4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\n\nC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\n"
}