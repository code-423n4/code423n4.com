{
  "circa": {
    "title": "Canto contest",
    "sponsor": "Canto",
    "slug": "2022-06-canto",
    "date": "2022-10-18",
    "findings": "https://github.com/code-423n4/2022-06-canto-findings/issues",
    "contest": 133
  },
  "html": "<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<h2 id=\"about-c4\" style=\"position:relative;\"><a href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>About C4</h2>\n<p>Code4rena (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.</p>\n<p>A C4 audit contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>\n<p>During the audit contest outlined in this document, C4 conducted an analysis of the Canto smart contract system written in Solidity. The audit contest took place between June 14—June 21 2022.</p>\n<p><em>Note: this audit contest originally ran under the name <code>New Blockchain</code>.</em></p>\n<h2 id=\"wardens\" style=\"position:relative;\"><a href=\"#wardens\" aria-label=\"wardens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wardens</h2>\n<p>63 Wardens contributed reports to the Canto contest:</p>\n<ol>\n<li><a href=\"https://twitter.com/WatchPug_\">WatchPug</a> (<a href=\"https://github.com/jack-the-pug\">jtp</a> and <a href=\"https://github.com/mingwatch\">ming</a>)</li>\n<li>cccz</li>\n<li>hake</li>\n<li><a href=\"https://twitter.com/0xruhum\">Ruhum</a></li>\n<li>0xf15ers (remora and twojoy)</li>\n<li><a href=\"https://twitter.com/thePicodes\">Picodes</a></li>\n<li>cryptphi</li>\n<li><a href=\"https://twitter.com/hansfriese\">hansfriese</a></li>\n<li><a href=\"https://chom.dev\">Chom</a></li>\n<li>p4st13r4 (<a href=\"https://github.com/0x69e8\">0x69e8</a> and 0xb4bb4)</li>\n<li><a href=\"https://twitter.com/TuturuTech\">Tutturu</a></li>\n<li><a href=\"https://twitter.com/gzeon\">gzeon</a></li>\n<li>0x52</li>\n<li>codexploder</li>\n<li>zzzitron</li>\n<li><a href=\"https://twitter.com/0xhyh\">hyh</a></li>\n<li>0x1f8b</li>\n<li><a href=\"https://twitter.com/csanuragjain\">csanuragjain</a></li>\n<li><a href=\"https://twitter.com/JoeStakey\">joestakey</a></li>\n<li>Soosh</li>\n<li>TerrierLover</li>\n<li><a href=\"https://twitter.com/defsec_\">defsec</a></li>\n<li><a href=\"https://twitter.com/catchup22\">catchup</a></li>\n<li><a href=\"https://twitter.com/BowTiedDravee\">Dravee</a></li>\n<li>_Adam</li>\n<li>Lambda</li>\n<li>0xDjango</li>\n<li>saian</li>\n<li>0xmint</li>\n<li><a href=\"https://twitter.com/andyfeili\">oyc_109</a></li>\n<li><a href=\"https://twitter.com/0xNazgul\">0xNazgul</a></li>\n<li>robee</li>\n<li>dipp</li>\n<li><a href=\"https://twitter.com/kylriley\">k</a></li>\n<li><a href=\"https://twitter.com/MukeshJ_eth\">JMukesh</a></li>\n<li><a href=\"https://mobile.twitter.com/tomj_bb\">TomJ</a></li>\n<li>Limbooo</li>\n<li>Waze</li>\n<li><a href=\"https://github.com/0xKitsune\">0xKitsune</a></li>\n<li><a href=\"https://instagram.com/vanensurya\">Funen</a></li>\n<li>sach1r0</li>\n<li>simon135</li>\n<li><a href=\"https://twitter.com/father0fBl0cks\">fatherOfBlocks</a></li>\n<li>0x29A (0x4non and rotcivegaf)</li>\n<li><a href=\"https://twitter.com/c3ph_\">c3phas</a></li>\n<li><a href=\"https://twitter.com/wookiemad\">MadWookie</a></li>\n<li><a href=\"https://twitter.com/Cryptonicle1\">Bronicle</a></li>\n<li>asutorufos</li>\n<li><a href=\"https://twitter.com/technicallyty\">technicallyty</a></li>\n<li>nxrblsrpr</li>\n<li><a href=\"https://twitter.com/0xheynacho\">ignacio</a></li>\n<li>0xkatana</li>\n<li><a href=\"https://twitter.com/sm4rtcontr4ct\">JC</a></li>\n<li><a href=\"https://www.instagram.com/riyan_rfa/\">rfa</a></li>\n<li><a href=\"https://twitter.com/meidhiwirara\">Tomio</a></li>\n<li><a href=\"https://twitter.com/ynnadt1\">ynnad</a></li>\n<li><a href=\"https://twitter.com/_0v3rf10w\">0v3rf10w</a></li>\n<li>ak1</li>\n<li><a href=\"https://twitter.com/fitraldys\">Fitraldys</a></li>\n</ol>\n<p>This contest was judged by <a href=\"https://twitter.com/GalloDaSballo\">Alex the Entreprenerd</a>.</p>\n<p>Final report assembled by <a href=\"https://twitter.com/liveactionllama\">liveactionllama</a>.</p>\n<h1 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h1>\n<p>The C4 analysis yielded an aggregated total of 26 unique vulnerabilities. Of these vulnerabilities, 14 received a risk rating in the category of HIGH severity and 12 received a risk rating in the category of MEDIUM severity.</p>\n<p>Additionally, C4 analysis included 45 reports detailing issues with a risk rating of LOW severity or non-critical. There were also 39 reports recommending gas optimizations.</p>\n<p>All of the issues presented here are linked back to their original finding.</p>\n<h1 id=\"scope\" style=\"position:relative;\"><a href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scope</h1>\n<p>The code under review can be found within the <a href=\"https://github.com/code-423n4/2022-06-canto\">C4 Canto contest repository</a>, and is composed of 15 smart contracts written in the Solidity programming language and includes 2,379 lines of Solidity code. One Cosmos SDK blockchain is also included.</p>\n<h1 id=\"severity-criteria\" style=\"position:relative;\"><a href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Severity Criteria</h1>\n<p>C4 assesses the severity of disclosed vulnerabilities according to a methodology based on <a href=\"https://owasp.org/www-community/OWASP_Risk_Rating_Methodology\">OWASP standards</a>.</p>\n<p>Vulnerabilities are divided into three primary risk categories: high, medium, and low/non-critical.</p>\n<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>\n<ul>\n<li>Malicious Input Handling</li>\n<li>Escalation of privileges</li>\n<li>Arithmetic</li>\n<li>Gas use</li>\n</ul>\n<p>Further information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href=\"https://code4rena.com\">the C4 website</a>.</p>\n<h1 id=\"high-risk-findings-14\" style=\"position:relative;\"><a href=\"#high-risk-findings-14\" aria-label=\"high risk findings 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>High Risk Findings (14)</h1>\n<h2 id=\"h-01-anyone-can-set-the-baserateperyear-after-the-updatefrequency-has-passed\" style=\"position:relative;\"><a href=\"#h-01-anyone-can-set-the-baserateperyear-after-the-updatefrequency-has-passed\" aria-label=\"h 01 anyone can set the baserateperyear after the updatefrequency has passed permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/22\">[H-01] Anyone can set the <code>baseRatePerYear</code> after the <code>updateFrequency</code> has passed</a></h2>\n<p><em>Submitted by 0xDjango, also found by 0x52, Chom, csanuragjain, JMukesh, k, oyc_109, Picodes, Soosh, and WatchPug</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/NoteInterest.sol#L118-L129\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/NoteInterest.sol#L118-L129</a></p>\n<p>The <code>updateBaseRate()</code> function is public and lacks access control, so anyone can set the critical variable <code>baseRatePerYear</code> once the block delta has surpassed the <code>updateFrequency</code> variable. This will have negative effects on the borrow and supply rates used anywhere else in the protocol.</p>\n<p>The updateFrequency is explained to default to 24 hours per the comments, so this vulnerability will be available every day. Important to note, the admin can fix the <code>baseRatePerYear</code> by calling the admin-only <code>_setBaseRatePerYear()</code> function. However, calling this function does not set the <code>lastUpdateBlock</code> so users will still be able to change the rate back after the 24 hours waiting period from the previous change.</p>\n<h3 id=\"proof-of-concept\" style=\"position:relative;\"><a href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    function updateBaseRate(uint newBaseRatePerYear) public {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        // check the current block number</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint blockNumber = block.number;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint deltaBlocks = blockNumber.sub(lastUpdateBlock);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        if (deltaBlocks &gt; updateFrequency) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            // pass in a base rate per year</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            baseRatePerYear = newBaseRatePerYear;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            lastUpdateBlock = blockNumber;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            emit NewInterestParams(baseRatePerYear);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>I have trouble understanding the intention of this function. It appears that the rate should only be able to be set by the admin, so the <code>_setBaseRatePerYear()</code> function seems sufficient. Otherwise, add access control for only trusted parties.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/22\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/22#issuecomment-1205570803\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to probably an oversight, a core function that has impact in determining the yearly interest rate was left open for anyone to change once every 24 hrs.</p>\n<p>Because the impact is:</p>\n<ul>\n<li>Potential bricking of integrating contracts</li>\n<li>Economic exploits</li>\n</ul>\n<p>And anyone can perform it</p>\n<p>I believe that High Severity is appropriate.</p>\n<p>Mitigation requires either deleting the function or adding access control.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-02-stealing-wrapped-manifest-in-wethsol\" style=\"position:relative;\"><a href=\"#h-02-stealing-wrapped-manifest-in-wethsol\" aria-label=\"h 02 stealing wrapped manifest in wethsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/19\">[H-02] Stealing Wrapped Manifest in WETH.sol</a></h2>\n<p><em>Submitted by Soosh, also found by 0x52, 0xDjango, cccz, saian, TerrierLover, WatchPug, and zzzitron</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/WETH.sol#L85\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/WETH.sol#L85</a></p>\n<p>Allows anyone to steal all wrapped manifest from the WETH.sol contract. Attacker can also withdraw\nto convert Wrapped Manifest to Manifest.</p>\n<p>Issue in approve(address owner, address spender) external function. This allows an attacker to approve themselves to spend another user’s tokens.</p>\n<p>Attacker can then use transferFrom(address src, address dst, uint wad) function to send tokens to themself.</p>\n<h3 id=\"proof-of-concept-1\" style=\"position:relative;\"><a href=\"#proof-of-concept-1\" aria-label=\"proof of concept 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>See warden’s <a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/19\">full report</a> for further details.</p>\n<h3 id=\"tools-used\" style=\"position:relative;\"><a href=\"#tools-used\" aria-label=\"tools used permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools Used</h3>\n<p>VScode, hardhat</p>\n<h3 id=\"recommended-mitigation-steps-1\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-1\" aria-label=\"recommended mitigation steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>I believe there is no need for this function. There is another approve(address guy, uint wad) function that uses msg.sender to approve allowance. There should be no need for someone to approve another user’s allowance.</p>\n<p>Remove the approve(address owner, address spender) function.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/19\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/19#issuecomment-1205591679\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, for whatever reason, an approve function which allows to pass the “approver” as parameter was present in the WETH contract.</p>\n<p>This allows anyone, to steal all WETH from any other holder.</p>\n<p>For that reason, High Severity is appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-03--accountantdelegate-sweepinterest-function-will-destroy-the-cnote-in-the-contract\" style=\"position:relative;\"><a href=\"#h-03--accountantdelegate-sweepinterest-function-will-destroy-the-cnote-in-the-contract\" aria-label=\"h 03  accountantdelegate sweepinterest function will destroy the cnote in the contract permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/89\">[H-03]  <code>AccountantDelegate</code>: <code>sweepInterest</code> function will destroy the cnote in the contract.</a></h2>\n<p><em>Submitted by cccz, also found by WatchPug</em></p>\n<p>When the user borrows note tokens, the AccountantDelegate contract provides note tokens and gets cnote tokens. Later, when the user repays the note tokens, the cnote tokens are destroyed and the note tokens are transferred to the AccountantDelegate contract.\nHowever, in the sweepInterest function of the AccountantDelegate contract, all cnote tokens in the contract will be transferred to address 0. This will prevent the user from repaying the note tokens, and the sweepInterest function will not calculate the interest correctly later.</p>\n<h3 id=\"proof-of-concept-2\" style=\"position:relative;\"><a href=\"#proof-of-concept-2\" aria-label=\"proof of concept 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegate.sol#L74-L92\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegate.sol#L74-L92</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CToken.sol#L533\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CToken.sol#L533</a></p>\n<h3 id=\"recommended-mitigation-steps-2\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-2\" aria-label=\"recommended mitigation steps 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    function sweepInterest() external override returns(uint) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tuint noteBalance = note.balanceOf(address(this));</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tuint CNoteBalance = cnote.balanceOf(address(this));</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tExp memory expRate = Exp({mantissa: cnote.exchangeRateStored()}); // obtain exchange Rate from cNote Lending Market as a mantissa (scaled by 1e18)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tuint cNoteConverted = mul_ScalarTruncate(expRate, CNoteBalance); //calculate truncate(cNoteBalance* mantissa{expRate})</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tuint noteDifferential = sub_(note.totalSupply(), noteBalance); //cannot underflow, subtraction first to prevent against overflow, subtraction as integers</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(cNoteConverted &gt;= noteDifferential, &quot;Note Loaned to LendingMarket must increase in value&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tuint amtToSweep = sub_(cNoteConverted, noteDifferential);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tnote.transfer(treasury, amtToSweep);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">-\t\tcnote.transfer(address(0), CNoteBalance);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\treturn 0;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/89\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/89#issuecomment-1205796186\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a programmer mistake, interest bearing Note will be burned.</p>\n<p>It is unclear why this decision was made, and I believe the sponsor should look into <code>redeem</code>ing the <code>cNote</code> over destroying it.</p>\n<p>The sponsor confirmed, and because this finding shows unconditional loss of assets, I agree with High Severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-04-lending-marketnoteinterestsol-wrong-implementation-of-getborrowrate\" style=\"position:relative;\"><a href=\"#h-04-lending-marketnoteinterestsol-wrong-implementation-of-getborrowrate\" aria-label=\"h 04 lending marketnoteinterestsol wrong implementation of getborrowrate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/166\">[H-04] <code>lending-market/NoteInterest.sol</code> Wrong implementation of <code>getBorrowRate()</code></a></h2>\n<p><em>Submitted by WatchPug, also found by 0x1f8b, Chom, and gzeon</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/NoteInterest.sol#L92-L101\">https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/NoteInterest.sol#L92-L101</a><br></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getBorrowRate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">cash</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">borrows</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">reserves</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> </span><span class=\"mtk11\">override</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Gets the Note/gUSDC TWAP in a given interval, as a mantissa (scaled by 1e18)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// uint twapMantissa = getUnderlyingPrice(note);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">rand</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">uint</span><span class=\"mtk1\">(</span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">))) % </span><span class=\"mtk7\">100</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ir</span><span class=\"mtk1\"> = (</span><span class=\"mtk7\">100</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">rand</span><span class=\"mtk1\">).</span><span class=\"mtk11\">mul</span><span class=\"mtk1\">(</span><span class=\"mtk12\">adjusterCoefficient</span><span class=\"mtk1\">).</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk12\">baseRatePerYear</span><span class=\"mtk1\">).</span><span class=\"mtk11\">mul</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1e16</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newRatePerYear</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">ir</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">ir</span><span class=\"mtk1\"> : </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// convert it to base rate per block</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newRatePerBlock</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">newRatePerYear</span><span class=\"mtk1\">.</span><span class=\"mtk11\">div</span><span class=\"mtk1\">(</span><span class=\"mtk12\">blocksPerYear</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newRatePerBlock</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>The current implementation will return a random rate based on the caller’s address and <code>baseRatePerYear</code>.</p>\n<p>This makes some lucky addresses pay much lower and some addresses pay much higher rates.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/166#issuecomment-1205799947\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to most likely a developer oversight, the unimplemented <code>getBorrowRate</code> returns a random value which can easily be gamed (and is not recommended for production).</p>\n<p>Because the contract is in scope, and the functionality is broken, I agree with High Severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-05-zeroswapuniswapv2librarysol-wrong-init-code-hash-in-uniswapv2librarypairfor-will-break-uniswapv2oracle-uniswapv2router02-sushiroll\" style=\"position:relative;\"><a href=\"#h-05-zeroswapuniswapv2librarysol-wrong-init-code-hash-in-uniswapv2librarypairfor-will-break-uniswapv2oracle-uniswapv2router02-sushiroll\" aria-label=\"h 05 zeroswapuniswapv2librarysol wrong init code hash in uniswapv2librarypairfor will break uniswapv2oracle uniswapv2router02 sushiroll permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/164\">[H-05] <code>zeroswap/UniswapV2Library.sol</code> Wrong init code hash in <code>UniswapV2Library.pairFor()</code> will break <code>UniswapV2Oracle</code>, <code>UniswapV2Router02</code>, <code>SushiRoll</code></a></h2>\n<p><em>Submitted by WatchPug</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/zeroswap/blob/03507a80322112f4f3c723fc68bed0f138702836/contracts/uniswapv2/libraries/UniswapV2Library.sol#L20-L28\">https://github.com/Plex-Engineer/zeroswap/blob/03507a80322112f4f3c723fc68bed0f138702836/contracts/uniswapv2/libraries/UniswapV2Library.sol#L20-L28</a><br></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pairFor</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">factory</span><span class=\"mtk1\">, </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">tokenA</span><span class=\"mtk1\">, </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">tokenB</span><span class=\"mtk1\">) </span><span class=\"mtk11\">internal</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pure</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pair</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    (</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token0</span><span class=\"mtk1\">, </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token1</span><span class=\"mtk1\">) = </span><span class=\"mtk11\">sortTokens</span><span class=\"mtk1\">(</span><span class=\"mtk12\">tokenA</span><span class=\"mtk1\">, </span><span class=\"mtk12\">tokenB</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">pair</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk11\">uint</span><span class=\"mtk1\">(</span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">hex</span><span class=\"mtk8\">&#39;ff&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">factory</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">keccak256</span><span class=\"mtk1\">(</span><span class=\"mtk12\">abi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">encodePacked</span><span class=\"mtk1\">(</span><span class=\"mtk12\">token0</span><span class=\"mtk1\">, </span><span class=\"mtk12\">token1</span><span class=\"mtk1\">)),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">hex</span><span class=\"mtk8\">&#39;e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk3\">// init code hash</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ))));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>The <code>init code hash</code> in <code>UniswapV2Library.pairFor()</code> should be updated since the code of <code>UniswapV2Pair</code> has been changed. Otherwise, the <code>pair</code> address calculated will be wrong, most likely non-existing address.</p>\n<p>There are many other functions and other contracts across the codebase, including  <code>UniswapV2Oracle</code>, <code>UniswapV2Router02</code>, and <code>SushiRoll</code>, that rely on the <code>UniswapV2Library.pairFor()</code> function for the address of the pair, with the <code>UniswapV2Library.pairFor()</code> returning a wrong and non-existing address, these functions and contracts will malfunction.</p>\n<h3 id=\"recommended-mitigation-steps-3\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-3\" aria-label=\"recommended mitigation steps 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Update the init code hash from <code>hex'e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303'</code> to the value of <code>UniswapV2Factory.pairCodeHash()</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/164\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/164#issuecomment-1207488488\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Amazing catch, because the contract bytecode has been change, the init hash will be different.</p>\n<p>While the bug seems trivial, it’s impact is a total bricking of all swapping functionality as the Library will cause all Periphery Contracts to call to the wrong addresses.</p>\n<p>Because of the impact, I agree with High Severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-06-accountant-cant-be-initialized\" style=\"position:relative;\"><a href=\"#h-06-accountant-cant-be-initialized\" aria-label=\"h 06 accountant cant be initialized permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/53\">[H-06] Accountant can’t be initialized</a></h2>\n<p><em>Submitted by Ruhum, also found by cccz</em></p>\n<p>It’s not possible to initialize the accountant because of a mistake in the function’s require statement.</p>\n<p>I rate it as MED since a key part of the protocol wouldn’t be available until the contract is modified and redeployed.</p>\n<h3 id=\"proof-of-concept-3\" style=\"position:relative;\"><a href=\"#proof-of-concept-3\" aria-label=\"proof of concept 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>The issue is the following <code>require()</code> statement: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Accountant/AccountantDelegate.sol#L29\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Accountant/AccountantDelegate.sol#L29</a></p>\n<p>There, the function checks whether the accountant has received the correct amount of tokens. But, it compares the accountant’s balance with the <code>_initialSupply</code>. That value is always 0. So the require statement will always fail</p>\n<p>When the Note contract is initialized, <code>_initialSupply</code> is set to 0:</p>\n<ul>\n<li><a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/deploy/canto/004_deploy_Note.ts#L14\">https://github.com/Plex-Engineer/lending-market/blob/main/deploy/canto/004_deploy_Note.ts#L14</a></li>\n<li><a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Note.sol#L9\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Note.sol#L9</a></li>\n<li><a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/ERC20.sol#L32\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/ERC20.sol#L32</a></li>\n</ul>\n<p>After <code>_mint_to_Accountant()</code> mints <code>type(uint).max</code> tokens to the accountant: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Note.sol#L18\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Note.sol#L18</a><br>\nThat increases the <code>totalSupply</code> but not the <code>_initialSupply</code>: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/ERC20.sol#L242\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/ERC20.sol#L242</a></p>\n<p>The <code>_initialSupply</code> value is only modified by the ERC20 contract’s constructor.</p>\n<h3 id=\"recommended-mitigation-steps-4\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-4\" aria-label=\"recommended mitigation steps 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Change the require statement to</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"sol\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">note</span><span class=\"mtk1\">.</span><span class=\"mtk11\">balanceOf</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">) == </span><span class=\"mtk12\">note</span><span class=\"mtk1\">.</span><span class=\"mtk11\">totalSupply</span><span class=\"mtk1\">(), </span><span class=\"mtk8\">&quot;AccountantDelegate::initiatlize: Accountant has not received payment&quot;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/53\">nivasan1 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/53#issuecomment-1207501752\">Alex the Entreprenerd (judge) increased severity to High and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to an incorrect assumption, <code>AccountantDelegate.initialize</code> cannot work, meaning part of the protocol will never work without fixing this issue.</p>\n<p>While the change should be fairly trivial, the impact is pretty high, for those reasons am going to raise severity to High.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-07-anyone-can-create-proposal-unigov-proposal-storesol\" style=\"position:relative;\"><a href=\"#h-07-anyone-can-create-proposal-unigov-proposal-storesol\" aria-label=\"h 07 anyone can create proposal unigov proposal storesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/26\">[H-07] Anyone can create Proposal Unigov <code>Proposal-Store.sol</code></a></h2>\n<p><em>Submitted by Soosh, also found by 0x1f8b, cccz, csanuragjain, hake, p4st13r4, Ruhum, TerrierLover, WatchPug, and zzzitron</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L46\">https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L46</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Governance/GovernorBravoDelegate.sol#L37\">https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Governance/GovernorBravoDelegate.sol#L37</a></p>\n<p>Proposal Store is used to store proposals that have already passed (<a href=\"https://code4rena.com/contests/2022-06-new-blockchain-contest#unigov-module-615-sloc\">https://code4rena.com/contests/2022-06-new-blockchain-contest#unigov-module-615-sloc</a>) ” Upon a proposal’s passing, the proposalHandler either deploys the ProposalStore contract (if it is not already deployed) or appends the proposal into the ProposalStore’s mapping ( uint ⇒ Proposal)”</p>\n<p>But anyone can add proposals to the contract directly via AddProposal() function.</p>\n<p>Unigov proposals can be queued and executed by anyone in GovernorBravoDelegate contract<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Governance/GovernorBravoDelegate.sol#L37\">https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Governance/GovernorBravoDelegate.sol#L37</a></p>\n<h3 id=\"proof-of-concept-4\" style=\"position:relative;\"><a href=\"#proof-of-concept-4\" aria-label=\"proof of concept 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L46\">https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L46</a></p>\n<h3 id=\"recommended-mitigation-steps-5\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-5\" aria-label=\"recommended mitigation steps 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Authorization checks for AddProposal, only governance module should be able to update.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/26\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/26#issuecomment-1211337729\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a lack of checks, anyone can create, queue, and execute a proposal without any particular checks.</p>\n<p>Because governance normally is limited via:</p>\n<ul>\n<li>Voting on a proposal</li>\n<li>Access control to limit transactions</li>\n</ul>\n<p>And the finding shows how this is completely ignored; </p>\n<p>I believe High Severity to be appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-08-transferring-any-amount-of-the-underlying-token-to-the-cnote-contract-will-make-the-contract-functions-unusable\" style=\"position:relative;\"><a href=\"#h-08-transferring-any-amount-of-the-underlying-token-to-the-cnote-contract-will-make-the-contract-functions-unusable\" aria-label=\"h 08 transferring any amount of the underlying token to the cnote contract will make the contract functions unusable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/227\">[H-08] Transferring any amount of the underlying token to the CNote contract will make the contract functions unusable</a></h2>\n<p><em>Submitted by Tutturu, also found by 0x52, hyh, p4st13r4, and WatchPug</em></p>\n<p>The contract expects the balance of the underlying token to == 0 at all points when calling the contract functions by requiring getCashPrior() == 0, which checks token.balanceOf(address(this)) where token is the underlying asset.</p>\n<p>An attacker can transfer any amount of the underlying asset directly to the contract and make all of the functions requiring getCashPrior() == 0 to revert.</p>\n<h4 id=\"proof-of-concept-5\" style=\"position:relative;\"><a href=\"#proof-of-concept-5\" aria-label=\"proof of concept 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L43\">CNote.sol#L43</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L114\">CNote.sol#L114</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L198\">CNote.sol#198</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L310\">CNote.sol#310</a><br></p>\n<ol>\n<li>Attacker gets any balance of Note (amount = 1 token)</li>\n<li>Attacker transfers the token to CNote which uses Note as an underlying asset, by calling note.transfer(CNoteAddress, amount). The function is available since Note inherits from ERC20</li>\n<li>Any calls to CNote functions now revert due to getCashPrior() not being equal to 0</li>\n</ol>\n<h3 id=\"recommended-mitigation-steps-6\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-6\" aria-label=\"recommended mitigation steps 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Instead of checking the underlying token balance via balanceOf(address(this)) the contract could hold an internal balance of the token, mitigating the impact of tokens being forcefully transferred to the contract.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/227\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/227#issuecomment-1211343983\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, via a simple transfer of 1 wei of token, the invariant of <code>getCashPrior() == 0</code> can be broken, bricking the functionality.</p>\n<p>Because of:</p>\n<ul>\n<li>the simplicity of the exploit</li>\n<li>The impact being inability to interact with the contract</li>\n<li>A protocol invariant is broken</li>\n</ul>\n<p>I agree with High Severity.</p>\n<p>Mitigation would require using delta balances and perhaps re-thinking the need for those intermediary checks.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-09-wethsol-computes-the-wrong-totalsupply\" style=\"position:relative;\"><a href=\"#h-09-wethsol-computes-the-wrong-totalsupply\" aria-label=\"h 09 wethsol computes the wrong totalsupply permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/191\">[H-09] WETH.sol computes the wrong <code>totalSupply()</code></a></h2>\n<p><em>Submitted by p4st13r4, also found by hansfriese, Ruhum, TerrierLover, WatchPug, and zzzitron</em></p>\n<p>Affected code:</p>\n<ul>\n<li><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L47\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L47</a></li>\n</ul>\n<p><code>WETH.sol</code> is almost copied from the infamous WETH contract that lives in mainnet. This contract is supposed to receive the native currency of the blockchain (for example ETH) and wrap it into a tokenized, ERC-20 form. This contract computes the <code>totalSupply()</code> using the balance of the contract itself stored in the <code>balanceOf</code> mapping, when instead it should be using the native <code>balance</code> function. This way, <code>totalSupply()</code> always returns zero as the <code>WETH</code> contract itself has no way of calling <code>deposit</code> to itself and increase its own balance</p>\n<h3 id=\"proof-of-concept-6\" style=\"position:relative;\"><a href=\"#proof-of-concept-6\" aria-label=\"proof of concept 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<ol>\n<li>Alice transfers 100 ETH to <code>WETH.sol</code></li>\n<li>Alice calls <code>balanceOf()</code> for her address and it returns 100 WETH</li>\n<li>Alice calls <code>totalSupply()</code>, expecting to see 100 WETH, but it returns 0</li>\n</ol>\n<h3 id=\"tools-used-1\" style=\"position:relative;\"><a href=\"#tools-used-1\" aria-label=\"tools used 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools Used</h3>\n<p>Editor</p>\n<h3 id=\"recommended-mitigation-steps-7\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-7\" aria-label=\"recommended mitigation steps 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"jsx\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">totalSupply</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">uint</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">).</span><span class=\"mtk12\">balance</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/191\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/191#issuecomment-1211349777\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a programming mistake, the WETH totalSupply will be incorrect.</p>\n<p>Mitigation seems straightforward, however, because the vulnerability would have causes totalSupply to return 0, and shows a broken functionality for a core contract, I think High Severity to be appropriate</p>\n</blockquote>\n<hr>\n<h2 id=\"h-10-comptroller-uses-the-wrong-address-for-the-weth-contract\" style=\"position:relative;\"><a href=\"#h-10-comptroller-uses-the-wrong-address-for-the-weth-contract\" aria-label=\"h 10 comptroller uses the wrong address for the weth contract permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/46\">[H-10] Comptroller uses the wrong address for the WETH contract</a></h2>\n<p><em>Submitted by Ruhum, also found by 0xf15ers, cccz, hake, Soosh, and WatchPug</em></p>\n<p>The Comptroller contract uses a hardcoded address for the WETH contract which is not the correct one. Because of that, it will be impossible to claim COMP rewards. That results in a loss of funds so I rate it as HIGH.</p>\n<h3 id=\"proof-of-concept-7\" style=\"position:relative;\"><a href=\"#proof-of-concept-7\" aria-label=\"proof of concept 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>The Comptroller’s <code>getWETHAddress()</code> function: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1469\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1469</a></p>\n<p>It’s a left-over from the original compound repo: <a href=\"https://github.com/compound-finance/compound-protocol/blob/master/contracts/Comptroller.sol#L1469\">https://github.com/compound-finance/compound-protocol/blob/master/contracts/Comptroller.sol#L1469</a></p>\n<p>It’s used by the <code>grantCompInternal()</code> function: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1377\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1377</a></p>\n<p>That function is called by <code>claimComp()</code>: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1365\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1365</a></p>\n<p>If there is a contract stored in that address and it doesn’t adhere to the interface (doesn’t have a <code>balanceOf()</code> and <code>transfer()</code> function), the transaction will revert. If there is no contract, the call will succeed without having any effect. In both cases, the user doesn’t get their COMP rewards.</p>\n<h3 id=\"recommended-mitigation-steps-8\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-8\" aria-label=\"recommended mitigation steps 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>The WETH contract’s address should be parsed to the Comptroller through the constructor or another function instead of being hardcoded.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/46\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/46#issuecomment-1211353848\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how the address for WETH / comp is hardcoded and the address is pointing to Mainnet’s COMP.</p>\n<p>This misconfiguration will guarantee that any function calling <code>grantCompInternal</code> as well as <code>claimComp</code> will revert.</p>\n<p>Because the functionality is hampered, I agree with High Severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-11-lending-marketnotesol-wrong-implementation-of-access-control\" style=\"position:relative;\"><a href=\"#h-11-lending-marketnotesol-wrong-implementation-of-access-control\" aria-label=\"h 11 lending marketnotesol wrong implementation of access control permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/173\">[H-11] <code>lending-market/Note.sol</code> Wrong implementation of access control</a></h2>\n<p><em>Submitted by WatchPug, also found by catchup, Lambda, p4st13r4, and Tutturu</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Note.sol#L13-L31\">https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Note.sol#L13-L31</a><br></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">_mint_to_Accountant</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accountantDelegator</span><span class=\"mtk1\">) </span><span class=\"mtk11\">external</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">accountant</span><span class=\"mtk1\"> == </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">_setAccountantAddress</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">accountant</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;Note::_mint_to_Accountant: &quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">_mint</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk11\">type</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint</span><span class=\"mtk1\">).</span><span class=\"mtk12\">max</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">RetAccountant</span><span class=\"mtk1\">() </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accountant</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">_setAccountantAddress</span><span class=\"mtk1\">(</span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accountant_</span><span class=\"mtk1\">) </span><span class=\"mtk11\">internal</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">(</span><span class=\"mtk12\">accountant</span><span class=\"mtk1\"> != </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">admin</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;Note::_setAccountantAddress: Only admin may call this function&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">accountant</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">accountant_</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">admin</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">accountant</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><code>_mint_to_Accountant()</code> calls <code>_setAccountantAddress()</code> when <code>accountant == address(0)</code>, which will always be the case when <code>_mint_to_Accountant()</code> is called for the first time.</p>\n<p>And <code>_setAccountantAddress()</code> only checks if <code>msg.sender == admin</code> when <code>accountant != address(0)</code> which will always be <code>false</code>, therefore the access control is not working.</p>\n<p>L17 will then check if <code>msg.sender == accountant</code>, now it will always be the case, because at L29, <code>accountant</code> was set to <code>msg.sender</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/173\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/173#issuecomment-1211378551\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a flaw in logic, via a front-run, anyone can become the <code>accountant</code> and mint all the totalSupply to themselves.</p>\n<p>While I’m not super confident on severity for the front-run as I’d argue the worst case is forcing a re-deploy, the warden has shown a lack of logic in the checks (<code>msg.sender == admin</code>) which breaks it’s invariants.</p>\n<p>For that reason, I think High Severity to be appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-12-in-erc20-totalsupply-is-broken\" style=\"position:relative;\"><a href=\"#h-12-in-erc20-totalsupply-is-broken\" aria-label=\"h 12 in erc20 totalsupply is broken permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/108\">[H-12] In <code>ERC20</code>, <code>TotalSupply</code> is broken</a></h2>\n<p><em>Submitted by Picodes, also found by cccz</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L33\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L33</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L95\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L95</a></p>\n<p>For an obscure reason as it’s not commented, <code>_totalSupply</code> is not initialized to 0, leading to an inaccurate total supply, which could easily break integrations, computations of market cap, etc.</p>\n<h3 id=\"proof-of-concept-8\" style=\"position:relative;\"><a href=\"#proof-of-concept-8\" aria-label=\"proof of concept 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>If the constructor is called with <code>_initialSupply = 1000</code>, then <code>1000</code> tokens are minted. The total supply will be <code>2000</code>.</p>\n<h3 id=\"recommended-mitigation-steps-9\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-9\" aria-label=\"recommended mitigation steps 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Remove <code>_initialSupply</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1163455701\">tkkwon1998 (Canto) disputed and commented</a>:</strong></p>\n<blockquote>\n<p>The explanation is not clear. We can’t seem to reproduce this issue as we can’t find a scenario where the <code>totalSupply</code> function returns an incorrect value. </p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1165895330\">Picodes (warden) commented</a>:</strong></p>\n<blockquote>\n<p>@tkkwon1998 to clarify:</p>\n<p>Deploy the ERC20 with <code>totalSupply_ = 1000</code>. </p>\n<p>Then <code>totalSupply()</code> returns 1000, which is incorrect.</p>\n<p>Then if someone mints 1000 tokens, there is 1000 tokens in the market but due to <code>_totalSupply += amount;</code>, totalSupply = 2000 which is still incorrect</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1211392092\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>I believe the submission could have benefitted by:</p>\n<ul>\n<li>A coded POC</li>\n<li>Recognizing a revert due to the finding</li>\n</ul>\n<p>However the finding is ultimately true in that, because <code>totalSupply</code> is a parameter passed in to the contract, and the ERC20 contract will not mint that amount, the <code>totalSupply</code> will end up not reflecting the total amounts of tokens minted.</p>\n<p>For this reason, I believe the finding to be valid and High Severity to be appropriate.</p>\n<p>I recommend the warden to err on the side of giving too much information to avoid getting their finding invalidated incorrectly.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1212622241\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>After further thinking, I still believe the finding is of high severity as the ERC20 standard is also broken. I do believe the submission could have been better developed, however, I think High is in place here.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-13-its-not-possible-to-execute-governance-proposals-through-the-governorbravodelegate-contract\" style=\"position:relative;\"><a href=\"#h-13-its-not-possible-to-execute-governance-proposals-through-the-governorbravodelegate-contract\" aria-label=\"h 13 its not possible to execute governance proposals through the governorbravodelegate contract permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/39\">[H-13] It’s not possible to execute governance proposals through the <code>GovernorBravoDelegate</code> contract</a></h2>\n<p><em>Submitted by Ruhum, also found by 0xmint, cccz, csanuragjain, dipp, hake, and zzzitron</em></p>\n<p>It’s not possible to execute a proposal through the GovernorBravoDelegate contract because the <code>executed</code> property of it is set to <code>true</code> when it’s queued up.</p>\n<p>Since this means that the governance contract is unusable, it might result in locked-up funds if those were transferred to the contract before the issue comes up. Because of that I’d rate it as HIGH.</p>\n<h4 id=\"proof-of-concept-9\" style=\"position:relative;\"><a href=\"#proof-of-concept-9\" aria-label=\"proof of concept 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<p><code>executed</code> is set to <code>true</code>: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L63\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L63</a></p>\n<p>Here, the <code>execute()</code> function checks whether the proposal’s state is <code>Queued</code>: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L87\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L87</a></p>\n<p>But, since the <code>execute</code> property is <code>true</code>, the <code>state()</code> function will return <code>Executed</code>: <a href=\"https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L117\">https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L117</a></p>\n<p>In the original compound repo, <code>executed</code> is <code>false</code> when the proposal is queued up: <a href=\"https://github.com/compound-finance/compound-protocol/blob/master/contracts/Governance/GovernorBravoDelegate.sol#L111\">https://github.com/compound-finance/compound-protocol/blob/master/contracts/Governance/GovernorBravoDelegate.sol#L111</a></p>\n<h3 id=\"recommended-mitigation-steps-10\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-10\" aria-label=\"recommended mitigation steps 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Just delete the line where <code>executed</code> is set to <code>true</code>. Since the zero-value is <code>false</code> anyway, you’ll save gas as well.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/39\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/39#issuecomment-1211409709\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a coding decision, no transaction can be executed from the Governor Contract.</p>\n<p>Because the functionality is broken, I agree with High Severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"h-14-wethallowance-returns-wrong-result\" style=\"position:relative;\"><a href=\"#h-14-wethallowance-returns-wrong-result\" aria-label=\"h 14 wethallowance returns wrong result permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/218\">[H-14] <code>WETH.allowance()</code> returns wrong result</a></h2>\n<p><em>Submitted by hansfriese, also found by 0xf15ers</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L104\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L104</a></p>\n<p>WETH.allowance() returns wrong result.<br>\nI can’t find other contracts that use this function but WETH.sol is a base contract and it should be fixed properly.</p>\n<h3 id=\"proof-of-concept-10\" style=\"position:relative;\"><a href=\"#proof-of-concept-10\" aria-label=\"proof of concept 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>In this function, the “return” keyword is missing and it will always output 0 in this case.</p>\n<h3 id=\"tools-used-2\" style=\"position:relative;\"><a href=\"#tools-used-2\" aria-label=\"tools used 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools Used</h3>\n<p>Solidity Visual Developer of VSCode</p>\n<h3 id=\"recommended-mitigation-steps-11\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-11\" aria-label=\"recommended mitigation steps 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>L104 should be changed like below.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">return _allowance[owner][spender];</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/218\">nivasan1 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/218#issuecomment-1212631296\">Alex the Entreprenerd (judge) increased severity to High and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has found a minor developer oversight, which will cause the view function <code>allowance</code> to always return 0.</p>\n<p>Breaking of a core contract such as WETH is a non-starter.</p>\n<p>Because I’ve already raised severity of #191 for similar reasons, I think High Severity is appropriate in this case. </p>\n</blockquote>\n<hr>\n<h1 id=\"medium-risk-findings-12\" style=\"position:relative;\"><a href=\"#medium-risk-findings-12\" aria-label=\"medium risk findings 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Medium Risk Findings (12)</h1>\n<h2 id=\"m-01-missing-zero-address-check-can-set-treasury-to-zero-address\" style=\"position:relative;\"><a href=\"#m-01-missing-zero-address-check-can-set-treasury-to-zero-address\" aria-label=\"m 01 missing zero address check can set treasury to zero address permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/121\">[M-01] Missing zero address check can set treasury to zero address</a></h2>\n<p><em>Submitted by cryptphi</em></p>\n<p>AccountantDelegate.initialize() is missing a zero address check for <code>treasury_</code> parameter, which could maybe allow treasury to be mistakenly set to 0 address.</p>\n<h3 id=\"proof-of-concept-11\" style=\"position:relative;\"><a href=\"#proof-of-concept-11\" aria-label=\"proof of concept 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Accountant/AccountantDelegate.sol#L20\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Accountant/AccountantDelegate.sol#L20</a></p>\n<h3 id=\"recommended-mitigation-steps-12\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-12\" aria-label=\"recommended mitigation steps 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Add a require() check for zero address for the treasury parameter before changing the treasury address in the initialize function.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/121\">nivasan1 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/121#issuecomment-1212623337\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Because:</p>\n<ul>\n<li>The finding is technically correct</li>\n<li>The <code>treasury</code> variable is only set on the initializer</li>\n<li>An incorrect setting could cause loss of funds</li>\n</ul>\n<p>I’m going to mark the finding as valid and of Medium severity.</p>\n<p>In mentioning this report in the future, notice that the conditions that caused me to raise the severity weren’t simply the lack of a check, but the actual risk of loss of funds, and the inability to easily fix.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-02-only-the-state-of-the-latest-proposal-can-be-checked\" style=\"position:relative;\"><a href=\"#m-02-only-the-state-of-the-latest-proposal-can-be-checked\" aria-label=\"m 02 only the state of the latest proposal can be checked permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/254\">[M-02] Only the <code>state()</code> of the latest proposal can be checked</a></h2>\n<p><em>Submitted by hake</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L115\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L115</a></p>\n<p><code>state()</code> function cannot view the state from any proposal except for the latest one.</p>\n<h3 id=\"proof-of-concept-12\" style=\"position:relative;\"><a href=\"#proof-of-concept-12\" aria-label=\"proof of concept 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">proposalCount</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk12\">proposalId</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">proposalId</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">initialProposalId</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;GovernorBravo::state: invalid proposal id&quot;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<p>Currently <code>proposalCount</code> needs to be bigger or equal to <code>proposalId</code>.<br>\nAssuming <code>proposalId</code> is incremented linearly in conjunction with <code>proposalCount</code>, this implies only the most recent <code>proposalId</code> will pass the <code>require()</code> check above. All other proposals will not be able to have their states checked via this function.</p>\n<h3 id=\"recommended-mitigation-steps-13\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-13\" aria-label=\"recommended mitigation steps 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Change above function to <code>proposalCount &#x3C;= proposalId</code> (assuming <code>proposalId</code> is set linearly, which currently is not enforced by code).</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/254\">nivasan1 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/254#issuecomment-1205684575\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a mistake in logic, only the <code>state</code> of the latest proposal can be read.</p>\n<p>Because the function <code>state</code> is used in <code>execute</code> we can conclude that only one proposal can be queue for execution at a time, drastically reducing the availability of the Governor.</p>\n<p>For this reason I believe medium severity is appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-03-unable-to-check-state-if-proposalid--0\" style=\"position:relative;\"><a href=\"#m-03-unable-to-check-state-if-proposalid--0\" aria-label=\"m 03 unable to check state if proposalid  0 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/244\">[M-03] Unable to check <code>state()</code> if <code>proposalId == 0</code></a></h2>\n<p><em>Submitted by hake</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L115\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L115</a></p>\n<p><code>state()</code> function cannot be called to view proposal state if <code>proposalId == 0</code>.</p>\n<h3 id=\"proof-of-concept-13\" style=\"position:relative;\"><a href=\"#proof-of-concept-13\" aria-label=\"proof of concept 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>There is no check to prevent queueing a <code>proposalId</code> with a value of 0 via the <a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L37-L47\"><code>queue()</code></a> function.<br>\nHowever, in the <code>state()</code> function there is a check preventing using a <code>proposalId == 0</code>.<br>\nFor clarity: <code>initialProposalId</code> must be zero according to <code>_initiate()</code>, therefore, <code>proposalId</code> cannot be 0 according to check below.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">state</span><span class=\"mtk1\">(</span><span class=\"mtk12\">uint</span><span class=\"mtk1\"> </span><span class=\"mtk12\">proposalId</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">view</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">ProposalState</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">proposalCount</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk12\">proposalId</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">proposalId</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">initialProposalId</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;GovernorBravo::state: invalid proposal id&quot;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-14\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-14\" aria-label=\"recommended mitigation steps 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Implement check to preventing queueing a <code>proposalId == 0</code>.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/244#issuecomment-1191992076\">nivasan1 (Canto) disputed and commented</a>:</strong></p>\n<blockquote>\n<p>The ProposalId cannot be 0 as the proposal IDs are fixed and will be set via the cosmos-sdk.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/244#issuecomment-1205692351\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, through a misconfiguration, a proposal could never be executable due to a revert in <code>state()</code>.</p>\n<p>While I believe the warden has already shown a remediation that would cover this scenario, I believe the Warden has shown a unique possible situation that can cause the system to stop working as intended.</p>\n<p>While the sponsor says the proposalId will never be 0, there is no way to avoid that at the Smart Contract level, meaning that any caller can set the proposal to 0.</p>\n<p>For these reasons, I think Medium Severity to be appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-04-accountant-address-can-be-set-to-zero-by-anyone-leading-to-loss-of-fundstokens\" style=\"position:relative;\"><a href=\"#m-04-accountant-address-can-be-set-to-zero-by-anyone-leading-to-loss-of-fundstokens\" aria-label=\"m 04 accountant address can be set to zero by anyone leading to loss of fundstokens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/117\">[M-04] accountant address can be set to zero by anyone leading to loss of funds/tokens</a></h2>\n<p><em>Submitted by cryptphi</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L14-L21\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L14-L21</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L31\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L31</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L96\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L96</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L178\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L178</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L258\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L258</a><br></p>\n<p>In <code>CNote._setAccountantContract()</code>, the require() check only works when <code>address(_accountant) != address(0)</code> , leading to the ability to set <code>_accountant</code> state variable to the zero address, as well as setting admin to zero address.</p>\n<p>The following below are impacts arising from above:</p>\n<h3 id=\"a-users-can-gain-underlying-asset-tokens-for-free-by-minting-ctoken-in-mintfresh-then-calling-redeemfresh\" style=\"position:relative;\"><a href=\"#a-users-can-gain-underlying-asset-tokens-for-free-by-minting-ctoken-in-mintfresh-then-calling-redeemfresh\" aria-label=\"a users can gain underlying asset tokens for free by minting ctoken in mintfresh then calling redeemfresh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A. Users can gain underlying asset tokens for free by minting CToken in <code>mintFresh()</code> then calling <code>redeemFresh()</code></h3>\n<h4 id=\"proof-of-concept-14\" style=\"position:relative;\"><a href=\"#proof-of-concept-14\" aria-label=\"proof of concept 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<ol>\n<li>Alice calls <code>_setAccountantContract()</code> with parameter input as 0.</li>\n<li>The <code>_accountant</code> state variable is now 0.</li>\n<li>Alice/or a contract calls <code>mintFresh()</code> with input address 0 and mintAmount 1000. (assuming function is external, reporting a separate issue on the mutability)</li>\n<li>This passes the <code>if (minter == address(_accountant))</code> and proceeds to mint 1000 CTokens to address(0)</li>\n<li>Alice then calls <code>redeemFresh()</code> with her address as the <code>redeemer</code> parameter, and redeemTokensIn as 1000.</li>\n<li>Assume exchangeRate is 1, Alice would receive 1000 tokens in underlying asset.</li>\n</ol>\n<h3 id=\"b-users-could-borrow-ctoken-asset-for-free\" style=\"position:relative;\"><a href=\"#b-users-could-borrow-ctoken-asset-for-free\" aria-label=\"b users could borrow ctoken asset for free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>B. Users could borrow CToken asset for free</h3>\n<p>A user can borrow CToken asset from the contract, then set <code>_accountant</code> to 0 after. With <code>_accountant</code> being set to 0 , the borrower , then call <code>repayBorrowFresh()</code> to have <code>_accountant</code> (address 0) to repay back the borrowed tokens assuming address(0) already has some tokens, and user’s borrowed asset (all/part) are repaid.</p>\n<h4 id=\"proof-of-concept-15\" style=\"position:relative;\"><a href=\"#proof-of-concept-15\" aria-label=\"proof of concept 15 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h4>\n<ol>\n<li>Alice calls <code>borrowFresh()</code> to borrow 500 CTokens from contract.</li>\n<li>Then Alice calls <code>_setAccountantContract()</code> with parameter input as 0.</li>\n<li>The <code>_accountant</code> state variable is now 0.</li>\n<li>With <code>_accountant</code> being set to 0, Alice calls <code>repayBorrowFresh()</code> having the payer be address 0, borrower being her address and 500 as repayAmount.</li>\n<li>Assume address 0 already holds 1000 CTokens, Alice’s debt will be fully repaid and she’ll gain 500 CTokens for free.</li>\n</ol>\n<h3 id=\"c-accounting-contract-could-loses-fundstokens\" style=\"position:relative;\"><a href=\"#c-accounting-contract-could-loses-fundstokens\" aria-label=\"c accounting contract could loses fundstokens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C. Accounting contract could loses funds/tokens</h3>\n<p>When the <code>_accountant</code> is set to 0, CTokens/CNote will be sent to the zero address making the Accounting contract lose funds whenever  <code>doTransferOut</code> is called.</p>\n<h3 id=\"recommended-mitigation-steps-15\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-15\" aria-label=\"recommended mitigation steps 15 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Instead of a <code>if (address(_accountant) != address(0))</code> statement, an additional require check to ensure <code>accountant_</code> parameter is not 0 address can be used in addition to the require check for caller is admin.</p>\n<p>Change this</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">if (address(_accountant) != address(0)){</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            require(msg.sender == admin, &quot;CNote::_setAccountantContract:Only admin may call this function&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        }</span></span></code></pre>\n<p>to this</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">require(msg.sender == admin, &quot;CNote::_setAccountantContract:Only admin may call this function&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">require(accountant_ != address(0), &quot;accoutant can&#39;t be zero address&quot;);</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/117\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/117#issuecomment-1207485106\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to a misconfiguration, if the <code>accountant</code> is set to 0, users will be able to extra additional value (repay tokens for free).</p>\n<p>Because this is contingent on a misconfiguration, I believe Medium Severity to be more appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-05-incorrect-amount-taken\" style=\"position:relative;\"><a href=\"#m-05-incorrect-amount-taken\" aria-label=\"m 05 incorrect amount taken permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/98\">[M-05] Incorrect amount taken</a></h2>\n<p><em>Submitted by csanuragjain, also found by 0xf15ers and gzeon</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L129\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L129</a><br></p>\n<p>It was observed that in repayBorrowFresh function, User is asked to send repayAmount instead of repayAmountFinal. This can lead to loss of user funds as user might be paying extra</p>\n<h3 id=\"proof-of-concept-16\" style=\"position:relative;\"><a href=\"#proof-of-concept-16\" aria-label=\"proof of concept 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<ol>\n<li>User is making a repayment which eventually calls repayBorrowFresh function</li>\n<li>Assuming repayAmount == type(uint).max, so repayAmountFinal becomes accountBorrowsPrev</li>\n<li>This means User should only transfer in accountBorrowsPrev instead of repayAmount but that is not true. Contract is transferring repayAmount instead of repayAmountFinal as seen at CNote.sol#L129</li>\n</ol>\n<!---->\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">uint actualRepayAmount = doTransferIn(payer, repayAmount);</span></span></code></pre>\n<h3 id=\"recommended-mitigation-steps-16\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-16\" aria-label=\"recommended mitigation steps 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Revise CNote.sol#L129 to below:</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">uint actualRepayAmount = doTransferIn(payer, repayAmountFinal);</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/98\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/98#issuecomment-1207507197\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has showed how, due to an oversight, using <code>type(uint).max</code> to signify a complete repayment will actually attempt to transfer 2^256-1 units of token.</p>\n<p>While I think High severity would have been reasonable had the tokens gotten transferred, because what will actually happen is a revert, I think Medium Severity to be more appropriate.</p>\n<p>Remediation requires using <code>actualRepayAmount</code> or re-assigning the value of <code>repayAmount</code></p>\n</blockquote>\n<hr>\n<h2 id=\"m-06-overprivileged-admin-can-grant-unlimited-weth\" style=\"position:relative;\"><a href=\"#m-06-overprivileged-admin-can-grant-unlimited-weth\" aria-label=\"m 06 overprivileged admin can grant unlimited weth permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/241\">[M-06] Overprivileged admin can grant unlimited WETH</a></h2>\n<p><em>Submitted by hake</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1376\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1376</a><br></p>\n<p>Admin can <code>_grantComp()</code> to any address using any amount and drain the contract.</p>\n<h3 id=\"proof-of-concept-17\" style=\"position:relative;\"><a href=\"#proof-of-concept-17\" aria-label=\"proof of concept 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>If admin key gets compromised there is no timelock, no amount boundaries and no address limitations to prevent the assets to be drained immediately to the attacker’s address.</p>\n<h3 id=\"recommended-mitigation-steps-17\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-17\" aria-label=\"recommended mitigation steps 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>There is a few suggestions that could help mitigate this issue:<br>\nImplement timelock for <code>_grantComp()</code><br>\nImplement hard coded recipient so funds cannot be arbitrarily sent to any address.<br>\nImplement a limit to the amount that can be granted.<br></p>\n<p>Here is a reference to a past submission where this issue has been made by team Watchpug: <a href=\"https://github.com/code-423n4/2022-01-insure-findings/issues/271\">https://github.com/code-423n4/2022-01-insure-findings/issues/271</a></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/241#issuecomment-1163850385\">nivasan1 (Canto) acknowledged and commented</a>:</strong></p>\n<blockquote>\n<p>We acknowledge that this is an issue, however we feel that changing the core functionality of compound would be too costly.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/241#issuecomment-1211287073\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how the Admin could sweep the reward token(in this case WETH) to any address, at any time, for an amount equal to all tokens available to the Comptroller.</p>\n<p>Because this is contingent on admin privilege, I think Medium Severity to be more appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-07-cnote-updates-the-accounts-after-sending-the-funds-allowing-for-reentrancy\" style=\"position:relative;\"><a href=\"#m-07-cnote-updates-the-accounts-after-sending-the-funds-allowing-for-reentrancy\" aria-label=\"m 07 cnote updates the accounts after sending the funds allowing for reentrancy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/311\">[M-07] CNote updates the accounts after sending the funds, allowing for reentrancy</a></h2>\n<p><em>Submitted by hyh, also found by defsec</em></p>\n<p>Having no reentrancy control and updating the records after external interactions allows for funds draining by reentrancy.</p>\n<p>Setting the severity to medium as this is conditional to transfer flow control introduction on future upgrades, but the impact is up to the full loss of the available funds by unrestricted borrowing.</p>\n<h3 id=\"proof-of-concept-18\" style=\"position:relative;\"><a href=\"#proof-of-concept-18\" aria-label=\"proof of concept 18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>CNote runs doTransferOut before borrowing accounts are updated:</p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CNote.sol#L70-L87\">https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CNote.sol#L70-L87</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">        /*</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">         * We invoke doTransferOut for the borrower and the borrowAmount.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">         *  Note: The cToken must handle variations between ERC-20 and ETH underlying.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">         *  On success, the cToken borrowAmount less of cash.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">         *  doTransferOut reverts if anything goes wrong, since we can&#39;t be sure if side effects occurred.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">         */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        doTransferOut(borrower, borrowAmount);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        require(getCashPrior() == 0,&quot;CNote::borrowFresh: Error in doTransferOut, impossible Liquidity in LendingMarket&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    //Amount minted by Accountant is always flashed from account</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    /* We write the previously calculated values into storage */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        accountBorrows[borrower].principal = accountBorrowsNew;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        accountBorrows[borrower].interestIndex = borrowIndex;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        totalBorrows = totalBorrowsNew;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        /* We emit a Borrow event */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        emit Borrow(borrower, borrowAmount, accountBorrowsNew, totalBorrowsNew);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p>Call sequence here is borrow() -> borrowInternal() -> borrowFresh() -> doTransferOut(), which transfers the token to an external recipient:</p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CErc20.sol#L189-L200\">https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CErc20.sol#L189-L200</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    /**</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     * @dev Similar to EIP20 transfer, except it handles a False success from `transfer` and returns an explanatory</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *      error code rather than reverting. If caller has not called checked protocol&#39;s balance, this may revert due to</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *      insufficient cash held in this contract. If caller has checked protocol&#39;s balance prior to this call, and verified</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *      it is &gt;= amount, this should not revert in normal conditions.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *      Note: This wrapper safely handles non-standard ERC-20 tokens that do not return a value.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *            See here: https://medium.com/coinmonks/missing-return-value-bug-at-least-130-tokens-affected-d67bf08521ca</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    function doTransferOut(address payable to, uint amount) virtual override internal {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        EIP20NonStandardInterface token = EIP20NonStandardInterface(underlying);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        token.transfer(to, amount);</span></span></code></pre>\n<p>There an attacker can call exitMarket() that have no reentrancy control to remove the account of the debt:</p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/Comptroller.sol#L167-L174\">https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/Comptroller.sol#L167-L174</a></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/ComptrollerG7.sol#L157-L164\">https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/ComptrollerG7.sol#L157-L164</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    /**</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     * @notice Removes asset from sender&#39;s account liquidity calculation</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     * @dev Sender must not have an outstanding borrow balance in the asset,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     *  or be providing necessary collateral for an outstanding borrow.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     * @param cTokenAddress The address of the asset to be removed</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     * @return Whether or not the account successfully exited the market</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">     */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    function exitMarket(address cTokenAddress) override external returns (uint) {</span></span></code></pre>\n<p>This attack was carried out several times:</p>\n<p><a href=\"https://certik.medium.com/fei-protocol-incident-analysis-8527440696cc\">https://certik.medium.com/fei-protocol-incident-analysis-8527440696cc</a></p>\n<h3 id=\"recommended-mitigation-steps-18\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-18\" aria-label=\"recommended mitigation steps 18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Consider moving accounting update before funds were sent out, for example as it is done in CToken’s borrowFresh():</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"609\"></span><span class=\"grvsc-source\">https:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"610\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"611\"></span><span class=\"grvsc-source\">        /*</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"612\"></span><span class=\"grvsc-source\">         * We write the previously calculated values into storage.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"613\"></span><span class=\"grvsc-source\">         *  Note: Avoid token reentrancy attacks by writing increased borrow before external transfer.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"614\"></span><span class=\"grvsc-source\">        `*/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"615\"></span><span class=\"grvsc-source\">        accountBorrows[borrower].principal = accountBorrowsNew;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"616\"></span><span class=\"grvsc-source\">        accountBorrows[borrower].interestIndex = borrowIndex;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"617\"></span><span class=\"grvsc-source\">        totalBorrows = totalBorrowsNew;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"618\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"619\"></span><span class=\"grvsc-source\">        /*</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"620\"></span><span class=\"grvsc-source\">         * We invoke doTransferOut for the borrower and the borrowAmount.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"621\"></span><span class=\"grvsc-source\">         *  Note: The cToken must handle variations between ERC-20 and ETH underlying.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"622\"></span><span class=\"grvsc-source\">         *  On success, the cToken borrowAmount less of cash.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"623\"></span><span class=\"grvsc-source\">         *  doTransferOut reverts if anything goes wrong, since we can&#39;t be sure if side effects occurred.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"624\"></span><span class=\"grvsc-source\">         */</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"625\"></span><span class=\"grvsc-source\">        doTransferOut(borrower, borrowAmount);</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/311\">nivasan1 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/311#issuecomment-1211346765\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, the in-scope codebase has historically been attacked due to a reentrancy attack.</p>\n<p>Because:</p>\n<ul>\n<li>The warden has provided POC and historical references</li>\n<li>The attack is contingent on a specific token that enables it</li>\n</ul>\n<p>I agree with Medium Severity.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-08-zeroswapuniswapv2pairsol-token-reserves-per-lp-token-can-be-manipulated-due-to-lack-of-minimum_liquidity-when-minting-the-first-liquidity-with-migrator\" style=\"position:relative;\"><a href=\"#m-08-zeroswapuniswapv2pairsol-token-reserves-per-lp-token-can-be-manipulated-due-to-lack-of-minimum_liquidity-when-minting-the-first-liquidity-with-migrator\" aria-label=\"m 08 zeroswapuniswapv2pairsol token reserves per lp token can be manipulated due to lack of minimum_liquidity when minting the first liquidity with migrator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/162\">[M-08] <code>zeroswap/UniswapV2Pair.sol</code> Token reserves per lp token can be manipulated due to lack of <code>MINIMUM_LIQUIDITY</code> when minting the first liquidity with <code>migrator</code></a></h2>\n<p><em>Submitted by WatchPug</em></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">_totalSupply</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">migrator</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">IUniswapV2Factory</span><span class=\"mtk1\">(</span><span class=\"mtk12\">factory</span><span class=\"mtk1\">).</span><span class=\"mtk11\">migrator</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">migrator</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">liquidity</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">IMigrator</span><span class=\"mtk1\">(</span><span class=\"mtk12\">migrator</span><span class=\"mtk1\">).</span><span class=\"mtk11\">desiredLiquidity</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">liquidity</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">liquidity</span><span class=\"mtk1\"> != </span><span class=\"mtk11\">uint256</span><span class=\"mtk1\">(-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&quot;Bad desired liquidity&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">migrator</span><span class=\"mtk1\"> == </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&quot;Must not have migrator&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">liquidity</span><span class=\"mtk1\"> = </span><span class=\"mtk10\">Math</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sqrt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">amount0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mul</span><span class=\"mtk1\">(</span><span class=\"mtk12\">amount1</span><span class=\"mtk1\">)).</span><span class=\"mtk11\">sub</span><span class=\"mtk1\">(</span><span class=\"mtk12\">MINIMUM_LIQUIDITY</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">_mint</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">), </span><span class=\"mtk12\">MINIMUM_LIQUIDITY</span><span class=\"mtk1\">); </span><span class=\"mtk3\">// permanently lock the first MINIMUM_LIQUIDITY tokens</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">} </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">liquidity</span><span class=\"mtk1\"> = </span><span class=\"mtk10\">Math</span><span class=\"mtk1\">.</span><span class=\"mtk11\">min</span><span class=\"mtk1\">(</span><span class=\"mtk12\">amount0</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mul</span><span class=\"mtk1\">(</span><span class=\"mtk12\">_totalSupply</span><span class=\"mtk1\">) / </span><span class=\"mtk12\">_reserve0</span><span class=\"mtk1\">, </span><span class=\"mtk12\">amount1</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mul</span><span class=\"mtk1\">(</span><span class=\"mtk12\">_totalSupply</span><span class=\"mtk1\">) / </span><span class=\"mtk12\">_reserve1</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><a href=\"https://github.com/Plex-Engineer/zeroswap/blob/03507a80322112f4f3c723fc68bed0f138702836/contracts/Migrator.sol#L28-L46\">https://github.com/Plex-Engineer/zeroswap/blob/03507a80322112f4f3c723fc68bed0f138702836/contracts/Migrator.sol#L28-L46</a></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">migrate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">IUniswapV2Pair</span><span class=\"mtk1\"> </span><span class=\"mtk12\">orig</span><span class=\"mtk1\">) </span><span class=\"mtk11\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">returns</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">IUniswapV2Pair</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\"> == </span><span class=\"mtk12\">chef</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;not from master chef&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">block</span><span class=\"mtk1\">.</span><span class=\"mtk12\">number</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk12\">notBeforeBlock</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;too early to migrate&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">require</span><span class=\"mtk1\">(</span><span class=\"mtk12\">orig</span><span class=\"mtk1\">.</span><span class=\"mtk11\">factory</span><span class=\"mtk1\">() == </span><span class=\"mtk12\">oldFactory</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;not from old factory&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token0</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">orig</span><span class=\"mtk1\">.</span><span class=\"mtk11\">token0</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">address</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token1</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">orig</span><span class=\"mtk1\">.</span><span class=\"mtk11\">token1</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">IUniswapV2Pair</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pair</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">IUniswapV2Pair</span><span class=\"mtk1\">(</span><span class=\"mtk12\">factory</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPair</span><span class=\"mtk1\">(</span><span class=\"mtk12\">token0</span><span class=\"mtk1\">, </span><span class=\"mtk12\">token1</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">pair</span><span class=\"mtk1\"> == </span><span class=\"mtk11\">IUniswapV2Pair</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">))) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">pair</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">IUniswapV2Pair</span><span class=\"mtk1\">(</span><span class=\"mtk12\">factory</span><span class=\"mtk1\">.</span><span class=\"mtk11\">createPair</span><span class=\"mtk1\">(</span><span class=\"mtk12\">token0</span><span class=\"mtk1\">, </span><span class=\"mtk12\">token1</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">uint256</span><span class=\"mtk1\"> </span><span class=\"mtk12\">lp</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">orig</span><span class=\"mtk1\">.</span><span class=\"mtk11\">balanceOf</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">lp</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">) </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pair</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">desiredLiquidity</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">lp</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">orig</span><span class=\"mtk1\">.</span><span class=\"mtk11\">transferFrom</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">, </span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">orig</span><span class=\"mtk1\">), </span><span class=\"mtk12\">lp</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">orig</span><span class=\"mtk1\">.</span><span class=\"mtk11\">burn</span><span class=\"mtk1\">(</span><span class=\"mtk11\">address</span><span class=\"mtk1\">(</span><span class=\"mtk12\">pair</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">pair</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mint</span><span class=\"mtk1\">(</span><span class=\"mtk12\">msg</span><span class=\"mtk1\">.</span><span class=\"mtk12\">sender</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">desiredLiquidity</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">uint256</span><span class=\"mtk1\">(-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pair</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>When minting LP tokens (<code>addLiquidity</code>), the amount of lp tokens you are getting is calculated based on <code>liquidity = Math.min(amount0.mul(_totalSupply) / _reserve0, amount1.mul(_totalSupply) / _reserve1);</code>, if the <code>_totalSupply</code> is small enough, and <code>1 wei</code> of the lp token worth large amounts of <code>token0</code> and <code>token1</code>, the user who adds small amounts of liquidity will receive less amount of lp tokens due to precision loss.</p>\n<p>A sophisticated attacker can artificially create that scenario by mint only <code>1 wei</code> of lp token and add <code>1e24</code> or even larger amounts of <code>token0</code> and <code>token1</code> by sending the tokens to the contract and then call <code>sync()</code> to update the reserves.</p>\n<p>Then all the new depositors will lose up to <code>1e24</code>, let’s say they deposited <code>1.99e24</code>, they will only receive <code>1 wei</code> of lp token, therefore, losing <code>0.99e24</code> of <code>token0</code> and <code>token1</code>.</p>\n<p>This attack vector was mitigated the original version of UniswapV2Pair by introcuing the <code>MINIMUM_LIQUIDITY</code> minted and permanently lock in <code>address(0)</code> upon the first mint.</p>\n<p>However, this can now be bypassed with the migrator, and this attacker vector is open again.</p>\n<h3 id=\"recommended-mitigation-steps-19\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-19\" aria-label=\"recommended mitigation steps 19 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Given the fact that zeroswap will be a DEX that does not need a feature to migrate liquidity from other DEXs, consider removing the migrator.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/162#issuecomment-1163498026\">tkkwon1998 (Canto) acknowledged and commented</a>:</strong></p>\n<blockquote>\n<p>Issue acknowledged, we will not be migrating liquidity from zeroswap. </p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/162#issuecomment-1211362065\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to legacy code, an LP pair can be permissionlessly minted and setup to cause loss to future depositors.</p>\n<p>Deployment of pairs is permissionless, however, the setup of Factory is Admin Dependent.</p>\n<p>While the Migrator file was out of scope, I believe the sponsor acknowledging, and the code being on the Pair file allows the finding to be valid.</p>\n<p>However, because it is ultimately contingent on setup, I think Medium Severity to be more appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-09-incorrect-condition-always-bound-to-fail\" style=\"position:relative;\"><a href=\"#m-09-incorrect-condition-always-bound-to-fail\" aria-label=\"m 09 incorrect condition always bound to fail permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/113\">[M-09] Incorrect condition always bound to fail</a></h2>\n<p><em>Submitted by codexploder</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L135\">https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L135</a><br></p>\n<p>The state function check GovernorBravoDelegate.sol#L115 will always fail since proposalId cannot lie in between initialProposalId and proposalCount due to an initialization in <code>_initiate</code> function</p>\n<h3 id=\"proof-of-concept-19\" style=\"position:relative;\"><a href=\"#proof-of-concept-19\" aria-label=\"proof of concept 19 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<ol>\n<li>The <code>_initiate</code> function sets initialProposalId = proposalCount;</li>\n<li>Now lets say proposal count was 5 so initialProposalId and proposalCount are both set to 5</li>\n<li>Now lets say state function is called on proposal id 2</li>\n<li>The require condition checks proposalCount >= proposalId &#x26;&#x26; proposalId > initialProposalId</li>\n<li>This is equivalent to 5>=2 &#x26;&#x26; 5>5, since 5>5 is not true this always fails even though proposal id 2 is correct</li>\n</ol>\n<h3 id=\"recommended-mitigation-steps-20\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-20\" aria-label=\"recommended mitigation steps 20 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>Remove initialProposalId = proposalCount; in the <code>_initiate</code> function.</p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/113#issuecomment-1163465664\">tkkwon1998 (Canto) disagreed with severity and commented</a>:</strong></p>\n<blockquote>\n<p>This is a bug, but will not lead to any attack or loss of funds. The initiate function will just fail, meaning the timelock admin cannot be set. This should be a 2 (Med Risk) issue. </p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/113#issuecomment-1211408426\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to misconfiguration the Governor contract can be prevented from creating new proposals.</p>\n<p>Because this is contingent on setup, I think Medium Severity to be more appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-10-oracle-may-be-attacked-if-an-attacker-can-pump-the-tokens-for-the-entire-block\" style=\"position:relative;\"><a href=\"#m-10-oracle-may-be-attacked-if-an-attacker-can-pump-the-tokens-for-the-entire-block\" aria-label=\"m 10 oracle may be attacked if an attacker can pump the tokens for the entire block permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/233\">[M-10] Oracle may be attacked if an attacker can pump the tokens for the entire block</a></h2>\n<p><em>Submitted by Chom</em></p>\n<p><a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L190-L201\">https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L190-L201</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L154-L171\">https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L154-L171</a><br></p>\n<p>Attacker may use huge amount of their fund to pump the token in a liquidity pair for one entire block. The oracle will capture the manipulated price as current TWAP implementation may only cover 1 block if timed correctly. (First block on every periodSize = 1800 minutes)</p>\n<p>This is possible and similar to Inverse finance April attack: <a href=\"https://www.coindesk.com/tech/2022/04/02/defi-lender-inverse-finance-exploited-for-156-million/\">https://www.coindesk.com/tech/2022/04/02/defi-lender-inverse-finance-exploited-for-156-million/</a></p>\n<h3 id=\"proof-of-concept-20\" style=\"position:relative;\"><a href=\"#proof-of-concept-20\" aria-label=\"proof of concept 20 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Assume currently is the first block after periodSize = 1800 minutes</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    function _update(uint balance0, uint balance1, uint _reserve0, uint _reserve1) internal {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint blockTimestamp = block.timestamp;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint timeElapsed = blockTimestamp - blockTimestampLast; // overflow is desired</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        if (timeElapsed &gt; 0 &amp;&amp; _reserve0 != 0 &amp;&amp; _reserve1 != 0) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            reserve0CumulativeLast += _reserve0 * timeElapsed;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            reserve1CumulativeLast += _reserve1 * timeElapsed;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        Observation memory _point = lastObservation();</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        timeElapsed = blockTimestamp - _point.timestamp; // compare the last observation with current timestamp, if greater than 30 minutes, record a new event</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        if (timeElapsed &gt; periodSize) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            observations.push(Observation(blockTimestamp, reserve0CumulativeLast, reserve1CumulativeLast));</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        reserve0 = balance0;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        reserve1 = balance1;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        blockTimestampLast = blockTimestamp;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        emit Sync(reserve0, reserve1);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p>timeElapsed > periodSize (Just greater as periodSize is just passed) -> add current cumulative reserve to observations list</p>\n<p>Now, let pump the token. And use some technique that inverse finance hacker have used to hold that price for 1 block.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    function current(address tokenIn, uint amountIn) external view returns (uint amountOut) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        Observation memory _observation = lastObservation();</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        (uint reserve0Cumulative, uint reserve1Cumulative,) = currentCumulativePrices();</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        if (block.timestamp == _observation.timestamp) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            _observation = observations[observations.length-2];</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint timeElapsed = block.timestamp - _observation.timestamp;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint _reserve0 = (reserve0Cumulative - _observation.reserve0Cumulative) / timeElapsed;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint _reserve1 = (reserve1Cumulative - _observation.reserve1Cumulative) / timeElapsed;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        amountOut = _getAmountOut(amountIn, tokenIn, _reserve0, _reserve1);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p>1 Block passed</p>\n<p><code>reserve0Cumulative</code> or <code>reserve1Cumulative</code> may now be skyrocketed due to current token pumping.</p>\n<p>timeElapsed = block.timestamp - <code>_observation.timestamp</code> is less than 20 seconds (= 1 block) since <code>_observation.timestamp</code> has just stamped in the previous block.</p>\n<p>As timeElapsed is less than 20 seconds (= 1 block) this mean <code>_reserve0</code> and <code>_reserve1</code> are just a TWAP of less than 20 seconds (= 1 block) which is easily manipulated by Inverse finance pumping attack technique.</p>\n<p>As <code>reserve0Cumulative</code> or <code>reserve1Cumulative</code> is skyrocketed in the 1 block timeframe that is being used in TWAP, <code>_reserve0</code> or <code>_reserve1</code> also skyrocketed.</p>\n<p>As a conclusion, price oracle may be attacked if attacker can pump price for 1 block since TWAP just cover 1 block.</p>\n<h3 id=\"recommended-mitigation-steps-21\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-21\" aria-label=\"recommended mitigation steps 21 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>You should calculate TWAP average of <code>_reserve0</code> and <code>_reserve1</code> in the <code>_update</code> function by using cumulative reserve difference from last update to now which has a duration of periodSize = 1800 minutes.</p>\n<p>And when querying for current price you can just return <code>_reserve0</code> and <code>_reserve1</code>.</p>\n<p>Refer to official uniswap v2 TWAP oracle example: <a href=\"https://github.com/Uniswap/v2-periphery/blob/master/contracts/examples/ExampleOracleSimple.sol\">https://github.com/Uniswap/v2-periphery/blob/master/contracts/examples/ExampleOracleSimple.sol</a></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/233\">nivasan1 (Canto) acknowledged</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/233#issuecomment-1211424481\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, the <code>current</code> pricing mechanism can be easily manipulated due to an excessively small observation window.</p>\n<p>Because the finding shows a property of the system, I believe it to be valid.</p>\n<p>However, the loss of funds is contingent on someone foolish enough to use that code for their pricing.</p>\n<p>Because of that, I believe Medium Severity to be more appropriate.</p>\n<p>To confirm: Do not use <code>current</code> for pricing an asset, you will get rekt.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-11-in-cnotesol-anyone-can-initially-become-both-accountant-and-admin\" style=\"position:relative;\"><a href=\"#m-11-in-cnotesol-anyone-can-initially-become-both-accountant-and-admin\" aria-label=\"m 11 in cnotesol anyone can initially become both accountant and admin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/195\">[M-11] In <code>Cnote.sol</code>, anyone can initially become both accountant and admin</a></h2>\n<p><em>Submitted by p4st13r4, also found by 0x52 and Tutturu</em></p>\n<p>Affected code:</p>\n<ul>\n<li><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L14\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L14</a></li>\n</ul>\n<p>The function <code>_setAccountantContract()</code> is supposed to be called after contract initialization, so that the <code>accountant</code> is immediately set. However, this function completely lacks any access control (it’s just <code>public</code>) so an attacker can monitor the mempool and frontrun the transaction in order to become both <code>accountant</code> and <code>admin</code></p>\n<h3 id=\"tools-used-3\" style=\"position:relative;\"><a href=\"#tools-used-3\" aria-label=\"tools used 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools Used</h3>\n<p>Editor</p>\n<h3 id=\"recommended-mitigation-steps-22\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-22\" aria-label=\"recommended mitigation steps 22 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>The function should:</p>\n<ol>\n<li>have a guard that regulates access control</li>\n<li>not set the <code>admin</code> too, which is dangerous and out of scope</li>\n</ol>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/195\">tkkwon1998 (Canto) confirmed</a></strong></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/195#issuecomment-1205562509\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Frontrunnable Initializer without POC (is impact having to re-deploy?).</p>\n<p>Pretty confident will downgrade.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/195#issuecomment-1212618986\">Alex the Entreprenerd (judge) decreased severity to Medium and commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, due to front-running, anyone can become the <code>accountant</code>. With the information I have, I think the worst case scenario is a re-deploy.</p>\n<p>Because the setter could have been written in a better way, but because the realistic consequence is a re-deploy, I think Medium Severity to be more appropriate.</p>\n</blockquote>\n<hr>\n<h2 id=\"m-12-note-when-_initialsupply---0-the-_mint_to_accountant-function-will-fail\" style=\"position:relative;\"><a href=\"#m-12-note-when-_initialsupply---0-the-_mint_to_accountant-function-will-fail\" aria-label=\"m 12 note when _initialsupply   0 the _mint_to_accountant function will fail permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/125\">[M-12] Note: When <code>_initialSupply ! = 0</code>, the <code>_mint_to_Accountant</code> function will fail</a></h2>\n<p><em>Submitted by cccz, also found by Picodes</em></p>\n<p>In Note contract, if <code>_initialSupply ! = 0</code>, <code>_totalSupply</code> will overflow when the <code>_mint_to_Accountant</code> function executes <code>_mint(msg.sender, type(uint).max)</code></p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    constructor(string memory name_, string memory symbol_, uint256 totalSupply_) public {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _name = name_;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _symbol = symbol_;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t    _initialSupply = totalSupply_;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t    _totalSupply = totalSupply_;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    function _mint(address account, uint256 amount) internal   {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _beforeTokenTransfer(address(0), account, amount);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _totalSupply += amount;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _balances[account] += amount;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        emit Transfer(address(0), account, amount);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _afterTokenTransfer(address(0), account, amount);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<h3 id=\"proof-of-concept-21\" style=\"position:relative;\"><a href=\"#proof-of-concept-21\" aria-label=\"proof of concept 21 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Note.sol#L13-L19\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Note.sol#L13-L19</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L29-L34\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L29-L34</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L237-L247\">https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L237-L247</a></p>\n<h3 id=\"recommended-mitigation-steps-23\" style=\"position:relative;\"><a href=\"#recommended-mitigation-steps-23\" aria-label=\"recommended mitigation steps 23 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recommended Mitigation Steps</h3>\n<p>ERC20.sol</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    constructor(string memory name_, string memory symbol_) public {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _name = name_;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        _symbol = symbol_;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p>note.sol</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    constructor() ERC20(&quot;Note&quot;, &quot;NOTE&quot;) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        admin = msg.sender;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    }</span></span></code></pre>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/125#issuecomment-1163903722\">nivasan1 (Canto) commented</a>:</strong></p>\n<blockquote>\n<p>Duplicate of <a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/53\">Issue #53 (H-06)</a></p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/125#issuecomment-1207502215\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>In contrast to #53 -> Revert of <code>initialize</code></p>\n<p>This finding shows how, based on <code>constructor</code> arguments, the function <code>_mint_to_accountant</code> can fail.</p>\n<p>Am not convinced on the impact as I believe in the worst case the Sponsor would just be forced to re-deploy</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/125#issuecomment-1212621688\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>The warden has shown how, because the function <code>_mint_to_accountant</code> mints the maximum value representable, deploying Note with a non-zero <code>initialSupply</code> will cause a revert.</p>\n<p>Because this is contingent on a misconfiguration, I agree with Med Severity.</p>\n</blockquote>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/125\">abhipingle (Canto) confirmed</a></strong></p>\n<hr>\n<h1 id=\"low-risk-and-non-critical-issues\" style=\"position:relative;\"><a href=\"#low-risk-and-non-critical-issues\" aria-label=\"low risk and non critical issues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Low Risk and Non-Critical Issues</h1>\n<p>For this contest, 45 reports were submitted by wardens detailing low risk and non-critical issues. The <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/170\">report highlighted below</a> by <strong>joestakey</strong> received the top score from the judge.</p>\n<p><em>The following wardens also submitted reports: <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/69\">Dravee</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/29\">robee</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/257\">hake</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/11\">oyc_109</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/154\">0xNazgul</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/210\">0xf15ers</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/275\">zzzitron</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/229\">Bronicle</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/48\">0x1f8b</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/194\">TomJ</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/110\">codexploder</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/219\">hansfriese</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/54\">Ruhum</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/97\">csanuragjain</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/182\">gzeon</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/317\">hyh</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/214\">Funen</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/147\">TerrierLover</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/38\">0xDjango</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/60\">sach1r0</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/312\">Limbooo</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/72\">0x52</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/84\">cccz</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/298\">simon135</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/105\">Picodes</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/292\">asutorufos</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/139\">catchup</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/116\">_Adam</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/76\">fatherOfBlocks</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/265\">saian</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/196\">Tutturu</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/252\">0x29A</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/306\">0xmint</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/261\">MadWookie</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/9\">technicallyty</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/28\">nxrblsrpr</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/163\">WatchPug</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/141\">Waze</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/126\">cryptphi</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/310\">ignacio</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/204\">JMukesh</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/264\">c3phas</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/260\">defsec</a>, and <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/43\">k</a>.</em></p>\n<h2 id=\"l-01-assert-statement-should-not-be-used\" style=\"position:relative;\"><a href=\"#l-01-assert-statement-should-not-be-used\" aria-label=\"l 01 assert statement should not be used permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-01] assert statement should not be used</h2>\n<p>Properly functioning code should never reach a failing assert statement. If it happened, it would indicate the presence of a bug in the contract. A failing assert uses all the remaining gas, which can be financially painful for a user.</p>\n<h3 id=\"proof-of-concept-22\" style=\"position:relative;\"><a href=\"#proof-of-concept-22\" aria-label=\"proof of concept 22 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketcomptrollersol\" style=\"position:relative;\"><a href=\"#lending-marketcomptrollersol\" aria-label=\"lending marketcomptrollersol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/Comptroller.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l214 assert(assetIndex &lt; len)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l360 assert(markets[cToken].accountMembership[borrower])</span></span></code></pre>\n<h4 id=\"stableswapbasev1-peripherysol\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol\" aria-label=\"stableswapbasev1 peripherysol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l82 assert(msg.sender == address(wcanto))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l227 assert(amountAOptimal &lt;= amountADesired)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l273 assert(wcanto.transfer(pair, amountCANTO))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l419 assert(wcanto.transfer(pairFor(routes[0].from, routes[0].to, routes[0].stable), amounts[0]))</span></span></code></pre>\n<h3 id=\"mitigation\" style=\"position:relative;\"><a href=\"#mitigation\" aria-label=\"mitigation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Replace the assert statements with a require statement or a custom error</p>\n<h2 id=\"l-02-closefactor-unbounded\" style=\"position:relative;\"><a href=\"#l-02-closefactor-unbounded\" aria-label=\"l 02 closefactor unbounded permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-02] CloseFactor unbounded</h2>\n<p>In <code>Comptroller.sol</code>, it is mentioned that <code>closeFactorMantissa</code> should be greater than <code>closeFactorMinMantissa</code> and less than <code>closeFactorMaxMantissa</code>. But in <code>_setCloseFactor</code>, these are not checked, meaning <code>closeFactorMantissa</code> can be set to a value outside the boundaries defined by the protocol.</p>\n<h3 id=\"proof-of-concept-23\" style=\"position:relative;\"><a href=\"#proof-of-concept-23\" aria-label=\"proof of concept 23 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketcomptrollersol-1\" style=\"position:relative;\"><a href=\"#lending-marketcomptrollersol-1\" aria-label=\"lending marketcomptrollersol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/Comptroller.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l81-l85</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">// closeFactorMantissa must be strictly greater than this value</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">uint internal constant closeFactorMinMantissa = 0.05e18; // 0.05</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">// closeFactorMantissa must not exceed this value</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">uint internal constant closeFactorMaxMantissa = 0.9e18; // 0.9</span></span></code></pre>\n<!---->\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"28\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l850-l859</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">function _setCloseFactor(uint newCloseFactorMantissa) external returns (uint) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    // Check caller is admin</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    require(msg.sender == admin, &quot;only admin can set close factor&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint oldCloseFactorMantissa = closeFactorMantissa;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    closeFactorMantissa = newCloseFactorMantissa;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    emit NewCloseFactor(oldCloseFactorMantissa, closeFactorMantissa);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    return uint(Error.NO_ERROR);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<h3 id=\"mitigation-1\" style=\"position:relative;\"><a href=\"#mitigation-1\" aria-label=\"mitigation 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add checks in <code>_setCloseFactor</code> to ensure <code>closeFactorMantissa</code> is greater than <code>closeFactorMinMantissa</code> and less than <code>closeFactorMaxMantissa</code>.</p>\n<h2 id=\"l-03-immutable-addresses-lack-zero-address-check\" style=\"position:relative;\"><a href=\"#l-03-immutable-addresses-lack-zero-address-check\" aria-label=\"l 03 immutable addresses lack zero address check permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-03] Immutable addresses lack zero-address check</h2>\n<p>Constructors should check the address written in an immutable address variable is not the zero address.</p>\n<h3 id=\"proof-of-concept-24\" style=\"position:relative;\"><a href=\"#proof-of-concept-24\" aria-label=\"proof of concept 24 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"stableswapbasev1-coresol\" style=\"position:relative;\"><a href=\"#stableswapbasev1-coresol\" aria-label=\"stableswapbasev1 coresol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-core.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"29\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l107 (token0, token1, stable) = (_token0, _token1, _stable)</span></span></code></pre>\n<h4 id=\"stableswapbasev1-peripherysol-1\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol-1\" aria-label=\"stableswapbasev1 peripherysol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"30\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l75factory = _factory;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">pairCodeHash = IBaseV1Factory(_factory).pairCodeHash();</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">wcanto = IWCANTO(_wcanto);</span></span></code></pre>\n<h3 id=\"mitigation-2\" style=\"position:relative;\"><a href=\"#mitigation-2\" aria-label=\"mitigation 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add a zero address check for the immutable variables aforementioned.</p>\n<h2 id=\"l-04-receive-function\" style=\"position:relative;\"><a href=\"#l-04-receive-function\" aria-label=\"l 04 receive function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-04] Receive function</h2>\n<p><code>AccountantDelegate</code> has a <code>receive()</code> function, but does not have any withdrawal function. Any Manifest mistakenly sent to this contract would be locked.</p>\n<h3 id=\"proof-of-concept-25\" style=\"position:relative;\"><a href=\"#proof-of-concept-25\" aria-label=\"proof of concept 25 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<h4 id=\"lending-marketaccountantdelegatesol\" style=\"position:relative;\"><a href=\"#lending-marketaccountantdelegatesol\" aria-label=\"lending marketaccountantdelegatesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/AccountantDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"31\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l94 receive() external override payable {}</span></span></code></pre>\n<h3 id=\"mitigation-3\" style=\"position:relative;\"><a href=\"#mitigation-3\" aria-label=\"mitigation 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add <code>require(0 == msg.value)</code> in <code>receive()</code> or remove the function altogether.</p>\n<h2 id=\"l-05-local-variable-shadowing\" style=\"position:relative;\"><a href=\"#l-05-local-variable-shadowing\" aria-label=\"l 05 local variable shadowing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-05] Local variable shadowing</h2>\n<p>In <code>lending-market/NoteInterest.sol</code>, there is local variable shadowing: the constructor parameter has the same name as the storage variable <code>baseRatePerYear</code>. This will not lead to any error but can be confusing, especially in the constructor where <code>baseRatePerBlock</code> is computed using the constructor parameter <code>baseRatePerYear</code>.</p>\n<h3 id=\"proof-of-concept-26\" style=\"position:relative;\"><a href=\"#proof-of-concept-26\" aria-label=\"proof of concept 26 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketnoteinterestsol\" style=\"position:relative;\"><a href=\"#lending-marketnoteinterestsol\" aria-label=\"lending marketnoteinterestsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/NoteInterest.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"32\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">constructor(uint baseRatePerYear) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    baseRatePerBlock = baseRatePerYear.div(blocksPerYear)</span></span></code></pre>\n<h3 id=\"mitigation-4\" style=\"position:relative;\"><a href=\"#mitigation-4\" aria-label=\"mitigation 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add an underscore to the constructor parameter (<code>_baseRatePerYear</code>) to avoid shadowing.</p>\n<h2 id=\"l-06-avoid-using-transfer-to-transfer-native-tokens\" style=\"position:relative;\"><a href=\"#l-06-avoid-using-transfer-to-transfer-native-tokens\" aria-label=\"l 06 avoid using transfer to transfer native tokens permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[L-06] Avoid Using <code>.Transfer</code> to Transfer Native Tokens</h2>\n<p>In <code>WETH</code> and <code>TreasuryDelegate</code>, the <code>.transfer()</code> method is used to transfer Manifest. </p>\n<p>The <code>transfer()</code> call requires that the recipient has a payable callback, only provides 2300 gas for its operation. This means the following cases can cause the transfer to fail:</p>\n<ul>\n<li>The contract does not have a payable callback</li>\n<li>The contract’s payable callback spends more than 2300 gas (which is only enough to emit something)</li>\n<li>The contract is called through a proxy which itself uses up the 2300 gas</li>\n</ul>\n<h3 id=\"proof-of-concept-27\" style=\"position:relative;\"><a href=\"#proof-of-concept-27\" aria-label=\"proof of concept 27 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof Of Concept</h3>\n<p>See <a href=\"https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/\">this article</a>.</p>\n<p>The <code>.transfer</code> method is called in these places:</p>\n<h4 id=\"wethsol\" style=\"position:relative;\"><a href=\"#wethsol\" aria-label=\"wethsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WETH.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"33\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l31 payable(msg.sender).transfer(wad)</span></span></code></pre>\n<h4 id=\"treasurydelegatesol\" style=\"position:relative;\"><a href=\"#treasurydelegatesol\" aria-label=\"treasurydelegatesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TreasuryDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"34\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l52 to.transfer(amount)</span></span></code></pre>\n<h3 id=\"mitigation-5\" style=\"position:relative;\"><a href=\"#mitigation-5\" aria-label=\"mitigation 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mitigation</h3>\n<p>Use <code>.call()</code> to send Manifest.</p>\n<h2 id=\"n-01-underflow-desired-but-not-possible\" style=\"position:relative;\"><a href=\"#n-01-underflow-desired-but-not-possible\" aria-label=\"n 01 underflow desired but not possible permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-01] Underflow desired but not possible</h2>\n<p>Underflow is desired in several price update functions of <code>stableswap/BaseV1Pair</code>, but as overflow/underflow checks are automatically performed since Solidity 0.8.0, the functions currently revert if there is underflow.</p>\n<h3 id=\"proof-of-concept-28\" style=\"position:relative;\"><a href=\"#proof-of-concept-28\" aria-label=\"proof of concept 28 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"stableswapbasev1-coresol-1\" style=\"position:relative;\"><a href=\"#stableswapbasev1-coresol-1\" aria-label=\"stableswapbasev1 coresol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-core.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"35\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l156 uint timeElapsed = blockTimestamp - blockTimestampLast; // overflow is desired</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l183 uint timeElapsed = blockTimestamp - _blockTimestampLast</span></span></code></pre>\n<h3 id=\"mitigation-6\" style=\"position:relative;\"><a href=\"#mitigation-6\" aria-label=\"mitigation 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Place these statements in an <code>unchecked</code> block to allow underflow</p>\n<h2 id=\"n-02-comment-missing-function-parameter\" style=\"position:relative;\"><a href=\"#n-02-comment-missing-function-parameter\" aria-label=\"n 02 comment missing function parameter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-02] Comment Missing function parameter</h2>\n<p>Some of the function comments are missing function parameters or returns</p>\n<h3 id=\"proof-of-concept-29\" style=\"position:relative;\"><a href=\"#proof-of-concept-29\" aria-label=\"proof of concept 29 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketgovernorbravodelegatesol\" style=\"position:relative;\"><a href=\"#lending-marketgovernorbravodelegatesol\" aria-label=\"lending marketgovernorbravodelegatesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/GovernorBravoDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"36\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l452 @param borrowerIndex</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l526 @param seizeTokens</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l677 @param accounts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l689 @param accounts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l826 @param newOracle</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1210 @param marketBorrowIndex</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1270 @param marketBorrowIndex</span></span></code></pre>\n<h4 id=\"lending-marketcnotesol\" style=\"position:relative;\"><a href=\"#lending-marketcnotesol\" aria-label=\"lending marketcnotesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/CNote.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"37\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l31 @param borrower</span></span></code></pre>\n<h4 id=\"lending-marketnoteinterestsol-1\" style=\"position:relative;\"><a href=\"#lending-marketnoteinterestsol-1\" aria-label=\"lending marketnoteinterestsol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/NoteInterest.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"38\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l92 @param cash</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l92 @param borrows</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l92 @param reserves</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l109 @param cash</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l109 @param borrows</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l109 @param reserves</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l109 @param reserveFactorMantissa</span></span></code></pre>\n<h3 id=\"mitigation-7\" style=\"position:relative;\"><a href=\"#mitigation-7\" aria-label=\"mitigation 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add a comment for these parameters.</p>\n<h2 id=\"n-03-constants-instead-of-magic-numbers\" style=\"position:relative;\"><a href=\"#n-03-constants-instead-of-magic-numbers\" aria-label=\"n 03 constants instead of magic numbers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-03] Constants instead of magic numbers</h2>\n<p>It is best practice to use constant variables rather than literal values to make the code easier to understand and maintain.</p>\n<h3 id=\"proof-of-concept-30\" style=\"position:relative;\"><a href=\"#proof-of-concept-30\" aria-label=\"proof of concept 30 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketnoteinterestsol-2\" style=\"position:relative;\"><a href=\"#lending-marketnoteinterestsol-2\" aria-label=\"lending marketnoteinterestsol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/NoteInterest.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"39\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l95 100</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l96 100</span></span></code></pre>\n<h3 id=\"mitigation-8\" style=\"position:relative;\"><a href=\"#mitigation-8\" aria-label=\"mitigation 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Define constant variables for the literal values aforementioned.</p>\n<h2 id=\"n-04-constructor-visibility\" style=\"position:relative;\"><a href=\"#n-04-constructor-visibility\" aria-label=\"n 04 constructor visibility permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-04] Constructor visibility</h2>\n<p>Visibility (public / external) is not needed for constructors anymore since Solidity 0.7.0, see <a href=\"https://docs.soliditylang.org/en/v0.7.0/070-breaking-changes.html#functions-and-events\">here</a></p>\n<h3 id=\"proof-of-concept-31\" style=\"position:relative;\"><a href=\"#proof-of-concept-31\" aria-label=\"proof of concept 31 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketaccountantdelegatorsol\" style=\"position:relative;\"><a href=\"#lending-marketaccountantdelegatorsol\" aria-label=\"lending marketaccountantdelegatorsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/AccountantDelegator.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"40\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l16 constructor(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t\taddress implementation_,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t\taddress admin_,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      address cnoteAddress_,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      address noteAddress_,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      address comptrollerAddress_, </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      address treasury_) public</span></span></code></pre>\n<h3 id=\"mitigation-9\" style=\"position:relative;\"><a href=\"#mitigation-9\" aria-label=\"mitigation 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Remove the <code>public</code> modifier from constructors.</p>\n<h2 id=\"n-05-events-indexing\" style=\"position:relative;\"><a href=\"#n-05-events-indexing\" aria-label=\"n 05 events indexing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-05] Events indexing</h2>\n<p>Events should use indexed fields</p>\n<h3 id=\"proof-of-concept-32\" style=\"position:relative;\"><a href=\"#proof-of-concept-32\" aria-label=\"proof of concept 32 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketcomptrollersol-2\" style=\"position:relative;\"><a href=\"#lending-marketcomptrollersol-2\" aria-label=\"lending marketcomptrollersol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/Comptroller.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"41\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l19 event MarketListed(CToken cToken)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l22 event MarketEntered(CToken cToken, address account)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l25 event MarketExited(CToken cToken, address account)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l28 event NewCloseFactor(uint oldCloseFactorMantissa, uint newCloseFactorMantissa)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l31 event NewCollateralFactor(CToken cToken, uint oldCollateralFactorMantissa, uint newCollateralFactorMantissa)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l34 event NewLiquidationIncentive(uint oldLiquidationIncentiveMantissa, uint newLiquidationIncentiveMantissa)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l37 event NewPriceOracle(PriceOracle oldPriceOracle, PriceOracle newPriceOracle)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l40 event NewPauseGuardian(address oldPauseGuardian, address newPauseGuardian)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l43 event ActionPaused(string action, bool pauseState)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l46 event ActionPaused(CToken cToken, string action, bool pauseState)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l49 event CompBorrowSpeedUpdated(CToken indexed cToken, uint newSpeed)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l52 event CompSupplySpeedUpdated(CToken indexed cToken, uint newSpeed)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l55 event ContributorCompSpeedUpdated(address indexed contributor, uint newSpeed)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l58 event DistributedSupplierComp(CToken indexed cToken, address indexed supplier, uint compDelta, uint compSupplyIndex)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l61 event DistributedBorrowerComp(CToken indexed cToken, address indexed borrower, uint compDelta, uint compBorrowIndex)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l64 event NewBorrowCap(CToken indexed cToken, uint newBorrowCap)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l67 event NewBorrowCapGuardian(address oldBorrowCapGuardian, address newBorrowCapGuardian)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l70 event CompGranted(address recipient, uint amount)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l73 event CompAccruedAdjusted(address indexed user, uint oldCompAccrued, uint newCompAccrued)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l76 event CompReceivableUpdated(address indexed user, uint oldCompReceivable, uint newCompReceivable)</span></span></code></pre>\n<h4 id=\"lending-marketaccountantinterfacessol\" style=\"position:relative;\"><a href=\"#lending-marketaccountantinterfacessol\" aria-label=\"lending marketaccountantinterfacessol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/AccountantInterfaces.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"42\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l15 event AcctInit(address lendingMarketAddress)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l16 event AcctSupplied(uint amount, uint err)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l25 event NewImplementation(address oldImplementation, address newImplementation)</span></span></code></pre>\n<h4 id=\"lending-markettreasuryinterfacessol\" style=\"position:relative;\"><a href=\"#lending-markettreasuryinterfacessol\" aria-label=\"lending markettreasuryinterfacessol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/TreasuryInterfaces.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"43\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l17 event NewImplementation(address oldImplementation, address newImplementation)</span></span></code></pre>\n<h4 id=\"lending-marketcnotesol-1\" style=\"position:relative;\"><a href=\"#lending-marketcnotesol-1\" aria-label=\"lending marketcnotesol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/CNote.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"44\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l10 event AccountantSet(address accountant, address accountantPrior)</span></span></code></pre>\n<h4 id=\"lending-marketnoteinterestsol-3\" style=\"position:relative;\"><a href=\"#lending-marketnoteinterestsol-3\" aria-label=\"lending marketnoteinterestsol 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/NoteInterest.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"45\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l17 event NewInterestParams(uint baserateperblock)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l61 event NewBaseRate(uint oldBaseRateMantissa, uint newBaseRateMantissa)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l64 event NewAdjusterCoefficient(uint oldAdjusterCoefficient, uint newAdjusterCoefficient)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l67 event NewUpdateFrequency(uint oldUpdateFrequency, uint newUpdateFrequency)</span></span></code></pre>\n<h4 id=\"stableswapbasev1-coresol-2\" style=\"position:relative;\"><a href=\"#stableswapbasev1-coresol-2\" aria-label=\"stableswapbasev1 coresol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-core.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"46\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l88 event Mint(address indexed sender, uint amount0, uint amount1);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l89 event Burn(address indexed sender, uint amount0, uint amount1, address indexed to);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l90 event Swap(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        address indexed sender,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint amount0In,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint amount1In,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint amount0Out,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        uint amount1Out,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        address indexed to</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    );</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l98 event Sync(uint reserve0, uint reserve1);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l99 event Claim(address indexed sender, address indexed recipient, uint amount0, uint amount1);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l101 event Transfer(address indexed from, address indexed to, uint amount);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l102 event Approval(address indexed owner, address indexed spender, uint amount)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l486 event PairCreated(address indexed token0, address indexed token1, bool stable, address pair, uint)</span></span></code></pre>\n<h3 id=\"mitigation-10\" style=\"position:relative;\"><a href=\"#mitigation-10\" aria-label=\"mitigation 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add indexed fields to these events so that they have the maximum number of indexed fields possible.</p>\n<h2 id=\"n-06-event-should-be-emitted-in-setters\" style=\"position:relative;\"><a href=\"#n-06-event-should-be-emitted-in-setters\" aria-label=\"n 06 event should be emitted in setters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-06] Event should be emitted in setters</h2>\n<p>Setters should emit an event so that Dapps can detect important changes to storage</p>\n<h3 id=\"proof-of-concept-33\" style=\"position:relative;\"><a href=\"#proof-of-concept-33\" aria-label=\"proof of concept 33 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketwethsol\" style=\"position:relative;\"><a href=\"#lending-marketwethsol\" aria-label=\"lending marketwethsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/WETH.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"47\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l22 function deposit() </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l28 function withdraw()</span></span></code></pre>\n<h4 id=\"lending-marketgovernorbravodelegatesol-1\" style=\"position:relative;\"><a href=\"#lending-marketgovernorbravodelegatesol-1\" aria-label=\"lending marketgovernorbravodelegatesol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/GovernorBravoDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"48\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l131 function _initiate()</span></span></code></pre>\n<h4 id=\"stableswapbasev1-coresol-3\" style=\"position:relative;\"><a href=\"#stableswapbasev1-coresol-3\" aria-label=\"stableswapbasev1 coresol 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-core.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"49\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l497 function setPauser()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l507 function setPause()</span></span></code></pre>\n<h3 id=\"mitigation-11\" style=\"position:relative;\"><a href=\"#mitigation-11\" aria-label=\"mitigation 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Emit an event in all setters.</p>\n<h2 id=\"n-07-function-missing-comments\" style=\"position:relative;\"><a href=\"#n-07-function-missing-comments\" aria-label=\"n 07 function missing comments permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-07] Function missing comments</h2>\n<p>Some functions are missing Natspec comments.</p>\n<h3 id=\"proof-of-concept-34\" style=\"position:relative;\"><a href=\"#proof-of-concept-34\" aria-label=\"proof of concept 34 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"manifestproposal-storesol\" style=\"position:relative;\"><a href=\"#manifestproposal-storesol\" aria-label=\"manifestproposal storesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>manifest/Proposal-Store.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"50\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l46 function AddProposal</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l52 function QueryProp</span></span></code></pre>\n<h4 id=\"lending-marketwethsol-1\" style=\"position:relative;\"><a href=\"#lending-marketwethsol-1\" aria-label=\"lending marketwethsol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/WETH.sol</h4>\n<p>All the functions are missing comments</p>\n<h4 id=\"lending-marketgovernorbravodelegatesol-2\" style=\"position:relative;\"><a href=\"#lending-marketgovernorbravodelegatesol-2\" aria-label=\"lending marketgovernorbravodelegatesol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/GovernorBravoDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"51\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l77 function queueOrRevertInternal</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l180 function add256</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l186 function sub256</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l191 function getChainIdInternal()</span></span></code></pre>\n<h4 id=\"lending-marketcomptrollersol-3\" style=\"position:relative;\"><a href=\"#lending-marketcomptrollersol-3\" aria-label=\"lending marketcomptrollersol 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/Comptroller.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"52\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l294 function redeemAllowedInternal</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l180 function add256</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l186 function sub256</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l191 function getChainIdInternal()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l958 function _addMarketInternal()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l965 function _initializeMarket</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1050 function _setMintPaused</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1060 function _setBorrowPaused</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1070 function _setTransferPaused</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1079 function _setSeizePaused</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1088 function _become</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1094 function fixBadAccruals</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1144 function adminOrInitializing</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1461 function getBlockNumber</span></span></code></pre>\n<h4 id=\"lending-marketcnotesol-2\" style=\"position:relative;\"><a href=\"#lending-marketcnotesol-2\" aria-label=\"lending marketcnotesol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/CNote.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"53\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l14 function _setAccountantContract</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l23 function getAccountant</span></span></code></pre>\n<h4 id=\"stableswapbasev1-coresol-4\" style=\"position:relative;\"><a href=\"#stableswapbasev1-coresol-4\" aria-label=\"stableswapbasev1 coresol 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-core.sol</h4>\n<p>All the functions are missing proper Natspec comments.</p>\n<h4 id=\"stableswapbasev1-peripherysol-2\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol-2\" aria-label=\"stableswapbasev1 peripherysol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<p>All the functions are missing proper Natspec comments.</p>\n<h3 id=\"mitigation-12\" style=\"position:relative;\"><a href=\"#mitigation-12\" aria-label=\"mitigation 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add comments to these functions.</p>\n<h2 id=\"n-08-function-order\" style=\"position:relative;\"><a href=\"#n-08-function-order\" aria-label=\"n 08 function order permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-08] Function order</h2>\n<p>Functions should be ordered following the <a href=\"https://docs.soliditylang.org/en/v0.8.15/style-guide.html#order-of-functions\">Soldiity conventions</a>: <code>receive()</code> function should be placed after the constructor and before every other function.</p>\n<h3 id=\"proof-of-concept-35\" style=\"position:relative;\"><a href=\"#proof-of-concept-35\" aria-label=\"proof of concept 35 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Several contracts have <code>receive()</code> and <code>fallback()</code> at the end:</p>\n<ul>\n<li>lending-market/AccountantDelegate.sol</li>\n<li>lending-market/AccountantDelegator.sol</li>\n<li>lending-market/TreasuryDelegator.sol</li>\n</ul>\n<h3 id=\"mitigation-13\" style=\"position:relative;\"><a href=\"#mitigation-13\" aria-label=\"mitigation 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Place the <code>receive()</code> and <code>fallback()</code> functions after the constructor, before all the other functions.</p>\n<h2 id=\"n-09-non-library-files-should-use-fixed-compiler-versions\" style=\"position:relative;\"><a href=\"#n-09-non-library-files-should-use-fixed-compiler-versions\" aria-label=\"n 09 non library files should use fixed compiler versions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-09] Non-library files should use fixed compiler versions</h2>\n<p>Contracts should be compiled using a fixed compiler version. Locking the pragma helps ensure that contracts do not accidentally get deployed using a different compiler version with which they have been tested the most.</p>\n<h3 id=\"proof-of-concept-36\" style=\"position:relative;\"><a href=\"#proof-of-concept-36\" aria-label=\"proof of concept 36 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"zoneinteractionsol\" style=\"position:relative;\"><a href=\"#zoneinteractionsol\" aria-label=\"zoneinteractionsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ZoneInteraction.sol</h4>\n<p><code>WETH.sol</code>, <code>GovernorBravoDelegate.sol</code>, <code>Comptroller.sol</code>, <code>AccountantDelegate.sol</code>, <code>AccountantDelegator.sol</code>, <code>AccountantInterfaces.sol</code>, <code>TreasuryDelegate.sol</code>, <code>TreasuryDelegator.sol</code>, <code>TreasuryInterfaces.sol</code>, <code>CNote.sol</code> and <code>NoteInterest.sol</code> have floating pragmas.</p>\n<h3 id=\"mitigation-14\" style=\"position:relative;\"><a href=\"#mitigation-14\" aria-label=\"mitigation 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Used a fixed compiler version.</p>\n<h2 id=\"n-10-open-todos\" style=\"position:relative;\"><a href=\"#n-10-open-todos\" aria-label=\"n 10 open todos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-10] Open TODOs</h2>\n<h3 id=\"problem\" style=\"position:relative;\"><a href=\"#problem\" aria-label=\"problem permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROBLEM</h3>\n<p>There are open TODOs in the code. Code architecture, incentives, and error handling/reporting questions/issues should be resolved before deployment.</p>\n<h3 id=\"proof-of-concept-37\" style=\"position:relative;\"><a href=\"#proof-of-concept-37\" aria-label=\"proof of concept 37 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketcomptrollersol-4\" style=\"position:relative;\"><a href=\"#lending-marketcomptrollersol-4\" aria-label=\"lending marketcomptrollersol 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/Comptroller.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"54\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l1232 // TODO: Don&#39;t distribute supplier COMP if the user is not in the supplier market.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1271 // TODO: Don&#39;t distribute supplier COMP if the user is not in the borrower market.</span></span></code></pre>\n<h3 id=\"mitigation-15\" style=\"position:relative;\"><a href=\"#mitigation-15\" aria-label=\"mitigation 15 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Remove the TODOs.</p>\n<h2 id=\"n-11-public-functions-can-be-external\" style=\"position:relative;\"><a href=\"#n-11-public-functions-can-be-external\" aria-label=\"n 11 public functions can be external permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-11] Public functions can be external</h2>\n<p>It is good practice to mark functions as <code>external</code> instead of <code>public</code> if they are not called by the contract where they are defined.</p>\n<h3 id=\"proof-of-concept-38\" style=\"position:relative;\"><a href=\"#proof-of-concept-38\" aria-label=\"proof of concept 38 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"manifestproposal-storesol-1\" style=\"position:relative;\"><a href=\"#manifestproposal-storesol-1\" aria-label=\"manifestproposal storesol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>manifest/Proposal-Store.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"55\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l46 function AddProposal()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l52 function QueryProp()</span></span></code></pre>\n<h4 id=\"lending-marketgovernorbravodelegatesol-3\" style=\"position:relative;\"><a href=\"#lending-marketgovernorbravodelegatesol-3\" aria-label=\"lending marketgovernorbravodelegatesol 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/GovernorBravoDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"56\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l24 function initialize()</span></span></code></pre>\n<h4 id=\"lending-marketcomptrollersol-5\" style=\"position:relative;\"><a href=\"#lending-marketcomptrollersol-5\" aria-label=\"lending marketcomptrollersol 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/Comptroller.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"57\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l122 function enterMarkets()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l677 function getAccountLiquidity()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l703 function getHypotheticalAccountLiquidity()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l826 function _setPriceOracle()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1033 function _setPauseGuardian()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1050 function _setMintPaused()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1060 function _setBorrowPaused()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1070 function _setTransferPaused()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1079 function _setSeizePaused()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1088 function _become()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1324 function claimComp(address holder)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1394 function _grantComp()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1407 function _setCompSpeeds()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1423 function _setContributorCompSpeed()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l1444 function getAllMarkets()</span></span></code></pre>\n<h4 id=\"lending-marketaccountantdelegatesol-1\" style=\"position:relative;\"><a href=\"#lending-marketaccountantdelegatesol-1\" aria-label=\"lending marketaccountantdelegatesol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/AccountantDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"58\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l15 function initialize()</span></span></code></pre>\n<h4 id=\"lending-marketaccountantdelegatorsol-1\" style=\"position:relative;\"><a href=\"#lending-marketaccountantdelegatorsol-1\" aria-label=\"lending marketaccountantdelegatorsol 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/AccountantDelegator.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"59\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l109 delegateToViewImplementation()</span></span></code></pre>\n<h4 id=\"lending-markettreasurydelegatesol\" style=\"position:relative;\"><a href=\"#lending-markettreasurydelegatesol\" aria-label=\"lending markettreasurydelegatesol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/TreasuryDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"60\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l15 function initialize()</span></span></code></pre>\n<h4 id=\"lending-markettreasurydelegatorsol\" style=\"position:relative;\"><a href=\"#lending-markettreasurydelegatorsol\" aria-label=\"lending markettreasurydelegatorsol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/TreasuryDelegator.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"61\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l84 delegateToViewImplementation()</span></span></code></pre>\n<h4 id=\"lending-marketcnotesol-3\" style=\"position:relative;\"><a href=\"#lending-marketcnotesol-3\" aria-label=\"lending marketcnotesol 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/CNote.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"62\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l14 function _setAccountantContract</span></span></code></pre>\n<h4 id=\"lending-marketnoteinterestsol-4\" style=\"position:relative;\"><a href=\"#lending-marketnoteinterestsol-4\" aria-label=\"lending marketnoteinterestsol 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/NoteInterest.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"63\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l118 function updateBaseRate</span></span></code></pre>\n<h3 id=\"mitigation-16\" style=\"position:relative;\"><a href=\"#mitigation-16\" aria-label=\"mitigation 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Declare these functions as <code>external</code> instead of <code>public</code>.</p>\n<h2 id=\"n-12-require-statements-should-have-descriptive-strings\" style=\"position:relative;\"><a href=\"#n-12-require-statements-should-have-descriptive-strings\" aria-label=\"n 12 require statements should have descriptive strings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-12] Require statements should have descriptive strings</h2>\n<p>Some require statements are missing error strings, which makes it more difficult to debug when the function reverts.</p>\n<h3 id=\"proof-of-concept-39\" style=\"position:relative;\"><a href=\"#proof-of-concept-39\" aria-label=\"proof of concept 39 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<h4 id=\"lending-marketwethsol-2\" style=\"position:relative;\"><a href=\"#lending-marketwethsol-2\" aria-label=\"lending marketwethsol 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/WETH.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"64\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l69 require(_balanceOf[src] &gt;= wad)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l72 require(_allowance[src][msg.sender] &gt;= wad)</span></span></code></pre>\n<h4 id=\"lending-marketgovernorbravodelegatesol-4\" style=\"position:relative;\"><a href=\"#lending-marketgovernorbravodelegatesol-4\" aria-label=\"lending marketgovernorbravodelegatesol 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/GovernorBravoDelegate.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"65\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l53 require(proposals[unigovProposal.id].id == 0)</span></span></code></pre>\n<h4 id=\"stableswapbasev1-coresol-5\" style=\"position:relative;\"><a href=\"#stableswapbasev1-coresol-5\" aria-label=\"stableswapbasev1 coresol 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-core.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"66\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l125 require(_unlocked == 1)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l285 require(!BaseV1Factory(factory).isPaused());</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l465 require(token.code.length &gt; 0)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l468 require(success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l498 require(msg.sender == pauser)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l503 require(msg.sender == pendingPauser)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l508 require(msg.sender == pauser)</span></span></code></pre>\n<h4 id=\"stableswapbasev1-peripherysol-3\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol-3\" aria-label=\"stableswapbasev1 peripherysol 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"67\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l210 require(amountADesired &gt;= amountAMin);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l211 require(amountBDesired &gt;= amountBMin)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l291 require(IBaseV1Pair(pair).transferFrom(msg.sender, pair, liquidity))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l456 require(token.code.length &gt; 0)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l459 require(success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l463 require(token.code.length &gt; 0, &quot;token code length faialure&quot;)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l466 require(success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))), &quot;failing here&quot;)</span></span></code></pre>\n<h3 id=\"mitigation-17\" style=\"position:relative;\"><a href=\"#mitigation-17\" aria-label=\"mitigation 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add error strings to all require statements.</p>\n<h2 id=\"n-13-scientific-notation\" style=\"position:relative;\"><a href=\"#n-13-scientific-notation\" aria-label=\"n 13 scientific notation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-13] Scientific notation</h2>\n<p>For readability, it is best to use scientific notation (e.g <code>10e5</code>) rather than decimal literals(<code>100000</code>) or exponentiation(<code>10**5</code>).</p>\n<h3 id=\"proof-of-concept-40\" style=\"position:relative;\"><a href=\"#proof-of-concept-40\" aria-label=\"proof of concept 40 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"stableswapbasev1-peripherysol-4\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol-4\" aria-label=\"stableswapbasev1 peripherysol 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"68\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l67 uint internal constant MINIMUM_LIQUIDITY = 10**3</span></span></code></pre>\n<h3 id=\"mitigation-18\" style=\"position:relative;\"><a href=\"#mitigation-18\" aria-label=\"mitigation 18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Replace <code>10**3</code> with <code>10e3</code>.</p>\n<h2 id=\"n-14-styling\" style=\"position:relative;\"><a href=\"#n-14-styling\" aria-label=\"n 14 styling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-14] Styling</h2>\n<p>There should be space between operands in mathematical computations</p>\n<h3 id=\"proof-of-concept-41\" style=\"position:relative;\"><a href=\"#proof-of-concept-41\" aria-label=\"proof of concept 41 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"stableswapbasev1-peripherysol-5\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol-5\" aria-label=\"stableswapbasev1 peripherysol 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"69\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l134 routes.length+1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l139 amounts[i+1]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">l366 routes[i+1].from, routes[i+1].to, routes[i+1].stable</span></span></code></pre>\n<h3 id=\"mitigation-19\" style=\"position:relative;\"><a href=\"#mitigation-19\" aria-label=\"mitigation 19 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Add spaces, e.g</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"70\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">-routes.length+1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">+routes.length + 1</span></span></code></pre>\n<h2 id=\"n-15-typos\" style=\"position:relative;\"><a href=\"#n-15-typos\" aria-label=\"n 15 typos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[N-15] Typos</h2>\n<p>There are a few typos in the contracts.</p>\n<h3 id=\"proof-of-concept-42\" style=\"position:relative;\"><a href=\"#proof-of-concept-42\" aria-label=\"proof of concept 42 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROOF OF CONCEPT</h3>\n<p>Instances include:</p>\n<h4 id=\"lending-marketnoteinterestsol-5\" style=\"position:relative;\"><a href=\"#lending-marketnoteinterestsol-5\" aria-label=\"lending marketnoteinterestsol 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lending-market/NoteInterest.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"71\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l89 irrelevent</span></span></code></pre>\n<h4 id=\"stableswapbasev1-peripherysol-6\" style=\"position:relative;\"><a href=\"#stableswapbasev1-peripherysol-6\" aria-label=\"stableswapbasev1 peripherysol 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stableswap/BaseV1-periphery.sol</h4>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"72\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">l463 faialure</span></span></code></pre>\n<h3 id=\"mitigation-20\" style=\"position:relative;\"><a href=\"#mitigation-20\" aria-label=\"mitigation 20 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MITIGATION</h3>\n<p>Correct the typos.</p>\n<hr>\n<h1 id=\"gas-optimizations\" style=\"position:relative;\"><a href=\"#gas-optimizations\" aria-label=\"gas optimizations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gas Optimizations</h1>\n<p>For this contest, 39 reports were submitted by wardens detailing gas optimizations. The <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/115\">report highlighted below</a> by <strong>_Adam</strong> received the top score from the judge.</p>\n<p><em>The following wardens also submitted reports: <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/153\">0xNazgul</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/183\">gzeon</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/150\">0xKitsune</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/286\">saian</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/45\">0x1f8b</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/156\">joestakey</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/67\">Dravee</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/247\">Limbooo</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/236\">defsec</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/221\">hansfriese</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/86\">Waze</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/273\">0x29A</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/215\">0xf15ers</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/27\">0xkatana</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/290\">c3phas</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/140\">catchup</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/75\">fatherOfBlocks</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/259\">Funen</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/305\">JC</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/10\">oyc_109</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/315\">rfa</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/30\">robee</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/59\">sach1r0</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/272\">simon135</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/144\">TerrierLover</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/262\">Tomio</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/157\">TomJ</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/92\">ynnad</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/55\">Ruhum</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/188\">0v3rf10w</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/307\">0xmint</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/230\">ak1</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/251\">Chom</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/285\">Fitraldys</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/258\">hake</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/44\">k</a>, <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/267\">MadWookie</a>, and <a href=\"https://github.com/code-423n4/2022-06-newblockchain-findings/issues/106\">Picodes</a>.</em></p>\n<h2 id=\"g-01-initialising-to-default-values\" style=\"position:relative;\"><a href=\"#g-01-initialising-to-default-values\" aria-label=\"g 01 initialising to default values permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-01] Initialising to Default Values</h2>\n<p>When initialising a variable to its default variable, it is cheaper to leave blank. I ran a test in remix that initialises a single variable and got a saving of 2,246 gas.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"73\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint256 public variable = 0;     (69,312 gas)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    vs</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    uint256 public variable;         (67,066 gas)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p><a href=\"https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-core.sol#L46\">BaseV1-core.sol#L46</a> - can change to: uint public totalSupply;</p>\n<h2 id=\"g-02-emitting-storage-variables\" style=\"position:relative;\"><a href=\"#g-02-emitting-storage-variables\" aria-label=\"g 02 emitting storage variables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-02] Emitting Storage Variables</h2>\n<p>You can save an SLOAD (~100 gas) by emiting local variables over storage variables when they have the same value.</p>\n<p><a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L170\">BaseV1-core.sol#L170</a> - can emit balance0 &#x26; balance1 over reserve0 &#x26; reserve0 (save 2 SLOADS)<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L856\">Comptroller.sol#L856</a> - can emit newCloseFactorMantissa instead of closeFactorMantissa<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1045\">Comptroller.sol#L1045</a> - can emit newPauseGuardian instead of pauseGuardian<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L127\">NoteInterest.sol#L127</a> - can emit newBaseRatePerYear instead of baseRatePerYear<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L144\">NoteInterest.sol#L144</a> - can emit newBaseRateMantissa instead of baseRatePerYear<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L144\">NoteInterest.sol#L144</a> - can emit newAdjusterCoefficient instead of adjusterCoefficient<br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L170\">NoteInterest.sol#L170</a> - can emit newUpdateFrequency instead of updateFrequency<br></p>\n<h2 id=\"g-03-variables-can-be-immutableconstant\" style=\"position:relative;\"><a href=\"#g-03-variables-can-be-immutableconstant\" aria-label=\"g 03 variables can be immutableconstant permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-03] Variables Can be Immutable/Constant</h2>\n<p>The following variables are initialised either when created or in the constructor and then never modified and can be changed to immutable/constant to save gas.</p>\n<p><a href=\"https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L35\">Proposal-Store.sol#L35</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L39-L40\">BaseV1-core.sol#L39-L40</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L6-L8\">WETH.sol#L6-L8</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L22\">NoteInterest.sol#L22</a><br></p>\n<h2 id=\"g-04-for-loop-optimisations\" style=\"position:relative;\"><a href=\"#g-04-for-loop-optimisations\" aria-label=\"g 04 for loop optimisations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-04] For Loop Optimisations</h2>\n<p>When incrementing i in for loops there is no chance of overflow so unchecked can be used to save gas. I ran a simple test in remix and found deployment savings of 31,653 gas and on each function call saved ~141 gas per iteration.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"74\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction loopTest() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tfor (uint256 i; i &lt; 1; ++i) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tDeployment Cost: 125,637, Cost on function call: 24,601</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tvs</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tfor (uint256 i; i &lt; 1; ) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t// for loop body</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tunchecked { ++i }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tDeployment Cost: 93,984, Cost on function call: 24,460</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p>In for loops pre increments can also be used to save a small amount of gas per iteraition.<br>\nI ran a test in remix using a for loop and found the deployment savings of 497 gas and ~5 gas per iteration.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"75\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction loopTest() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tfor (uint256 i; i &lt; 1; i++) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 118,408, Cost on function call: 24,532)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tvs</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tfor (uint256 i; i &lt; 1; ++i) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 117,911, Cost on function call: 24,527)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p>Looping over memory/storage variable lengths will cost ~3 gas/~100 gas per iteration, I recommend cacheing their value and looping over that instead.</p>\n<p>Instances of for loops that can be optimised:<br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-core.sol#L207\">BaseV1-core.sol#L207</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-core.sol#L337\">BaseV1-core.sol#L337</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-periphery.sol#L136\">BaseV1-periphery.sol#L136</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-periphery.sol#L362\">BaseV1-periphery.sol#L362</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L68\">GovernorBravoDelegate.sol#L68</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L90\">GovernorBravoDelegate.sol#L90</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L126\">Comptroller.sol#L126</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L206\">Comptroller.sol#L206</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L735\">Comptroller.sol#L735</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L959\">Comptroller.sol#L959</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1005\">Comptroller.sol#L1005</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1106\">Comptroller.sol#L1106</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1347\">Comptroller.sol#L1347</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1353\">Comptroller.sol#L1353</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1359\">Comptroller.sol#L1359</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1364\">Comptroller.sol#L1364</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1413\">Comptroller.sol#L1413</a><br></p>\n<h2 id=\"g-05-minimising-sloads\" style=\"position:relative;\"><a href=\"#g-05-minimising-sloads\" aria-label=\"g 05 minimising sloads permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-05] Minimising SLOAD’s</h2>\n<p>You can save 1 SLOAD (~97 gas) per use by cacheing a storage variable that is used more than once.</p>\n<p><a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L15-L18\">CNote.sol#L15-L18</a> - can cache <code>address(_ accountant)</code><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L179-L180\">CNote.sol#L179-L180</a> - can cache <code>address(_ accountant)</code><br></p>\n<h2 id=\"g-06-no-need-to-check--true-in-conditional-statements\" style=\"position:relative;\"><a href=\"#g-06-no-need-to-check--true-in-conditional-statements\" aria-label=\"g 06 no need to check  true in conditional statements permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-06] No Need to check == True in Conditional Statements</h2>\n<p>You can save some gas (~1000 gas on deployment and ~10 gas on function call, based on remix test) by removing == True from the following locations.\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L149\">Comptroller.sol#L149</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1053\">Comptroller.sol#L1053</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1063\">Comptroller.sol#L1063</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1072\">Comptroller.sol#L1072</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1081\">Comptroller.sol#L1081</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1350\">Comptroller.sol#L1350</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1357\">Comptroller.sol#L1357</a>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1456\">Comptroller.sol#L1456</a></p>\n<h2 id=\"g-07-custom-errors\" style=\"position:relative;\"><a href=\"#g-07-custom-errors\" aria-label=\"g 07 custom errors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-07] Custom Errors</h2>\n<p>As your using a solidity version greater 0.8.4 you can replace revert strings with custom errors. This will save in deployment costs and runtime costs.<br>\nI ran a test in remix comparing a revert string vs custom errors and found that replacing a single revert string with a custom error saved 12,404 gas in deployment cost and 86 gas on each function call.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"76\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tuint256 a;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction check() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a != 0, &quot;check failed&quot;);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}   (Deployment cost: 114,703, Cost on Function call: 23,392)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">vs </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tuint256 a;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\terror checkFailed();</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction check() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tif (a != 0) revert checkFailed();</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}   (Deployment cost: 102,299, Cost on Function call: 23,306)</span></span></code></pre>\n<p>I recommend replacing all revert strings with custom errors.</p>\n<h2 id=\"g-08-long-revert-strings\" style=\"position:relative;\"><a href=\"#g-08-long-revert-strings\" aria-label=\"g 08 long revert strings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-08] Long Revert Strings</h2>\n<p>If opting not to update revert strings to custom errors, keeping revert strings &#x3C;= 32 bytes in length will save gas.<br>\nI ran a test in remix and found the savings for a single short revert string vs long string to be 9,377 gas in deployment cost and 18 gas on function call.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"77\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tuint256 a;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction check() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a != 0, &quot;short error message&quot;); </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 114,799, Cost on function call: 23,392)\t</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tvs </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a != 0, &quot;A longer Error Message over 32 bytes in     </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        length&quot;); </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 124,176, Cost on function call: 23,410)\t</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p>I recommend shortenning the following revert strings to &#x3C;= 32 bytes in length:</p>\n<p><a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L86\">BaseV1-periphery.sol#L86</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L104-L105\">BaseV1-periphery.sol#L104-L105</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L223\">BaseV1-periphery.sol#L223</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L228\">BaseV1-periphery.sol#L228</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L295-L296\">BaseV1-periphery.sol#L295-L296</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L387\">BaseV1-periphery.sol#L387</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L402\">BaseV1-periphery.sol#L402</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L417\">BaseV1-periphery.sol#L417</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L430\">BaseV1-periphery.sol#L430</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L452\">BaseV1-periphery.sol#L452</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L29\">WETH.sol#L29</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L96-L97\">WETH.sol#L96-L97</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L25-L27\">GovernorBravoDelegate.sol#L25-L27</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L42-L47\">GovernorBravoDelegate.sol#L42-L47</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L78\">GovernorBravoDelegate.sol#L78</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L87\">GovernorBravoDelegate.sol#L87</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L115\">GovernorBravoDelegate.sol#L115</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L132-L133\">GovernorBravoDelegate.sol#L132-L133</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L146\">GovernorBravoDelegate.sol#L146</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L164\">GovernorBravoDelegate.sol#L164</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L178\">Comptroller.sol#L178</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L491\">Comptroller.sol#L491</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L998\">Comptroller.sol#L998</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1016\">Comptroller.sol#L1016</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1051-L1052\">Comptroller.sol#L1051-L1052</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1061-L1062\">Comptroller.sol#L1061-L1062</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1071\">Comptroller.sol#L1071</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1080\">Comptroller.sol#L1080</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1089\">Comptroller.sol#L1089</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1095-L1096\">Comptroller.sol#L1095-L1096</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1411\">Comptroller.sol#L1411</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegator.sol#L43-L44\">AccountantDelegator.sol#L43-L44</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegator.sol#L124\">AccountantDelegator.sol#L124</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Treasury/TreasuryDelegator.sol#L31-L32\">TreasuryDelegator.sol#L31-L32</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Treasury/TreasuryDelegate.sol#L47\">TreasuryDelegate.sol#L47</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L16\">CNote.sol#L16</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L43\">CNote.sol#L43</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L45\">CNote.sol#L45</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L54\">CNote.sol#L54</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L77\">CNote.sol#L77</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L114\">CNote.sol#L114</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L130\">CNote.sol#L130</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L146\">CNote.sol#L146</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L198\">CNote.sol#L198</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L214\">CNote.sol#L214</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L264\">CNote.sol#L264</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L310\">CNote.sol#L310</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L330\">CNote.sol#L330</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L141\">NoteInterest.sol#L141</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L154\">NoteInterest.sol#L154</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L167\">NoteInterest.sol#L167</a><br></p>\n<h2 id=\"g-09-uint--0-checks-in-require-functions\" style=\"position:relative;\"><a href=\"#g-09-uint--0-checks-in-require-functions\" aria-label=\"g 09 uint  0 checks in require functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-09] Uint > 0 Checks in Require Functions</h2>\n<p>If opting not to use custom errors when checking whether a uint is > 0 in a requrie functions you can save a small amount of gas by replacing with != 0. This is only true if optimiser is turned on and in a require statement. I ran a test in remix with optimisation set to 10,000 and found the savings for a single occurance is 632 in deployment cost and 6 gas on each function call.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"78\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tuint256 a;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction check() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a &gt; 0); </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 79,763, Cost on function call: 23,305)\t</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tvs</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a != 0); </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 79,331, Cost on function call: 23,299)\t</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p>Instances where a uint is compared > 0:<br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L253\">BaseV1-core.sol#L253</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L272\">BaseV1-core.sol#L272</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L286\">BaseV1-core.sol#L286</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L303\">BaseV1-core.sol#L303</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L465\">BaseV1-core.sol#L465</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L104-L105\">BaseV1-periphery.sol#L104-L105</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L456\">BaseV1-periphery.sol#L456</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L463\">BaseV1-periphery.sol#L463</a><br></p>\n<h2 id=\"g-10--in-require-functions\" style=\"position:relative;\"><a href=\"#g-10--in-require-functions\" aria-label=\"g 10  in require functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[G-10] &#x26;&#x26; in Require Functions</h2>\n<p>If not opting to use custom errors and If optimising for running costs over deployment costs you can seperate &#x26;&#x26; in require functions into 2 parts. I ran a basic test in remix and it cost an extra 234 gas to deploy but will save ~9 gas everytime the require function is called.</p>\n<pre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"79\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">contract Test {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tuint256 a = 0;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tuint256 b = 1;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\tfunction test() external {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a == 0 &amp;&amp; b &gt; a) </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 123,291, Cost on function call: 29,371)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\tvs</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(a == 0);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\trequire(b &gt; a);</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t\t(Deployment cost: 123,525, Cost on function call: 29,362)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\t}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p>Instances where require statements can be split into seperate statements:</p>\n<p><a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L272\">BaseV1-core.sol#L272</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L288\">BaseV1-core.sol#L288</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L294\">BaseV1-core.sol#L294</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L431\">BaseV1-core.sol#L431</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L468\">BaseV1-core.sol#L468</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L105\">BaseV1-periphery.sol#L105</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L459\">BaseV1-periphery.sol#L459</a><br>\n<a href=\"https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L466\">BaseV1-periphery.sol#L466</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L42-L45\">GovernorBravoDelegate.sol#L42-L45</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L115\">GovernorBravoDelegate.sol#L115</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L164\">GovernorBravoDelegate.sol#L164</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1003\">Comptroller.sol#L1003</a><br>\n<a href=\"https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1411\">Comptroller.sol#L1411</a><br></p>\n<p><strong><a href=\"https://github.com/code-423n4/2022-06-canto-findings/issues/115#issuecomment-1204597814\">Alex the Entreprenerd (judge) commented</a>:</strong></p>\n<blockquote>\n<p>Over 10k between immutables and stuff</p>\n<p><strong>[G-01] Initialising to Default Values</strong><br>\nValid but I only count runtime gas vs deployment</p>\n<p><strong>[G-02] Emitting Storage Variables</strong><br>\n8 * 97 (3 gas for the MLOAD)<br></p>\n<p>776</p>\n<p><strong>[G-03] Variables Can be Immutable/Constant</strong><br>\n7 * 2100<br>\n14700</p>\n<p><strong>[G-04] For Loop Optimisations</strong><br>\nI think the benchmark is correct but may be unfairly skewed against the non-optimized (perhaps no optimizer)<br>\nWill give 25 points per instance<br></p>\n<p>17 * 25<br>\n425</p>\n<p><strong>[G-05] Minimising SLOAD’s</strong><br>\n94 each (6 gas for setup of cache)<br>\n188</p>\n<p><strong>[G-06] No Need to check == True in Conditional Statements</strong><br>\n6 gas per instance (3 for check, 3 for MLOAD of the hardcoded value)<br>\n8 * 6<br>\n48</p>\n<p><strong>[G-07] Custom Errors</strong><br>\nBecause you benchmarked it, I’ll keep that in mind in scoring</p>\n<p><strong>[G-08] Long Revert Strings</strong><br>\n6 per instance<br>\n51 * 6 <br>\n301</p>\n<p><strong>[G-09] Uint > 0 Checks in Require Functions</strong><br>\n6 per instance<br>\n8 * 6<br>\n48</p>\n<p><strong>[G-10] &#x26;&#x26; in Require Functions</strong><br>\n9 per instance (because you benchmarked, would have given 3 normally)<br>\n13 * 9 <br>\n117<br></p>\n<p><strong>Total Gas Saved</strong><br>\n<strong>16603</strong></p>\n</blockquote>\n<hr>\n<h1 id=\"disclosures\" style=\"position:relative;\"><a href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disclosures</h1>\n<p>C4 is an open organization governed by participants in the community.</p>\n<p>C4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>\n<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk10 { color: #4EC9B0; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>",
  "toc": "<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n<ul>\n<li><a href=\"#about-c4\">About C4</a></li>\n<li><a href=\"#wardens\">Wardens</a></li>\n</ul>\n</li>\n<li><a href=\"#summary\">Summary</a></li>\n<li><a href=\"#scope\">Scope</a></li>\n<li><a href=\"#severity-criteria\">Severity Criteria</a></li>\n<li>\n<p><a href=\"#high-risk-findings-14\">High Risk Findings (14)</a></p>\n<ul>\n<li><a href=\"#h-01-anyone-can-set-the-baserateperyear-after-the-updatefrequency-has-passed\">[H-01] Anyone can set the <code>baseRatePerYear</code> after the <code>updateFrequency</code> has passed</a></li>\n<li><a href=\"#h-02-stealing-wrapped-manifest-in-wethsol\">[H-02] Stealing Wrapped Manifest in WETH.sol</a></li>\n<li><a href=\"#h-03--accountantdelegate-sweepinterest-function-will-destroy-the-cnote-in-the-contract\">[H-03]  <code>AccountantDelegate</code>: <code>sweepInterest</code> function will destroy the cnote in the contract.</a></li>\n<li><a href=\"#h-04-lending-marketnoteinterestsol-wrong-implementation-of-getborrowrate\">[H-04] <code>lending-market/NoteInterest.sol</code> Wrong implementation of <code>getBorrowRate()</code></a></li>\n<li><a href=\"#h-05-zeroswapuniswapv2librarysol-wrong-init-code-hash-in-uniswapv2librarypairfor-will-break-uniswapv2oracle-uniswapv2router02-sushiroll\">[H-05] <code>zeroswap/UniswapV2Library.sol</code> Wrong init code hash in <code>UniswapV2Library.pairFor()</code> will break <code>UniswapV2Oracle</code>, <code>UniswapV2Router02</code>, <code>SushiRoll</code></a></li>\n<li><a href=\"#h-06-accountant-cant-be-initialized\">[H-06] Accountant can’t be initialized</a></li>\n<li><a href=\"#h-07-anyone-can-create-proposal-unigov-proposal-storesol\">[H-07] Anyone can create Proposal Unigov <code>Proposal-Store.sol</code></a></li>\n<li><a href=\"#h-08-transferring-any-amount-of-the-underlying-token-to-the-cnote-contract-will-make-the-contract-functions-unusable\">[H-08] Transferring any amount of the underlying token to the CNote contract will make the contract functions unusable</a></li>\n<li><a href=\"#h-09-wethsol-computes-the-wrong-totalsupply\">[H-09] WETH.sol computes the wrong <code>totalSupply()</code></a></li>\n<li><a href=\"#h-10-comptroller-uses-the-wrong-address-for-the-weth-contract\">[H-10] Comptroller uses the wrong address for the WETH contract</a></li>\n<li><a href=\"#h-11-lending-marketnotesol-wrong-implementation-of-access-control\">[H-11] <code>lending-market/Note.sol</code> Wrong implementation of access control</a></li>\n<li><a href=\"#h-12-in-erc20-totalsupply-is-broken\">[H-12] In <code>ERC20</code>, <code>TotalSupply</code> is broken</a></li>\n<li><a href=\"#h-13-its-not-possible-to-execute-governance-proposals-through-the-governorbravodelegate-contract\">[H-13] It’s not possible to execute governance proposals through the <code>GovernorBravoDelegate</code> contract</a></li>\n<li><a href=\"#h-14-wethallowance-returns-wrong-result\">[H-14] <code>WETH.allowance()</code> returns wrong result</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#medium-risk-findings-12\">Medium Risk Findings (12)</a></p>\n<ul>\n<li><a href=\"#m-01-missing-zero-address-check-can-set-treasury-to-zero-address\">[M-01] Missing zero address check can set treasury to zero address</a></li>\n<li><a href=\"#m-02-only-the-state-of-the-latest-proposal-can-be-checked\">[M-02] Only the <code>state()</code> of the latest proposal can be checked</a></li>\n<li><a href=\"#m-03-unable-to-check-state-if-proposalid--0\">[M-03] Unable to check <code>state()</code> if <code>proposalId == 0</code></a></li>\n<li><a href=\"#m-04-accountant-address-can-be-set-to-zero-by-anyone-leading-to-loss-of-fundstokens\">[M-04] accountant address can be set to zero by anyone leading to loss of funds/tokens</a></li>\n<li><a href=\"#m-05-incorrect-amount-taken\">[M-05] Incorrect amount taken</a></li>\n<li><a href=\"#m-06-overprivileged-admin-can-grant-unlimited-weth\">[M-06] Overprivileged admin can grant unlimited WETH</a></li>\n<li><a href=\"#m-07-cnote-updates-the-accounts-after-sending-the-funds-allowing-for-reentrancy\">[M-07] CNote updates the accounts after sending the funds, allowing for reentrancy</a></li>\n<li><a href=\"#m-08-zeroswapuniswapv2pairsol-token-reserves-per-lp-token-can-be-manipulated-due-to-lack-of-minimum_liquidity-when-minting-the-first-liquidity-with-migrator\">[M-08] <code>zeroswap/UniswapV2Pair.sol</code> Token reserves per lp token can be manipulated due to lack of <code>MINIMUM_LIQUIDITY</code> when minting the first liquidity with <code>migrator</code></a></li>\n<li><a href=\"#m-09-incorrect-condition-always-bound-to-fail\">[M-09] Incorrect condition always bound to fail</a></li>\n<li><a href=\"#m-10-oracle-may-be-attacked-if-an-attacker-can-pump-the-tokens-for-the-entire-block\">[M-10] Oracle may be attacked if an attacker can pump the tokens for the entire block</a></li>\n<li><a href=\"#m-11-in-cnotesol-anyone-can-initially-become-both-accountant-and-admin\">[M-11] In <code>Cnote.sol</code>, anyone can initially become both accountant and admin</a></li>\n<li><a href=\"#m-12-note-when-_initialsupply---0-the-_mint_to_accountant-function-will-fail\">[M-12] Note: When <code>_initialSupply ! = 0</code>, the <code>_mint_to_Accountant</code> function will fail</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#low-risk-and-non-critical-issues\">Low Risk and Non-Critical Issues</a></p>\n<ul>\n<li><a href=\"#l-01-assert-statement-should-not-be-used\">L-01 assert statement should not be used</a></li>\n<li><a href=\"#l-02-closefactor-unbounded\">L-02 CloseFactor unbounded</a></li>\n<li><a href=\"#l-03-immutable-addresses-lack-zero-address-check\">L-03 Immutable addresses lack zero-address check</a></li>\n<li><a href=\"#l-04-receive-function\">L-04 Receive function</a></li>\n<li><a href=\"#l-05-local-variable-shadowing\">L-05 Local variable shadowing</a></li>\n<li><a href=\"#l-06-avoid-using-transfer-to-transfer-native-tokens\">L-06 Avoid Using <code>.Transfer</code> to Transfer Native Tokens</a></li>\n<li><a href=\"#n-01-underflow-desired-but-not-possible\">N-01 Underflow desired but not possible</a></li>\n<li><a href=\"#n-02-comment-missing-function-parameter\">N-02 Comment Missing function parameter</a></li>\n<li><a href=\"#n-03-constants-instead-of-magic-numbers\">N-03 Constants instead of magic numbers</a></li>\n<li><a href=\"#n-04-constructor-visibility\">N-04 Constructor visibility</a></li>\n<li><a href=\"#n-05-events-indexing\">N-05 Events indexing</a></li>\n<li><a href=\"#n-06-event-should-be-emitted-in-setters\">N-06 Event should be emitted in setters</a></li>\n<li><a href=\"#n-07-function-missing-comments\">N-07 Function missing comments</a></li>\n<li><a href=\"#n-08-function-order\">N-08 Function order</a></li>\n<li><a href=\"#n-09-non-library-files-should-use-fixed-compiler-versions\">N-09 Non-library files should use fixed compiler versions</a></li>\n<li><a href=\"#n-10-open-todos\">N-10 Open TODOs</a></li>\n<li><a href=\"#n-11-public-functions-can-be-external\">N-11 Public functions can be external</a></li>\n<li><a href=\"#n-12-require-statements-should-have-descriptive-strings\">N-12 Require statements should have descriptive strings</a></li>\n<li><a href=\"#n-13-scientific-notation\">N-13 Scientific notation</a></li>\n<li><a href=\"#n-14-styling\">N-14 Styling</a></li>\n<li><a href=\"#n-15-typos\">N-15 Typos</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#gas-optimizations\">Gas Optimizations</a></p>\n<ul>\n<li><a href=\"#g-01-initialising-to-default-values\">G-01 Initialising to Default Values</a></li>\n<li><a href=\"#g-02-emitting-storage-variables\">G-02 Emitting Storage Variables</a></li>\n<li><a href=\"#g-03-variables-can-be-immutableconstant\">G-03 Variables Can be Immutable/Constant</a></li>\n<li><a href=\"#g-04-for-loop-optimisations\">G-04 For Loop Optimisations</a></li>\n<li><a href=\"#g-05-minimising-sloads\">G-05 Minimising SLOAD’s</a></li>\n<li><a href=\"#g-06-no-need-to-check--true-in-conditional-statements\">G-06 No Need to check == True in Conditional Statements</a></li>\n<li><a href=\"#g-07-custom-errors\">G-07 Custom Errors</a></li>\n<li><a href=\"#g-08-long-revert-strings\">G-08 Long Revert Strings</a></li>\n<li><a href=\"#g-09-uint--0-checks-in-require-functions\">G-09 Uint > 0 Checks in Require Functions</a></li>\n<li><a href=\"#g-10--in-require-functions\">G-10 &#x26;&#x26; in Require Functions</a></li>\n</ul>\n</li>\n<li><a href=\"#disclosures\">Disclosures</a></li>\n</ul>",
  "md": "\n# Overview\n\n## About C4\n\nCode4rena (C4) is an open organization consisting of security researchers, auditors, developers, and individuals with domain expertise in smart contracts.\n\nA C4 audit contest is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\n\nDuring the audit contest outlined in this document, C4 conducted an analysis of the Canto smart contract system written in Solidity. The audit contest took place between June 14—June 21 2022.\n\n*Note: this audit contest originally ran under the name `New Blockchain`.*\n\n## Wardens\n\n63 Wardens contributed reports to the Canto contest:\n\n  1. [WatchPug](https://twitter.com/WatchPug_) ([jtp](https://github.com/jack-the-pug) and [ming](https://github.com/mingwatch))\n  1. cccz\n  1. hake\n  1. [Ruhum](https://twitter.com/0xruhum)\n  1. 0xf15ers (remora and twojoy)\n  1. [Picodes](https://twitter.com/thePicodes)\n  1. cryptphi\n  1. [hansfriese](https://twitter.com/hansfriese)\n  1. [Chom](https://chom.dev)\n  1. p4st13r4 ([0x69e8](https://github.com/0x69e8) and 0xb4bb4)\n  1. [Tutturu](https://twitter.com/TuturuTech)\n  1. [gzeon](https://twitter.com/gzeon)\n  1. 0x52\n  1. codexploder\n  1. zzzitron\n  1. [hyh](https://twitter.com/0xhyh)\n  1. 0x1f8b\n  1. [csanuragjain](https://twitter.com/csanuragjain)\n  1. [joestakey](https://twitter.com/JoeStakey)\n  1. Soosh\n  1. TerrierLover\n  1. [defsec](https://twitter.com/defsec_)\n  1. [catchup](https://twitter.com/catchup22)\n  1. [Dravee](https://twitter.com/BowTiedDravee)\n  1. &#95;Adam\n  1. Lambda\n  1. 0xDjango\n  1. saian\n  1. 0xmint\n  1. [oyc&#95;109](https://twitter.com/andyfeili)\n  1. [0xNazgul](https://twitter.com/0xNazgul)\n  1. robee\n  1. dipp\n  1. [k](https://twitter.com/kylriley)\n  1. [JMukesh](https://twitter.com/MukeshJ_eth)\n  1. [TomJ](https://mobile.twitter.com/tomj_bb)\n  1. Limbooo\n  1. Waze\n  1. [0xKitsune](https://github.com/0xKitsune)\n  1. [Funen](https://instagram.com/vanensurya)\n  1. sach1r0\n  1. simon135\n  1. [fatherOfBlocks](https://twitter.com/father0fBl0cks)\n  1. 0x29A (0x4non and rotcivegaf)\n  1. [c3phas](https://twitter.com/c3ph_)\n  1. [MadWookie](https://twitter.com/wookiemad)\n  1. [Bronicle](https://twitter.com/Cryptonicle1)\n  1. asutorufos\n  1. [technicallyty](https://twitter.com/technicallyty)\n  1. nxrblsrpr\n  1. [ignacio](https://twitter.com/0xheynacho)\n  1. 0xkatana\n  1. [JC](https://twitter.com/sm4rtcontr4ct)\n  1. [rfa](https://www.instagram.com/riyan_rfa/)\n  1. [Tomio](https://twitter.com/meidhiwirara)\n  1. [ynnad](https://twitter.com/ynnadt1)\n  1. [0v3rf10w](https://twitter.com/_0v3rf10w)\n  1. ak1\n  1. [Fitraldys](https://twitter.com/fitraldys)\n\nThis contest was judged by [Alex the Entreprenerd](https://twitter.com/GalloDaSballo).\n\nFinal report assembled by [liveactionllama](https://twitter.com/liveactionllama).\n\n# Summary\n\nThe C4 analysis yielded an aggregated total of 26 unique vulnerabilities. Of these vulnerabilities, 14 received a risk rating in the category of HIGH severity and 12 received a risk rating in the category of MEDIUM severity.\n\nAdditionally, C4 analysis included 45 reports detailing issues with a risk rating of LOW severity or non-critical. There were also 39 reports recommending gas optimizations.\n\nAll of the issues presented here are linked back to their original finding.\n\n# Scope\n\nThe code under review can be found within the [C4 Canto contest repository](https://github.com/code-423n4/2022-06-canto), and is composed of 15 smart contracts written in the Solidity programming language and includes 2,379 lines of Solidity code. One Cosmos SDK blockchain is also included.\n\n# Severity Criteria\n\nC4 assesses the severity of disclosed vulnerabilities according to a methodology based on [OWASP standards](https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).\n\nVulnerabilities are divided into three primary risk categories: high, medium, and low/non-critical.\n\nHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\n\n- Malicious Input Handling\n- Escalation of privileges\n- Arithmetic\n- Gas use\n\nFurther information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on [the C4 website](https://code4rena.com).\n\n# High Risk Findings (14)\n## [[H-01] Anyone can set the `baseRatePerYear` after the `updateFrequency` has passed](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/22)\n_Submitted by 0xDjango, also found by 0x52, Chom, csanuragjain, JMukesh, k, oyc&#95;109, Picodes, Soosh, and WatchPug_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/NoteInterest.sol#L118-L129>\n\nThe `updateBaseRate()` function is public and lacks access control, so anyone can set the critical variable `baseRatePerYear` once the block delta has surpassed the `updateFrequency` variable. This will have negative effects on the borrow and supply rates used anywhere else in the protocol.\n\nThe updateFrequency is explained to default to 24 hours per the comments, so this vulnerability will be available every day. Important to note, the admin can fix the `baseRatePerYear` by calling the admin-only `_setBaseRatePerYear()` function. However, calling this function does not set the `lastUpdateBlock` so users will still be able to change the rate back after the 24 hours waiting period from the previous change.\n\n### Proof of Concept\n\n        function updateBaseRate(uint newBaseRatePerYear) public {\n            // check the current block number\n            uint blockNumber = block.number;\n            uint deltaBlocks = blockNumber.sub(lastUpdateBlock);\n\n\n            if (deltaBlocks > updateFrequency) {\n                // pass in a base rate per year\n                baseRatePerYear = newBaseRatePerYear;\n                lastUpdateBlock = blockNumber;\n                emit NewInterestParams(baseRatePerYear);\n            }\n        }\n\n### Recommended Mitigation Steps\n\nI have trouble understanding the intention of this function. It appears that the rate should only be able to be set by the admin, so the `_setBaseRatePerYear()` function seems sufficient. Otherwise, add access control for only trusted parties.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/22)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/22#issuecomment-1205570803):**\n > The warden has shown how, due to probably an oversight, a core function that has impact in determining the yearly interest rate was left open for anyone to change once every 24 hrs.\n> \n> Because the impact is:\n> - Potential bricking of integrating contracts\n> - Economic exploits\n> \n> And anyone can perform it\n> \n> I believe that High Severity is appropriate.\n> \n> Mitigation requires either deleting the function or adding access control.\n\n\n\n***\n\n## [[H-02] Stealing Wrapped Manifest in WETH.sol](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/19)\n_Submitted by Soosh, also found by 0x52, 0xDjango, cccz, saian, TerrierLover, WatchPug, and zzzitron_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/WETH.sol#L85>\n\nAllows anyone to steal all wrapped manifest from the WETH.sol contract. Attacker can also withdraw\nto convert Wrapped Manifest to Manifest.\n\nIssue in approve(address owner, address spender) external function. This allows an attacker to approve themselves to spend another user's tokens.\n\nAttacker can then use transferFrom(address src, address dst, uint wad) function to send tokens to themself.\n\n### Proof of Concept\n\nSee warden's [full report](https://github.com/code-423n4/2022-06-canto-findings/issues/19) for further details.\n\n### Tools Used\n\nVScode, hardhat\n\n### Recommended Mitigation Steps\n\nI believe there is no need for this function. There is another approve(address guy, uint wad) function that uses msg.sender to approve allowance. There should be no need for someone to approve another user's allowance.\n\nRemove the approve(address owner, address spender) function.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/19)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/19#issuecomment-1205591679):**\n > The warden has shown how, for whatever reason, an approve function which allows to pass the \"approver\" as parameter was present in the WETH contract.\n> \n> This allows anyone, to steal all WETH from any other holder.\n> \n> For that reason, High Severity is appropriate.\n\n\n\n***\n\n## [[H-03]  `AccountantDelegate`: `sweepInterest` function will destroy the cnote in the contract.](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/89)\n_Submitted by cccz, also found by WatchPug_\n\nWhen the user borrows note tokens, the AccountantDelegate contract provides note tokens and gets cnote tokens. Later, when the user repays the note tokens, the cnote tokens are destroyed and the note tokens are transferred to the AccountantDelegate contract.\nHowever, in the sweepInterest function of the AccountantDelegate contract, all cnote tokens in the contract will be transferred to address 0. This will prevent the user from repaying the note tokens, and the sweepInterest function will not calculate the interest correctly later.\n\n### Proof of Concept\n\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegate.sol#L74-L92><br>\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CToken.sol#L533>\n\n### Recommended Mitigation Steps\n\n        function sweepInterest() external override returns(uint) {\n    \t\t\n    \t\tuint noteBalance = note.balanceOf(address(this));\n    \t\tuint CNoteBalance = cnote.balanceOf(address(this));\n\n    \t\tExp memory expRate = Exp({mantissa: cnote.exchangeRateStored()}); // obtain exchange Rate from cNote Lending Market as a mantissa (scaled by 1e18)\n    \t\tuint cNoteConverted = mul_ScalarTruncate(expRate, CNoteBalance); //calculate truncate(cNoteBalance* mantissa{expRate})\n    \t\tuint noteDifferential = sub_(note.totalSupply(), noteBalance); //cannot underflow, subtraction first to prevent against overflow, subtraction as integers\n\n    \t\trequire(cNoteConverted >= noteDifferential, \"Note Loaned to LendingMarket must increase in value\");\n    \t\t\n    \t\tuint amtToSweep = sub_(cNoteConverted, noteDifferential);\n\n    \t\tnote.transfer(treasury, amtToSweep);\n\n    -\t\tcnote.transfer(address(0), CNoteBalance);\n\n    \t\treturn 0;\n        }\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/89)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/89#issuecomment-1205796186):**\n > The warden has shown how, due to a programmer mistake, interest bearing Note will be burned.\n> \n> It is unclear why this decision was made, and I believe the sponsor should look into `redeem`ing the `cNote` over destroying it.\n> \n> The sponsor confirmed, and because this finding shows unconditional loss of assets, I agree with High Severity.\n\n\n\n***\n\n## [[H-04] `lending-market/NoteInterest.sol` Wrong implementation of `getBorrowRate()`](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/166)\n_Submitted by WatchPug, also found by 0x1f8b, Chom, and gzeon_\n\n<https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/NoteInterest.sol#L92-L101><br>\n\n```solidity\nfunction getBorrowRate(uint cash, uint borrows, uint reserves) public view override returns (uint) {\n    // Gets the Note/gUSDC TWAP in a given interval, as a mantissa (scaled by 1e18)\n    // uint twapMantissa = getUnderlyingPrice(note);\n    uint rand = uint(keccak256(abi.encodePacked(msg.sender))) % 100;\n    uint ir = (100 - rand).mul(adjusterCoefficient).add(baseRatePerYear).mul(1e16);\n    uint newRatePerYear = ir >= 0 ? ir : 0;\n    // convert it to base rate per block\n    uint newRatePerBlock = newRatePerYear.div(blocksPerYear);\n    return newRatePerBlock;\n}\n```\n\nThe current implementation will return a random rate based on the caller's address and `baseRatePerYear`.\n\nThis makes some lucky addresses pay much lower and some addresses pay much higher rates.\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/166#issuecomment-1205799947):**\n > The warden has shown how, due to most likely a developer oversight, the unimplemented `getBorrowRate` returns a random value which can easily be gamed (and is not recommended for production).\n> \n> Because the contract is in scope, and the functionality is broken, I agree with High Severity.\n\n\n\n***\n\n## [[H-05] `zeroswap/UniswapV2Library.sol` Wrong init code hash in `UniswapV2Library.pairFor()` will break `UniswapV2Oracle`, `UniswapV2Router02`, `SushiRoll`](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/164)\n_Submitted by WatchPug_\n\n<https://github.com/Plex-Engineer/zeroswap/blob/03507a80322112f4f3c723fc68bed0f138702836/contracts/uniswapv2/libraries/UniswapV2Library.sol#L20-L28><br>\n\n```solidity\nfunction pairFor(address factory, address tokenA, address tokenB) internal pure returns (address pair) {\n    (address token0, address token1) = sortTokens(tokenA, tokenB);\n    pair = address(uint(keccak256(abi.encodePacked(\n            hex'ff',\n            factory,\n            keccak256(abi.encodePacked(token0, token1)),\n            hex'e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303' // init code hash\n        ))));\n}\n```\n\nThe `init code hash` in `UniswapV2Library.pairFor()` should be updated since the code of `UniswapV2Pair` has been changed. Otherwise, the `pair` address calculated will be wrong, most likely non-existing address.\n\nThere are many other functions and other contracts across the codebase, including  `UniswapV2Oracle`, `UniswapV2Router02`, and `SushiRoll`, that rely on the `UniswapV2Library.pairFor()` function for the address of the pair, with the `UniswapV2Library.pairFor()` returning a wrong and non-existing address, these functions and contracts will malfunction.\n\n### Recommended Mitigation Steps\n\nUpdate the init code hash from `hex'e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303'` to the value of `UniswapV2Factory.pairCodeHash()`.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/164)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/164#issuecomment-1207488488):**\n > Amazing catch, because the contract bytecode has been change, the init hash will be different.\n> \n> While the bug seems trivial, it's impact is a total bricking of all swapping functionality as the Library will cause all Periphery Contracts to call to the wrong addresses.\n> \n> Because of the impact, I agree with High Severity.\n\n\n\n***\n\n## [[H-06] Accountant can't be initialized](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/53)\n_Submitted by Ruhum, also found by cccz_\n\nIt's not possible to initialize the accountant because of a mistake in the function's require statement.\n\nI rate it as MED since a key part of the protocol wouldn't be available until the contract is modified and redeployed.\n\n### Proof of Concept\n\nThe issue is the following `require()` statement: <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Accountant/AccountantDelegate.sol#L29>\n\nThere, the function checks whether the accountant has received the correct amount of tokens. But, it compares the accountant's balance with the `_initialSupply`. That value is always 0. So the require statement will always fail\n\nWhen the Note contract is initialized, `_initialSupply` is set to 0:\n\n*   <https://github.com/Plex-Engineer/lending-market/blob/main/deploy/canto/004_deploy_Note.ts#L14>\n*   <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Note.sol#L9>\n*   <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/ERC20.sol#L32>\n\nAfter `_mint_to_Accountant()` mints `type(uint).max` tokens to the accountant: <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Note.sol#L18><br>\nThat increases the `totalSupply` but not the `_initialSupply`: <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/ERC20.sol#L242>\n\nThe `_initialSupply` value is only modified by the ERC20 contract's constructor.\n\n### Recommended Mitigation Steps\n\nChange the require statement to\n\n```sol\nrequire(note.balanceOf(msg.sender) == note.totalSupply(), \"AccountantDelegate::initiatlize: Accountant has not received payment\");\n```\n\n**[nivasan1 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/53)**\n\n**[Alex the Entreprenerd (judge) increased severity to High and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/53#issuecomment-1207501752):**\n > The warden has shown how, due to an incorrect assumption, `AccountantDelegate.initialize` cannot work, meaning part of the protocol will never work without fixing this issue.\n> \n> While the change should be fairly trivial, the impact is pretty high, for those reasons am going to raise severity to High.\n\n\n\n***\n\n## [[H-07] Anyone can create Proposal Unigov `Proposal-Store.sol`](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/26)\n_Submitted by Soosh, also found by 0x1f8b, cccz, csanuragjain, hake, p4st13r4, Ruhum, TerrierLover, WatchPug, and zzzitron_\n\n<https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L46><br>\n<https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Governance/GovernorBravoDelegate.sol#L37>\n\nProposal Store is used to store proposals that have already passed (<https://code4rena.com/contests/2022-06-new-blockchain-contest#unigov-module-615-sloc>) \" Upon a proposal’s passing, the proposalHandler either deploys the ProposalStore contract (if it is not already deployed) or appends the proposal into the ProposalStore’s mapping ( uint ⇒ Proposal)\"\n\nBut anyone can add proposals to the contract directly via AddProposal() function.\n\nUnigov proposals can be queued and executed by anyone in GovernorBravoDelegate contract<br>\n<https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Governance/GovernorBravoDelegate.sol#L37>\n\n### Proof of Concept\n\n<https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L46>\n\n### Recommended Mitigation Steps\n\nAuthorization checks for AddProposal, only governance module should be able to update.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/26)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/26#issuecomment-1211337729):**\n > The warden has shown how, due to a lack of checks, anyone can create, queue, and execute a proposal without any particular checks.\n> \n> Because governance normally is limited via:\n> - Voting on a proposal\n> - Access control to limit transactions\n> \n> And the finding shows how this is completely ignored; \n> \n> I believe High Severity to be appropriate.\n\n\n\n***\n\n## [[H-08] Transferring any amount of the underlying token to the CNote contract will make the contract functions unusable](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/227)\n_Submitted by Tutturu, also found by 0x52, hyh, p4st13r4, and WatchPug_\n\nThe contract expects the balance of the underlying token to == 0 at all points when calling the contract functions by requiring getCashPrior() == 0, which checks token.balanceOf(address(this)) where token is the underlying asset.\n\nAn attacker can transfer any amount of the underlying asset directly to the contract and make all of the functions requiring getCashPrior() == 0 to revert.\n\n#### Proof of Concept\n\n[CNote.sol#L43](https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L43)<br>\n[CNote.sol#L114](https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L114)<br>\n[CNote.sol#198](https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L198)<br>\n[CNote.sol#310](https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L310)<br>\n\n1.  Attacker gets any balance of Note (amount = 1 token)\n2.  Attacker transfers the token to CNote which uses Note as an underlying asset, by calling note.transfer(CNoteAddress, amount). The function is available since Note inherits from ERC20\n3.  Any calls to CNote functions now revert due to getCashPrior() not being equal to 0\n\n### Recommended Mitigation Steps\n\nInstead of checking the underlying token balance via balanceOf(address(this)) the contract could hold an internal balance of the token, mitigating the impact of tokens being forcefully transferred to the contract.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/227)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/227#issuecomment-1211343983):**\n > The warden has shown how, via a simple transfer of 1 wei of token, the invariant of `getCashPrior() == 0` can be broken, bricking the functionality.\n> \n> Because of:\n> - the simplicity of the exploit\n> - The impact being inability to interact with the contract\n> - A protocol invariant is broken\n> \n> I agree with High Severity.\n> \n> Mitigation would require using delta balances and perhaps re-thinking the need for those intermediary checks.\n\n\n\n***\n\n## [[H-09] WETH.sol computes the wrong `totalSupply()`](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/191)\n_Submitted by p4st13r4, also found by hansfriese, Ruhum, TerrierLover, WatchPug, and zzzitron_\n\nAffected code:\n\n*   <https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L47>\n\n`WETH.sol` is almost copied from the infamous WETH contract that lives in mainnet. This contract is supposed to receive the native currency of the blockchain (for example ETH) and wrap it into a tokenized, ERC-20 form. This contract computes the `totalSupply()` using the balance of the contract itself stored in the `balanceOf` mapping, when instead it should be using the native `balance` function. This way, `totalSupply()` always returns zero as the `WETH` contract itself has no way of calling `deposit` to itself and increase its own balance\n\n### Proof of Concept\n\n1.  Alice transfers 100 ETH to `WETH.sol`\n2.  Alice calls `balanceOf()` for her address and it returns 100 WETH\n3.  Alice calls `totalSupply()`, expecting to see 100 WETH, but it returns 0\n\n### Tools Used\n\nEditor\n\n### Recommended Mitigation Steps\n\n```jsx\nfunction totalSupply() public view returns (uint) {\n    return address(this).balance\n}\n```\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/191)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/191#issuecomment-1211349777):**\n > The warden has shown how, due to a programming mistake, the WETH totalSupply will be incorrect.\n> \n> Mitigation seems straightforward, however, because the vulnerability would have causes totalSupply to return 0, and shows a broken functionality for a core contract, I think High Severity to be appropriate\n\n\n\n***\n\n## [[H-10] Comptroller uses the wrong address for the WETH contract](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/46)\n_Submitted by Ruhum, also found by 0xf15ers, cccz, hake, Soosh, and WatchPug_\n\nThe Comptroller contract uses a hardcoded address for the WETH contract which is not the correct one. Because of that, it will be impossible to claim COMP rewards. That results in a loss of funds so I rate it as HIGH.\n\n### Proof of Concept\n\nThe Comptroller's `getWETHAddress()` function: <https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1469>\n\nIt's a left-over from the original compound repo: <https://github.com/compound-finance/compound-protocol/blob/master/contracts/Comptroller.sol#L1469>\n\nIt's used by the `grantCompInternal()` function: <https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1377>\n\nThat function is called by `claimComp()`: <https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1365>\n\nIf there is a contract stored in that address and it doesn't adhere to the interface (doesn't have a `balanceOf()` and `transfer()` function), the transaction will revert. If there is no contract, the call will succeed without having any effect. In both cases, the user doesn't get their COMP rewards.\n\n### Recommended Mitigation Steps\n\nThe WETH contract's address should be parsed to the Comptroller through the constructor or another function instead of being hardcoded.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/46)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/46#issuecomment-1211353848):**\n > The warden has shown how the address for WETH / comp is hardcoded and the address is pointing to Mainnet's COMP.\n> \n> This misconfiguration will guarantee that any function calling `grantCompInternal` as well as `claimComp` will revert.\n> \n> Because the functionality is hampered, I agree with High Severity.\n\n\n\n***\n\n## [[H-11] `lending-market/Note.sol` Wrong implementation of access control](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/173)\n_Submitted by WatchPug, also found by catchup, Lambda, p4st13r4, and Tutturu_\n\n<https://github.com/Plex-Engineer/lending-market/blob/b93e2867a64b420ce6ce317f01c7834a7b6b17ca/contracts/Note.sol#L13-L31><br>\n\n```solidity\nfunction _mint_to_Accountant(address accountantDelegator) external {\n    if (accountant == address(0)) {\n        _setAccountantAddress(msg.sender);\n    }\n    require(msg.sender == accountant, \"Note::_mint_to_Accountant: \");\n    _mint(msg.sender, type(uint).max);\n}\n\nfunction RetAccountant() public view returns(address) {\n    return accountant;\n}\n\nfunction _setAccountantAddress(address accountant_) internal {\n    if(accountant != address(0)) {\n        require(msg.sender == admin, \"Note::_setAccountantAddress: Only admin may call this function\");\n    }\n    accountant = accountant_;\n    admin = accountant;\n}\n```\n\n`_mint_to_Accountant()` calls `_setAccountantAddress()` when `accountant == address(0)`, which will always be the case when `_mint_to_Accountant()` is called for the first time.\n\nAnd `_setAccountantAddress()` only checks if `msg.sender == admin` when `accountant != address(0)` which will always be `false`, therefore the access control is not working.\n\nL17 will then check if `msg.sender == accountant`, now it will always be the case, because at L29, `accountant` was set to `msg.sender`.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/173)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/173#issuecomment-1211378551):**\n > The warden has shown how, due to a flaw in logic, via a front-run, anyone can become the `accountant` and mint all the totalSupply to themselves.\n> \n> While I'm not super confident on severity for the front-run as I'd argue the worst case is forcing a re-deploy, the warden has shown a lack of logic in the checks (`msg.sender == admin`) which breaks it's invariants.\n> \n> For that reason, I think High Severity to be appropriate.\n\n\n\n***\n\n## [[H-12] In `ERC20`, `TotalSupply` is broken](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/108)\n_Submitted by Picodes, also found by cccz_\n\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L33>\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L95>\n\nFor an obscure reason as it’s not commented, `_totalSupply` is not initialized to 0, leading to an inaccurate total supply, which could easily break integrations, computations of market cap, etc.\n\n### Proof of Concept\n\nIf the constructor is called with `_initialSupply = 1000`, then `1000` tokens are minted. The total supply will be `2000`.\n\n### Recommended Mitigation Steps\n\nRemove `_initialSupply`.\n\n**[tkkwon1998 (Canto) disputed and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1163455701):**\n > The explanation is not clear. We can't seem to reproduce this issue as we can't find a scenario where the `totalSupply` function returns an incorrect value. \n\n**[Picodes (warden) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1165895330):**\n > @tkkwon1998 to clarify:\n> \n> Deploy the ERC20 with `totalSupply_ = 1000`. \n> \n> Then `totalSupply()` returns 1000, which is incorrect.\n> \n> Then if someone mints 1000 tokens, there is 1000 tokens in the market but due to `_totalSupply += amount;`, totalSupply = 2000 which is still incorrect\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1211392092):**\n > I believe the submission could have benefitted by:\n> - A coded POC\n> - Recognizing a revert due to the finding\n> \n> However the finding is ultimately true in that, because `totalSupply` is a parameter passed in to the contract, and the ERC20 contract will not mint that amount, the `totalSupply` will end up not reflecting the total amounts of tokens minted.\n> \n> For this reason, I believe the finding to be valid and High Severity to be appropriate.\n> \n> I recommend the warden to err on the side of giving too much information to avoid getting their finding invalidated incorrectly.\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/108#issuecomment-1212622241):**\n > After further thinking, I still believe the finding is of high severity as the ERC20 standard is also broken. I do believe the submission could have been better developed, however, I think High is in place here.\n\n\n\n***\n\n## [[H-13] It's not possible to execute governance proposals through the `GovernorBravoDelegate` contract](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/39)\n_Submitted by Ruhum, also found by 0xmint, cccz, csanuragjain, dipp, hake, and zzzitron_\n\nIt's not possible to execute a proposal through the GovernorBravoDelegate contract because the `executed` property of it is set to `true` when it's queued up.\n\nSince this means that the governance contract is unusable, it might result in locked-up funds if those were transferred to the contract before the issue comes up. Because of that I'd rate it as HIGH.\n\n#### Proof of Concept\n\n`executed` is set to `true`: <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L63>\n\nHere, the `execute()` function checks whether the proposal's state is `Queued`: <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L87>\n\nBut, since the `execute` property is `true`, the `state()` function will return `Executed`: <https://github.com/Plex-Engineer/lending-market/blob/main/contracts/Governance/GovernorBravoDelegate.sol#L117>\n\nIn the original compound repo, `executed` is `false` when the proposal is queued up: <https://github.com/compound-finance/compound-protocol/blob/master/contracts/Governance/GovernorBravoDelegate.sol#L111>\n\n### Recommended Mitigation Steps\n\nJust delete the line where `executed` is set to `true`. Since the zero-value is `false` anyway, you'll save gas as well.\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/39)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/39#issuecomment-1211409709):**\n > The warden has shown how, due to a coding decision, no transaction can be executed from the Governor Contract.\n> \n> Because the functionality is broken, I agree with High Severity.\n\n\n\n***\n\n## [[H-14] `WETH.allowance()` returns wrong result](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/218)\n_Submitted by hansfriese, also found by 0xf15ers_\n\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L104>\n\nWETH.allowance() returns wrong result.<br>\nI can't find other contracts that use this function but WETH.sol is a base contract and it should be fixed properly.\n\n### Proof of Concept\n\nIn this function, the \"return\" keyword is missing and it will always output 0 in this case.\n\n### Tools Used\n\nSolidity Visual Developer of VSCode\n\n### Recommended Mitigation Steps\n\nL104 should be changed like below.\n\n    return _allowance[owner][spender];\n\n**[nivasan1 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/218)**\n\n**[Alex the Entreprenerd (judge) increased severity to High and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/218#issuecomment-1212631296):**\n > The warden has found a minor developer oversight, which will cause the view function `allowance` to always return 0.\n> \n> Breaking of a core contract such as WETH is a non-starter.\n> \n> Because I've already raised severity of #191 for similar reasons, I think High Severity is appropriate in this case. \n\n\n\n***\n\n \n# Medium Risk Findings (12)\n## [[M-01] Missing zero address check can set treasury to zero address](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/121)\n_Submitted by cryptphi_\n\nAccountantDelegate.initialize() is missing a zero address check for `treasury_` parameter, which could maybe allow treasury to be mistakenly set to 0 address.\n\n### Proof of Concept\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Accountant/AccountantDelegate.sol#L20>\n\n### Recommended Mitigation Steps\n\nAdd a require() check for zero address for the treasury parameter before changing the treasury address in the initialize function.\n\n**[nivasan1 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/121)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/121#issuecomment-1212623337):**\n > Because:\n> - The finding is technically correct\n> - The `treasury` variable is only set on the initializer\n> - An incorrect setting could cause loss of funds\n> \n> I'm going to mark the finding as valid and of Medium severity.\n> \n> In mentioning this report in the future, notice that the conditions that caused me to raise the severity weren't simply the lack of a check, but the actual risk of loss of funds, and the inability to easily fix.\n\n\n\n***\n\n## [[M-02] Only the `state()` of the latest proposal can be checked](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/254)\n_Submitted by hake_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L115>\n\n`state()` function cannot view the state from any proposal except for the latest one.\n\n### Proof of Concept\n\n```solidity\nrequire(proposalCount >= proposalId && proposalId > initialProposalId, \"GovernorBravo::state: invalid proposal id\");\n```\n\nCurrently `proposalCount` needs to be bigger or equal to `proposalId`.<br>\nAssuming `proposalId` is incremented linearly in conjunction with `proposalCount`, this implies only the most recent `proposalId` will pass the `require()` check above. All other proposals will not be able to have their states checked via this function.\n\n### Recommended Mitigation Steps\n\nChange above function to `proposalCount <= proposalId` (assuming `proposalId` is set linearly, which currently is not enforced by code).\n\n**[nivasan1 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/254)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/254#issuecomment-1205684575):**\n > The warden has shown how, due to a mistake in logic, only the `state` of the latest proposal can be read.\n> \n> Because the function `state` is used in `execute` we can conclude that only one proposal can be queue for execution at a time, drastically reducing the availability of the Governor.\n> \n> For this reason I believe medium severity is appropriate.\n\n\n\n***\n\n## [[M-03] Unable to check `state()` if `proposalId == 0`](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/244)\n_Submitted by hake_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L115>\n\n`state()` function cannot be called to view proposal state if `proposalId == 0`.\n\n### Proof of Concept\n\nThere is no check to prevent queueing a `proposalId` with a value of 0 via the [`queue()`](https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L37-L47) function.<br>\nHowever, in the `state()` function there is a check preventing using a `proposalId == 0`.<br>\nFor clarity: `initialProposalId` must be zero according to `_initiate()`, therefore, `proposalId` cannot be 0 according to check below.\n\n```solidity\nfunction state(uint proposalId) public view returns (ProposalState) {\n    require(proposalCount >= proposalId && proposalId > initialProposalId, \"GovernorBravo::state: invalid proposal id\");\n```\n\n### Recommended Mitigation Steps\n\nImplement check to preventing queueing a `proposalId == 0`.\n\n**[nivasan1 (Canto) disputed and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/244#issuecomment-1191992076):**\n > The ProposalId cannot be 0 as the proposal IDs are fixed and will be set via the cosmos-sdk.\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/244#issuecomment-1205692351):**\n > The warden has shown how, through a misconfiguration, a proposal could never be executable due to a revert in `state()`.\n> \n> While I believe the warden has already shown a remediation that would cover this scenario, I believe the Warden has shown a unique possible situation that can cause the system to stop working as intended.\n> \n> While the sponsor says the proposalId will never be 0, there is no way to avoid that at the Smart Contract level, meaning that any caller can set the proposal to 0.\n> \n> For these reasons, I think Medium Severity to be appropriate.\n\n\n\n***\n\n## [[M-04] accountant address can be set to zero by anyone leading to loss of funds/tokens](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/117)\n_Submitted by cryptphi_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L14-L21><br>\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L31><br>\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L96><br>\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L178><br>\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L258><br>\n\nIn `CNote._setAccountantContract()`, the require() check only works when `address(_accountant) != address(0)` , leading to the ability to set `_accountant` state variable to the zero address, as well as setting admin to zero address.\n\nThe following below are impacts arising from above:\n\n### A. Users can gain underlying asset tokens for free by minting CToken in `mintFresh()` then calling `redeemFresh()`\n\n#### Proof of Concept\n\n1.  Alice calls `_setAccountantContract()` with parameter input as 0.\n2.  The `_accountant` state variable is now 0.\n3.  Alice/or a contract calls `mintFresh()` with input address 0 and mintAmount 1000. (assuming function is external, reporting a separate issue on the mutability)\n4.  This passes the `if (minter == address(_accountant))` and proceeds to mint 1000 CTokens to address(0)\n5.  Alice then calls `redeemFresh()` with her address as the `redeemer` parameter, and redeemTokensIn as 1000.\n6.  Assume exchangeRate is 1, Alice would receive 1000 tokens in underlying asset.\n\n### B. Users could borrow CToken asset for free\n\nA user can borrow CToken asset from the contract, then set `_accountant` to 0 after. With `_accountant` being set to 0 , the borrower , then call `repayBorrowFresh()` to have `_accountant` (address 0) to repay back the borrowed tokens assuming address(0) already has some tokens, and user's borrowed asset (all/part) are repaid.\n\n#### Proof of Concept\n\n1.  Alice calls `borrowFresh()` to borrow 500 CTokens from contract.\n2.  Then Alice calls `_setAccountantContract()` with parameter input as 0.\n3.  The `_accountant` state variable is now 0.\n4.  With `_accountant` being set to 0, Alice calls `repayBorrowFresh()` having the payer be address 0, borrower being her address and 500 as repayAmount.\n5.  Assume address 0 already holds 1000 CTokens, Alice's debt will be fully repaid and she'll gain 500 CTokens for free.\n\n### C. Accounting contract could loses funds/tokens\n\nWhen the `_accountant` is set to 0, CTokens/CNote will be sent to the zero address making the Accounting contract lose funds whenever  `doTransferOut` is called.\n\n### Recommended Mitigation Steps\n\nInstead of a `if (address(_accountant) != address(0))` statement, an additional require check to ensure `accountant_` parameter is not 0 address can be used in addition to the require check for caller is admin.\n\nChange this\n\n```\nif (address(_accountant) != address(0)){\n            require(msg.sender == admin, \"CNote::_setAccountantContract:Only admin may call this function\");\n        }\n```\n\nto this\n\n    require(msg.sender == admin, \"CNote::_setAccountantContract:Only admin may call this function\");\n    require(accountant_ != address(0), \"accoutant can't be zero address\");\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/117)**\n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/117#issuecomment-1207485106):**\n > The warden has shown how, due to a misconfiguration, if the `accountant` is set to 0, users will be able to extra additional value (repay tokens for free).\n> \n> Because this is contingent on a misconfiguration, I believe Medium Severity to be more appropriate.\n\n\n\n***\n\n## [[M-05] Incorrect amount taken](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/98)\n_Submitted by csanuragjain, also found by 0xf15ers and gzeon_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/CNote.sol#L129><br>\n\nIt was observed that in repayBorrowFresh function, User is asked to send repayAmount instead of repayAmountFinal. This can lead to loss of user funds as user might be paying extra\n\n### Proof of Concept\n\n1.  User is making a repayment which eventually calls repayBorrowFresh function\n\n2.  Assuming repayAmount == type(uint).max, so repayAmountFinal becomes accountBorrowsPrev\n\n3.  This means User should only transfer in accountBorrowsPrev instead of repayAmount but that is not true. Contract is transferring repayAmount instead of repayAmountFinal as seen at CNote.sol#L129\n\n<!---->\n\n    uint actualRepayAmount = doTransferIn(payer, repayAmount);\n\n### Recommended Mitigation Steps\n\nRevise CNote.sol#L129 to below:\n\n    uint actualRepayAmount = doTransferIn(payer, repayAmountFinal);\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/98)**\n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/98#issuecomment-1207507197):**\n > The warden has showed how, due to an oversight, using `type(uint).max` to signify a complete repayment will actually attempt to transfer 2^256-1 units of token.\n> \n> While I think High severity would have been reasonable had the tokens gotten transferred, because what will actually happen is a revert, I think Medium Severity to be more appropriate.\n> \n> Remediation requires using `actualRepayAmount` or re-assigning the value of `repayAmount`\n\n\n\n***\n\n## [[M-06] Overprivileged admin can grant unlimited WETH](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/241)\n_Submitted by hake_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Comptroller.sol#L1376><br>\n\nAdmin can `_grantComp()` to any address using any amount and drain the contract.\n\n### Proof of Concept\n\nIf admin key gets compromised there is no timelock, no amount boundaries and no address limitations to prevent the assets to be drained immediately to the attacker's address.\n\n### Recommended Mitigation Steps\n\nThere is a few suggestions that could help mitigate this issue:<br>\nImplement timelock for `_grantComp()`<br>\nImplement hard coded recipient so funds cannot be arbitrarily sent to any address.<br>\nImplement a limit to the amount that can be granted.<br>\n\nHere is a reference to a past submission where this issue has been made by team Watchpug: <https://github.com/code-423n4/2022-01-insure-findings/issues/271>\n\n**[nivasan1 (Canto) acknowledged and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/241#issuecomment-1163850385):**\n > We acknowledge that this is an issue, however we feel that changing the core functionality of compound would be too costly.\n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/241#issuecomment-1211287073):**\n > The warden has shown how the Admin could sweep the reward token(in this case WETH) to any address, at any time, for an amount equal to all tokens available to the Comptroller.\n> \n> Because this is contingent on admin privilege, I think Medium Severity to be more appropriate.\n\n\n\n***\n\n## [[M-07] CNote updates the accounts after sending the funds, allowing for reentrancy](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/311)\n_Submitted by hyh, also found by defsec_\n\nHaving no reentrancy control and updating the records after external interactions allows for funds draining by reentrancy.\n\nSetting the severity to medium as this is conditional to transfer flow control introduction on future upgrades, but the impact is up to the full loss of the available funds by unrestricted borrowing.\n\n### Proof of Concept\n\nCNote runs doTransferOut before borrowing accounts are updated:\n\n<https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CNote.sol#L70-L87>\n\n            /*\n             * We invoke doTransferOut for the borrower and the borrowAmount.\n             *  Note: The cToken must handle variations between ERC-20 and ETH underlying.\n             *  On success, the cToken borrowAmount less of cash.\n             *  doTransferOut reverts if anything goes wrong, since we can't be sure if side effects occurred.\n             */\n            doTransferOut(borrower, borrowAmount);\n            require(getCashPrior() == 0,\"CNote::borrowFresh: Error in doTransferOut, impossible Liquidity in LendingMarket\");\n        //Amount minted by Accountant is always flashed from account\n        \n        /* We write the previously calculated values into storage */\n            accountBorrows[borrower].principal = accountBorrowsNew;\n            accountBorrows[borrower].interestIndex = borrowIndex;\n            totalBorrows = totalBorrowsNew;\n\n            /* We emit a Borrow event */\n            emit Borrow(borrower, borrowAmount, accountBorrowsNew, totalBorrowsNew);\n        }\n\nCall sequence here is borrow() -> borrowInternal() -> borrowFresh() -> doTransferOut(), which transfers the token to an external recipient:\n\n<https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CErc20.sol#L189-L200>\n\n        /**\n         * @dev Similar to EIP20 transfer, except it handles a False success from `transfer` and returns an explanatory\n         *      error code rather than reverting. If caller has not called checked protocol's balance, this may revert due to\n         *      insufficient cash held in this contract. If caller has checked protocol's balance prior to this call, and verified\n         *      it is >= amount, this should not revert in normal conditions.\n         *\n         *      Note: This wrapper safely handles non-standard ERC-20 tokens that do not return a value.\n         *            See here: https://medium.com/coinmonks/missing-return-value-bug-at-least-130-tokens-affected-d67bf08521ca\n         */\n        function doTransferOut(address payable to, uint amount) virtual override internal {\n            EIP20NonStandardInterface token = EIP20NonStandardInterface(underlying);\n            token.transfer(to, amount);\n\nThere an attacker can call exitMarket() that have no reentrancy control to remove the account of the debt:\n\n<https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/Comptroller.sol#L167-L174>\n\n<https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/ComptrollerG7.sol#L157-L164>\n\n        /**\n         * @notice Removes asset from sender's account liquidity calculation\n         * @dev Sender must not have an outstanding borrow balance in the asset,\n         *  or be providing necessary collateral for an outstanding borrow.\n         * @param cTokenAddress The address of the asset to be removed\n         * @return Whether or not the account successfully exited the market\n         */\n        function exitMarket(address cTokenAddress) override external returns (uint) {\n\nThis attack was carried out several times:\n\n<https://certik.medium.com/fei-protocol-incident-analysis-8527440696cc>\n\n### Recommended Mitigation Steps\n\nConsider moving accounting update before funds were sent out, for example as it is done in CToken's borrowFresh():\n\n    https://github.com/Plex-Engineer/lending-market/blob/2d423c7c3f62d65182d802deb99cc7bba4e057fd/contracts/CToken.sol#L595-L609\n\n            /*\n             * We write the previously calculated values into storage.\n             *  Note: Avoid token reentrancy attacks by writing increased borrow before external transfer.\n            `*/\n            accountBorrows[borrower].principal = accountBorrowsNew;\n            accountBorrows[borrower].interestIndex = borrowIndex;\n            totalBorrows = totalBorrowsNew;\n\n            /*\n             * We invoke doTransferOut for the borrower and the borrowAmount.\n             *  Note: The cToken must handle variations between ERC-20 and ETH underlying.\n             *  On success, the cToken borrowAmount less of cash.\n             *  doTransferOut reverts if anything goes wrong, since we can't be sure if side effects occurred.\n             */\n            doTransferOut(borrower, borrowAmount);\n\n**[nivasan1 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/311)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/311#issuecomment-1211346765):**\n > The warden has shown how, the in-scope codebase has historically been attacked due to a reentrancy attack.\n> \n> Because:\n> - The warden has provided POC and historical references\n> - The attack is contingent on a specific token that enables it\n> \n> I agree with Medium Severity.\n\n\n\n***\n\n## [[M-08] `zeroswap/UniswapV2Pair.sol` Token reserves per lp token can be manipulated due to lack of `MINIMUM_LIQUIDITY` when minting the first liquidity with `migrator`](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/162)\n_Submitted by WatchPug_\n\n```solidity\nif (_totalSupply == 0) {\n    address migrator = IUniswapV2Factory(factory).migrator();\n    if (msg.sender == migrator) {\n        liquidity = IMigrator(migrator).desiredLiquidity();\n        require(liquidity > 0 && liquidity != uint256(-1), \"Bad desired liquidity\");\n    } else {\n        require(migrator == address(0), \"Must not have migrator\");\n        liquidity = Math.sqrt(amount0.mul(amount1)).sub(MINIMUM_LIQUIDITY);\n        _mint(address(0), MINIMUM_LIQUIDITY); // permanently lock the first MINIMUM_LIQUIDITY tokens\n    }\n} else {\n    liquidity = Math.min(amount0.mul(_totalSupply) / _reserve0, amount1.mul(_totalSupply) / _reserve1);\n}\n```\n\n<https://github.com/Plex-Engineer/zeroswap/blob/03507a80322112f4f3c723fc68bed0f138702836/contracts/Migrator.sol#L28-L46>\n\n```solidity\nfunction migrate(IUniswapV2Pair orig) public returns (IUniswapV2Pair) {\n    require(msg.sender == chef, \"not from master chef\");\n    require(block.number >= notBeforeBlock, \"too early to migrate\");\n    require(orig.factory() == oldFactory, \"not from old factory\");\n    address token0 = orig.token0();\n    address token1 = orig.token1();\n    IUniswapV2Pair pair = IUniswapV2Pair(factory.getPair(token0, token1));\n    if (pair == IUniswapV2Pair(address(0))) {\n        pair = IUniswapV2Pair(factory.createPair(token0, token1));\n    }\n    uint256 lp = orig.balanceOf(msg.sender);\n    if (lp == 0) return pair;\n    desiredLiquidity = lp;\n    orig.transferFrom(msg.sender, address(orig), lp);\n    orig.burn(address(pair));\n    pair.mint(msg.sender);\n    desiredLiquidity = uint256(-1);\n    return pair;\n}\n```\n\nWhen minting LP tokens (`addLiquidity`), the amount of lp tokens you are getting is calculated based on `liquidity = Math.min(amount0.mul(_totalSupply) / _reserve0, amount1.mul(_totalSupply) / _reserve1);`, if the `_totalSupply` is small enough, and `1 wei` of the lp token worth large amounts of `token0` and `token1`, the user who adds small amounts of liquidity will receive less amount of lp tokens due to precision loss.\n\nA sophisticated attacker can artificially create that scenario by mint only `1 wei` of lp token and add `1e24` or even larger amounts of `token0` and `token1` by sending the tokens to the contract and then call `sync()` to update the reserves.\n\nThen all the new depositors will lose up to `1e24`, let's say they deposited `1.99e24`, they will only receive `1 wei` of lp token, therefore, losing `0.99e24` of `token0` and `token1`.\n\nThis attack vector was mitigated the original version of UniswapV2Pair by introcuing the `MINIMUM_LIQUIDITY` minted and permanently lock in `address(0)` upon the first mint.\n\nHowever, this can now be bypassed with the migrator, and this attacker vector is open again.\n\n### Recommended Mitigation Steps\n\nGiven the fact that zeroswap will be a DEX that does not need a feature to migrate liquidity from other DEXs, consider removing the migrator.\n\n**[tkkwon1998 (Canto) acknowledged and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/162#issuecomment-1163498026):**\n > Issue acknowledged, we will not be migrating liquidity from zeroswap. \n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/162#issuecomment-1211362065):**\n > The warden has shown how, due to legacy code, an LP pair can be permissionlessly minted and setup to cause loss to future depositors.\n> \n> Deployment of pairs is permissionless, however, the setup of Factory is Admin Dependent.\n> \n> While the Migrator file was out of scope, I believe the sponsor acknowledging, and the code being on the Pair file allows the finding to be valid.\n> \n> However, because it is ultimately contingent on setup, I think Medium Severity to be more appropriate.\n\n\n\n***\n\n## [[M-09] Incorrect condition always bound to fail](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/113)\n_Submitted by codexploder_\n\n<https://github.com/Plex-Engineer/lending-market/blob/755424c1f9ab3f9f0408443e6606f94e4f08a990/contracts/Governance/GovernorBravoDelegate.sol#L135><br>\n\nThe state function check GovernorBravoDelegate.sol#L115 will always fail since proposalId cannot lie in between initialProposalId and proposalCount due to an initialization in `_initiate` function\n\n### Proof of Concept\n\n1.  The `_initiate` function sets initialProposalId = proposalCount;\n\n2.  Now lets say proposal count was 5 so initialProposalId and proposalCount are both set to 5\n\n3.  Now lets say state function is called on proposal id 2\n\n4.  The require condition checks proposalCount >= proposalId && proposalId > initialProposalId\n\n5.  This is equivalent to 5>=2 && 5>5, since 5>5 is not true this always fails even though proposal id 2 is correct\n\n### Recommended Mitigation Steps\n\nRemove initialProposalId = proposalCount; in the `_initiate` function.\n\n**[tkkwon1998 (Canto) disagreed with severity and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/113#issuecomment-1163465664):**\n > This is a bug, but will not lead to any attack or loss of funds. The initiate function will just fail, meaning the timelock admin cannot be set. This should be a 2 (Med Risk) issue. \n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/113#issuecomment-1211408426):**\n > The warden has shown how, due to misconfiguration the Governor contract can be prevented from creating new proposals.\n> \n> Because this is contingent on setup, I think Medium Severity to be more appropriate.\n\n\n\n***\n\n## [[M-10] Oracle may be attacked if an attacker can pump the tokens for the entire block](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/233)\n_Submitted by Chom_\n\n<https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L190-L201><br>\n<https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L154-L171><br>\n\nAttacker may use huge amount of their fund to pump the token in a liquidity pair for one entire block. The oracle will capture the manipulated price as current TWAP implementation may only cover 1 block if timed correctly. (First block on every periodSize = 1800 minutes)\n\nThis is possible and similar to Inverse finance April attack: <https://www.coindesk.com/tech/2022/04/02/defi-lender-inverse-finance-exploited-for-156-million/>\n\n### Proof of Concept\n\nAssume currently is the first block after periodSize = 1800 minutes\n\n        function _update(uint balance0, uint balance1, uint _reserve0, uint _reserve1) internal {\n            uint blockTimestamp = block.timestamp;\n            uint timeElapsed = blockTimestamp - blockTimestampLast; // overflow is desired\n            if (timeElapsed > 0 && _reserve0 != 0 && _reserve1 != 0) {\n                reserve0CumulativeLast += _reserve0 * timeElapsed;\n                reserve1CumulativeLast += _reserve1 * timeElapsed;\n            }\n\n            Observation memory _point = lastObservation();\n            timeElapsed = blockTimestamp - _point.timestamp; // compare the last observation with current timestamp, if greater than 30 minutes, record a new event\n            if (timeElapsed > periodSize) {\n                observations.push(Observation(blockTimestamp, reserve0CumulativeLast, reserve1CumulativeLast));\n            }\n            reserve0 = balance0;\n            reserve1 = balance1;\n            blockTimestampLast = blockTimestamp;\n            emit Sync(reserve0, reserve1);\n        }\n\ntimeElapsed > periodSize (Just greater as periodSize is just passed) -> add current cumulative reserve to observations list\n\nNow, let pump the token. And use some technique that inverse finance hacker have used to hold that price for 1 block.\n\n        function current(address tokenIn, uint amountIn) external view returns (uint amountOut) {\n            Observation memory _observation = lastObservation();\n            (uint reserve0Cumulative, uint reserve1Cumulative,) = currentCumulativePrices();\n            if (block.timestamp == _observation.timestamp) {\n                _observation = observations[observations.length-2];\n            }\n\n            uint timeElapsed = block.timestamp - _observation.timestamp;\n            uint _reserve0 = (reserve0Cumulative - _observation.reserve0Cumulative) / timeElapsed;\n            uint _reserve1 = (reserve1Cumulative - _observation.reserve1Cumulative) / timeElapsed;\n            amountOut = _getAmountOut(amountIn, tokenIn, _reserve0, _reserve1);\n        }\n\n1 Block passed\n\n`reserve0Cumulative` or `reserve1Cumulative` may now be skyrocketed due to current token pumping.\n\ntimeElapsed = block.timestamp - `_observation.timestamp` is less than 20 seconds (= 1 block) since `_observation.timestamp` has just stamped in the previous block.\n\nAs timeElapsed is less than 20 seconds (= 1 block) this mean `_reserve0` and `_reserve1` are just a TWAP of less than 20 seconds (= 1 block) which is easily manipulated by Inverse finance pumping attack technique.\n\nAs `reserve0Cumulative` or `reserve1Cumulative` is skyrocketed in the 1 block timeframe that is being used in TWAP, `_reserve0` or `_reserve1` also skyrocketed.\n\nAs a conclusion, price oracle may be attacked if attacker can pump price for 1 block since TWAP just cover 1 block.\n\n### Recommended Mitigation Steps\n\nYou should calculate TWAP average of `_reserve0` and `_reserve1` in the `_update` function by using cumulative reserve difference from last update to now which has a duration of periodSize = 1800 minutes.\n\nAnd when querying for current price you can just return `_reserve0` and `_reserve1`.\n\nRefer to official uniswap v2 TWAP oracle example: <https://github.com/Uniswap/v2-periphery/blob/master/contracts/examples/ExampleOracleSimple.sol>\n\n**[nivasan1 (Canto) acknowledged](https://github.com/code-423n4/2022-06-canto-findings/issues/233)**\n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/233#issuecomment-1211424481):**\n > The warden has shown how, the `current` pricing mechanism can be easily manipulated due to an excessively small observation window.\n> \n> Because the finding shows a property of the system, I believe it to be valid.\n> \n> However, the loss of funds is contingent on someone foolish enough to use that code for their pricing.\n> \n> Because of that, I believe Medium Severity to be more appropriate.\n> \n> To confirm: Do not use `current` for pricing an asset, you will get rekt.\n\n\n\n***\n\n## [[M-11] In `Cnote.sol`, anyone can initially become both accountant and admin](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/195)\n_Submitted by p4st13r4, also found by 0x52 and Tutturu_\n\nAffected code:\n\n*   <https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L14>\n\nThe function `_setAccountantContract()` is supposed to be called after contract initialization, so that the `accountant` is immediately set. However, this function completely lacks any access control (it’s just `public`) so an attacker can monitor the mempool and frontrun the transaction in order to become both `accountant` and `admin`\n\n### Tools Used\n\nEditor\n\n### Recommended Mitigation Steps\n\nThe function should:\n\n1.  have a guard that regulates access control\n2.  not set the `admin` too, which is dangerous and out of scope\n\n**[tkkwon1998 (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/195)**\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/195#issuecomment-1205562509):**\n > Frontrunnable Initializer without POC (is impact having to re-deploy?).\n> \n> Pretty confident will downgrade.\n\n**[Alex the Entreprenerd (judge) decreased severity to Medium and commented](https://github.com/code-423n4/2022-06-canto-findings/issues/195#issuecomment-1212618986):**\n > The warden has shown how, due to front-running, anyone can become the `accountant`. With the information I have, I think the worst case scenario is a re-deploy.\n> \n> Because the setter could have been written in a better way, but because the realistic consequence is a re-deploy, I think Medium Severity to be more appropriate.\n\n\n\n***\n\n## [[M-12] Note: When `_initialSupply ! = 0`, the `_mint_to_Accountant` function will fail](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/125)\n_Submitted by cccz, also found by Picodes_\n\nIn Note contract, if `_initialSupply ! = 0`, `_totalSupply` will overflow when the `_mint_to_Accountant` function executes `_mint(msg.sender, type(uint).max)`\n\n        constructor(string memory name_, string memory symbol_, uint256 totalSupply_) public {\n            _name = name_;\n            _symbol = symbol_;\n    \t    _initialSupply = totalSupply_;\n    \t    _totalSupply = totalSupply_;\n        }\n    ...\n        function _mint(address account, uint256 amount) internal   {\n            require(account != address(0), \"ERC20: mint to the zero address\");\n\n            _beforeTokenTransfer(address(0), account, amount);\n\n            _totalSupply += amount;\n            _balances[account] += amount;\n            emit Transfer(address(0), account, amount);\n\n            _afterTokenTransfer(address(0), account, amount);\n        }\n\n### Proof of Concept\n\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Note.sol#L13-L19>\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L29-L34>\n<https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/ERC20.sol#L237-L247>\n\n### Recommended Mitigation Steps\n\nERC20.sol\n\n        constructor(string memory name_, string memory symbol_) public {\n            _name = name_;\n            _symbol = symbol_;\n        }\n\nnote.sol\n\n        constructor() ERC20(\"Note\", \"NOTE\") {\n            admin = msg.sender;\n        }\n\n**[nivasan1 (Canto) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/125#issuecomment-1163903722):**\n > Duplicate of [Issue #53 (H-06)](https://github.com/code-423n4/2022-06-canto-findings/issues/53)\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/125#issuecomment-1207502215):**\n > In contrast to #53 -> Revert of `initialize`\n> \n> This finding shows how, based on `constructor` arguments, the function `_mint_to_accountant` can fail.\n> \n> Am not convinced on the impact as I believe in the worst case the Sponsor would just be forced to re-deploy\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/125#issuecomment-1212621688):**\n > The warden has shown how, because the function `_mint_to_accountant` mints the maximum value representable, deploying Note with a non-zero `initialSupply` will cause a revert.\n> \n> Because this is contingent on a misconfiguration, I agree with Med Severity.\n\n**[abhipingle (Canto) confirmed](https://github.com/code-423n4/2022-06-canto-findings/issues/125)**\n\n\n\n***\n\n# Low Risk and Non-Critical Issues\n\nFor this contest, 45 reports were submitted by wardens detailing low risk and non-critical issues. The [report highlighted below](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/170) by **joestakey** received the top score from the judge.\n\n*The following wardens also submitted reports: [Dravee](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/69), [robee](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/29), [hake](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/257), [oyc&#95;109](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/11), [0xNazgul](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/154), [0xf15ers](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/210), [zzzitron](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/275), [Bronicle](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/229), [0x1f8b](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/48), [TomJ](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/194), [codexploder](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/110), [hansfriese](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/219), [Ruhum](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/54), [csanuragjain](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/97), [gzeon](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/182), [hyh](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/317), [Funen](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/214), [TerrierLover](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/147), [0xDjango](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/38), [sach1r0](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/60), [Limbooo](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/312), [0x52](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/72), [cccz](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/84), [simon135](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/298), [Picodes](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/105), [asutorufos](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/292), [catchup](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/139), [&#95;Adam](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/116), [fatherOfBlocks](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/76), [saian](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/265), [Tutturu](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/196), [0x29A](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/252), [0xmint](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/306), [MadWookie](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/261), [technicallyty](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/9), [nxrblsrpr](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/28), [WatchPug](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/163), [Waze](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/141), [cryptphi](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/126), [ignacio](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/310), [JMukesh](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/204), [c3phas](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/264), [defsec](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/260), and [k](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/43).*\n\n## [L-01] assert statement should not be used\n\nProperly functioning code should never reach a failing assert statement. If it happened, it would indicate the presence of a bug in the contract. A failing assert uses all the remaining gas, which can be financially painful for a user.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/Comptroller.sol\n\n    l214 assert(assetIndex < len)\n    l360 assert(markets[cToken].accountMembership[borrower])\n\n#### stableswap/BaseV1-periphery.sol\n\n    l82 assert(msg.sender == address(wcanto))\n    l227 assert(amountAOptimal <= amountADesired)\n    l273 assert(wcanto.transfer(pair, amountCANTO))\n    l419 assert(wcanto.transfer(pairFor(routes[0].from, routes[0].to, routes[0].stable), amounts[0]))\n\n### MITIGATION\n\nReplace the assert statements with a require statement or a custom error\n\n## [L-02] CloseFactor unbounded\n\nIn `Comptroller.sol`, it is mentioned that `closeFactorMantissa` should be greater than `closeFactorMinMantissa` and less than `closeFactorMaxMantissa`. But in `_setCloseFactor`, these are not checked, meaning `closeFactorMantissa` can be set to a value outside the boundaries defined by the protocol.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/Comptroller.sol\n\n    l81-l85\n    // closeFactorMantissa must be strictly greater than this value\n    uint internal constant closeFactorMinMantissa = 0.05e18; // 0.05\n\n    // closeFactorMantissa must not exceed this value\n    uint internal constant closeFactorMaxMantissa = 0.9e18; // 0.9\n\n<!---->\n\n    l850-l859\n    function _setCloseFactor(uint newCloseFactorMantissa) external returns (uint) {\n        // Check caller is admin\n        require(msg.sender == admin, \"only admin can set close factor\");\n\n        uint oldCloseFactorMantissa = closeFactorMantissa;\n        closeFactorMantissa = newCloseFactorMantissa;\n        emit NewCloseFactor(oldCloseFactorMantissa, closeFactorMantissa);\n\n        return uint(Error.NO_ERROR);\n    }\n\n### MITIGATION\n\nAdd checks in `_setCloseFactor` to ensure `closeFactorMantissa` is greater than `closeFactorMinMantissa` and less than `closeFactorMaxMantissa`.\n\n## [L-03] Immutable addresses lack zero-address check\n\nConstructors should check the address written in an immutable address variable is not the zero address.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### stableswap/BaseV1-core.sol\n\n    l107 (token0, token1, stable) = (_token0, _token1, _stable)\n\n#### stableswap/BaseV1-periphery.sol\n\n    l75factory = _factory;\n    pairCodeHash = IBaseV1Factory(_factory).pairCodeHash();\n    wcanto = IWCANTO(_wcanto);\n\n### MITIGATION\n\nAdd a zero address check for the immutable variables aforementioned.\n\n## [L-04] Receive function\n\n`AccountantDelegate` has a `receive()` function, but does not have any withdrawal function. Any Manifest mistakenly sent to this contract would be locked.\n\n### PROOF OF CONCEPT\n\n#### lending-market/AccountantDelegate.sol\n\n    l94 receive() external override payable {}\n\n### MITIGATION\n\nAdd `require(0 == msg.value)` in `receive()` or remove the function altogether.\n\n## [L-05] Local variable shadowing\n\nIn `lending-market/NoteInterest.sol`, there is local variable shadowing: the constructor parameter has the same name as the storage variable `baseRatePerYear`. This will not lead to any error but can be confusing, especially in the constructor where `baseRatePerBlock` is computed using the constructor parameter `baseRatePerYear`.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/NoteInterest.sol\n\n    constructor(uint baseRatePerYear) {\n        baseRatePerBlock = baseRatePerYear.div(blocksPerYear)\n\n### MITIGATION\n\nAdd an underscore to the constructor parameter (`_baseRatePerYear`) to avoid shadowing.\n\n## [L-06] Avoid Using `.Transfer` to Transfer Native Tokens\n\nIn `WETH` and `TreasuryDelegate`, the `.transfer()` method is used to transfer Manifest. \n\nThe `transfer()` call requires that the recipient has a payable callback, only provides 2300 gas for its operation. This means the following cases can cause the transfer to fail:\n\n- The contract does not have a payable callback\n- The contract’s payable callback spends more than 2300 gas (which is only enough to emit something)\n- The contract is called through a proxy which itself uses up the 2300 gas\n\n### Proof Of Concept\n\nSee [this article](https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/).\n\nThe `.transfer` method is called in these places:\n\n#### WETH.sol\n\n```\nl31 payable(msg.sender).transfer(wad)\n```\n\n#### TreasuryDelegate.sol\n\n```\nl52 to.transfer(amount)\n```\n\n### Mitigation\n\nUse `.call()` to send Manifest.\n\n## [N-01] Underflow desired but not possible\n\nUnderflow is desired in several price update functions of `stableswap/BaseV1Pair`, but as overflow/underflow checks are automatically performed since Solidity 0.8.0, the functions currently revert if there is underflow.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### stableswap/BaseV1-core.sol\n\n    l156 uint timeElapsed = blockTimestamp - blockTimestampLast; // overflow is desired\n    l183 uint timeElapsed = blockTimestamp - _blockTimestampLast\n\n### MITIGATION\n\nPlace these statements in an `unchecked` block to allow underflow\n\n## [N-02] Comment Missing function parameter\n\nSome of the function comments are missing function parameters or returns\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/GovernorBravoDelegate.sol\n\n    l452 @param borrowerIndex\n    l526 @param seizeTokens\n    l677 @param accounts\n    l689 @param accounts\n    l826 @param newOracle\n    l1210 @param marketBorrowIndex\n    l1270 @param marketBorrowIndex\n\n#### lending-market/CNote.sol\n\n    l31 @param borrower\n\n#### lending-market/NoteInterest.sol\n\n    l92 @param cash\n    l92 @param borrows\n    l92 @param reserves\n    l109 @param cash\n    l109 @param borrows\n    l109 @param reserves\n    l109 @param reserveFactorMantissa\n\n### MITIGATION\n\nAdd a comment for these parameters.\n\n## [N-03] Constants instead of magic numbers\n\nIt is best practice to use constant variables rather than literal values to make the code easier to understand and maintain.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/NoteInterest.sol\n\n    l95 100\n    l96 100\n\n### MITIGATION\n\nDefine constant variables for the literal values aforementioned.\n\n## [N-04] Constructor visibility\n\nVisibility (public / external) is not needed for constructors anymore since Solidity 0.7.0, see [here](https://docs.soliditylang.org/en/v0.7.0/070-breaking-changes.html#functions-and-events)\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/AccountantDelegator.sol\n\n    l16 constructor(\n    \t\t\taddress implementation_,\n    \t\t\taddress admin_,\n          address cnoteAddress_,\n          address noteAddress_,\n          address comptrollerAddress_, \n          address treasury_) public\n\n### MITIGATION\n\nRemove the `public` modifier from constructors.\n\n## [N-05] Events indexing\n\nEvents should use indexed fields\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/Comptroller.sol\n\n    l19 event MarketListed(CToken cToken)\n    l22 event MarketEntered(CToken cToken, address account)\n    l25 event MarketExited(CToken cToken, address account)\n    l28 event NewCloseFactor(uint oldCloseFactorMantissa, uint newCloseFactorMantissa)\n    l31 event NewCollateralFactor(CToken cToken, uint oldCollateralFactorMantissa, uint newCollateralFactorMantissa)\n    l34 event NewLiquidationIncentive(uint oldLiquidationIncentiveMantissa, uint newLiquidationIncentiveMantissa)\n    l37 event NewPriceOracle(PriceOracle oldPriceOracle, PriceOracle newPriceOracle)\n    l40 event NewPauseGuardian(address oldPauseGuardian, address newPauseGuardian)\n    l43 event ActionPaused(string action, bool pauseState)\n    l46 event ActionPaused(CToken cToken, string action, bool pauseState)\n    l49 event CompBorrowSpeedUpdated(CToken indexed cToken, uint newSpeed)\n    l52 event CompSupplySpeedUpdated(CToken indexed cToken, uint newSpeed)\n    l55 event ContributorCompSpeedUpdated(address indexed contributor, uint newSpeed)\n    l58 event DistributedSupplierComp(CToken indexed cToken, address indexed supplier, uint compDelta, uint compSupplyIndex)\n    l61 event DistributedBorrowerComp(CToken indexed cToken, address indexed borrower, uint compDelta, uint compBorrowIndex)\n    l64 event NewBorrowCap(CToken indexed cToken, uint newBorrowCap)\n    l67 event NewBorrowCapGuardian(address oldBorrowCapGuardian, address newBorrowCapGuardian)\n    l70 event CompGranted(address recipient, uint amount)\n    l73 event CompAccruedAdjusted(address indexed user, uint oldCompAccrued, uint newCompAccrued)\n    l76 event CompReceivableUpdated(address indexed user, uint oldCompReceivable, uint newCompReceivable)\n\n#### lending-market/AccountantInterfaces.sol\n\n    l15 event AcctInit(address lendingMarketAddress)\n    l16 event AcctSupplied(uint amount, uint err)\n    l25 event NewImplementation(address oldImplementation, address newImplementation)\n\n#### lending-market/TreasuryInterfaces.sol\n\n    l17 event NewImplementation(address oldImplementation, address newImplementation)\n\n#### lending-market/CNote.sol\n\n    l10 event AccountantSet(address accountant, address accountantPrior)\n\n#### lending-market/NoteInterest.sol\n\n    l17 event NewInterestParams(uint baserateperblock)\n    l61 event NewBaseRate(uint oldBaseRateMantissa, uint newBaseRateMantissa)\n    l64 event NewAdjusterCoefficient(uint oldAdjusterCoefficient, uint newAdjusterCoefficient)\n    l67 event NewUpdateFrequency(uint oldUpdateFrequency, uint newUpdateFrequency)\n\n#### stableswap/BaseV1-core.sol\n\n    l88 event Mint(address indexed sender, uint amount0, uint amount1);\n    l89 event Burn(address indexed sender, uint amount0, uint amount1, address indexed to);\n    l90 event Swap(\n            address indexed sender,\n            uint amount0In,\n            uint amount1In,\n            uint amount0Out,\n            uint amount1Out,\n            address indexed to\n        );\n    l98 event Sync(uint reserve0, uint reserve1);\n    l99 event Claim(address indexed sender, address indexed recipient, uint amount0, uint amount1);\n    l101 event Transfer(address indexed from, address indexed to, uint amount);\n    l102 event Approval(address indexed owner, address indexed spender, uint amount)\n    l486 event PairCreated(address indexed token0, address indexed token1, bool stable, address pair, uint)\n\n### MITIGATION\n\nAdd indexed fields to these events so that they have the maximum number of indexed fields possible.\n\n## [N-06] Event should be emitted in setters\n\nSetters should emit an event so that Dapps can detect important changes to storage\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/WETH.sol\n\n    l22 function deposit() \n    l28 function withdraw()\n\n#### lending-market/GovernorBravoDelegate.sol\n\n    l131 function _initiate()\n\n#### stableswap/BaseV1-core.sol\n\n    l497 function setPauser()\n    l507 function setPause()\n\n### MITIGATION\n\nEmit an event in all setters.\n\n## [N-07] Function missing comments\n\nSome functions are missing Natspec comments.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### manifest/Proposal-Store.sol\n\n    l46 function AddProposal\n    l52 function QueryProp\n\n#### lending-market/WETH.sol\n\nAll the functions are missing comments\n\n#### lending-market/GovernorBravoDelegate.sol\n\n    l77 function queueOrRevertInternal\n    l180 function add256\n    l186 function sub256\n    l191 function getChainIdInternal()\n\n#### lending-market/Comptroller.sol\n\n    l294 function redeemAllowedInternal\n    l180 function add256\n    l186 function sub256\n    l191 function getChainIdInternal()\n    l958 function _addMarketInternal()\n    l965 function _initializeMarket\n    l1050 function _setMintPaused\n    l1060 function _setBorrowPaused\n    l1070 function _setTransferPaused\n    l1079 function _setSeizePaused\n    l1088 function _become\n    l1094 function fixBadAccruals\n    l1144 function adminOrInitializing\n    l1461 function getBlockNumber\n\n#### lending-market/CNote.sol\n\n    l14 function _setAccountantContract\n    l23 function getAccountant\n\n#### stableswap/BaseV1-core.sol\n\nAll the functions are missing proper Natspec comments.\n\n#### stableswap/BaseV1-periphery.sol\n\nAll the functions are missing proper Natspec comments.\n\n### MITIGATION\n\nAdd comments to these functions.\n\n## [N-08] Function order\n\nFunctions should be ordered following the [Soldiity conventions](https://docs.soliditylang.org/en/v0.8.15/style-guide.html#order-of-functions): `receive()` function should be placed after the constructor and before every other function.\n\n### PROOF OF CONCEPT\n\nSeveral contracts have `receive()` and `fallback()` at the end:\n\n*   lending-market/AccountantDelegate.sol\n\n*   lending-market/AccountantDelegator.sol\n\n*   lending-market/TreasuryDelegator.sol\n\n### MITIGATION\n\nPlace the `receive()` and `fallback()` functions after the constructor, before all the other functions.\n\n## [N-09] Non-library files should use fixed compiler versions\n\nContracts should be compiled using a fixed compiler version. Locking the pragma helps ensure that contracts do not accidentally get deployed using a different compiler version with which they have been tested the most.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### ZoneInteraction.sol\n\n`WETH.sol`, `GovernorBravoDelegate.sol`, `Comptroller.sol`, `AccountantDelegate.sol`, `AccountantDelegator.sol`, `AccountantInterfaces.sol`, `TreasuryDelegate.sol`, `TreasuryDelegator.sol`, `TreasuryInterfaces.sol`, `CNote.sol` and `NoteInterest.sol` have floating pragmas.\n\n### MITIGATION\n\nUsed a fixed compiler version.\n\n## [N-10] Open TODOs\n\n### PROBLEM\n\nThere are open TODOs in the code. Code architecture, incentives, and error handling/reporting questions/issues should be resolved before deployment.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/Comptroller.sol\n\n    l1232 // TODO: Don't distribute supplier COMP if the user is not in the supplier market.\n    l1271 // TODO: Don't distribute supplier COMP if the user is not in the borrower market.\n\n### MITIGATION\n\nRemove the TODOs.\n\n## [N-11] Public functions can be external\n\nIt is good practice to mark functions as `external` instead of `public` if they are not called by the contract where they are defined.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### manifest/Proposal-Store.sol\n\n    l46 function AddProposal()\n    l52 function QueryProp()\n\n#### lending-market/GovernorBravoDelegate.sol\n\n    l24 function initialize()\n\n#### lending-market/Comptroller.sol\n\n    l122 function enterMarkets()\n    l677 function getAccountLiquidity()\n    l703 function getHypotheticalAccountLiquidity()\n    l826 function _setPriceOracle()\n    l1033 function _setPauseGuardian()\n    l1050 function _setMintPaused()\n    l1060 function _setBorrowPaused()\n    l1070 function _setTransferPaused()\n    l1079 function _setSeizePaused()\n    l1088 function _become()\n    l1324 function claimComp(address holder)\n    l1394 function _grantComp()\n    l1407 function _setCompSpeeds()\n    l1423 function _setContributorCompSpeed()\n    l1444 function getAllMarkets()\n\n#### lending-market/AccountantDelegate.sol\n\n    l15 function initialize()\n\n#### lending-market/AccountantDelegator.sol\n\n    l109 delegateToViewImplementation()\n\n#### lending-market/TreasuryDelegate.sol\n\n    l15 function initialize()\n\n#### lending-market/TreasuryDelegator.sol\n\n    l84 delegateToViewImplementation()\n\n#### lending-market/CNote.sol\n\n    l14 function _setAccountantContract\n\n#### lending-market/NoteInterest.sol\n\n    l118 function updateBaseRate\n\n### MITIGATION\n\nDeclare these functions as `external` instead of `public`.\n\n## [N-12] Require statements should have descriptive strings\n\nSome require statements are missing error strings, which makes it more difficult to debug when the function reverts.\n\n### PROOF OF CONCEPT\n\n#### lending-market/WETH.sol\n\n    l69 require(_balanceOf[src] >= wad)\n    l72 require(_allowance[src][msg.sender] >= wad)\n\n#### lending-market/GovernorBravoDelegate.sol\n\n    l53 require(proposals[unigovProposal.id].id == 0)\n\n#### stableswap/BaseV1-core.sol\n\n    l125 require(_unlocked == 1)\n    l285 require(!BaseV1Factory(factory).isPaused());\n    l465 require(token.code.length > 0)\n    l468 require(success && (data.length == 0 || abi.decode(data, (bool))))\n    l498 require(msg.sender == pauser)\n    l503 require(msg.sender == pendingPauser)\n    l508 require(msg.sender == pauser)\n\n#### stableswap/BaseV1-periphery.sol\n\n    l210 require(amountADesired >= amountAMin);\n    l211 require(amountBDesired >= amountBMin)\n    l291 require(IBaseV1Pair(pair).transferFrom(msg.sender, pair, liquidity))\n    l456 require(token.code.length > 0)\n    l459 require(success && (data.length == 0 || abi.decode(data, (bool))))\n    l463 require(token.code.length > 0, \"token code length faialure\")\n    l466 require(success && (data.length == 0 || abi.decode(data, (bool))), \"failing here\")\n\n### MITIGATION\n\nAdd error strings to all require statements.\n\n## [N-13] Scientific notation\n\nFor readability, it is best to use scientific notation (e.g `10e5`) rather than decimal literals(`100000`) or exponentiation(`10**5`).\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### stableswap/BaseV1-periphery.sol\n\n    l67 uint internal constant MINIMUM_LIQUIDITY = 10**3\n\n### MITIGATION\n\nReplace `10**3` with `10e3`.\n\n## [N-14] Styling\n\nThere should be space between operands in mathematical computations\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### stableswap/BaseV1-periphery.sol\n\n    l134 routes.length+1\n    l139 amounts[i+1]\n    l366 routes[i+1].from, routes[i+1].to, routes[i+1].stable\n\n### MITIGATION\n\nAdd spaces, e.g\n\n    -routes.length+1\n    +routes.length + 1\n\n## [N-15] Typos\n\nThere are a few typos in the contracts.\n\n### PROOF OF CONCEPT\n\nInstances include:\n\n#### lending-market/NoteInterest.sol\n\n    l89 irrelevent\n\n#### stableswap/BaseV1-periphery.sol\n\n    l463 faialure\n\n### MITIGATION\n\nCorrect the typos.\n\n\n\n***\n\n# Gas Optimizations\n\nFor this contest, 39 reports were submitted by wardens detailing gas optimizations. The [report highlighted below](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/115) by **&#95;Adam** received the top score from the judge.\n\n*The following wardens also submitted reports: [0xNazgul](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/153), [gzeon](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/183), [0xKitsune](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/150), [saian](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/286), [0x1f8b](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/45), [joestakey](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/156), [Dravee](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/67), [Limbooo](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/247), [defsec](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/236), [hansfriese](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/221), [Waze](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/86), [0x29A](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/273), [0xf15ers](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/215), [0xkatana](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/27), [c3phas](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/290), [catchup](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/140), [fatherOfBlocks](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/75), [Funen](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/259), [JC](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/305), [oyc&#95;109](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/10), [rfa](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/315), [robee](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/30), [sach1r0](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/59), [simon135](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/272), [TerrierLover](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/144), [Tomio](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/262), [TomJ](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/157), [ynnad](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/92), [Ruhum](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/55), [0v3rf10w](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/188), [0xmint](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/307), [ak1](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/230), [Chom](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/251), [Fitraldys](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/285), [hake](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/258), [k](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/44), [MadWookie](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/267), and [Picodes](https://github.com/code-423n4/2022-06-newblockchain-findings/issues/106).*\n\n## [G-01] Initialising to Default Values\n\nWhen initialising a variable to its default variable, it is cheaper to leave blank. I ran a test in remix that initialises a single variable and got a saving of 2,246 gas.\n\n    contract Test {\n        uint256 public variable = 0;     (69,312 gas)\n        vs\n        uint256 public variable;         (67,066 gas)\n    }\n\n[BaseV1-core.sol#L46](https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-core.sol#L46) - can change to: uint public totalSupply;\n\n## [G-02] Emitting Storage Variables\n\nYou can save an SLOAD (&#126;100 gas) by emiting local variables over storage variables when they have the same value.\n\n[BaseV1-core.sol#L170](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L170) - can emit balance0 & balance1 over reserve0 & reserve0 (save 2 SLOADS)<br>\n[Comptroller.sol#L856](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L856) - can emit newCloseFactorMantissa instead of closeFactorMantissa<br>\n[Comptroller.sol#L1045](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1045) - can emit newPauseGuardian instead of pauseGuardian<br>\n[NoteInterest.sol#L127](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L127) - can emit newBaseRatePerYear instead of baseRatePerYear<br>\n[NoteInterest.sol#L144](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L144) - can emit newBaseRateMantissa instead of baseRatePerYear<br>\n[NoteInterest.sol#L144](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L144) - can emit newAdjusterCoefficient instead of adjusterCoefficient<br>\n[NoteInterest.sol#L170](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L170) - can emit newUpdateFrequency instead of updateFrequency<br>\n\n## [G-03] Variables Can be Immutable/Constant\n\nThe following variables are initialised either when created or in the constructor and then never modified and can be changed to immutable/constant to save gas.\n\n[Proposal-Store.sol#L35](https://github.com/Plex-Engineer/manifest/blob/688e9b4e7835854c22ef44b045d6d226b784b4b8/contracts/Proposal-Store.sol#L35)<br>\n[BaseV1-core.sol#L39-L40](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L39-L40)<br>\n[WETH.sol#L6-L8](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L6-L8)<br>\n[NoteInterest.sol#L22](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L22)<br>\n\n## [G-04] For Loop Optimisations\n\nWhen incrementing i in for loops there is no chance of overflow so unchecked can be used to save gas. I ran a simple test in remix and found deployment savings of 31,653 gas and on each function call saved &#126;141 gas per iteration.\n\n    contract Test {\n    \tfunction loopTest() external {\n    \t\tfor (uint256 i; i < 1; ++i) {\n    \t\tDeployment Cost: 125,637, Cost on function call: 24,601\n    \t\tvs\n    \t\tfor (uint256 i; i < 1; ) {\n    \t\t// for loop body\n    \t\tunchecked { ++i }\n    \t\tDeployment Cost: 93,984, Cost on function call: 24,460\n    \t\t}\n    \t}\n    }\n\nIn for loops pre increments can also be used to save a small amount of gas per iteraition.<br>\nI ran a test in remix using a for loop and found the deployment savings of 497 gas and &#126;5 gas per iteration.\n\n    contract Test {\n    \tfunction loopTest() external {\n    \t\tfor (uint256 i; i < 1; i++) {\n    \t\t(Deployment cost: 118,408, Cost on function call: 24,532)\n    \t\tvs\n    \t\tfor (uint256 i; i < 1; ++i) {\n    \t\t(Deployment cost: 117,911, Cost on function call: 24,527)\n    \t\t}\n    \t}\n    }\n\nLooping over memory/storage variable lengths will cost &#126;3 gas/&#126;100 gas per iteration, I recommend cacheing their value and looping over that instead.\n\nInstances of for loops that can be optimised:<br>\n[BaseV1-core.sol#L207](https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-core.sol#L207)<br>\n[BaseV1-core.sol#L337](https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-core.sol#L337)<br>\n[BaseV1-periphery.sol#L136](https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-periphery.sol#L136)<br>\n[BaseV1-periphery.sol#L362](https://github.com/Plex-Engineer/stableswap/blob/0dd7ac65d923bb7462c47f6d56b564af34b34118/contracts/BaseV1-periphery.sol#L362)<br>\n[GovernorBravoDelegate.sol#L68](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L68)<br>\n[GovernorBravoDelegate.sol#L90](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L90)<br>\n[Comptroller.sol#L126](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L126)<br>\n[Comptroller.sol#L206](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L206)<br>\n[Comptroller.sol#L735](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L735)<br>\n[Comptroller.sol#L959](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L959)<br>\n[Comptroller.sol#L1005](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1005)<br>\n[Comptroller.sol#L1106](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1106)<br>\n[Comptroller.sol#L1347](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1347)<br>\n[Comptroller.sol#L1353](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1353)<br>\n[Comptroller.sol#L1359](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1359)<br>\n[Comptroller.sol#L1364](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1364)<br>\n[Comptroller.sol#L1413](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1413)<br>\n\n## [G-05] Minimising SLOAD's\n\nYou can save 1 SLOAD (&#126;97 gas) per use by cacheing a storage variable that is used more than once.\n\n[CNote.sol#L15-L18](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L15-L18) - can cache `address(_ accountant)`<br>\n[CNote.sol#L179-L180](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L179-L180) - can cache `address(_ accountant)`<br>\n\n## [G-06] No Need to check == True in Conditional Statements\n\nYou can save some gas (&#126;1000 gas on deployment and &#126;10 gas on function call, based on remix test) by removing == True from the following locations.\n[Comptroller.sol#L149](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L149)\n[Comptroller.sol#L1053](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1053)\n[Comptroller.sol#L1063](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1063)\n[Comptroller.sol#L1072](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1072)\n[Comptroller.sol#L1081](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1081)\n[Comptroller.sol#L1350](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1350)\n[Comptroller.sol#L1357](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1357)\n[Comptroller.sol#L1456](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1456)\n\n## [G-07] Custom Errors\n\nAs your using a solidity version greater 0.8.4 you can replace revert strings with custom errors. This will save in deployment costs and runtime costs.<br>\nI ran a test in remix comparing a revert string vs custom errors and found that replacing a single revert string with a custom error saved 12,404 gas in deployment cost and 86 gas on each function call.\n\n    contract Test {\n    \tuint256 a;\n    \tfunction check() external {\n    \t\trequire(a != 0, \"check failed\");\n    \t}\n    }   (Deployment cost: 114,703, Cost on Function call: 23,392)\n    vs \n    contract Test {\n    \tuint256 a;\n    \terror checkFailed();\n    \tfunction check() external {\n    \t\tif (a != 0) revert checkFailed();\n    \t}\n    }   (Deployment cost: 102,299, Cost on Function call: 23,306)\n\nI recommend replacing all revert strings with custom errors.\n\n## [G-08] Long Revert Strings\n\nIf opting not to update revert strings to custom errors, keeping revert strings <= 32 bytes in length will save gas.<br>\nI ran a test in remix and found the savings for a single short revert string vs long string to be 9,377 gas in deployment cost and 18 gas on function call.\n\n    contract Test {\n    \tuint256 a;\n    \tfunction check() external {\n    \t\trequire(a != 0, \"short error message\"); \n    \t\t(Deployment cost: 114,799, Cost on function call: 23,392)\t\n    \t\tvs \n    \t\trequire(a != 0, \"A longer Error Message over 32 bytes in     \n            length\"); \n    \t\t(Deployment cost: 124,176, Cost on function call: 23,410)\t\n    \t}\n    }\n\nI recommend shortenning the following revert strings to <= 32 bytes in length:\n\n[BaseV1-periphery.sol#L86](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L86)<br>\n[BaseV1-periphery.sol#L104-L105](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L104-L105)<br>\n[BaseV1-periphery.sol#L223](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L223)<br>\n[BaseV1-periphery.sol#L228](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L228)<br>\n[BaseV1-periphery.sol#L295-L296](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L295-L296)<br>\n[BaseV1-periphery.sol#L387](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L387)<br>\n[BaseV1-periphery.sol#L402](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L402)<br>\n[BaseV1-periphery.sol#L417](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L417)<br>\n[BaseV1-periphery.sol#L430](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L430)<br>\n[BaseV1-periphery.sol#L452](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L452)<br>\n[WETH.sol#L29](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L29)<br>\n[WETH.sol#L96-L97](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/WETH.sol#L96-L97)<br>\n[GovernorBravoDelegate.sol#L25-L27](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L25-L27)<br>\n[GovernorBravoDelegate.sol#L42-L47](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L42-L47)<br>\n[GovernorBravoDelegate.sol#L78](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L78)<br>\n[GovernorBravoDelegate.sol#L87](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L87)<br>\n[GovernorBravoDelegate.sol#L115](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L115)<br>\n[GovernorBravoDelegate.sol#L132-L133](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L132-L133)<br>\n[GovernorBravoDelegate.sol#L146](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L146)<br>\n[GovernorBravoDelegate.sol#L164](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L164)<br>\n[Comptroller.sol#L178](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L178)<br>\n[Comptroller.sol#L491](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L491)<br>\n[Comptroller.sol#L998](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L998)<br>\n[Comptroller.sol#L1016](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1016)<br>\n[Comptroller.sol#L1051-L1052](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1051-L1052)<br>\n[Comptroller.sol#L1061-L1062](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1061-L1062)<br>\n[Comptroller.sol#L1071](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1071)<br>\n[Comptroller.sol#L1080](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1080)<br>\n[Comptroller.sol#L1089](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1089)<br>\n[Comptroller.sol#L1095-L1096](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1095-L1096)<br>\n[Comptroller.sol#L1411](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1411)<br>\n[AccountantDelegator.sol#L43-L44](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegator.sol#L43-L44)<br>\n[AccountantDelegator.sol#L124](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Accountant/AccountantDelegator.sol#L124)<br>\n[TreasuryDelegator.sol#L31-L32](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Treasury/TreasuryDelegator.sol#L31-L32)<br>\n[TreasuryDelegate.sol#L47](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Treasury/TreasuryDelegate.sol#L47)<br>\n[CNote.sol#L16](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L16)<br>\n[CNote.sol#L43](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L43)<br>\n[CNote.sol#L45](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L45)<br>\n[CNote.sol#L54](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L54)<br>\n[CNote.sol#L77](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L77)<br>\n[CNote.sol#L114](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L114)<br>\n[CNote.sol#L130](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L130)<br>\n[CNote.sol#L146](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L146)<br>\n[CNote.sol#L198](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L198)<br>\n[CNote.sol#L214](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L214)<br>\n[CNote.sol#L264](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L264)<br>\n[CNote.sol#L310](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L310)<br>\n[CNote.sol#L330](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/CNote.sol#L330)<br>\n[NoteInterest.sol#L141](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L141)<br>\n[NoteInterest.sol#L154](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L154)<br>\n[NoteInterest.sol#L167](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/NoteInterest.sol#L167)<br>\n\n## [G-09] Uint > 0 Checks in Require Functions\n\nIf opting not to use custom errors when checking whether a uint is > 0 in a requrie functions you can save a small amount of gas by replacing with != 0. This is only true if optimiser is turned on and in a require statement. I ran a test in remix with optimisation set to 10,000 and found the savings for a single occurance is 632 in deployment cost and 6 gas on each function call.\n\n    contract Test {\n    \tuint256 a;\n    \tfunction check() external {\n    \t\trequire(a > 0); \n    \t\t(Deployment cost: 79,763, Cost on function call: 23,305)\t\n    \t\tvs\n    \t\trequire(a != 0); \n    \t\t(Deployment cost: 79,331, Cost on function call: 23,299)\t\n    \t}\n    }\n\nInstances where a uint is compared > 0:<br>\n[BaseV1-core.sol#L253](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L253)<br>\n[BaseV1-core.sol#L272](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L272)<br>\n[BaseV1-core.sol#L286](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L286)<br>\n[BaseV1-core.sol#L303](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L303)<br>\n[BaseV1-core.sol#L465](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L465)<br>\n[BaseV1-periphery.sol#L104-L105](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L104-L105)<br>\n[BaseV1-periphery.sol#L456](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L456)<br>\n[BaseV1-periphery.sol#L463](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L463)<br>\n\n## [G-10] && in Require Functions\n\nIf not opting to use custom errors and If optimising for running costs over deployment costs you can seperate && in require functions into 2 parts. I ran a basic test in remix and it cost an extra 234 gas to deploy but will save &#126;9 gas everytime the require function is called.\n\n    contract Test {\n    \tuint256 a = 0;\n    \tuint256 b = 1;\n\n    \tfunction test() external {\n    \t\trequire(a == 0 && b > a) \n    \t\t(Deployment cost: 123,291, Cost on function call: 29,371)\n    \t\tvs\n    \t\trequire(a == 0);\n    \t\trequire(b > a);\n    \t\t(Deployment cost: 123,525, Cost on function call: 29,362)\n    \t}\n    }\n\nInstances where require statements can be split into seperate statements:\n\n[BaseV1-core.sol#L272](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L272)<br>\n[BaseV1-core.sol#L288](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L288)<br>\n[BaseV1-core.sol#L294](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L294)<br>\n[BaseV1-core.sol#L431](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L431)<br>\n[BaseV1-core.sol#L468](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-core.sol#L468)<br>\n[BaseV1-periphery.sol#L105](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L105)<br>\n[BaseV1-periphery.sol#L459](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L459)<br>\n[BaseV1-periphery.sol#L466](https://github.com/Plex-Engineer/stableswap/blob/489d010eb99a0885139b2d5ed5a2d826838cc5f9/contracts/BaseV1-periphery.sol#L466)<br>\n[GovernorBravoDelegate.sol#L42-L45](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L42-L45)<br>\n[GovernorBravoDelegate.sol#L115](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L115)<br>\n[GovernorBravoDelegate.sol#L164](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Governance/GovernorBravoDelegate.sol#L164)<br>\n[Comptroller.sol#L1003](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1003)<br>\n[Comptroller.sol#L1411](https://github.com/Plex-Engineer/lending-market/blob/ab31a612be354e252d72faead63d86b844172761/contracts/Comptroller.sol#L1411)<br>\n\n**[Alex the Entreprenerd (judge) commented](https://github.com/code-423n4/2022-06-canto-findings/issues/115#issuecomment-1204597814):**\n > Over 10k between immutables and stuff\n>\n > **[G-01] Initialising to Default Values**<br>\n> Valid but I only count runtime gas vs deployment\n> \n> **[G-02] Emitting Storage Variables**<br>\n> 8 * 97 (3 gas for the MLOAD)<br>\n> \n> 776\n> \n> **[G-03] Variables Can be Immutable/Constant**<br>\n> 7 * 2100<br>\n> 14700\n> \n> **[G-04] For Loop Optimisations**<br>\n> I think the benchmark is correct but may be unfairly skewed against the non-optimized (perhaps no optimizer)<br>\n> Will give 25 points per instance<br>\n> \n> 17 * 25<br>\n> 425\n> \n> **[G-05] Minimising SLOAD's**<br>\n> 94 each (6 gas for setup of cache)<br>\n> 188\n> \n> **[G-06] No Need to check == True in Conditional Statements**<br>\n> 6 gas per instance (3 for check, 3 for MLOAD of the hardcoded value)<br>\n> 8 * 6<br>\n> 48\n>\n > **[G-07] Custom Errors**<br>\n> Because you benchmarked it, I'll keep that in mind in scoring\n> \n> **[G-08] Long Revert Strings**<br>\n> 6 per instance<br>\n> 51 * 6 <br>\n> 301\n> \n> **[G-09] Uint > 0 Checks in Require Functions**<br>\n> 6 per instance<br>\n> 8 * 6<br>\n> 48\n> \n> **[G-10] && in Require Functions**<br>\n> 9 per instance (because you benchmarked, would have given 3 normally)<br>\n> 13 * 9 <br>\n> 117<br>\n> \n> \n> **Total Gas Saved**<br>\n> **16603**\n\n\n\n***\n\n# Disclosures\n\nC4 is an open organization governed by participants in the community.\n\nC4 Contests incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Contest submissions are judged by a knowledgeable security researcher and solidity developer and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\n\nC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\n"
}